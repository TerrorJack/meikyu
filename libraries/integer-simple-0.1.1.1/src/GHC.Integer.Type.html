<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE CPP, MagicHash, NoImplicitPrelude, BangPatterns, UnboxedTuples,
             UnliftedFFITypes #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-- Commentary of Integer library is located on the wiki:</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- http://ghc.haskell.org/trac/ghc/wiki/Commentary/Libraries/Integer</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- It gives an in-depth description of implementation details and</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- decisions.</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Module      :  GHC.Integer.Type</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Copyright   :  (c) Ian Lynagh 2007-2012</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- License     :  BSD3</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- Maintainer  :  igloo@earth.li</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- Stability   :  internal</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- Portability :  non-portable (GHC Extensions)</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- A simple definition of the 'Integer' type.</span><span>
</span><a name="line-22"></a><span class="hs-comment">--</span><span>
</span><a name="line-23"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-cpp">#include &quot;MachDeps.h&quot;</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Integer</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Prim</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Classes</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Tuple.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Tuple</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">IntWord64</span><span>
</span><a name="line-35"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">data</span><span> </span><a name="Integer"><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier">Integer</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Positive"><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier">Positive</span></a></a><span> </span><span class="hs-glyph">!</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Negative"><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier">Negative</span></a></a><span> </span><span class="hs-glyph">!</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Naught"><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier">Naught</span></a></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- The hard work is done on positive numbers</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- Least significant bit is first</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- Positive's have the property that they contain at least one Bit,</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- and their last Bit is One.</span><span>
</span><a name="line-46"></a><span class="hs-keyword">type</span><span> </span><a name="Positive"><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier">Positive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-47"></a><span class="hs-keyword">type</span><span> </span><a name="Positives"><a href="GHC.Integer.Type.html#Positives"><span class="hs-identifier">Positives</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#List"><span class="hs-identifier hs-type">List</span></a><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-keyword">data</span><span> </span><a name="Digits"><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier">Digits</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Some"><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier">Some</span></a></a><span> </span><span class="hs-glyph">!</span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">!</span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-50"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="None"><a href="GHC.Integer.Type.html#None"><span class="hs-identifier">None</span></a></a><span>
</span><a name="line-51"></a><span class="hs-keyword">type</span><span> </span><a name="Digit"><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier">Digit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- XXX Could move [] above us</span><span>
</span><a name="line-54"></a><span class="hs-keyword">data</span><span> </span><a name="List"><a href="GHC.Integer.Type.html#List"><span class="hs-identifier">List</span></a></a><span> </span><a name="local-6989586621679016966"><a href="#local-6989586621679016966"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Nil"><a href="GHC.Integer.Type.html#Nil"><span class="hs-identifier">Nil</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Cons"><a href="GHC.Integer.Type.html#Cons"><span class="hs-identifier">Cons</span></a></a><span> </span><a href="#local-6989586621679016966"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#List"><span class="hs-identifier hs-type">List</span></a><span> </span><a href="#local-6989586621679016966"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-identifier">mkInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>   </span><span class="hs-comment">-- non-negative?</span><span>
</span><a name="line-57"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- absolute value in 31 bit chunks, least significant first</span><span>
</span><a name="line-58"></a><span>                    </span><span class="hs-comment">-- ideally these would be Words rather than Ints, but</span><span>
</span><a name="line-59"></a><span>                    </span><span class="hs-comment">-- we don't have Word available at the moment.</span><span>
</span><a name="line-60"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-61"></a><a name="mkInteger"><a href="GHC.Integer.Type.html#mkInteger"><span class="hs-identifier">mkInteger</span></a></a><span> </span><a name="local-6989586621679016967"><a href="#local-6989586621679016967"><span class="hs-identifier">nonNegative</span></a></a><span> </span><a name="local-6989586621679016968"><a href="#local-6989586621679016968"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679016972"><a href="#local-6989586621679016972"><span class="hs-identifier">abs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016969"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679016968"><span class="hs-identifier hs-var">is</span></a><span>
</span><a name="line-62"></a><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679016967"><span class="hs-identifier hs-var">nonNegative</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679016972"><span class="hs-identifier hs-var">abs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><a href="#local-6989586621679016972"><span class="hs-identifier hs-var">abs</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679016969"><a href="#local-6989586621679016969"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-64"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span></a><span> </span><a name="local-6989586621679016970"><a href="#local-6989586621679016970"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679016971"><a href="#local-6989586621679016971"><span class="hs-identifier">is'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#smallInteger"><span class="hs-identifier hs-var">smallInteger</span></a><span> </span><a href="#local-6989586621679016970"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#orInteger"><span class="hs-identifier hs-var">orInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#shiftLInteger"><span class="hs-identifier hs-var">shiftLInteger</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679016969"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679016971"><span class="hs-identifier hs-var">is'</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">31</span><span class="hs-operator">#</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-identifier">errorInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-67"></a><a name="errorInteger"><a href="GHC.Integer.Type.html#errorInteger"><span class="hs-identifier">errorInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="GHC.Integer.Type.html#errorPositive"><span class="hs-identifier hs-var">errorPositive</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-identifier">errorPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-70"></a><a name="errorPositive"><a href="GHC.Integer.Type.html#errorPositive"><span class="hs-identifier">errorPositive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">47</span><span class="hs-operator">##</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-comment">-- Random number</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-pragma">{-# NOINLINE smallInteger #-}</span><span>
</span><a name="line-73"></a><span class="hs-identifier">smallInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-74"></a><a name="smallInteger"><a href="GHC.Integer.Type.html#smallInteger"><span class="hs-identifier">smallInteger</span></a></a><span> </span><a name="local-6989586621679016973"><a href="#local-6989586621679016973"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679016973"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#wordToInteger"><span class="hs-identifier hs-var">wordToInteger</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Word%23"><span class="hs-identifier hs-var">int2Word</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679016973"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- XXX is this right for -minBound?</span><span>
</span><a name="line-76"></a><span>                      </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#wordToInteger"><span class="hs-identifier hs-var">wordToInteger</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Word%23"><span class="hs-identifier hs-var">int2Word</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#negateInt%23"><span class="hs-identifier hs-var">negateInt</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679016973"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-pragma">{-# NOINLINE wordToInteger #-}</span><span>
</span><a name="line-79"></a><span class="hs-identifier">wordToInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-80"></a><a name="wordToInteger"><a href="GHC.Integer.Type.html#wordToInteger"><span class="hs-identifier">wordToInteger</span></a></a><span> </span><a name="local-6989586621679016974"><a href="#local-6989586621679016974"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679016974"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>                  </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-82"></a><span>                  </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679016974"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-pragma">{-# NOINLINE integerToWord #-}</span><span>
</span><a name="line-85"></a><span class="hs-identifier">integerToWord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-86"></a><a name="integerToWord"><a href="GHC.Integer.Type.html#integerToWord"><span class="hs-identifier">integerToWord</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679016975"><a href="#local-6989586621679016975"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016975"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-87"></a><span class="hs-identifier">integerToWord</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679016976"><a href="#local-6989586621679016976"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#minusWord%23"><span class="hs-identifier hs-var">minusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679016976"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-88"></a><span class="hs-comment">-- Must be Naught by the invariant:</span><span>
</span><a name="line-89"></a><span class="hs-identifier">integerToWord</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-pragma">{-# NOINLINE integerToInt #-}</span><span>
</span><a name="line-92"></a><span class="hs-identifier">integerToInt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-93"></a><a name="integerToInt"><a href="GHC.Integer.Type.html#integerToInt"><span class="hs-identifier">integerToInt</span></a></a><span> </span><a name="local-6989586621679016977"><a href="#local-6989586621679016977"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#integerToWord"><span class="hs-identifier hs-var">integerToWord</span></a><span> </span><a href="#local-6989586621679016977"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS == 64</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- Nothing</span><span>
</span><a name="line-97"></a><span class="hs-cpp">#elif WORD_SIZE_IN_BITS == 32</span><span>
</span><a name="line-98"></a><span class="hs-pragma">{-# NOINLINE integerToWord64 #-}</span><span>
</span><a name="line-99"></a><span class="hs-identifier">integerToWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64</span><span class="hs-operator">#</span><span>
</span><a name="line-100"></a><span class="hs-identifier">integerToWord64</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int64ToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">integerToInt64</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-pragma">{-# NOINLINE word64ToInteger #-}</span><span>
</span><a name="line-103"></a><span class="hs-identifier">word64ToInteger</span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word64</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span>
</span><a name="line-104"></a><span class="hs-identifier">word64ToInteger</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isTrue</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">eqWord64</span><span class="hs-operator">#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">wordToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">Naught</span><span>
</span><a name="line-106"></a><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">Positive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToPositive</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-pragma">{-# NOINLINE integerToInt64 #-}</span><span>
</span><a name="line-109"></a><span class="hs-identifier">integerToInt64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int64</span><span class="hs-operator">#</span><span>
</span><a name="line-110"></a><span class="hs-identifier">integerToInt64</span><span> </span><span class="hs-identifier">Naught</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">intToInt64</span><span class="hs-operator">#</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-111"></a><span class="hs-identifier">integerToInt64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Positive</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">word64ToInt64</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">positiveToWord64</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span class="hs-identifier">integerToInt64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Negative</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">negateInt64</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToInt64</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">positiveToWord64</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-pragma">{-# NOINLINE int64ToInteger #-}</span><span>
</span><a name="line-116"></a><span class="hs-identifier">int64ToInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int64</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Integer</span><span>
</span><a name="line-117"></a><span class="hs-identifier">int64ToInteger</span><span> </span><span class="hs-identifier">i</span><span>
</span><a name="line-118"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isTrue</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">eqInt64</span><span class="hs-operator">#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">intToInt64</span><span class="hs-operator">#</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">Naught</span><span>
</span><a name="line-120"></a><span>   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isTrue</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">gtInt64</span><span class="hs-operator">#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">intToInt64</span><span class="hs-operator">#</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">Positive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToPositive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">int64ToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>   </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">Negative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToPositive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">int64ToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negateInt64</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-124"></a><span class="hs-cpp">#error WORD_SIZE_IN_BITS not supported</span><span>
</span><a name="line-125"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-identifier">oneInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-128"></a><a name="oneInteger"><a href="GHC.Integer.Type.html#oneInteger"><span class="hs-identifier">oneInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-identifier">negativeOneInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-131"></a><a name="negativeOneInteger"><a href="GHC.Integer.Type.html#negativeOneInteger"><span class="hs-identifier">negativeOneInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-identifier">twoToTheThirtytwoInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-134"></a><a name="twoToTheThirtytwoInteger"><a href="GHC.Integer.Type.html#twoToTheThirtytwoInteger"><span class="hs-identifier">twoToTheThirtytwoInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="GHC.Integer.Type.html#twoToTheThirtytwoPositive"><span class="hs-identifier hs-var">twoToTheThirtytwoPositive</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-pragma">{-# NOINLINE encodeDoubleInteger #-}</span><span>
</span><a name="line-137"></a><span class="hs-identifier">encodeDoubleInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Double%23"><span class="hs-identifier hs-type">Double</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-138"></a><a name="encodeDoubleInteger"><a href="GHC.Integer.Type.html#encodeDoubleInteger"><span class="hs-identifier">encodeDoubleInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679016978"><a href="#local-6989586621679016978"><span class="hs-identifier">ds0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679016979"><a href="#local-6989586621679016979"><span class="hs-identifier">e0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016980"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">0.0</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679016978"><span class="hs-identifier hs-var">ds0</span></a><span> </span><a href="#local-6989586621679016979"><span class="hs-identifier hs-var">e0</span></a><span>
</span><a name="line-139"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679016980"><a href="#local-6989586621679016980"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679016981"><a href="#local-6989586621679016981"><span class="hs-identifier">acc</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>        </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016981"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-140"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679016982"><a href="#local-6989586621679016982"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679016983"><a href="#local-6989586621679016983"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679016984"><a href="#local-6989586621679016984"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679016985"><a href="#local-6989586621679016985"><span class="hs-identifier">e</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016980"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679016982"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23%23"><span class="hs-operator hs-var">+##</span></a><span> </span><a href="GHC.Integer.Type.html#encodeDouble%23"><span class="hs-identifier hs-var">encodeDouble</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679016983"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679016985"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>                                      </span><a href="#local-6989586621679016984"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-142"></a><span>                                      </span><span class="hs-comment">-- XXX We assume that this adding to e</span><span>
</span><a name="line-143"></a><span>                                      </span><span class="hs-comment">-- isn't going to overflow</span><span>
</span><a name="line-144"></a><span>                                      </span><span class="hs-special">(</span><a href="#local-6989586621679016985"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span class="hs-identifier">encodeDoubleInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679016986"><a href="#local-6989586621679016986"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679016987"><a href="#local-6989586621679016987"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-146"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#negateDouble%23"><span class="hs-identifier hs-var">negateDouble</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#encodeDoubleInteger"><span class="hs-identifier hs-var">encodeDoubleInteger</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679016986"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679016987"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span class="hs-identifier">encodeDoubleInteger</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span class="hs-operator">##</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;__word_encodeDouble&quot;</span><span>
</span><a name="line-150"></a><span>        </span><span class="hs-identifier">encodeDouble</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Double%23"><span class="hs-identifier hs-type">Double</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-pragma">{-# NOINLINE encodeFloatInteger #-}</span><span>
</span><a name="line-153"></a><span class="hs-identifier">encodeFloatInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Float%23"><span class="hs-identifier hs-type">Float</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-154"></a><a name="encodeFloatInteger"><a href="GHC.Integer.Type.html#encodeFloatInteger"><span class="hs-identifier">encodeFloatInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679016988"><a href="#local-6989586621679016988"><span class="hs-identifier">ds0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679016989"><a href="#local-6989586621679016989"><span class="hs-identifier">e0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016990"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">0.0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679016988"><span class="hs-identifier hs-var">ds0</span></a><span> </span><a href="#local-6989586621679016989"><span class="hs-identifier hs-var">e0</span></a><span>
</span><a name="line-155"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679016990"><a href="#local-6989586621679016990"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679016991"><a href="#local-6989586621679016991"><span class="hs-identifier">acc</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>        </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016991"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-156"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679016992"><a href="#local-6989586621679016992"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679016993"><a href="#local-6989586621679016993"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679016994"><a href="#local-6989586621679016994"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679016995"><a href="#local-6989586621679016995"><span class="hs-identifier">e</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679016990"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679016992"><span class="hs-identifier hs-var">acc</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusFloat%23"><span class="hs-identifier hs-var">plusFloat</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#encodeFloat%23"><span class="hs-identifier hs-var">encodeFloat</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679016993"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679016995"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>                                      </span><a href="#local-6989586621679016994"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-158"></a><span>                                      </span><span class="hs-comment">-- XXX We assume that this adding to e</span><span>
</span><a name="line-159"></a><span>                                      </span><span class="hs-comment">-- isn't going to overflow</span><span>
</span><a name="line-160"></a><span>                                      </span><span class="hs-special">(</span><a href="#local-6989586621679016995"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span class="hs-identifier">encodeFloatInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679016996"><a href="#local-6989586621679016996"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679016997"><a href="#local-6989586621679016997"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-162"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#negateFloat%23"><span class="hs-identifier hs-var">negateFloat</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#encodeFloatInteger"><span class="hs-identifier hs-var">encodeFloatInteger</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679016996"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679016997"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span class="hs-identifier">encodeFloatInteger</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span class="hs-operator">#</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-identifier">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">ccall</span><span> </span><span class="hs-identifier">unsafe</span><span> </span><span class="hs-string">&quot;__word_encodeFloat&quot;</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-identifier">encodeFloat</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Float%23"><span class="hs-identifier hs-type">Float</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-pragma">{-# NOINLINE decodeFloatInteger #-}</span><span>
</span><a name="line-169"></a><span class="hs-identifier">decodeFloatInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Float%23"><span class="hs-identifier hs-type">Float</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span class="hs-special">,</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-170"></a><a name="decodeFloatInteger"><a href="GHC.Integer.Type.html#decodeFloatInteger"><span class="hs-identifier">decodeFloatInteger</span></a></a><span> </span><a name="local-6989586621679016998"><a href="#local-6989586621679016998"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#decodeFloat_Int%23"><span class="hs-identifier hs-var">decodeFloat_Int</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679016998"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-171"></a><span>                       </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679016999"><a href="#local-6989586621679016999"><span class="hs-identifier">mant</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017000"><a href="#local-6989586621679017000"><span class="hs-identifier">exp</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#smallInteger"><span class="hs-identifier hs-var">smallInteger</span></a><span> </span><a href="#local-6989586621679016999"><span class="hs-identifier hs-var">mant</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679017000"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">-- XXX This could be optimised better, by either (word-size dependent)</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- using single 64bit value for the mantissa, or doing the multiplication</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- by just building the Digits directly</span><span>
</span><a name="line-176"></a><span class="hs-pragma">{-# NOINLINE decodeDoubleInteger #-}</span><span>
</span><a name="line-177"></a><span class="hs-identifier">decodeDoubleInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Double%23"><span class="hs-identifier hs-type">Double</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span class="hs-special">,</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><a name="decodeDoubleInteger"><a href="GHC.Integer.Type.html#decodeDoubleInteger"><span class="hs-identifier">decodeDoubleInteger</span></a></a><span> </span><a name="local-6989586621679017001"><a href="#local-6989586621679017001"><span class="hs-identifier">d</span></a></a><span>
</span><a name="line-179"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#decodeDouble_2Int%23"><span class="hs-identifier hs-var">decodeDouble_2Int</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679017001"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-180"></a><span>   </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017002"><a href="#local-6989586621679017002"><span class="hs-identifier">mantSign</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017003"><a href="#local-6989586621679017003"><span class="hs-identifier">mantHigh</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017004"><a href="#local-6989586621679017004"><span class="hs-identifier">mantLow</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017005"><a href="#local-6989586621679017005"><span class="hs-identifier">exp</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-181"></a><span>       </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#smallInteger"><span class="hs-identifier hs-var">smallInteger</span></a><span> </span><a href="#local-6989586621679017002"><span class="hs-identifier hs-var">mantSign</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesInteger"><span class="hs-identifier hs-var">timesInteger</span></a><span class="hs-special">`</span><span>
</span><a name="line-182"></a><span>          </span><span class="hs-special">(</span><span>  </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#wordToInteger"><span class="hs-identifier hs-var">wordToInteger</span></a><span> </span><a href="#local-6989586621679017003"><span class="hs-identifier hs-var">mantHigh</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesInteger"><span class="hs-identifier hs-var">timesInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#twoToTheThirtytwoInteger"><span class="hs-identifier hs-var">twoToTheThirtytwoInteger</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span>             </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusInteger"><span class="hs-identifier hs-var">plusInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#wordToInteger"><span class="hs-identifier hs-var">wordToInteger</span></a><span> </span><a href="#local-6989586621679017004"><span class="hs-identifier hs-var">mantLow</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-184"></a><span>          </span><a href="#local-6989586621679017005"><span class="hs-identifier hs-var">exp</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-pragma">{-# NOINLINE doubleFromInteger #-}</span><span>
</span><a name="line-187"></a><span class="hs-identifier">doubleFromInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Double%23"><span class="hs-identifier hs-type">Double</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-188"></a><a name="doubleFromInteger"><a href="GHC.Integer.Type.html#doubleFromInteger"><span class="hs-identifier">doubleFromInteger</span></a></a><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span class="hs-operator">##</span><span>
</span><a name="line-189"></a><span class="hs-identifier">doubleFromInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017006"><a href="#local-6989586621679017006"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#doubleFromPositive"><span class="hs-identifier hs-var">doubleFromPositive</span></a><span> </span><a href="#local-6989586621679017006"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-190"></a><span class="hs-identifier">doubleFromInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017007"><a href="#local-6989586621679017007"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#negateDouble%23"><span class="hs-identifier hs-var">negateDouble</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#doubleFromPositive"><span class="hs-identifier hs-var">doubleFromPositive</span></a><span> </span><a href="#local-6989586621679017007"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-pragma">{-# NOINLINE floatFromInteger #-}</span><span>
</span><a name="line-193"></a><span class="hs-identifier">floatFromInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Float%23"><span class="hs-identifier hs-type">Float</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-194"></a><a name="floatFromInteger"><a href="GHC.Integer.Type.html#floatFromInteger"><span class="hs-identifier">floatFromInteger</span></a></a><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span class="hs-operator">#</span><span>
</span><a name="line-195"></a><span class="hs-identifier">floatFromInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017008"><a href="#local-6989586621679017008"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#floatFromPositive"><span class="hs-identifier hs-var">floatFromPositive</span></a><span> </span><a href="#local-6989586621679017008"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-196"></a><span class="hs-identifier">floatFromInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017009"><a href="#local-6989586621679017009"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#negateFloat%23"><span class="hs-identifier hs-var">negateFloat</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#floatFromPositive"><span class="hs-identifier hs-var">floatFromPositive</span></a><span> </span><a href="#local-6989586621679017009"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-pragma">{-# NOINLINE andInteger #-}</span><span>
</span><a name="line-199"></a><span class="hs-identifier">andInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-200"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-special">`</span><a name="andInteger"><a href="GHC.Integer.Type.html#andInteger"><span class="hs-identifier">andInteger</span></a></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-201"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">andInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-202"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017010"><a href="#local-6989586621679017010"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">andInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017011"><a href="#local-6989586621679017011"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#digitsToInteger"><span class="hs-identifier hs-var">digitsToInteger</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017010"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#andDigits"><span class="hs-identifier hs-var">andDigits</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017011"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span class="hs-comment">{-
To calculate x &amp; -y we need to calculate
    x &amp; twosComplement y
The (imaginary) sign bits are 0 and 1, so &amp;ing them give 0, i.e. positive.
Note that
    twosComplement y
has infinitely many 1s, but x has a finite number of digits, so andDigits
will return a finite result.
-}</span><span>
</span><a name="line-212"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017012"><a href="#local-6989586621679017012"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">andInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017013"><a href="#local-6989586621679017013"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017014"><a href="#local-6989586621679017014"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#twosComplementPositive"><span class="hs-identifier hs-var">twosComplementPositive</span></a><span> </span><a href="#local-6989586621679017013"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-213"></a><span>                                         </span><a name="local-6989586621679017015"><a href="#local-6989586621679017015"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017014"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#andDigitsOnes"><span class="hs-identifier hs-var">andDigitsOnes</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017012"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-214"></a><span>                                     </span><span class="hs-keyword">in</span><span> </span><a href="GHC.Integer.Type.html#digitsToInteger"><span class="hs-identifier hs-var">digitsToInteger</span></a><span> </span><a href="#local-6989586621679017015"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-215"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017016"><a href="#local-6989586621679017016"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">andInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017017"><a href="#local-6989586621679017017"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017017"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#andInteger"><span class="hs-identifier hs-var">andInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a href="#local-6989586621679017016"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-216"></a><span class="hs-comment">{-
To calculate -x &amp; -y, naively we need to calculate
    twosComplement (twosComplement x &amp; twosComplement y)
but
    twosComplement x &amp; twosComplement y
has infinitely many 1s, so this won't work. Thus we use de Morgan's law
to get
    -x &amp; -y = !(!(-x) | !(-y))
            = !(!(twosComplement x) | !(twosComplement y))
            = !(!(!x + 1) | (!y + 1))
            = !((x - 1) | (y - 1))
but the result is negative, so we need to take the two's complement of
this in order to get the magnitude of the result.
    twosComplement !((x - 1) | (y - 1))
            = !(!((x - 1) | (y - 1))) + 1
            = ((x - 1) | (y - 1)) + 1
-}</span><span>
</span><a name="line-233"></a><span class="hs-comment">-- We don't know that x and y are /strictly/ greater than 1, but</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- minusPositive gives us the required answer anyway.</span><span>
</span><a name="line-235"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017018"><a href="#local-6989586621679017018"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">andInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017019"><a href="#local-6989586621679017019"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017020"><a href="#local-6989586621679017020"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017018"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-236"></a><span>                                         </span><a name="local-6989586621679017021"><a href="#local-6989586621679017021"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017019"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-237"></a><span>                                         </span><a name="local-6989586621679017022"><a href="#local-6989586621679017022"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017020"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#orDigits"><span class="hs-identifier hs-var">orDigits</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017021"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-238"></a><span>                                         </span><span class="hs-comment">-- XXX Cheating the precondition:</span><span>
</span><a name="line-239"></a><span>                                         </span><a name="local-6989586621679017023"><a href="#local-6989586621679017023"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#succPositive"><span class="hs-identifier hs-var">succPositive</span></a><span> </span><a href="#local-6989586621679017022"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-240"></a><span>                                     </span><span class="hs-keyword">in</span><span> </span><a href="GHC.Integer.Type.html#digitsToNegativeInteger"><span class="hs-identifier hs-var">digitsToNegativeInteger</span></a><span> </span><a href="#local-6989586621679017023"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-pragma">{-# NOINLINE orInteger #-}</span><span>
</span><a name="line-243"></a><span class="hs-identifier">orInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-244"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-special">`</span><a name="orInteger"><a href="GHC.Integer.Type.html#orInteger"><span class="hs-identifier">orInteger</span></a></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017024"><a href="#local-6989586621679017024"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017024"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-245"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017025"><a href="#local-6989586621679017025"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">orInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017025"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-246"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017026"><a href="#local-6989586621679017026"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">orInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017027"><a href="#local-6989586621679017027"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017026"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#orDigits"><span class="hs-identifier hs-var">orDigits</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017027"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span class="hs-comment">{-
x | -y = - (twosComplement (x | twosComplement y))
       = - (twosComplement !(!x &amp; !(twosComplement y)))
       = - (twosComplement !(!x &amp; !(!y + 1)))
       = - (twosComplement !(!x &amp; (y - 1)))
       = - ((!x &amp; (y - 1)) + 1)
-}</span><span>
</span><a name="line-254"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017028"><a href="#local-6989586621679017028"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">orInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017029"><a href="#local-6989586621679017029"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017030"><a href="#local-6989586621679017030"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#flipBits"><span class="hs-identifier hs-var">flipBits</span></a><span> </span><a href="#local-6989586621679017028"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-255"></a><span>                                        </span><a name="local-6989586621679017031"><a href="#local-6989586621679017031"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017029"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-256"></a><span>                                        </span><a name="local-6989586621679017032"><a href="#local-6989586621679017032"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017030"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#andDigitsOnes"><span class="hs-identifier hs-var">andDigitsOnes</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017031"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-257"></a><span>                                        </span><a name="local-6989586621679017033"><a href="#local-6989586621679017033"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#succPositive"><span class="hs-identifier hs-var">succPositive</span></a><span> </span><a href="#local-6989586621679017032"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-258"></a><span>                                    </span><span class="hs-keyword">in</span><span> </span><a href="GHC.Integer.Type.html#digitsToNegativeInteger"><span class="hs-identifier hs-var">digitsToNegativeInteger</span></a><span> </span><a href="#local-6989586621679017033"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-259"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017034"><a href="#local-6989586621679017034"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">orInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017035"><a href="#local-6989586621679017035"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017035"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#orInteger"><span class="hs-identifier hs-var">orInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a href="#local-6989586621679017034"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-260"></a><span class="hs-comment">{-
-x | -y = - (twosComplement (twosComplement x | twosComplement y))
        = - (twosComplement !(!(twosComplement x) &amp; !(twosComplement y)))
        = - (twosComplement !(!(!x + 1) &amp; !(!y + 1)))
        = - (twosComplement !((x - 1) &amp; (y - 1)))
        = - (((x - 1) &amp; (y - 1)) + 1)
-}</span><span>
</span><a name="line-267"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017036"><a href="#local-6989586621679017036"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">orInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017037"><a href="#local-6989586621679017037"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017038"><a href="#local-6989586621679017038"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017036"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-268"></a><span>                                        </span><a name="local-6989586621679017039"><a href="#local-6989586621679017039"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017037"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-269"></a><span>                                        </span><a name="local-6989586621679017040"><a href="#local-6989586621679017040"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017038"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#andDigits"><span class="hs-identifier hs-var">andDigits</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017039"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-270"></a><span>                                        </span><a name="local-6989586621679017041"><a href="#local-6989586621679017041"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#succPositive"><span class="hs-identifier hs-var">succPositive</span></a><span> </span><a href="#local-6989586621679017040"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-271"></a><span>                                    </span><span class="hs-keyword">in</span><span> </span><a href="GHC.Integer.Type.html#digitsToNegativeInteger"><span class="hs-identifier hs-var">digitsToNegativeInteger</span></a><span> </span><a href="#local-6989586621679017041"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-pragma">{-# NOINLINE xorInteger #-}</span><span>
</span><a name="line-274"></a><span class="hs-identifier">xorInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-275"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-special">`</span><a name="xorInteger"><a href="GHC.Integer.Type.html#xorInteger"><span class="hs-identifier">xorInteger</span></a></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017042"><a href="#local-6989586621679017042"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017042"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-276"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017043"><a href="#local-6989586621679017043"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">xorInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017043"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-277"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017044"><a href="#local-6989586621679017044"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">xorInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017045"><a href="#local-6989586621679017045"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#digitsToInteger"><span class="hs-identifier hs-var">digitsToInteger</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017044"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#xorDigits"><span class="hs-identifier hs-var">xorDigits</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017045"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span class="hs-comment">{-
x ^ -y = - (twosComplement (x ^ twosComplement y))
       = - (twosComplement !(x ^ !(twosComplement y)))
       = - (twosComplement !(x ^ !(!y + 1)))
       = - (twosComplement !(x ^ (y - 1)))
       = - ((x ^ (y - 1)) + 1)
-}</span><span>
</span><a name="line-285"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017046"><a href="#local-6989586621679017046"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">xorInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017047"><a href="#local-6989586621679017047"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017048"><a href="#local-6989586621679017048"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017047"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-286"></a><span>                                         </span><a name="local-6989586621679017049"><a href="#local-6989586621679017049"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017046"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#xorDigits"><span class="hs-identifier hs-var">xorDigits</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017048"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-287"></a><span>                                         </span><a name="local-6989586621679017050"><a href="#local-6989586621679017050"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#succPositive"><span class="hs-identifier hs-var">succPositive</span></a><span> </span><a href="#local-6989586621679017049"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-288"></a><span>                                     </span><span class="hs-keyword">in</span><span> </span><a href="GHC.Integer.Type.html#digitsToNegativeInteger"><span class="hs-identifier hs-var">digitsToNegativeInteger</span></a><span> </span><a href="#local-6989586621679017050"><span class="hs-identifier hs-var">z'</span></a><span>
</span><a name="line-289"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017051"><a href="#local-6989586621679017051"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">xorInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017052"><a href="#local-6989586621679017052"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017052"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#xorInteger"><span class="hs-identifier hs-var">xorInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a href="#local-6989586621679017051"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-290"></a><span class="hs-comment">{-
-x ^ -y = twosComplement x ^ twosComplement y
        = (!x + 1) ^ (!y + 1)
        = (!x + 1) ^ (!y + 1)
        = !(!x + 1) ^ !(!y + 1)
        = (x - 1) ^ (y - 1)
-}</span><span>
</span><a name="line-297"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017053"><a href="#local-6989586621679017053"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">xorInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017054"><a href="#local-6989586621679017054"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017055"><a href="#local-6989586621679017055"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017053"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-298"></a><span>                                         </span><a name="local-6989586621679017056"><a href="#local-6989586621679017056"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017054"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span>
</span><a name="line-299"></a><span>                                         </span><a name="local-6989586621679017057"><a href="#local-6989586621679017057"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017055"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#xorDigits"><span class="hs-identifier hs-var">xorDigits</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017056"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-300"></a><span>                                     </span><span class="hs-keyword">in</span><span> </span><a href="GHC.Integer.Type.html#digitsToInteger"><span class="hs-identifier hs-var">digitsToInteger</span></a><span> </span><a href="#local-6989586621679017057"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-pragma">{-# NOINLINE complementInteger #-}</span><span>
</span><a name="line-303"></a><span class="hs-identifier">complementInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-304"></a><a name="complementInteger"><a href="GHC.Integer.Type.html#complementInteger"><span class="hs-identifier">complementInteger</span></a></a><span> </span><a name="local-6989586621679017058"><a href="#local-6989586621679017058"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#negativeOneInteger"><span class="hs-identifier hs-var">negativeOneInteger</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusInteger"><span class="hs-identifier hs-var">minusInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017058"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-pragma">{-# NOINLINE shiftLInteger #-}</span><span>
</span><a name="line-307"></a><span class="hs-identifier">shiftLInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-308"></a><a name="shiftLInteger"><a href="GHC.Integer.Type.html#shiftLInteger"><span class="hs-identifier">shiftLInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017059"><a href="#local-6989586621679017059"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679017060"><a href="#local-6989586621679017060"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#shiftLPositive"><span class="hs-identifier hs-var">shiftLPositive</span></a><span> </span><a href="#local-6989586621679017059"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679017060"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span class="hs-identifier">shiftLInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017061"><a href="#local-6989586621679017061"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679017062"><a href="#local-6989586621679017062"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#shiftLPositive"><span class="hs-identifier hs-var">shiftLPositive</span></a><span> </span><a href="#local-6989586621679017061"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679017062"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span class="hs-identifier">shiftLInteger</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>       </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-pragma">{-# NOINLINE shiftRInteger #-}</span><span>
</span><a name="line-313"></a><span class="hs-identifier">shiftRInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-314"></a><a name="shiftRInteger"><a href="GHC.Integer.Type.html#shiftRInteger"><span class="hs-identifier">shiftRInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017063"><a href="#local-6989586621679017063"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-6989586621679017064"><a href="#local-6989586621679017064"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#shiftRPositive"><span class="hs-identifier hs-var">shiftRPositive</span></a><span> </span><a href="#local-6989586621679017063"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679017064"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-315"></a><span class="hs-identifier">shiftRInteger</span><span> </span><a name="local-6989586621679017065"><a href="#local-6989586621679017065"><span class="hs-identifier">j</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679017066"><a href="#local-6989586621679017066"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-316"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#complementInteger"><span class="hs-identifier hs-var">complementInteger</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#shiftRInteger"><span class="hs-identifier hs-var">shiftRInteger</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#complementInteger"><span class="hs-identifier hs-var">complementInteger</span></a><span> </span><a href="#local-6989586621679017065"><span class="hs-identifier hs-var">j</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679017066"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span class="hs-identifier">shiftRInteger</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">-- XXX this could be a lot more efficient, but this is a quick</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- reimplementation of the default Data.Bits instance, so that we can</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- implement the Integer interface</span><span>
</span><a name="line-322"></a><span class="hs-identifier">testBitInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-323"></a><a name="testBitInteger"><a href="GHC.Integer.Type.html#testBitInteger"><span class="hs-identifier">testBitInteger</span></a></a><span> </span><a name="local-6989586621679017067"><a href="#local-6989586621679017067"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679017068"><a href="#local-6989586621679017068"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017067"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#andInteger"><span class="hs-identifier hs-var">andInteger</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#oneInteger"><span class="hs-identifier hs-var">oneInteger</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#shiftLInteger"><span class="hs-identifier hs-var">shiftLInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017068"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>        </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#neqInteger"><span class="hs-identifier hs-var">neqInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">twosComplementPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-type">DigitsOnes</span></a><span>
</span><a name="line-327"></a><a name="twosComplementPositive"><a href="GHC.Integer.Type.html#twosComplementPositive"><span class="hs-identifier">twosComplementPositive</span></a></a><span> </span><a name="local-6989586621679017069"><a href="#local-6989586621679017069"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#flipBits"><span class="hs-identifier hs-var">flipBits</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017069"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span class="hs-special">)</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-identifier">flipBits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-type">DigitsOnes</span></a><span>
</span><a name="line-330"></a><a name="flipBits"><a href="GHC.Integer.Type.html#flipBits"><span class="hs-identifier">flipBits</span></a></a><span> </span><a name="local-6989586621679017070"><a href="#local-6989586621679017070"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-var">DigitsOnes</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#flipBitsDigits"><span class="hs-identifier hs-var">flipBitsDigits</span></a><span> </span><a href="#local-6989586621679017070"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-identifier">flipBitsDigits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-333"></a><a name="flipBitsDigits"><a href="GHC.Integer.Type.html#flipBitsDigits"><span class="hs-identifier">flipBitsDigits</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-334"></a><span class="hs-identifier">flipBitsDigits</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017071"><a href="#local-6989586621679017071"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679017072"><a href="#local-6989586621679017072"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#not%23"><span class="hs-identifier hs-var">not</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679017071"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#flipBitsDigits"><span class="hs-identifier hs-var">flipBitsDigits</span></a><span> </span><a href="#local-6989586621679017072"><span class="hs-identifier hs-var">ws</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-pragma">{-# NOINLINE negateInteger #-}</span><span>
</span><a name="line-337"></a><span class="hs-identifier">negateInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-338"></a><a name="negateInteger"><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier">negateInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017073"><a href="#local-6989586621679017073"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a href="#local-6989586621679017073"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-339"></a><span class="hs-identifier">negateInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017074"><a href="#local-6989586621679017074"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017074"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-340"></a><span class="hs-identifier">negateInteger</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-343"></a><span class="hs-pragma">{-# NOINLINE plusInteger #-}</span><span>
</span><a name="line-344"></a><span class="hs-identifier">plusInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-345"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017075"><a href="#local-6989586621679017075"><span class="hs-identifier">p1</span></a></a><span>    </span><span class="hs-special">`</span><a name="plusInteger"><a href="GHC.Integer.Type.html#plusInteger"><span class="hs-identifier">plusInteger</span></a></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017076"><a href="#local-6989586621679017076"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017075"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier hs-var">plusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017076"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span>
</span><a name="line-346"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017077"><a href="#local-6989586621679017077"><span class="hs-identifier">p1</span></a></a><span>    </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017078"><a href="#local-6989586621679017078"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017077"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier hs-var">plusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017078"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span>
</span><a name="line-347"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017079"><a href="#local-6989586621679017079"><span class="hs-identifier">p1</span></a></a><span>    </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017080"><a href="#local-6989586621679017080"><span class="hs-identifier">p2</span></a></a><span>
</span><a name="line-348"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017079"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#comparePositive"><span class="hs-identifier hs-var">comparePositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017080"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-349"></a><span>      </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017079"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017080"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span>      </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-351"></a><span>      </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017080"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017079"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017081"><a href="#local-6989586621679017081"><span class="hs-identifier">p1</span></a></a><span>    </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017082"><a href="#local-6989586621679017082"><span class="hs-identifier">p2</span></a></a><span>
</span><a name="line-353"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017082"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusInteger"><span class="hs-identifier hs-var">plusInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a href="#local-6989586621679017081"><span class="hs-identifier hs-var">p1</span></a><span>
</span><a name="line-354"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>         </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-355"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>         </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a name="local-6989586621679017083"><a href="#local-6989586621679017083"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017083"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-356"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>         </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a name="local-6989586621679017084"><a href="#local-6989586621679017084"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017084"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-357"></a><a name="local-6989586621679017085"><a href="#local-6989586621679017085"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017085"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-358"></a><a name="local-6989586621679017086"><a href="#local-6989586621679017086"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">plusInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017086"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-pragma">{-# NOINLINE minusInteger #-}</span><span>
</span><a name="line-361"></a><span class="hs-identifier">minusInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-362"></a><a name="local-6989586621679017087"><a href="#local-6989586621679017087"><span class="hs-identifier">i1</span></a></a><span> </span><span class="hs-special">`</span><a name="minusInteger"><a href="GHC.Integer.Type.html#minusInteger"><span class="hs-identifier">minusInteger</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017088"><a href="#local-6989586621679017088"><span class="hs-identifier">i2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017087"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusInteger"><span class="hs-identifier hs-var">plusInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><a href="#local-6989586621679017088"><span class="hs-identifier hs-var">i2</span></a><span>
</span><a name="line-363"></a><span>
</span><a name="line-364"></a><span class="hs-pragma">{-# NOINLINE timesInteger #-}</span><span>
</span><a name="line-365"></a><span class="hs-identifier">timesInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-366"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017089"><a href="#local-6989586621679017089"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><a name="timesInteger"><a href="GHC.Integer.Type.html#timesInteger"><span class="hs-identifier">timesInteger</span></a></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017090"><a href="#local-6989586621679017090"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017089"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017090"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span>
</span><a name="line-367"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017091"><a href="#local-6989586621679017091"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017092"><a href="#local-6989586621679017092"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017091"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017092"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span>
</span><a name="line-368"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017093"><a href="#local-6989586621679017093"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017094"><a href="#local-6989586621679017094"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017093"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017094"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span>
</span><a name="line-369"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017095"><a href="#local-6989586621679017095"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017096"><a href="#local-6989586621679017096"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017095"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017096"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">timesInteger</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-pragma">{-# NOINLINE divModInteger #-}</span><span>
</span><a name="line-373"></a><span class="hs-identifier">divModInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><a name="local-6989586621679017097"><a href="#local-6989586621679017097"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">`</span><a name="divModInteger"><a href="GHC.Integer.Type.html#divModInteger"><span class="hs-identifier">divModInteger</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017098"><a href="#local-6989586621679017098"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-375"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017097"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#quotRemInteger"><span class="hs-identifier hs-var">quotRemInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017098"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-376"></a><span>        </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017099"><a href="#local-6989586621679017099"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017100"><a href="#local-6989586621679017100"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-377"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="GHC.Integer.Type.html#signumInteger"><span class="hs-identifier hs-var">signumInteger</span></a><span> </span><a href="#local-6989586621679017100"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#eqInteger"><span class="hs-identifier hs-var">eqInteger</span></a><span class="hs-special">`</span><span>
</span><a name="line-378"></a><span>               </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#signumInteger"><span class="hs-identifier hs-var">signumInteger</span></a><span> </span><a href="#local-6989586621679017098"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679017099"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusInteger"><span class="hs-identifier hs-var">minusInteger</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#oneInteger"><span class="hs-identifier hs-var">oneInteger</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679017100"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusInteger"><span class="hs-identifier hs-var">plusInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017098"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679017099"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679017100"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span class="hs-pragma">{-# NOINLINE divInteger #-}</span><span>
</span><a name="line-383"></a><span class="hs-identifier">divInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-384"></a><a name="local-6989586621679017101"><a href="#local-6989586621679017101"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">`</span><a name="divInteger"><a href="GHC.Integer.Type.html#divInteger"><span class="hs-identifier">divInteger</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017102"><a href="#local-6989586621679017102"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017103"><span class="hs-identifier hs-var">quotient</span></a><span>
</span><a name="line-385"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017103"><a href="#local-6989586621679017103"><span class="hs-identifier">quotient</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017101"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#divModInteger"><span class="hs-identifier hs-var">divModInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017102"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-pragma">{-# NOINLINE modInteger #-}</span><span>
</span><a name="line-388"></a><span class="hs-identifier">modInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-389"></a><a name="local-6989586621679017104"><a href="#local-6989586621679017104"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">`</span><a name="modInteger"><a href="GHC.Integer.Type.html#modInteger"><span class="hs-identifier">modInteger</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017105"><a href="#local-6989586621679017105"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017106"><span class="hs-identifier hs-var">modulus</span></a><span>
</span><a name="line-390"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679017106"><a href="#local-6989586621679017106"><span class="hs-identifier">modulus</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017104"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#divModInteger"><span class="hs-identifier hs-var">divModInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017105"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-pragma">{-# NOINLINE quotRemInteger #-}</span><span>
</span><a name="line-393"></a><span class="hs-identifier">quotRemInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-394"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>      </span><span class="hs-special">`</span><a name="quotRemInteger"><a href="GHC.Integer.Type.html#quotRemInteger"><span class="hs-identifier">quotRemInteger</span></a></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">quotRemInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-396"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#errorInteger"><span class="hs-identifier hs-var">errorInteger</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#errorInteger"><span class="hs-identifier hs-var">errorInteger</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- XXX Can't happen</span><span>
</span><a name="line-397"></a><span class="hs-comment">-- XXX _            `quotRemInteger` Naught     = error &quot;Division by zero&quot;</span><span>
</span><a name="line-398"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017107"><a href="#local-6989586621679017107"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">quotRemInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017108"><a href="#local-6989586621679017108"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017107"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#quotRemPositive"><span class="hs-identifier hs-var">quotRemPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017108"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-399"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017109"><a href="#local-6989586621679017109"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">quotRemInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017110"><a href="#local-6989586621679017110"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017109"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#quotRemPositive"><span class="hs-identifier hs-var">quotRemPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017110"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-400"></a><span>                                           </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017111"><a href="#local-6989586621679017111"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017112"><a href="#local-6989586621679017112"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-401"></a><span>                                               </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><a href="#local-6989586621679017111"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><span>
</span><a name="line-402"></a><span>                                                  </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><a href="#local-6989586621679017112"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-403"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017113"><a href="#local-6989586621679017113"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">quotRemInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017114"><a href="#local-6989586621679017114"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017113"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#quotRemPositive"><span class="hs-identifier hs-var">quotRemPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017114"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-404"></a><span>                                           </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017115"><a href="#local-6989586621679017115"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017116"><a href="#local-6989586621679017116"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-405"></a><span>                                               </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><a href="#local-6989586621679017115"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679017116"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-406"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017117"><a href="#local-6989586621679017117"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">quotRemInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017118"><a href="#local-6989586621679017118"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017117"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#quotRemPositive"><span class="hs-identifier hs-var">quotRemPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017118"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-407"></a><span>                                           </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017119"><a href="#local-6989586621679017119"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017120"><a href="#local-6989586621679017120"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-408"></a><span>                                               </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679017119"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#negateInteger"><span class="hs-identifier hs-var">negateInteger</span></a><span> </span><a href="#local-6989586621679017120"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>
</span><a name="line-410"></a><span class="hs-pragma">{-# NOINLINE quotInteger #-}</span><span>
</span><a name="line-411"></a><span class="hs-identifier">quotInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-412"></a><a name="local-6989586621679017121"><a href="#local-6989586621679017121"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="quotInteger"><a href="GHC.Integer.Type.html#quotInteger"><span class="hs-identifier">quotInteger</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017122"><a href="#local-6989586621679017122"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017121"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#quotRemInteger"><span class="hs-identifier hs-var">quotRemInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017122"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-413"></a><span>                    </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017123"><a href="#local-6989586621679017123"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679017123"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-pragma">{-# NOINLINE remInteger #-}</span><span>
</span><a name="line-416"></a><span class="hs-identifier">remInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-417"></a><a name="local-6989586621679017124"><a href="#local-6989586621679017124"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="remInteger"><a href="GHC.Integer.Type.html#remInteger"><span class="hs-identifier">remInteger</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017125"><a href="#local-6989586621679017125"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017124"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#quotRemInteger"><span class="hs-identifier hs-var">quotRemInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017125"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-418"></a><span>                   </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679017126"><a href="#local-6989586621679017126"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679017126"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-pragma">{-# NOINLINE compareInteger #-}</span><span>
</span><a name="line-421"></a><span class="hs-identifier">compareInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a><span>
</span><a name="line-422"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017127"><a href="#local-6989586621679017127"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="compareInteger"><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier">compareInteger</span></a></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a name="local-6989586621679017128"><a href="#local-6989586621679017128"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017127"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#comparePositive"><span class="hs-identifier hs-var">comparePositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017128"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-423"></a><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">compareInteger</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span>
</span><a name="line-424"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-special">`</span><span class="hs-identifier">compareInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a><span>
</span><a name="line-425"></a><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>     </span><span class="hs-special">`</span><span class="hs-identifier">compareInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span>
</span><a name="line-426"></a><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017129"><a href="#local-6989586621679017129"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">compareInteger</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017130"><a href="#local-6989586621679017130"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017130"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#comparePositive"><span class="hs-identifier hs-var">comparePositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017129"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-427"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">compareInteger</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a><span>
</span><a name="line-428"></a><span>
</span><a name="line-429"></a><span class="hs-pragma">{-# NOINLINE eqInteger# #-}</span><span>
</span><a name="line-430"></a><span class="hs-identifier">eqInteger</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-431"></a><a name="local-6989586621679017131"><a href="#local-6989586621679017131"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="eqInteger%23"><a href="GHC.Integer.Type.html#eqInteger%23"><span class="hs-identifier">eqInteger</span><span class="hs-operator">#</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017132"><a href="#local-6989586621679017132"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017131"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier hs-var">compareInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017132"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-432"></a><span>                        </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span>
</span><a name="line-433"></a><span>                        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span class="hs-pragma">{-# NOINLINE neqInteger# #-}</span><span>
</span><a name="line-436"></a><span class="hs-identifier">neqInteger</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-437"></a><a name="local-6989586621679017133"><a href="#local-6989586621679017133"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="neqInteger%23"><a href="GHC.Integer.Type.html#neqInteger%23"><span class="hs-identifier">neqInteger</span><span class="hs-operator">#</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017134"><a href="#local-6989586621679017134"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017133"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier hs-var">compareInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017134"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-438"></a><span>                         </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-439"></a><span>                         </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-pragma">{-# INLINE eqInteger  #-}</span><span>
</span><a name="line-442"></a><span class="hs-pragma">{-# INLINE neqInteger #-}</span><span>
</span><a name="line-443"></a><span class="hs-identifier">eqInteger</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">neqInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-444"></a><a name="eqInteger"><a href="GHC.Integer.Type.html#eqInteger"><span class="hs-identifier">eqInteger</span></a></a><span>  </span><a name="local-6989586621679017135"><a href="#local-6989586621679017135"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679017136"><a href="#local-6989586621679017136"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017135"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#eqInteger%23"><span class="hs-identifier hs-var">eqInteger</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span>  </span><a href="#local-6989586621679017136"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-445"></a><a name="neqInteger"><a href="GHC.Integer.Type.html#neqInteger"><span class="hs-identifier">neqInteger</span></a></a><span> </span><a name="local-6989586621679017137"><a href="#local-6989586621679017137"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679017138"><a href="#local-6989586621679017138"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017137"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#neqInteger%23"><span class="hs-identifier hs-var">neqInteger</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017138"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span class="hs-keyword">instance</span><span>  </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-448"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541095"><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator">==</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#eqInteger"><span class="hs-identifier hs-var">eqInteger</span></a><span>
</span><a name="line-449"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784735"><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%2F%3D"><span class="hs-operator">/=</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#neqInteger"><span class="hs-identifier hs-var">neqInteger</span></a><span>
</span><a name="line-450"></a><span>
</span><a name="line-451"></a><span class="hs-pragma">{-# NOINLINE ltInteger# #-}</span><span>
</span><a name="line-452"></a><span class="hs-identifier">ltInteger</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-453"></a><a name="local-6989586621679017139"><a href="#local-6989586621679017139"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="ltInteger%23"><a href="GHC.Integer.Type.html#ltInteger%23"><span class="hs-identifier">ltInteger</span><span class="hs-operator">#</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017140"><a href="#local-6989586621679017140"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017139"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier hs-var">compareInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017140"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-454"></a><span>                        </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span>
</span><a name="line-455"></a><span>                        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-pragma">{-# NOINLINE gtInteger# #-}</span><span>
</span><a name="line-458"></a><span class="hs-identifier">gtInteger</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-459"></a><a name="local-6989586621679017141"><a href="#local-6989586621679017141"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="gtInteger%23"><a href="GHC.Integer.Type.html#gtInteger%23"><span class="hs-identifier">gtInteger</span><span class="hs-operator">#</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017142"><a href="#local-6989586621679017142"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017141"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier hs-var">compareInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017142"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-460"></a><span>                        </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span>
</span><a name="line-461"></a><span>                        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span class="hs-pragma">{-# NOINLINE leInteger# #-}</span><span>
</span><a name="line-464"></a><span class="hs-identifier">leInteger</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-465"></a><a name="local-6989586621679017143"><a href="#local-6989586621679017143"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="leInteger%23"><a href="GHC.Integer.Type.html#leInteger%23"><span class="hs-identifier">leInteger</span><span class="hs-operator">#</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017144"><a href="#local-6989586621679017144"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017143"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier hs-var">compareInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017144"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-466"></a><span>                        </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-467"></a><span>                        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span>
</span><a name="line-468"></a><span>
</span><a name="line-469"></a><span class="hs-pragma">{-# NOINLINE geInteger# #-}</span><span>
</span><a name="line-470"></a><span class="hs-identifier">geInteger</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-471"></a><a name="local-6989586621679017145"><a href="#local-6989586621679017145"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="geInteger%23"><a href="GHC.Integer.Type.html#geInteger%23"><span class="hs-identifier">geInteger</span><span class="hs-operator">#</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679017146"><a href="#local-6989586621679017146"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017145"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier hs-var">compareInteger</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017146"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-472"></a><span>                        </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-473"></a><span>                        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span>
</span><a name="line-474"></a><span>
</span><a name="line-475"></a><span class="hs-pragma">{-# INLINE leInteger #-}</span><span>
</span><a name="line-476"></a><span class="hs-pragma">{-# INLINE ltInteger #-}</span><span>
</span><a name="line-477"></a><span class="hs-pragma">{-# INLINE geInteger #-}</span><span>
</span><a name="line-478"></a><span class="hs-pragma">{-# INLINE gtInteger #-}</span><span>
</span><a name="line-479"></a><span class="hs-identifier">leInteger</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gtInteger</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltInteger</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">geInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-480"></a><a name="leInteger"><a href="GHC.Integer.Type.html#leInteger"><span class="hs-identifier">leInteger</span></a></a><span> </span><a name="local-6989586621679017147"><a href="#local-6989586621679017147"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679017148"><a href="#local-6989586621679017148"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017147"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#leInteger%23"><span class="hs-identifier hs-var">leInteger</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017148"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-481"></a><a name="gtInteger"><a href="GHC.Integer.Type.html#gtInteger"><span class="hs-identifier">gtInteger</span></a></a><span> </span><a name="local-6989586621679017149"><a href="#local-6989586621679017149"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679017150"><a href="#local-6989586621679017150"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017149"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#gtInteger%23"><span class="hs-identifier hs-var">gtInteger</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017150"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><a name="ltInteger"><a href="GHC.Integer.Type.html#ltInteger"><span class="hs-identifier">ltInteger</span></a></a><span> </span><a name="local-6989586621679017151"><a href="#local-6989586621679017151"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679017152"><a href="#local-6989586621679017152"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017151"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#ltInteger%23"><span class="hs-identifier hs-var">ltInteger</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017152"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><a name="geInteger"><a href="GHC.Integer.Type.html#geInteger"><span class="hs-identifier">geInteger</span></a></a><span> </span><a name="local-6989586621679017153"><a href="#local-6989586621679017153"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679017154"><a href="#local-6989586621679017154"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017153"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#geInteger%23"><span class="hs-identifier hs-var">geInteger</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017154"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>
</span><a name="line-485"></a><span class="hs-keyword">instance</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-486"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784733"><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3C%3D"><span class="hs-operator">&lt;=</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#leInteger"><span class="hs-identifier hs-var">leInteger</span></a><span>
</span><a name="line-487"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784728"><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3E"><span class="hs-operator">&gt;</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#gtInteger"><span class="hs-identifier hs-var">gtInteger</span></a><span>
</span><a name="line-488"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323784729"><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator">&lt;</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#ltInteger"><span class="hs-identifier hs-var">ltInteger</span></a><span>
</span><a name="line-489"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541096"><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3E%3D"><span class="hs-operator">&gt;=</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#geInteger"><span class="hs-identifier hs-var">geInteger</span></a><span>
</span><a name="line-490"></a><span>    </span><a name="local-8214565720323784734"><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#compare"><span class="hs-identifier">compare</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#compareInteger"><span class="hs-identifier hs-var">compareInteger</span></a><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-pragma">{-# NOINLINE absInteger #-}</span><span>
</span><a name="line-493"></a><span class="hs-identifier">absInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-494"></a><a name="absInteger"><a href="GHC.Integer.Type.html#absInteger"><span class="hs-identifier">absInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a name="local-6989586621679017155"><a href="#local-6989586621679017155"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017155"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-495"></a><span class="hs-identifier">absInteger</span><span> </span><a name="local-6989586621679017156"><a href="#local-6989586621679017156"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017156"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-496"></a><span>
</span><a name="line-497"></a><span class="hs-pragma">{-# NOINLINE signumInteger #-}</span><span>
</span><a name="line-498"></a><span class="hs-identifier">signumInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-499"></a><a name="signumInteger"><a href="GHC.Integer.Type.html#signumInteger"><span class="hs-identifier">signumInteger</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#negativeOneInteger"><span class="hs-identifier hs-var">negativeOneInteger</span></a><span>
</span><a name="line-500"></a><span class="hs-identifier">signumInteger</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-501"></a><span class="hs-identifier">signumInteger</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#oneInteger"><span class="hs-identifier hs-var">oneInteger</span></a><span>
</span><a name="line-502"></a><span>
</span><a name="line-503"></a><span class="hs-pragma">{-# NOINLINE hashInteger #-}</span><span>
</span><a name="line-504"></a><span class="hs-identifier">hashInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-505"></a><a name="hashInteger"><a href="GHC.Integer.Type.html#hashInteger"><span class="hs-identifier">hashInteger</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#integerToInt"><span class="hs-identifier hs-var">integerToInt</span></a><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span class="hs-comment">-------------------------------------------------------------------</span><span>
</span><a name="line-508"></a><span class="hs-comment">-- The hard work is done on positive numbers</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-identifier">onePositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-511"></a><a name="onePositive"><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier">onePositive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">1</span><span class="hs-operator">##</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-identifier">halfBoundUp</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fullBound</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span>
</span><a name="line-514"></a><span class="hs-identifier">lowHalfMask</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span>
</span><a name="line-515"></a><span class="hs-identifier">highHalfShift</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-516"></a><span class="hs-identifier">twoToTheThirtytwoPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-517"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS == 64</span><span>
</span><a name="line-518"></a><a name="halfBoundUp"><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier">halfBoundUp</span></a></a><span>   </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x8000000000000000</span><span class="hs-operator">##</span><span>
</span><a name="line-519"></a><a name="fullBound"><a href="GHC.Integer.Type.html#fullBound"><span class="hs-identifier">fullBound</span></a></a><span>     </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0xFFFFFFFFFFFFFFFF</span><span class="hs-operator">##</span><span>
</span><a name="line-520"></a><a name="lowHalfMask"><a href="GHC.Integer.Type.html#lowHalfMask"><span class="hs-identifier">lowHalfMask</span></a></a><span>   </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0xFFFFFFFF</span><span class="hs-operator">##</span><span>
</span><a name="line-521"></a><a name="highHalfShift"><a href="GHC.Integer.Type.html#highHalfShift"><span class="hs-identifier">highHalfShift</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">32</span><span class="hs-operator">#</span><span>
</span><a name="line-522"></a><a name="twoToTheThirtytwoPositive"><a href="GHC.Integer.Type.html#twoToTheThirtytwoPositive"><span class="hs-identifier">twoToTheThirtytwoPositive</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">0x100000000</span><span class="hs-operator">##</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-523"></a><span class="hs-cpp">#elif WORD_SIZE_IN_BITS == 32</span><span>
</span><a name="line-524"></a><span class="hs-identifier">halfBoundUp</span><span>   </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0x80000000</span><span class="hs-operator">##</span><span>
</span><a name="line-525"></a><span class="hs-identifier">fullBound</span><span>     </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0xFFFFFFFF</span><span class="hs-operator">##</span><span>
</span><a name="line-526"></a><span class="hs-identifier">lowHalfMask</span><span>   </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0xFFFF</span><span class="hs-operator">##</span><span>
</span><a name="line-527"></a><span class="hs-identifier">highHalfShift</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">16</span><span class="hs-operator">#</span><span>
</span><a name="line-528"></a><span class="hs-identifier">twoToTheThirtytwoPositive</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Some</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Some</span><span> </span><span class="hs-number">1</span><span class="hs-operator">##</span><span> </span><span class="hs-identifier">None</span><span class="hs-special">)</span><span>
</span><a name="line-529"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-530"></a><span class="hs-cpp">#error Unhandled WORD_SIZE_IN_BITS</span><span>
</span><a name="line-531"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">digitsMaybeZeroToInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-534"></a><a name="digitsMaybeZeroToInteger"><a href="GHC.Integer.Type.html#digitsMaybeZeroToInteger"><span class="hs-identifier">digitsMaybeZeroToInteger</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-535"></a><span class="hs-identifier">digitsMaybeZeroToInteger</span><span> </span><a name="local-6989586621679017157"><a href="#local-6989586621679017157"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017157"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-536"></a><span>
</span><a name="line-537"></a><span class="hs-identifier">digitsToInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-538"></a><a name="digitsToInteger"><a href="GHC.Integer.Type.html#digitsToInteger"><span class="hs-identifier">digitsToInteger</span></a></a><span> </span><a name="local-6989586621679017158"><a href="#local-6989586621679017158"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#removeZeroTails"><span class="hs-identifier hs-var">removeZeroTails</span></a><span> </span><a href="#local-6989586621679017158"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-539"></a><span>                     </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-540"></a><span>                     </span><a name="local-6989586621679017159"><a href="#local-6989586621679017159"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017159"><span class="hs-identifier hs-var">ds'</span></a><span>
</span><a name="line-541"></a><span>
</span><a name="line-542"></a><span class="hs-identifier">digitsToNegativeInteger</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-543"></a><a name="digitsToNegativeInteger"><a href="GHC.Integer.Type.html#digitsToNegativeInteger"><span class="hs-identifier">digitsToNegativeInteger</span></a></a><span> </span><a name="local-6989586621679017160"><a href="#local-6989586621679017160"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#removeZeroTails"><span class="hs-identifier hs-var">removeZeroTails</span></a><span> </span><a href="#local-6989586621679017160"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-544"></a><span>                             </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-545"></a><span>                             </span><a name="local-6989586621679017161"><a href="#local-6989586621679017161"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Negative"><span class="hs-identifier hs-var">Negative</span></a><span> </span><a href="#local-6989586621679017161"><span class="hs-identifier hs-var">ds'</span></a><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span class="hs-identifier">removeZeroTails</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-548"></a><a name="removeZeroTails"><a href="GHC.Integer.Type.html#removeZeroTails"><span class="hs-identifier">removeZeroTails</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017162"><a href="#local-6989586621679017162"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679017163"><a href="#local-6989586621679017163"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017162"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-549"></a><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#removeZeroTails"><span class="hs-identifier hs-var">removeZeroTails</span></a><span> </span><a href="#local-6989586621679017163"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-550"></a><span>                                   </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-551"></a><span>                                   </span><a name="local-6989586621679017164"><a href="#local-6989586621679017164"><span class="hs-identifier">ds'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017162"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679017164"><span class="hs-identifier hs-var">ds'</span></a><span>
</span><a name="line-552"></a><span>                              </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017162"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#removeZeroTails"><span class="hs-identifier hs-var">removeZeroTails</span></a><span> </span><a href="#local-6989586621679017163"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span class="hs-identifier">removeZeroTails</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span class="hs-cpp">#if WORD_SIZE_IN_BITS &lt; 64</span><span>
</span><a name="line-556"></a><span class="hs-identifier">word64ToPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word64</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Positive</span><span>
</span><a name="line-557"></a><span class="hs-identifier">word64ToPositive</span><span> </span><span class="hs-identifier">w</span><span>
</span><a name="line-558"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">isTrue</span><span class="hs-operator">#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">eqWord64</span><span class="hs-operator">#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">wordToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-559"></a><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">None</span><span>
</span><a name="line-560"></a><span>   </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">Some</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToWord</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToPositive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftRL64</span><span class="hs-operator">#</span><span class="hs-special">`</span><span> </span><span class="hs-number">32</span><span class="hs-operator">#</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-identifier">positiveToWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Positive</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64</span><span class="hs-operator">#</span><span>
</span><a name="line-563"></a><span class="hs-identifier">positiveToWord64</span><span> </span><span class="hs-identifier">None</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">wordToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><span class="hs-comment">-- XXX Can't happen</span><span>
</span><a name="line-564"></a><span class="hs-identifier">positiveToWord64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Some</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">None</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">wordToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">w</span><span>
</span><a name="line-565"></a><span class="hs-identifier">positiveToWord64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Some</span><span> </span><span class="hs-identifier">low</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Some</span><span> </span><span class="hs-identifier">high</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-566"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">wordToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">low</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or64</span><span class="hs-operator">#</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64</span><span class="hs-operator">#</span><span> </span><span class="hs-identifier">high</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL64</span><span class="hs-operator">#</span><span class="hs-special">`</span><span> </span><span class="hs-number">32</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-567"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-570"></a><span class="hs-identifier">comparePositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a><span>
</span><a name="line-571"></a><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017165"><a href="#local-6989586621679017165"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679017166"><a href="#local-6989586621679017166"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">`</span><a name="comparePositive"><a href="GHC.Integer.Type.html#comparePositive"><span class="hs-identifier">comparePositive</span></a></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017167"><a href="#local-6989586621679017167"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679017168"><a href="#local-6989586621679017168"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017166"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#comparePositive"><span class="hs-identifier hs-var">comparePositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017168"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-572"></a><span>                                        </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>      </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017165"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#ltWord%23"><span class="hs-identifier hs-var">ltWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017167"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a><span>
</span><a name="line-573"></a><span>                                              </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017165"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#gtWord%23"><span class="hs-identifier hs-var">gtWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017167"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span>
</span><a name="line-574"></a><span>                                              </span><span class="hs-keyword">else</span><span>                                 </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a><span>
</span><a name="line-575"></a><span>                                        </span><a name="local-6989586621679017169"><a href="#local-6989586621679017169"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679017169"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-576"></a><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>      </span><span class="hs-special">`</span><span class="hs-identifier">comparePositive</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a><span>
</span><a name="line-577"></a><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">comparePositive</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span>
</span><a name="line-578"></a><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>      </span><span class="hs-special">`</span><span class="hs-identifier">comparePositive</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a><span>
</span><a name="line-579"></a><span>
</span><a name="line-580"></a><span class="hs-identifier">plusPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-581"></a><a name="plusPositive"><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier">plusPositive</span></a></a><span> </span><a name="local-6989586621679017170"><a href="#local-6989586621679017170"><span class="hs-identifier">x0</span></a></a><span> </span><a name="local-6989586621679017171"><a href="#local-6989586621679017171"><span class="hs-identifier">y0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017172"><span class="hs-identifier hs-var">addWithCarry</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679017170"><span class="hs-identifier hs-var">x0</span></a><span> </span><a href="#local-6989586621679017171"><span class="hs-identifier hs-var">y0</span></a><span>
</span><a name="line-582"></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- digit `elem` [0, 1]</span><span>
</span><a name="line-583"></a><span>       </span><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-584"></a><span>       </span><span class="hs-identifier">addWithCarry</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-585"></a><span>       </span><a name="local-6989586621679017172"><a href="#local-6989586621679017172"><span class="hs-identifier">addWithCarry</span></a></a><span> </span><a name="local-6989586621679017174"><a href="#local-6989586621679017174"><span class="hs-identifier">c</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>            </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017173"><span class="hs-identifier hs-var">addOnCarry</span></a><span> </span><a href="#local-6989586621679017174"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-586"></a><span>       </span><span class="hs-identifier">addWithCarry</span><span> </span><a name="local-6989586621679017175"><a href="#local-6989586621679017175"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679017176"><a href="#local-6989586621679017176"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017173"><span class="hs-identifier hs-var">addOnCarry</span></a><span> </span><a href="#local-6989586621679017175"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679017176"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-587"></a><span>       </span><span class="hs-identifier">addWithCarry</span><span> </span><a name="local-6989586621679017177"><a href="#local-6989586621679017177"><span class="hs-identifier">c</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>            </span><a name="local-6989586621679017178"><a href="#local-6989586621679017178"><span class="hs-identifier">ys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017173"><span class="hs-identifier hs-var">addOnCarry</span></a><span> </span><a href="#local-6989586621679017177"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679017178"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-588"></a><span>       </span><span class="hs-identifier">addWithCarry</span><span> </span><a name="local-6989586621679017179"><a href="#local-6989586621679017179"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679017180"><a href="#local-6989586621679017180"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017181"><a href="#local-6989586621679017181"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679017182"><a href="#local-6989586621679017182"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679017183"><a href="#local-6989586621679017183"><span class="hs-identifier">ys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017184"><a href="#local-6989586621679017184"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679017185"><a href="#local-6989586621679017185"><span class="hs-identifier">ys'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-589"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017181"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#ltWord%23"><span class="hs-identifier hs-var">ltWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017184"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679017172"><span class="hs-identifier hs-var">addWithCarry</span></a><span> </span><a href="#local-6989586621679017179"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679017183"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679017180"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-590"></a><span>          </span><span class="hs-comment">-- Now x &gt;= y</span><span>
</span><a name="line-591"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017184"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#geWord%23"><span class="hs-identifier hs-var">geWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-592"></a><span>               </span><span class="hs-comment">-- So they are both at least halfBoundUp, so we subtract</span><span>
</span><a name="line-593"></a><span>               </span><span class="hs-comment">-- halfBoundUp from each and thus carry 1</span><span>
</span><a name="line-594"></a><span>               </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017181"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#minusWord%23"><span class="hs-identifier hs-var">minusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-595"></a><span>                    </span><a name="local-6989586621679017188"><a href="#local-6989586621679017188"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-596"></a><span>                     </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017184"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#minusWord%23"><span class="hs-identifier hs-var">minusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-597"></a><span>                     </span><a name="local-6989586621679017189"><a href="#local-6989586621679017189"><span class="hs-identifier">y'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-598"></a><span>                      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017188"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017189"><span class="hs-identifier hs-var">y'</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017179"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-599"></a><span>                      </span><a name="local-6989586621679017190"><a href="#local-6989586621679017190"><span class="hs-identifier">this</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-600"></a><span>                       </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017190"><span class="hs-identifier hs-var">this</span></a><span> </span><a href="#local-6989586621679017186"><span class="hs-identifier hs-var">withCarry</span></a><span>
</span><a name="line-601"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017181"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#geWord%23"><span class="hs-identifier hs-var">geWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span>               </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017181"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#minusWord%23"><span class="hs-identifier hs-var">minusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-603"></a><span>                    </span><a name="local-6989586621679017191"><a href="#local-6989586621679017191"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-604"></a><span>                     </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017191"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017184"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017179"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-605"></a><span>                     </span><a name="local-6989586621679017192"><a href="#local-6989586621679017192"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-606"></a><span>                      </span><span class="hs-comment">-- We've taken off halfBoundUp, so now we need to</span><span>
</span><a name="line-607"></a><span>                      </span><span class="hs-comment">-- add it back on</span><span>
</span><a name="line-608"></a><span>                      </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017192"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#ltWord%23"><span class="hs-identifier hs-var">ltWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-609"></a><span>                       </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017192"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span>  </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679017187"><span class="hs-identifier hs-var">withoutCarry</span></a><span>
</span><a name="line-610"></a><span>                       </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017192"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#minusWord%23"><span class="hs-identifier hs-var">minusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#halfBoundUp"><span class="hs-identifier hs-var">halfBoundUp</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679017186"><span class="hs-identifier hs-var">withCarry</span></a><span>
</span><a name="line-611"></a><span>          </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017181"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017184"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017179"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679017187"><span class="hs-identifier hs-var">withoutCarry</span></a><span>
</span><a name="line-612"></a><span>           </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679017186"><a href="#local-6989586621679017186"><span class="hs-identifier">withCarry</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017172"><span class="hs-identifier hs-var">addWithCarry</span></a><span> </span><span class="hs-number">1</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679017182"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621679017185"><span class="hs-identifier hs-var">ys'</span></a><span>
</span><a name="line-613"></a><span>                 </span><a name="local-6989586621679017187"><a href="#local-6989586621679017187"><span class="hs-identifier">withoutCarry</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017172"><span class="hs-identifier hs-var">addWithCarry</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679017182"><span class="hs-identifier hs-var">xs'</span></a><span> </span><a href="#local-6989586621679017185"><span class="hs-identifier hs-var">ys'</span></a><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span>       </span><span class="hs-comment">-- digit `elem` [0, 1]</span><span>
</span><a name="line-616"></a><span>       </span><span class="hs-identifier">addOnCarry</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-617"></a><span>       </span><a name="local-6989586621679017173"><a href="#local-6989586621679017173"><span class="hs-identifier">addOnCarry</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017193"><a href="#local-6989586621679017193"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017194"><a href="#local-6989586621679017194"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017193"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-618"></a><span>                               </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679017194"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-619"></a><span>                               </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#succPositive"><span class="hs-identifier hs-var">succPositive</span></a><span> </span><a href="#local-6989586621679017194"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-620"></a><span>
</span><a name="line-621"></a><span class="hs-comment">-- digit `elem` [0, 1]</span><span>
</span><a name="line-622"></a><span class="hs-identifier">succPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-623"></a><a name="succPositive"><a href="GHC.Integer.Type.html#succPositive"><span class="hs-identifier">succPositive</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">1</span><span class="hs-operator">##</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-624"></a><span class="hs-identifier">succPositive</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017195"><a href="#local-6989586621679017195"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679017196"><a href="#local-6989586621679017196"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017195"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#fullBound"><span class="hs-identifier hs-var">fullBound</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-625"></a><span>                           </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#succPositive"><span class="hs-identifier hs-var">succPositive</span></a><span> </span><a href="#local-6989586621679017196"><span class="hs-identifier hs-var">ws</span></a><span class="hs-special">)</span><span>
</span><a name="line-626"></a><span>                           </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017195"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-operator">##</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679017196"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span class="hs-comment">-- Requires x &gt; y</span><span>
</span><a name="line-629"></a><span class="hs-comment">-- In recursive calls, x &gt;= y and x == y =&gt; result is None</span><span>
</span><a name="line-630"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-631"></a><span class="hs-identifier">minusPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-632"></a><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017197"><a href="#local-6989586621679017197"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679017198"><a href="#local-6989586621679017198"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">`</span><a name="minusPositive"><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier">minusPositive</span></a></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017199"><a href="#local-6989586621679017199"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679017200"><a href="#local-6989586621679017200"><span class="hs-identifier">ys</span></a></a><span>
</span><a name="line-633"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017197"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017199"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017198"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017200"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-635"></a><span>        </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-636"></a><span>        </span><a name="local-6989586621679017201"><a href="#local-6989586621679017201"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679017201"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-637"></a><span>   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017197"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#gtWord%23"><span class="hs-identifier hs-var">gtWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017199"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-638"></a><span>        </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017197"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#minusWord%23"><span class="hs-identifier hs-var">minusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017199"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017198"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017200"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#fullBound"><span class="hs-identifier hs-var">fullBound</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#minusWord%23"><span class="hs-identifier hs-var">minusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017199"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-operator">##</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-640"></a><span>        </span><a name="local-6989586621679017202"><a href="#local-6989586621679017202"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- z = 2^n - y, calculated without overflow</span><span>
</span><a name="line-641"></a><span>         </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017202"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017197"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-642"></a><span>         </span><a name="local-6989586621679017203"><a href="#local-6989586621679017203"><span class="hs-identifier">z'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- z = 2^n + (x - y), calculated without overflow</span><span>
</span><a name="line-643"></a><span>          </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017203"><span class="hs-identifier hs-var">z'</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679017198"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017200"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#onePositive"><span class="hs-identifier hs-var">onePositive</span></a><span class="hs-special">)</span><span>
</span><a name="line-644"></a><a name="local-6989586621679017204"><a href="#local-6989586621679017204"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">minusPositive</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017204"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-645"></a><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>         </span><span class="hs-special">`</span><span class="hs-identifier">minusPositive</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-646"></a><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>         </span><span class="hs-special">`</span><span class="hs-identifier">minusPositive</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#errorPositive"><span class="hs-identifier hs-var">errorPositive</span></a><span> </span><span class="hs-comment">-- XXX Can't happen</span><span>
</span><a name="line-647"></a><span class="hs-comment">-- XXX None `minusPositive` _ = error &quot;minusPositive: Requirement x &gt; y not met&quot;</span><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-650"></a><span class="hs-identifier">timesPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-651"></a><span class="hs-comment">-- XXX None's can't happen here:</span><span>
</span><a name="line-652"></a><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>            </span><span class="hs-special">`</span><a name="timesPositive"><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier">timesPositive</span></a></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#errorPositive"><span class="hs-identifier hs-var">errorPositive</span></a><span>
</span><a name="line-653"></a><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>            </span><span class="hs-special">`</span><span class="hs-identifier">timesPositive</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#errorPositive"><span class="hs-identifier hs-var">errorPositive</span></a><span>
</span><a name="line-654"></a><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">timesPositive</span><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#errorPositive"><span class="hs-identifier hs-var">errorPositive</span></a><span>
</span><a name="line-655"></a><span class="hs-comment">-- x and y are the last digits in Positive numbers, so are not 0:</span><span>
</span><a name="line-656"></a><a name="local-6989586621679017205"><a href="#local-6989586621679017205"><span class="hs-identifier">xs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017206"><a href="#local-6989586621679017206"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679017207"><a href="#local-6989586621679017207"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesPositive</span><span class="hs-special">`</span><span> </span><a name="local-6989586621679017208"><a href="#local-6989586621679017208"><span class="hs-identifier">ys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017209"><a href="#local-6989586621679017209"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679017210"><a href="#local-6989586621679017210"><span class="hs-identifier">ys'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017207"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-658"></a><span>   </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-659"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017210"><span class="hs-identifier hs-var">ys'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-660"></a><span>           </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-661"></a><span>               </span><a href="#local-6989586621679017206"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesDigit"><span class="hs-identifier hs-var">timesDigit</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017209"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-662"></a><span>           </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-663"></a><span>               </span><a href="#local-6989586621679017208"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017205"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-664"></a><span>   </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-665"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017210"><span class="hs-identifier hs-var">ys'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-666"></a><span>       </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-667"></a><span>           </span><span class="hs-comment">-- y is the last digit in a Positive number, so is not 0.</span><span>
</span><a name="line-668"></a><span>           </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017211"><a href="#local-6989586621679017211"><span class="hs-identifier">zs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017207"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017208"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-669"></a><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- We could actually skip this test, and everything would</span><span>
</span><a name="line-670"></a><span>              </span><span class="hs-comment">-- turn out OK. We already play tricks like that in timesPositive.</span><span>
</span><a name="line-671"></a><span>              </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017206"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-672"></a><span>              </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679017211"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-673"></a><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017206"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesDigit"><span class="hs-identifier hs-var">timesDigit</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017209"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier hs-var">plusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017211"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-674"></a><span>       </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-675"></a><span>           </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017206"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017208"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier hs-var">plusPositive</span></a><span class="hs-special">`</span><span>
</span><a name="line-676"></a><span>           </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017207"><span class="hs-identifier hs-var">xs'</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#timesPositive"><span class="hs-identifier hs-var">timesPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017208"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-677"></a><span>
</span><a name="line-678"></a><span class="hs-comment">{-
-- Requires arguments /= 0
Suppose we have 2n bits in a Word. Then
    x = 2^n xh + xl
    y = 2^n yh + yl
    x * y = (2^n xh + xl) * (2^n yh + yl)
          = 2^(2n) (xh yh)
          + 2^n    (xh yl)
          + 2^n    (xl yh)
          +        (xl yl)
                   ~~~~~~~ - all fit in 2n bits
-}</span><span>
</span><a name="line-690"></a><span class="hs-identifier">timesDigit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-691"></a><a name="timesDigit"><a href="GHC.Integer.Type.html#timesDigit"><span class="hs-identifier">timesDigit</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017212"><a href="#local-6989586621679017212"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017213"><a href="#local-6989586621679017213"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#splitHalves"><span class="hs-identifier hs-var">splitHalves</span></a><span> </span><a href="#local-6989586621679017212"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-693"></a><span>   </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017214"><a href="#local-6989586621679017214"><span class="hs-identifier">xh</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017215"><a href="#local-6989586621679017215"><span class="hs-identifier">xl</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-694"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#splitHalves"><span class="hs-identifier hs-var">splitHalves</span></a><span> </span><a href="#local-6989586621679017213"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-695"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017216"><a href="#local-6989586621679017216"><span class="hs-identifier">yh</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017217"><a href="#local-6989586621679017217"><span class="hs-identifier">yl</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-696"></a><span>     </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017214"><span class="hs-identifier hs-var">xh</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#timesWord%23"><span class="hs-identifier hs-var">timesWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017216"><span class="hs-identifier hs-var">yh</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-697"></a><span>     </span><a name="local-6989586621679017218"><a href="#local-6989586621679017218"><span class="hs-identifier">xhyh</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-698"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#splitHalves"><span class="hs-identifier hs-var">splitHalves</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017214"><span class="hs-identifier hs-var">xh</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#timesWord%23"><span class="hs-identifier hs-var">timesWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017217"><span class="hs-identifier hs-var">yl</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-699"></a><span>      </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017219"><a href="#local-6989586621679017219"><span class="hs-identifier">xhylh</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017220"><a href="#local-6989586621679017220"><span class="hs-identifier">xhyll</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-700"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017220"><span class="hs-identifier hs-var">xhyll</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#uncheckedShiftL%23"><span class="hs-identifier hs-var">uncheckedShiftL</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#highHalfShift"><span class="hs-identifier hs-var">highHalfShift</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-701"></a><span>       </span><a name="local-6989586621679017221"><a href="#local-6989586621679017221"><span class="hs-identifier">xhyll'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-702"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#splitHalves"><span class="hs-identifier hs-var">splitHalves</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017215"><span class="hs-identifier hs-var">xl</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#timesWord%23"><span class="hs-identifier hs-var">timesWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017216"><span class="hs-identifier hs-var">yh</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-703"></a><span>        </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017222"><a href="#local-6989586621679017222"><span class="hs-identifier">xlyhh</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017223"><a href="#local-6989586621679017223"><span class="hs-identifier">xlyhl</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-704"></a><span>         </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017223"><span class="hs-identifier hs-var">xlyhl</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#uncheckedShiftL%23"><span class="hs-identifier hs-var">uncheckedShiftL</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#highHalfShift"><span class="hs-identifier hs-var">highHalfShift</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-705"></a><span>         </span><a name="local-6989586621679017224"><a href="#local-6989586621679017224"><span class="hs-identifier">xlyhl'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-706"></a><span>          </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017215"><span class="hs-identifier hs-var">xl</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#timesWord%23"><span class="hs-identifier hs-var">timesWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017217"><span class="hs-identifier hs-var">yl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-707"></a><span>          </span><a name="local-6989586621679017225"><a href="#local-6989586621679017225"><span class="hs-identifier">xlyl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-708"></a><span>           </span><span class="hs-comment">-- Add up all the high word results. As the result fits in</span><span>
</span><a name="line-709"></a><span>           </span><span class="hs-comment">-- 4n bits this can't overflow.</span><span>
</span><a name="line-710"></a><span>           </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017218"><span class="hs-identifier hs-var">xhyh</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017219"><span class="hs-identifier hs-var">xhylh</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017222"><span class="hs-identifier hs-var">xlyhh</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-711"></a><span>           </span><a name="local-6989586621679017226"><a href="#local-6989586621679017226"><span class="hs-identifier">high</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-712"></a><span>           </span><span class="hs-comment">-- low: xhyll&lt;&lt;n + xlyhl&lt;&lt;n + xlyl</span><span>
</span><a name="line-713"></a><span>            </span><span class="hs-comment">-- From this point we might make (Some 0 None), but we know</span><span>
</span><a name="line-714"></a><span>            </span><span class="hs-comment">-- that the final result will be positive and the addition</span><span>
</span><a name="line-715"></a><span>            </span><span class="hs-comment">-- will work out OK, so everything will work out in the end.</span><span>
</span><a name="line-716"></a><span>            </span><span class="hs-comment">-- One thing we do need to be careful of is avoiding returning</span><span>
</span><a name="line-717"></a><span>            </span><span class="hs-comment">-- Some 0 (Some 0 None) + Some n None, as this will result in</span><span>
</span><a name="line-718"></a><span>            </span><span class="hs-comment">-- Some n (Some 0 None) instead of Some n None.</span><span>
</span><a name="line-719"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017227"><a href="#local-6989586621679017227"><span class="hs-identifier">low</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017221"><span class="hs-identifier hs-var">xhyll'</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier hs-var">plusPositive</span></a><span class="hs-special">`</span><span>
</span><a name="line-720"></a><span>                      </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017224"><span class="hs-identifier hs-var">xlyhl'</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier hs-var">plusPositive</span></a><span class="hs-special">`</span><span>
</span><a name="line-721"></a><span>                      </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017225"><span class="hs-identifier hs-var">xlyl</span></a><span>   </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-722"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017226"><span class="hs-identifier hs-var">high</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-723"></a><span>               </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679017227"><span class="hs-identifier hs-var">low</span></a><span>
</span><a name="line-724"></a><span>               </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017226"><span class="hs-identifier hs-var">high</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#plusPositive"><span class="hs-identifier hs-var">plusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017227"><span class="hs-identifier hs-var">low</span></a><span>
</span><a name="line-725"></a><span>
</span><a name="line-726"></a><span class="hs-identifier">splitHalves</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><span class="hs-comment">{- High -}</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">{- Low -}</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-727"></a><a name="splitHalves"><a href="GHC.Integer.Type.html#splitHalves"><span class="hs-identifier">splitHalves</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017228"><a href="#local-6989586621679017228"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679017228"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#uncheckedShiftRL%23"><span class="hs-identifier hs-var">uncheckedShiftRL</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#highHalfShift"><span class="hs-identifier hs-var">highHalfShift</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-728"></a><span>                      </span><a href="#local-6989586621679017228"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#and%23"><span class="hs-identifier hs-var">and</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="GHC.Integer.Type.html#lowHalfMask"><span class="hs-identifier hs-var">lowHalfMask</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span>
</span><a name="line-730"></a><span class="hs-comment">-- Assumes 0 &lt;= i</span><span>
</span><a name="line-731"></a><span class="hs-identifier">shiftLPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-732"></a><a name="shiftLPositive"><a href="GHC.Integer.Type.html#shiftLPositive"><span class="hs-identifier">shiftLPositive</span></a></a><span> </span><a name="local-6989586621679017229"><a href="#local-6989586621679017229"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679017230"><a href="#local-6989586621679017230"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-733"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017230"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-734"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#shiftLPositive"><span class="hs-identifier hs-var">shiftLPositive</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679017229"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017230"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-735"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#smallShiftLPositive"><span class="hs-identifier hs-var">smallShiftLPositive</span></a><span> </span><a href="#local-6989586621679017229"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679017230"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-736"></a><span>
</span><a name="line-737"></a><span class="hs-comment">-- Assumes 0 &lt;= i &lt; WORD_SIZE_IN_BITS#</span><span>
</span><a name="line-738"></a><span class="hs-identifier">smallShiftLPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span>
</span><a name="line-739"></a><a name="smallShiftLPositive"><a href="GHC.Integer.Type.html#smallShiftLPositive"><span class="hs-identifier">smallShiftLPositive</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017231"><a href="#local-6989586621679017231"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017231"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-740"></a><span class="hs-identifier">smallShiftLPositive</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017232"><a href="#local-6989586621679017232"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017233"><a href="#local-6989586621679017233"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-741"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span> </span><span class="hs-operator">-#</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-742"></a><span>    </span><a name="local-6989586621679017234"><a href="#local-6989586621679017234"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679017235"><a href="#local-6989586621679017235"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679017236"><a href="#local-6989586621679017236"><span class="hs-identifier">carry</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017236"><span class="hs-identifier hs-var">carry</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-743"></a><span>                            </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-744"></a><span>                            </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017236"><span class="hs-identifier hs-var">carry</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-745"></a><span>             </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679017237"><a href="#local-6989586621679017237"><span class="hs-identifier">carry</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017238"><a href="#local-6989586621679017238"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679017239"><a href="#local-6989586621679017239"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017238"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#uncheckedShiftRL%23"><span class="hs-identifier hs-var">uncheckedShiftRL</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017234"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-746"></a><span>                                   </span><a name="local-6989586621679017240"><a href="#local-6989586621679017240"><span class="hs-identifier">carry'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-747"></a><span>                                    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017238"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#uncheckedShiftL%23"><span class="hs-identifier hs-var">uncheckedShiftL</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017233"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-748"></a><span>                                    </span><a name="local-6989586621679017241"><a href="#local-6989586621679017241"><span class="hs-identifier">me</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-749"></a><span>                                     </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017241"><span class="hs-identifier hs-var">me</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#or%23"><span class="hs-identifier hs-var">or</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017237"><span class="hs-identifier hs-var">carry</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017235"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679017240"><span class="hs-identifier hs-var">carry'</span></a><span> </span><a href="#local-6989586621679017239"><span class="hs-identifier hs-var">ws</span></a><span class="hs-special">)</span><span>
</span><a name="line-750"></a><span>         </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679017235"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679017232"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-751"></a><span>
</span><a name="line-752"></a><span class="hs-comment">-- Assumes 0 &lt;= i</span><span>
</span><a name="line-753"></a><span class="hs-identifier">shiftRPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-754"></a><a name="shiftRPositive"><a href="GHC.Integer.Type.html#shiftRPositive"><span class="hs-identifier">shiftRPositive</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-755"></a><span class="hs-identifier">shiftRPositive</span><span> </span><a name="local-6989586621679017242"><a href="#local-6989586621679017242"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679017243"><a href="#local-6989586621679017243"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679017244"><a href="#local-6989586621679017244"><span class="hs-identifier">i</span></a></a><span>
</span><a name="line-756"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017244"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#shiftRPositive"><span class="hs-identifier hs-var">shiftRPositive</span></a><span> </span><a href="#local-6989586621679017243"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017244"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#smallShiftRPositive"><span class="hs-identifier hs-var">smallShiftRPositive</span></a><span> </span><a href="#local-6989586621679017242"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679017244"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-759"></a><span>
</span><a name="line-760"></a><span class="hs-comment">-- Assumes 0 &lt;= i &lt; WORD_SIZE_IN_BITS#</span><span>
</span><a name="line-761"></a><span class="hs-identifier">smallShiftRPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span>
</span><a name="line-762"></a><a name="smallShiftRPositive"><a href="GHC.Integer.Type.html#smallShiftRPositive"><span class="hs-identifier">smallShiftRPositive</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017245"><a href="#local-6989586621679017245"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017246"><a href="#local-6989586621679017246"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-763"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017246"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%3D%3D%23"><span class="hs-operator hs-var">==#</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-764"></a><span>    </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017245"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-765"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#smallShiftLPositive"><span class="hs-identifier hs-var">smallShiftLPositive</span></a><span> </span><a href="#local-6989586621679017245"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span> </span><span class="hs-operator">-#</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-766"></a><span>         </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679017247"><a href="#local-6989586621679017247"><span class="hs-identifier">p'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-var">Positive</span></a><span> </span><a href="#local-6989586621679017247"><span class="hs-identifier hs-var">p'</span></a><span>
</span><a name="line-767"></a><span>         </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Naught"><span class="hs-identifier hs-var">Naught</span></a><span>
</span><a name="line-768"></a><span>
</span><a name="line-769"></a><span class="hs-comment">-- Long division</span><span>
</span><a name="line-770"></a><span class="hs-identifier">quotRemPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-771"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017248"><a href="#local-6989586621679017248"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a name="quotRemPositive"><a href="GHC.Integer.Type.html#quotRemPositive"><span class="hs-identifier">quotRemPositive</span></a></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017249"><a href="#local-6989586621679017249"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-772"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017252"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679017248"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-773"></a><span>      </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017269"><a href="#local-6989586621679017269"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017270"><a href="#local-6989586621679017270"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#digitsMaybeZeroToInteger"><span class="hs-identifier hs-var">digitsMaybeZeroToInteger</span></a><span> </span><a href="#local-6989586621679017269"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span>
</span><a name="line-774"></a><span>                       </span><a href="GHC.Integer.Type.html#digitsMaybeZeroToInteger"><span class="hs-identifier hs-var">digitsMaybeZeroToInteger</span></a><span> </span><a href="#local-6989586621679017270"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-775"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-776"></a><span>          </span><span class="hs-identifier">subtractors</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positives"><span class="hs-identifier hs-type">Positives</span></a><span>
</span><a name="line-777"></a><span>          </span><a name="local-6989586621679017250"><a href="#local-6989586621679017250"><span class="hs-identifier">subtractors</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017251"><span class="hs-identifier hs-var">mkSubtractors</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">WORD_SIZE_IN_BITS</span><span class="hs-operator">#</span><span> </span><span class="hs-operator">-#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-778"></a><span>
</span><a name="line-779"></a><span>          </span><a name="local-6989586621679017251"><a href="#local-6989586621679017251"><span class="hs-identifier">mkSubtractors</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017254"><a href="#local-6989586621679017254"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017254"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%3D%3D%23"><span class="hs-operator hs-var">==#</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-780"></a><span>                               </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#Cons"><span class="hs-identifier hs-var">Cons</span></a><span> </span><a href="#local-6989586621679017249"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="GHC.Integer.Type.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>
</span><a name="line-781"></a><span>                               </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Cons"><span class="hs-identifier hs-var">Cons</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017249"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#smallShiftLPositive"><span class="hs-identifier hs-var">smallShiftLPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017254"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-782"></a><span>                                         </span><span class="hs-special">(</span><a href="#local-6989586621679017251"><span class="hs-identifier hs-var">mkSubtractors</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017254"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span>          </span><span class="hs-comment">-- The main function. Go the end of xs, then walk</span><span>
</span><a name="line-785"></a><span>          </span><span class="hs-comment">-- back trying to divide the number we accumulate by ys.</span><span>
</span><a name="line-786"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-787"></a><span>          </span><a name="local-6989586621679017252"><a href="#local-6989586621679017252"><span class="hs-identifier">f</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-788"></a><span>          </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017255"><a href="#local-6989586621679017255"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679017256"><a href="#local-6989586621679017256"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-789"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017252"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679017256"><span class="hs-identifier hs-var">zs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-790"></a><span>                </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017257"><a href="#local-6989586621679017257"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017258"><a href="#local-6989586621679017258"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-791"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- We need to avoid making (Some Zero None) here</span><span>
</span><a name="line-792"></a><span>                        </span><a name="local-6989586621679017259"><a href="#local-6989586621679017259"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#some"><span class="hs-identifier hs-var">some</span></a><span> </span><a href="#local-6989586621679017255"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679017258"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-793"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017253"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span> </span><a href="#local-6989586621679017250"><span class="hs-identifier hs-var">subtractors</span></a><span> </span><a href="#local-6989586621679017259"><span class="hs-identifier hs-var">m'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-794"></a><span>                       </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017260"><a href="#local-6989586621679017260"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017261"><a href="#local-6989586621679017261"><span class="hs-identifier">m''</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-795"></a><span>                        </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#some"><span class="hs-identifier hs-var">some</span></a><span> </span><a href="#local-6989586621679017260"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679017257"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679017261"><span class="hs-identifier hs-var">m''</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-796"></a><span>
</span><a name="line-797"></a><span>          </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Positives"><span class="hs-identifier hs-type">Positives</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-798"></a><span>          </span><a name="local-6989586621679017253"><a href="#local-6989586621679017253"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017262"><a href="#local-6989586621679017262"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><a href="GHC.Integer.Type.html#Nil"><span class="hs-identifier hs-var">Nil</span></a><span>             </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017263"><a href="#local-6989586621679017263"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679017262"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679017263"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>          </span><span class="hs-identifier">g</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017264"><a href="#local-6989586621679017264"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Cons"><span class="hs-identifier hs-var">Cons</span></a><span> </span><a name="local-6989586621679017265"><a href="#local-6989586621679017265"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679017266"><a href="#local-6989586621679017266"><span class="hs-identifier">subs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017267"><a href="#local-6989586621679017267"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-800"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017264"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#uncheckedShiftL%23"><span class="hs-identifier hs-var">uncheckedShiftL</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-801"></a><span>                </span><a name="local-6989586621679017268"><a href="#local-6989586621679017268"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-802"></a><span>                 </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679017267"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#comparePositive"><span class="hs-identifier hs-var">comparePositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017265"><span class="hs-identifier hs-var">sub</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-803"></a><span>                 </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679017253"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679017268"><span class="hs-identifier hs-var">d'</span></a><span> </span><a href="#local-6989586621679017266"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679017267"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-804"></a><span>                 </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679017253"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017268"><span class="hs-identifier hs-var">d'</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusWord%23"><span class="hs-identifier hs-var">plusWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-operator">##</span><span class="hs-special">)</span><span>
</span><a name="line-805"></a><span>                         </span><a href="#local-6989586621679017266"><span class="hs-identifier hs-var">subs</span></a><span>
</span><a name="line-806"></a><span>                         </span><span class="hs-special">(</span><a href="#local-6989586621679017267"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Integer.Type.html#minusPositive"><span class="hs-identifier hs-var">minusPositive</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017265"><span class="hs-identifier hs-var">sub</span></a><span class="hs-special">)</span><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span class="hs-identifier">some</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digit"><span class="hs-identifier hs-type">Digit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-809"></a><a name="some"><a href="GHC.Integer.Type.html#some"><span class="hs-identifier">some</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017271"><a href="#local-6989586621679017271"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017271"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#eqWord%23"><span class="hs-identifier hs-var">eqWord</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">0</span><span class="hs-operator">##</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017271"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-810"></a><span class="hs-identifier">some</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017272"><a href="#local-6989586621679017272"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><a name="local-6989586621679017273"><a href="#local-6989586621679017273"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a href="#local-6989586621679017272"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679017273"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-811"></a><span>
</span><a name="line-812"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-813"></a><span class="hs-identifier">andDigits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-814"></a><a name="andDigits"><a href="GHC.Integer.Type.html#andDigits"><span class="hs-identifier">andDigits</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-815"></a><span class="hs-identifier">andDigits</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-816"></a><span class="hs-identifier">andDigits</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-817"></a><span class="hs-identifier">andDigits</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017274"><a href="#local-6989586621679017274"><span class="hs-identifier">w1</span></a></a><span> </span><a name="local-6989586621679017275"><a href="#local-6989586621679017275"><span class="hs-identifier">ws1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017276"><a href="#local-6989586621679017276"><span class="hs-identifier">w2</span></a></a><span> </span><a name="local-6989586621679017277"><a href="#local-6989586621679017277"><span class="hs-identifier">ws2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017274"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#and%23"><span class="hs-identifier hs-var">and</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017276"><span class="hs-identifier hs-var">w2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#andDigits"><span class="hs-identifier hs-var">andDigits</span></a><span> </span><a href="#local-6989586621679017275"><span class="hs-identifier hs-var">ws1</span></a><span> </span><a href="#local-6989586621679017277"><span class="hs-identifier hs-var">ws2</span></a><span class="hs-special">)</span><span>
</span><a name="line-818"></a><span>
</span><a name="line-819"></a><span class="hs-comment">-- DigitsOnes is just like Digits, only None is really 0xFFFFFFF...,</span><span>
</span><a name="line-820"></a><span class="hs-comment">-- i.e. ones off to infinity. This makes sense when we want to &quot;and&quot;</span><span>
</span><a name="line-821"></a><span class="hs-comment">-- a DigitOnes with a Digits, as the latter will bound the size of the</span><span>
</span><a name="line-822"></a><span class="hs-comment">-- result.</span><span>
</span><a name="line-823"></a><span class="hs-keyword">newtype</span><span> </span><a name="DigitsOnes"><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier">DigitsOnes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="DigitsOnes"><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier">DigitsOnes</span></a></a><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-824"></a><span>
</span><a name="line-825"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-826"></a><span class="hs-identifier">andDigitsOnes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-type">DigitsOnes</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-827"></a><a name="andDigitsOnes"><a href="GHC.Integer.Type.html#andDigitsOnes"><span class="hs-identifier">andDigitsOnes</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-var">DigitsOnes</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span class="hs-special">)</span><span>          </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-828"></a><span class="hs-identifier">andDigitsOnes</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-var">DigitsOnes</span></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span class="hs-special">)</span><span>          </span><a name="local-6989586621679017278"><a href="#local-6989586621679017278"><span class="hs-identifier">ws2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017278"><span class="hs-identifier hs-var">ws2</span></a><span>
</span><a name="line-829"></a><span class="hs-identifier">andDigitsOnes</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-var">DigitsOnes</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-830"></a><span class="hs-identifier">andDigitsOnes</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-var">DigitsOnes</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017279"><a href="#local-6989586621679017279"><span class="hs-identifier">w1</span></a></a><span> </span><a name="local-6989586621679017280"><a href="#local-6989586621679017280"><span class="hs-identifier">ws1</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017281"><a href="#local-6989586621679017281"><span class="hs-identifier">w2</span></a></a><span> </span><a name="local-6989586621679017282"><a href="#local-6989586621679017282"><span class="hs-identifier">ws2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-831"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017279"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#and%23"><span class="hs-identifier hs-var">and</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017281"><span class="hs-identifier hs-var">w2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#andDigitsOnes"><span class="hs-identifier hs-var">andDigitsOnes</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#DigitsOnes"><span class="hs-identifier hs-var">DigitsOnes</span></a><span> </span><a href="#local-6989586621679017280"><span class="hs-identifier hs-var">ws1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679017282"><span class="hs-identifier hs-var">ws2</span></a><span class="hs-special">)</span><span>
</span><a name="line-832"></a><span>
</span><a name="line-833"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-834"></a><span class="hs-identifier">orDigits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-835"></a><a name="orDigits"><a href="GHC.Integer.Type.html#orDigits"><span class="hs-identifier">orDigits</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-836"></a><span class="hs-identifier">orDigits</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><a name="local-6989586621679017283"><a href="#local-6989586621679017283"><span class="hs-identifier">ds</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017283"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-837"></a><span class="hs-identifier">orDigits</span><span> </span><a name="local-6989586621679017284"><a href="#local-6989586621679017284"><span class="hs-identifier">ds</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017284"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-838"></a><span class="hs-identifier">orDigits</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017285"><a href="#local-6989586621679017285"><span class="hs-identifier">w1</span></a></a><span> </span><a name="local-6989586621679017286"><a href="#local-6989586621679017286"><span class="hs-identifier">ds1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017287"><a href="#local-6989586621679017287"><span class="hs-identifier">w2</span></a></a><span> </span><a name="local-6989586621679017288"><a href="#local-6989586621679017288"><span class="hs-identifier">ds2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017285"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#or%23"><span class="hs-identifier hs-var">or</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017287"><span class="hs-identifier hs-var">w2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#orDigits"><span class="hs-identifier hs-var">orDigits</span></a><span> </span><a href="#local-6989586621679017286"><span class="hs-identifier hs-var">ds1</span></a><span> </span><a href="#local-6989586621679017288"><span class="hs-identifier hs-var">ds2</span></a><span class="hs-special">)</span><span>
</span><a name="line-839"></a><span>
</span><a name="line-840"></a><span class="hs-comment">-- Note [Avoid patError]</span><span>
</span><a name="line-841"></a><span class="hs-identifier">xorDigits</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Integer.Type.html#Digits"><span class="hs-identifier hs-type">Digits</span></a><span>
</span><a name="line-842"></a><a name="xorDigits"><a href="GHC.Integer.Type.html#xorDigits"><span class="hs-identifier">xorDigits</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>
</span><a name="line-843"></a><span class="hs-identifier">xorDigits</span><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><a name="local-6989586621679017289"><a href="#local-6989586621679017289"><span class="hs-identifier">ds</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017289"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-844"></a><span class="hs-identifier">xorDigits</span><span> </span><a name="local-6989586621679017290"><a href="#local-6989586621679017290"><span class="hs-identifier">ds</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679017290"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-845"></a><span class="hs-identifier">xorDigits</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017291"><a href="#local-6989586621679017291"><span class="hs-identifier">w1</span></a></a><span> </span><a name="local-6989586621679017292"><a href="#local-6989586621679017292"><span class="hs-identifier">ds1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017293"><a href="#local-6989586621679017293"><span class="hs-identifier">w2</span></a></a><span> </span><a name="local-6989586621679017294"><a href="#local-6989586621679017294"><span class="hs-identifier">ds2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679017291"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#xor%23"><span class="hs-identifier hs-var">xor</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679017293"><span class="hs-identifier hs-var">w2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#xorDigits"><span class="hs-identifier hs-var">xorDigits</span></a><span> </span><a href="#local-6989586621679017292"><span class="hs-identifier hs-var">ds1</span></a><span> </span><a href="#local-6989586621679017294"><span class="hs-identifier hs-var">ds2</span></a><span class="hs-special">)</span><span>
</span><a name="line-846"></a><span>
</span><a name="line-847"></a><span class="hs-comment">-- XXX We'd really like word2Double# for this</span><span>
</span><a name="line-848"></a><span class="hs-identifier">doubleFromPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Double%23"><span class="hs-identifier hs-type">Double</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-849"></a><a name="doubleFromPositive"><a href="GHC.Integer.Type.html#doubleFromPositive"><span class="hs-identifier">doubleFromPositive</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span class="hs-operator">##</span><span>
</span><a name="line-850"></a><span class="hs-identifier">doubleFromPositive</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017295"><a href="#local-6989586621679017295"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679017296"><a href="#local-6989586621679017296"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-851"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#splitHalves"><span class="hs-identifier hs-var">splitHalves</span></a><span> </span><a href="#local-6989586621679017295"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-852"></a><span>      </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017297"><a href="#local-6989586621679017297"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017298"><a href="#local-6989586621679017298"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-853"></a><span>       </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#doubleFromPositive"><span class="hs-identifier hs-var">doubleFromPositive</span></a><span> </span><a href="#local-6989586621679017296"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2A%23%23"><span class="hs-operator hs-var">*##</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">2.0</span><span class="hs-operator">##</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2A%2A%23%23"><span class="hs-operator hs-var">**##</span></a><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS_FLOAT</span><span class="hs-operator">##</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-854"></a><span>       </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23%23"><span class="hs-operator hs-var">+##</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Double%23"><span class="hs-identifier hs-var">int2Double</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679017297"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2A%23%23"><span class="hs-operator hs-var">*##</span></a><span>
</span><a name="line-855"></a><span>              </span><span class="hs-special">(</span><span class="hs-number">2.0</span><span class="hs-operator">##</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2A%2A%23%23"><span class="hs-operator hs-var">**##</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Double%23"><span class="hs-identifier hs-var">int2Double</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#highHalfShift"><span class="hs-identifier hs-var">highHalfShift</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-856"></a><span>       </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23%23"><span class="hs-operator hs-var">+##</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Double%23"><span class="hs-identifier hs-var">int2Double</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679017298"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span class="hs-comment">-- XXX We'd really like word2Float# for this</span><span>
</span><a name="line-859"></a><span class="hs-identifier">floatFromPositive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Integer.Type.html#Positive"><span class="hs-identifier hs-type">Positive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#Float%23"><span class="hs-identifier hs-type">Float</span><span class="hs-operator hs-type">#</span></a><span>
</span><a name="line-860"></a><a name="floatFromPositive"><a href="GHC.Integer.Type.html#floatFromPositive"><span class="hs-identifier">floatFromPositive</span></a></a><span> </span><a href="GHC.Integer.Type.html#None"><span class="hs-identifier hs-var">None</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0.0</span><span class="hs-operator">#</span><span>
</span><a name="line-861"></a><span class="hs-identifier">floatFromPositive</span><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#Some"><span class="hs-identifier hs-var">Some</span></a><span> </span><a name="local-6989586621679017299"><a href="#local-6989586621679017299"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679017300"><a href="#local-6989586621679017300"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-862"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.Integer.Type.html#splitHalves"><span class="hs-identifier hs-var">splitHalves</span></a><span> </span><a href="#local-6989586621679017299"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-863"></a><span>      </span><span class="hs-special">(</span><span class="hs-operator">#</span><span> </span><a name="local-6989586621679017301"><a href="#local-6989586621679017301"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679017302"><a href="#local-6989586621679017302"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-864"></a><span>       </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#floatFromPositive"><span class="hs-identifier hs-var">floatFromPositive</span></a><span> </span><a href="#local-6989586621679017300"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#timesFloat%23"><span class="hs-identifier hs-var">timesFloat</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-number">2.0</span><span class="hs-operator">#</span><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#powerFloat%23"><span class="hs-identifier hs-var">powerFloat</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">WORD_SIZE_IN_BITS_FLOAT</span><span class="hs-operator">#</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>       </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusFloat%23"><span class="hs-identifier hs-var">plusFloat</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Float%23"><span class="hs-identifier hs-var">int2Float</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679017301"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#timesFloat%23"><span class="hs-identifier hs-var">timesFloat</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span>
</span><a name="line-866"></a><span>             </span><span class="hs-special">(</span><span class="hs-number">2.0</span><span class="hs-operator">#</span><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#powerFloat%23"><span class="hs-identifier hs-var">powerFloat</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Float%23"><span class="hs-identifier hs-var">int2Float</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Integer.Type.html#highHalfShift"><span class="hs-identifier hs-var">highHalfShift</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-867"></a><span>       </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#plusFloat%23"><span class="hs-identifier hs-var">plusFloat</span><span class="hs-operator hs-var">#</span></a><span class="hs-special">`</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#int2Float%23"><span class="hs-identifier hs-var">int2Float</span><span class="hs-operator hs-var">#</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int</span><span class="hs-operator hs-var">#</span></a><span> </span><a href="#local-6989586621679017302"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span class="hs-comment">{-
Note [Avoid patError]

If we use the natural set of definitions for functions, e.g.:

    orDigits None          ds            = ds
    orDigits ds            None          = ds
    orDigits (Some w1 ds1) (Some w2 ds2) = Some ... ...

then GHC may not be smart enough (especially when compiling with -O0)
to see that all the cases are handled, and will thus insert calls to
base:Control.Exception.Base.patError. But we are below base in the
package hierarchy, so this causes build failure!

We therefore help GHC out, by being more explicit about what all the
cases are:

    orDigits None          None          = None
    orDigits None          ds@(Some {})  = ds
    orDigits ds@(Some {})  None          = ds
    orDigits (Some w1 ds1) (Some w2 ds2) = Some ... ...
-}</span><span>
</span><a name="line-891"></a><span>
</span><a name="line-892"></a></pre></body></html>