<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
Author: George Karachalias &lt;george.karachalias@cs.kuleuven.be&gt;

Pattern Matching Coverage Checking.
-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE CPP, GADTs, DataKinds, KindSignatures #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Check</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- Checking and printing</span><span>
</span><a name="line-12"></a><span>        </span><a href="Check.html#checkSingle"><span class="hs-identifier hs-var">checkSingle</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#checkMatches"><span class="hs-identifier hs-var">checkMatches</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#checkGuardMatches"><span class="hs-identifier hs-var">checkGuardMatches</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#isAnyPmCheckEnabled"><span class="hs-identifier hs-var">isAnyPmCheckEnabled</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span>        </span><span class="hs-comment">-- See Note [Type and Term Equality Propagation]</span><span>
</span><a name="line-15"></a><span>        </span><a href="Check.html#genCaseTmCs1"><span class="hs-identifier hs-var">genCaseTmCs1</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#genCaseTmCs2"><span class="hs-identifier hs-var">genCaseTmCs2</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>        </span><span class="hs-comment">-- Pattern-match-specific type operations</span><span>
</span><a name="line-18"></a><span>        </span><a href="Check.html#pmIsClosedType"><span class="hs-identifier hs-var">pmIsClosedType</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#pmTopNormaliseType_maybe"><span class="hs-identifier hs-var">pmTopNormaliseType_maybe</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="TmOracle.html"><span class="hs-identifier">TmOracle</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Unify.html"><span class="hs-identifier">Unify</span></a><span class="hs-special">(</span><span> </span><a href="Unify.html#tcMatchTy"><span class="hs-identifier hs-var">tcMatchTy</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="TcHsSyn.html"><span class="hs-identifier">TcHsSyn</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Id.html"><span class="hs-identifier">Id</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="ConLike.html"><span class="hs-identifier">ConLike</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="FamInstEnv.html"><span class="hs-identifier">FamInstEnv</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span> </span><span class="hs-special">(</span><a href="TysPrim.html#tYPETyCon"><span class="hs-identifier hs-var">tYPETyCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span> </span><span class="hs-special">(</span><a href="HscTypes.html#CompleteMatch"><span class="hs-identifier hs-type">CompleteMatch</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="DsMonad.html"><span class="hs-identifier">DsMonad</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="TcSimplify.html"><span class="hs-identifier">TcSimplify</span></a><span>    </span><span class="hs-special">(</span><a href="TcSimplify.html#tcCheckSatisfiability"><span class="hs-identifier hs-var">tcCheckSatisfiability</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="TcType.html"><span class="hs-identifier">TcType</span></a><span>        </span><span class="hs-special">(</span><a href="TcType.html#toTcType"><span class="hs-identifier hs-var">toTcType</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#isIntTy"><span class="hs-identifier hs-var">isIntTy</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#isWordTy"><span class="hs-identifier hs-var">isWordTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><a href="Bag.html"><span class="hs-identifier">Bag</span></a><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span> </span><a href="ErrUtils.html"><span class="hs-identifier">ErrUtils</span></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>           </span><span class="hs-special">(</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSupply.html"><span class="hs-identifier">UniqSupply</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="DsGRHSs.html"><span class="hs-identifier">DsGRHSs</span></a><span>       </span><span class="hs-special">(</span><a href="DsGRHSs.html#isTrueLHsExpr"><span class="hs-identifier hs-var">isTrueLHsExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>        </span><span class="hs-special">(</span><a href="Maybes.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>     </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span></a><span>    </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#zipWithM"><span class="hs-identifier hs-var">zipWithM</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><a href="TcEvidence.html"><span class="hs-identifier">TcEvidence</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="IOEnv.html"><span class="hs-identifier">IOEnv</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Semigroup.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Semi</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="ListT.html"><span class="hs-identifier">ListT</span></a><span> </span><span class="hs-special">(</span><a href="ListT.html#ListT"><span class="hs-identifier hs-type">ListT</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="ListT.html#fold"><span class="hs-identifier hs-var">fold</span></a><span class="hs-special">,</span><span> </span><a href="ListT.html#select"><span class="hs-identifier hs-var">select</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">{-
This module checks pattern matches for:
\begin{enumerate}
  \item Equations that are redundant
  \item Equations with inaccessible right-hand-side
  \item Exhaustiveness
\end{enumerate}

The algorithm is based on the paper:

  &quot;GADTs Meet Their Match:
     Pattern-matching Warnings That Account for GADTs, Guards, and Laziness&quot;

    http://people.cs.kuleuven.be/~george.karachalias/papers/p424-karachalias.pdf

%************************************************************************
%*                                                                      *
                     Pattern Match Check Types
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- We use the non-determinism monad to apply the algorithm to several</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- possible sets of constructors. Users can specify complete sets of</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- constructors by using COMPLETE pragmas.</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- The algorithm only picks out constructor</span><span>
</span><a name="line-93"></a><span class="hs-comment">-- sets deep in the bowels which makes a simpler `mapM` more difficult to</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- implement. The non-determinism is only used in one place, see the ConVar</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- case in `pmCheckHd`.</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-keyword">type</span><span> </span><a name="PmM"><a href="Check.html#PmM"><span class="hs-identifier">PmM</span></a></a><span> </span><a name="local-6989586621680278509"><a href="#local-6989586621680278509"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListT.html#ListT"><span class="hs-identifier hs-type">ListT</span></a><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="#local-6989586621680278509"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-identifier">liftD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="#local-6989586621680278533"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="#local-6989586621680278533"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-100"></a><a name="liftD"><a href="Check.html#liftD"><span class="hs-identifier">liftD</span></a></a><span> </span><a name="local-6989586621680278534"><a href="#local-6989586621680278534"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ListT.html#ListT"><span class="hs-identifier hs-var">ListT</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680278535"><a href="#local-6989586621680278535"><span class="hs-identifier">sk</span></a></a><span> </span><a name="local-6989586621680278536"><a href="#local-6989586621680278536"><span class="hs-identifier">fk</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278534"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680278537"><a href="#local-6989586621680278537"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278535"><span class="hs-identifier hs-var">sk</span></a><span> </span><a href="#local-6989586621680278537"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621680278536"><span class="hs-identifier hs-var">fk</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-comment">-- Pick the first match complete covered match or otherwise the &quot;best&quot; match.</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- The best match is the one with the least uncovered clauses, ties broken</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- by the number of inaccessible clauses followed by number of redundant</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- clauses.</span><span>
</span><a name="line-106"></a><span class="hs-comment">--</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- This is specified in the</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- &quot;Disambiguating between multiple ``COMPLETE`` pragmas&quot; section of the</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- users' guide. If you update the implementation of this function, make sure</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- to update that section of the users' guide as well.</span><span>
</span><a name="line-111"></a><span class="hs-identifier">getResult</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span>
</span><a name="line-112"></a><a name="getResult"><a href="Check.html#getResult"><span class="hs-identifier">getResult</span></a></a><span> </span><a name="local-6989586621680278538"><a href="#local-6989586621680278538"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-113"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680278556"><a href="#local-6989586621680278556"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="ListT.html#fold"><span class="hs-identifier hs-var">fold</span></a><span> </span><a href="#local-6989586621680278538"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621680278539"><span class="hs-identifier hs-var">goM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278556"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-115"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;getResult is empty&quot;</span><span>
</span><a name="line-116"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278557"><a href="#local-6989586621680278557"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680278557"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-identifier">goM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>    </span><a name="local-6989586621680278539"><a href="#local-6989586621680278539"><span class="hs-identifier">goM</span></a></a><span> </span><a name="local-6989586621680278541"><a href="#local-6989586621680278541"><span class="hs-identifier">mpm</span></a></a><span> </span><a name="local-6989586621680278542"><a href="#local-6989586621680278542"><span class="hs-identifier">dpm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680278543"><a href="#local-6989586621680278543"><span class="hs-identifier">pmr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278542"><span class="hs-identifier hs-var">dpm</span></a><span>
</span><a name="line-120"></a><span>                     </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621680278540"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680278543"><span class="hs-identifier hs-var">pmr</span></a><span> </span><a href="#local-6989586621680278541"><span class="hs-identifier hs-var">mpm</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-comment">-- Careful not to force unecessary results</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span>
</span><a name="line-124"></a><span>    </span><a name="local-6989586621680278540"><a href="#local-6989586621680278540"><span class="hs-identifier">go</span></a></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a name="local-6989586621680278544"><a href="#local-6989586621680278544"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278544"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278545"><a href="#local-6989586621680278545"><span class="hs-identifier">old</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a name="local-6989586621680278546"><a href="#local-6989586621680278546"><span class="hs-identifier">prov</span></a></a><span> </span><a name="local-6989586621680278547"><a href="#local-6989586621680278547"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><a name="local-6989586621680278548"><a href="#local-6989586621680278548"><span class="hs-identifier">us</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278549"><a href="#local-6989586621680278549"><span class="hs-identifier">is</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680278550"><a href="#local-6989586621680278550"><span class="hs-identifier">new</span></a></a><span>
</span><a name="line-126"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278548"><span class="hs-identifier hs-var">us</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278547"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278549"><span class="hs-identifier hs-var">is</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278545"><span class="hs-identifier hs-var">old</span></a><span>
</span><a name="line-127"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-128"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a name="local-6989586621680278551"><a href="#local-6989586621680278551"><span class="hs-identifier">prov'</span></a></a><span> </span><a name="local-6989586621680278552"><a href="#local-6989586621680278552"><span class="hs-identifier">rs'</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><a name="local-6989586621680278553"><a href="#local-6989586621680278553"><span class="hs-identifier">us'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278554"><a href="#local-6989586621680278554"><span class="hs-identifier">is'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278550"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-129"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Util.html#compareLength"><span class="hs-identifier hs-var">compareLength</span></a><span> </span><a href="#local-6989586621680278548"><span class="hs-identifier hs-var">us</span></a><span> </span><a href="#local-6989586621680278553"><span class="hs-identifier hs-var">us'</span></a><span>
</span><a name="line-130"></a><span>                </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Util.html#compareLength"><span class="hs-identifier hs-var">compareLength</span></a><span> </span><a href="#local-6989586621680278549"><span class="hs-identifier hs-var">is</span></a><span> </span><a href="#local-6989586621680278554"><span class="hs-identifier hs-var">is'</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>                </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Util.html#compareLength"><span class="hs-identifier hs-var">compareLength</span></a><span> </span><a href="#local-6989586621680278547"><span class="hs-identifier hs-var">rs</span></a><span> </span><a href="#local-6989586621680278552"><span class="hs-identifier hs-var">rs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>                </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621680278546"><span class="hs-identifier hs-var">prov</span></a><span> </span><a href="#local-6989586621680278551"><span class="hs-identifier hs-var">prov'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-133"></a><span>              </span><span class="hs-identifier hs-var">GT</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278550"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-134"></a><span>              </span><span class="hs-identifier hs-var">EQ</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278550"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-135"></a><span>              </span><span class="hs-identifier hs-var">LT</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278545"><span class="hs-identifier hs-var">old</span></a><span>
</span><a name="line-136"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Check.html#TypeOfUncovered"><span class="hs-identifier hs-var">TypeOfUncovered</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680278555"><a href="#local-6989586621680278555"><span class="hs-identifier">_new</span></a></a><span>
</span><a name="line-137"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;getResult: No inhabitation candidates&quot;</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-keyword">data</span><span> </span><a name="PatTy"><a href="Check.html#PatTy"><span class="hs-identifier">PatTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PAT"><a href="Check.html#PAT"><span class="hs-identifier">PAT</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="VA"><a href="Check.html#VA"><span class="hs-identifier">VA</span></a></a><span> </span><span class="hs-comment">-- Used only as a kind, to index PmPat</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- The *arity* of a PatVec [p1,..,pn] is</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- the number of p1..pn that are not Guards</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-keyword">data</span><span> </span><a name="PmPat"><a href="Check.html#PmPat"><span class="hs-identifier">PmPat</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatTy"><span class="hs-identifier hs-type">PatTy</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator hs-type">*</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>  </span><a name="PmCon"><a href="Check.html#PmCon"><span class="hs-identifier">PmCon</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><a name="pm_con_con"><a href="Check.html#pm_con_con"><span class="hs-identifier">pm_con_con</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span>
</span><a name="line-146"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="pm_con_arg_tys"><a href="Check.html#pm_con_arg_tys"><span class="hs-identifier">pm_con_arg_tys</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-147"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="pm_con_tvs"><a href="Check.html#pm_con_tvs"><span class="hs-identifier">pm_con_tvs</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-148"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="pm_con_dicts"><a href="Check.html#pm_con_dicts"><span class="hs-identifier">pm_con_dicts</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="pm_con_args"><a href="Check.html#pm_con_args"><span class="hs-identifier">pm_con_args</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><a href="#local-6989586621680278506"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><a href="#local-6989586621680278506"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-150"></a><span>            </span><span class="hs-comment">-- For PmCon arguments' meaning see @ConPatOut@ in hsSyn/HsPat.hs</span><span>
</span><a name="line-151"></a><span>  </span><a name="PmVar"><a href="Check.html#PmVar"><span class="hs-identifier">PmVar</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><a name="pm_var_id"><a href="Check.html#pm_var_id"><span class="hs-identifier">pm_var_id</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><a href="#local-6989586621680278507"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-152"></a><span>  </span><a name="PmLit"><a href="Check.html#PmLit"><span class="hs-identifier">PmLit</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><a name="pm_lit_lit"><a href="Check.html#pm_lit_lit"><span class="hs-identifier">pm_lit_lit</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="PmExpr.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><a href="#local-6989586621680278508"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-comment">-- See Note [Literals in PmPat]</span><span>
</span><a name="line-153"></a><span>  </span><a name="PmNLit"><a href="Check.html#PmNLit"><span class="hs-identifier">PmNLit</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><a name="pm_lit_id"><a href="Check.html#pm_lit_id"><span class="hs-identifier">pm_lit_id</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-154"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="pm_lit_not"><a href="Check.html#pm_lit_not"><span class="hs-identifier">pm_lit_not</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="PmExpr.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><span class="hs-special">'</span><a href="Check.html#VA"><span class="hs-identifier hs-type">VA</span></a><span>
</span><a name="line-155"></a><span>  </span><a name="PmGrd"><a href="Check.html#PmGrd"><span class="hs-identifier">PmGrd</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><a name="pm_grd_pv"><a href="Check.html#pm_grd_pv"><span class="hs-identifier">pm_grd_pv</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-156"></a><span>            </span><span class="hs-special">,</span><span> </span><a name="pm_grd_expr"><a href="Check.html#pm_grd_expr"><span class="hs-identifier">pm_grd_expr</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="PmExpr.html#PmExpr"><span class="hs-identifier hs-type">PmExpr</span></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><span class="hs-special">'</span><a href="Check.html#PAT"><span class="hs-identifier hs-type">PAT</span></a><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- data T a where</span><span>
</span><a name="line-159"></a><span class="hs-comment">--     MkT :: forall p q. (Eq p, Ord q) =&gt; p -&gt; q -&gt; T [p]</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- or  MkT :: forall p q r. (Eq p, Ord q, [p] ~ r) =&gt; p -&gt; q -&gt; T r</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-keyword">type</span><span> </span><a name="Pattern"><a href="Check.html#Pattern"><span class="hs-identifier">Pattern</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><span class="hs-special">'</span><a href="Check.html#PAT"><span class="hs-identifier hs-type">PAT</span></a><span> </span><span class="hs-comment">-- ^ Patterns</span><span>
</span><a name="line-163"></a><span class="hs-keyword">type</span><span> </span><a name="ValAbs"><a href="Check.html#ValAbs"><span class="hs-identifier">ValAbs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><span class="hs-special">'</span><a href="Check.html#VA"><span class="hs-identifier hs-type">VA</span></a><span>  </span><span class="hs-comment">-- ^ Value Abstractions</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-keyword">type</span><span> </span><a name="PatVec"><a href="Check.html#PatVec"><span class="hs-identifier">PatVec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ Pattern Vectors</span><span>
</span><a name="line-166"></a><span class="hs-keyword">data</span><span> </span><a name="ValVec"><a href="Check.html#ValVec"><span class="hs-identifier">ValVec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ValVec"><a href="Check.html#ValVec"><span class="hs-identifier">ValVec</span></a></a><span> </span><span class="hs-special">[</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">]</span><span> </span><a href="Check.html#Delta"><span class="hs-identifier hs-type">Delta</span></a><span> </span><span class="hs-comment">-- ^ Value Vector Abstractions</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">-- | Term and type constraints to accompany each value vector abstraction.</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- For efficiency, we store the term oracle state instead of the term</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- constraints. TODO: Do the same for the type constraints?</span><span>
</span><a name="line-171"></a><span class="hs-keyword">data</span><span> </span><a name="Delta"><a href="Check.html#Delta"><span class="hs-identifier">Delta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MkDelta"><a href="Check.html#MkDelta"><span class="hs-identifier">MkDelta</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="delta_ty_cs"><a href="Check.html#delta_ty_cs"><span class="hs-identifier">delta_ty_cs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-172"></a><span>                     </span><span class="hs-special">,</span><span> </span><a name="delta_tm_cs"><a href="Check.html#delta_tm_cs"><span class="hs-identifier">delta_tm_cs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TmOracle.html#TmState"><span class="hs-identifier hs-type">TmState</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-keyword">type</span><span> </span><a name="ValSetAbs"><a href="Check.html#ValSetAbs"><span class="hs-identifier">ValSetAbs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Value Set Abstractions</span><span>
</span><a name="line-175"></a><span class="hs-keyword">type</span><span> </span><a name="Uncovered"><a href="Check.html#Uncovered"><span class="hs-identifier">Uncovered</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#ValSetAbs"><span class="hs-identifier hs-type">ValSetAbs</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- Instead of keeping the whole sets in memory, we keep a boolean for both the</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- covered and the divergent set (we store the uncovered set though, since we</span><span>
</span><a name="line-179"></a><span class="hs-comment">-- want to print it). For both the covered and the divergent we have:</span><span>
</span><a name="line-180"></a><span class="hs-comment">--</span><span>
</span><a name="line-181"></a><span class="hs-comment">--   True &lt;=&gt; The set is non-empty</span><span>
</span><a name="line-182"></a><span class="hs-comment">--</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- hence:</span><span>
</span><a name="line-184"></a><span class="hs-comment">--  C = True             ==&gt; Useful clause (no warning)</span><span>
</span><a name="line-185"></a><span class="hs-comment">--  C = False, D = True  ==&gt; Clause with inaccessible RHS</span><span>
</span><a name="line-186"></a><span class="hs-comment">--  C = False, D = False ==&gt; Redundant clause</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-keyword">data</span><span> </span><a name="Covered"><a href="Check.html#Covered"><span class="hs-identifier">Covered</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Covered"><a href="Check.html#Covered"><span class="hs-identifier">Covered</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NotCovered"><a href="Check.html#NotCovered"><span class="hs-identifier">NotCovered</span></a></a><span>
</span><a name="line-189"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-type">Covered</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-192"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Covered&quot;</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NotCovered&quot;</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- Like the or monoid for booleans</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- Covered = True, Uncovered = False</span><span>
</span><a name="line-197"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semi</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Semigroup</span></a><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-type">Covered</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-198"></a><span>  </span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span> </span><a name="local-3458764513820541482"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-operator">&lt;&gt;</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span>
</span><a name="line-199"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span>
</span><a name="line-200"></a><span>  </span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-type">Covered</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-203"></a><span>  </span><a name="local-3458764513820541483"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier">mempty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span>
</span><a name="line-204"></a><span>  </span><a name="local-3458764513820541484"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier">mappend</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-keyword">data</span><span> </span><a name="Diverged"><a href="Check.html#Diverged"><span class="hs-identifier">Diverged</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Diverged"><a href="Check.html#Diverged"><span class="hs-identifier">Diverged</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NotDiverged"><a href="Check.html#NotDiverged"><span class="hs-identifier">NotDiverged</span></a></a><span>
</span><a name="line-207"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-type">Diverged</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-210"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Diverged&quot;</span><span>
</span><a name="line-211"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="Check.html#NotDiverged"><span class="hs-identifier hs-var">NotDiverged</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;NotDiverged&quot;</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semi</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Semigroup</span></a><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-type">Diverged</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-214"></a><span>  </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span> </span><a name="local-3458764513820541482"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-operator">&lt;&gt;</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span>
</span><a name="line-215"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span>
</span><a name="line-216"></a><span>  </span><a href="Check.html#NotDiverged"><span class="hs-identifier hs-var">NotDiverged</span></a><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a href="Check.html#NotDiverged"><span class="hs-identifier hs-var">NotDiverged</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#NotDiverged"><span class="hs-identifier hs-var">NotDiverged</span></a><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-type">Diverged</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-219"></a><span>  </span><a name="local-3458764513820541483"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier">mempty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#NotDiverged"><span class="hs-identifier hs-var">NotDiverged</span></a><span>
</span><a name="line-220"></a><span>  </span><a name="local-3458764513820541484"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier">mappend</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- | When we learned that a given match group is complete</span><span>
</span><a name="line-223"></a><span class="hs-keyword">data</span><span> </span><a name="Provenance"><a href="Check.html#Provenance"><span class="hs-identifier">Provenance</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-224"></a><span>                  </span><a name="FromBuiltin"><a href="Check.html#FromBuiltin"><span class="hs-identifier">FromBuiltin</span></a></a><span> </span><span class="hs-comment">-- ^  From the original definition of the type</span><span>
</span><a name="line-225"></a><span>                              </span><span class="hs-comment">--    constructor.</span><span>
</span><a name="line-226"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="FromComplete"><a href="Check.html#FromComplete"><span class="hs-identifier">FromComplete</span></a></a><span> </span><span class="hs-comment">-- ^ From a user-provided @COMPLETE@ pragma</span><span>
</span><a name="line-227"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-230"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semi</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Semigroup</span></a><span> </span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-233"></a><span>  </span><a href="Check.html#FromComplete"><span class="hs-identifier hs-var">FromComplete</span></a><span> </span><a name="local-3458764513820541482"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-operator">&lt;&gt;</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#FromComplete"><span class="hs-identifier hs-var">FromComplete</span></a><span>
</span><a name="line-234"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><a href="Check.html#FromComplete"><span class="hs-identifier hs-var">FromComplete</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#FromComplete"><span class="hs-identifier hs-var">FromComplete</span></a><span>
</span><a name="line-235"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span> </span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-238"></a><span>  </span><a name="local-3458764513820541483"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier">mempty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a><span>
</span><a name="line-239"></a><span>  </span><a name="local-3458764513820541484"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier">mappend</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-keyword">data</span><span> </span><a name="PartialResult"><a href="Check.html#PartialResult"><span class="hs-identifier">PartialResult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="PartialResult"><a href="Check.html#PartialResult"><span class="hs-identifier">PartialResult</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-242"></a><span>                        </span><a name="presultProvenance"><a href="Check.html#presultProvenance"><span class="hs-identifier">presultProvenance</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span>
</span><a name="line-243"></a><span>                         </span><span class="hs-comment">-- keep track of provenance because we don't want</span><span>
</span><a name="line-244"></a><span>                         </span><span class="hs-comment">-- to warn about redundant matches if the result</span><span>
</span><a name="line-245"></a><span>                         </span><span class="hs-comment">-- is contaminated with a COMPLETE pragma</span><span>
</span><a name="line-246"></a><span>                      </span><span class="hs-special">,</span><span> </span><a name="presultCovered"><a href="Check.html#presultCovered"><span class="hs-identifier">presultCovered</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-type">Covered</span></a><span>
</span><a name="line-247"></a><span>                      </span><span class="hs-special">,</span><span> </span><a name="presultUncovered"><a href="Check.html#presultUncovered"><span class="hs-identifier">presultUncovered</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Uncovered"><span class="hs-identifier hs-type">Uncovered</span></a><span>
</span><a name="line-248"></a><span>                      </span><span class="hs-special">,</span><span> </span><a name="presultDivergent"><a href="Check.html#presultDivergent"><span class="hs-identifier">presultDivergent</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-type">Diverged</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-251"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a name="local-6989586621680278523"><a href="#local-6989586621680278523"><span class="hs-identifier">prov</span></a></a><span> </span><a name="local-6989586621680278524"><a href="#local-6989586621680278524"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621680278525"><a href="#local-6989586621680278525"><span class="hs-identifier">vsa</span></a></a><span> </span><a name="local-6989586621680278526"><a href="#local-6989586621680278526"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PartialResult&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278523"><span class="hs-identifier hs-var">prov</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278524"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-253"></a><span>                                  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278526"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278525"><span class="hs-identifier hs-var">vsa</span></a><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span>
</span><a name="line-256"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semi</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Semigroup</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-257"></a><span>  </span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a name="local-6989586621680278515"><a href="#local-6989586621680278515"><span class="hs-identifier">prov1</span></a></a><span> </span><a name="local-6989586621680278516"><a href="#local-6989586621680278516"><span class="hs-identifier">cs1</span></a></a><span> </span><a name="local-6989586621680278517"><a href="#local-6989586621680278517"><span class="hs-identifier">vsa1</span></a></a><span> </span><a name="local-6989586621680278518"><a href="#local-6989586621680278518"><span class="hs-identifier">ds1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>    </span><a name="local-3458764513820541482"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-operator">&lt;&gt;</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a name="local-6989586621680278519"><a href="#local-6989586621680278519"><span class="hs-identifier">prov2</span></a></a><span> </span><a name="local-6989586621680278520"><a href="#local-6989586621680278520"><span class="hs-identifier">cs2</span></a></a><span> </span><a name="local-6989586621680278521"><a href="#local-6989586621680278521"><span class="hs-identifier">vsa2</span></a></a><span> </span><a name="local-6989586621680278522"><a href="#local-6989586621680278522"><span class="hs-identifier">ds2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-259"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278515"><span class="hs-identifier hs-var">prov1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span> </span><a href="#local-6989586621680278519"><span class="hs-identifier hs-var">prov2</span></a><span class="hs-special">)</span><span>
</span><a name="line-260"></a><span>                      </span><span class="hs-special">(</span><a href="#local-6989586621680278516"><span class="hs-identifier hs-var">cs1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span> </span><a href="#local-6989586621680278520"><span class="hs-identifier hs-var">cs2</span></a><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>                      </span><span class="hs-special">(</span><a href="#local-6989586621680278517"><span class="hs-identifier hs-var">vsa1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span> </span><a href="#local-6989586621680278521"><span class="hs-identifier hs-var">vsa2</span></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>                      </span><span class="hs-special">(</span><a href="#local-6989586621680278518"><span class="hs-identifier hs-var">ds1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span> </span><a href="#local-6989586621680278522"><span class="hs-identifier hs-var">ds2</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-266"></a><span>  </span><a name="local-3458764513820541483"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier">mempty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-267"></a><span>  </span><a name="local-3458764513820541484"><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier">mappend</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%3E"><span class="hs-identifier hs-var">Semi</span><span class="hs-operator hs-var">.&lt;&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-comment">-- newtype ChoiceOf a = ChoiceOf [a]</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">-- | Pattern check result</span><span>
</span><a name="line-272"></a><span class="hs-comment">--</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- * Redundant clauses</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- * Not-covered clauses (or their type, if no pattern is available)</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- * Clauses with inaccessible RHS</span><span>
</span><a name="line-276"></a><span class="hs-comment">--</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- More details about the classification of clauses into useful, redundant</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- and with inaccessible right hand side can be found here:</span><span>
</span><a name="line-279"></a><span class="hs-comment">--</span><span>
</span><a name="line-280"></a><span class="hs-comment">--     https://ghc.haskell.org/trac/ghc/wiki/PatternMatchCheck</span><span>
</span><a name="line-281"></a><span class="hs-comment">--</span><span>
</span><a name="line-282"></a><span class="hs-keyword">data</span><span> </span><a name="PmResult"><a href="Check.html#PmResult"><span class="hs-identifier">PmResult</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-283"></a><span>  </span><a name="PmResult"><a href="Check.html#PmResult"><span class="hs-identifier">PmResult</span></a></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-284"></a><span>      </span><a name="pmresultProvenance"><a href="Check.html#pmresultProvenance"><span class="hs-identifier">pmresultProvenance</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span>
</span><a name="line-285"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="pmresultRedundant"><a href="Check.html#pmresultRedundant"><span class="hs-identifier">pmresultRedundant</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-286"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="pmresultUncovered"><a href="Check.html#pmresultUncovered"><span class="hs-identifier">pmresultUncovered</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#UncoveredCandidates"><span class="hs-identifier hs-type">UncoveredCandidates</span></a><span>
</span><a name="line-287"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="pmresultInaccessible"><a href="Check.html#pmresultInaccessible"><span class="hs-identifier">pmresultInaccessible</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-comment">-- | Either a list of patterns that are not covered, or their type, in case we</span><span>
</span><a name="line-290"></a><span class="hs-comment">-- have no patterns at hand. Not having patterns at hand can arise when</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- handling EmptyCase expressions, in two cases:</span><span>
</span><a name="line-292"></a><span class="hs-comment">--</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- * The type of the scrutinee is a trivially inhabited type (like Int or Char)</span><span>
</span><a name="line-294"></a><span class="hs-comment">-- * The type of the scrutinee cannot be reduced to WHNF.</span><span>
</span><a name="line-295"></a><span class="hs-comment">--</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- In both these cases we have no inhabitation candidates for the type at hand,</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- but we don't want to issue just a wildcard as missing. Instead, we print a</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- type annotated wildcard, so that the user knows what kind of patterns is</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- expected (e.g. (_ :: Int), or (_ :: F Int), where F Int does not reduce).</span><span>
</span><a name="line-300"></a><span class="hs-keyword">data</span><span> </span><a name="UncoveredCandidates"><a href="Check.html#UncoveredCandidates"><span class="hs-identifier">UncoveredCandidates</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UncoveredPatterns"><a href="Check.html#UncoveredPatterns"><span class="hs-identifier">UncoveredPatterns</span></a></a><span> </span><a href="Check.html#Uncovered"><span class="hs-identifier hs-type">Uncovered</span></a><span>
</span><a name="line-301"></a><span>                         </span><span class="hs-glyph">|</span><span> </span><a name="TypeOfUncovered"><a href="Check.html#TypeOfUncovered"><span class="hs-identifier">TypeOfUncovered</span></a></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-comment">-- | The empty pattern check result</span><span>
</span><a name="line-304"></a><span class="hs-identifier">emptyPmResult</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span>
</span><a name="line-305"></a><a name="emptyPmResult"><a href="Check.html#emptyPmResult"><span class="hs-identifier">emptyPmResult</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a href="Check.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-comment">-- | Non-exhaustive empty case with unknown/trivial inhabitants</span><span>
</span><a name="line-308"></a><span class="hs-identifier">uncoveredWithTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span>
</span><a name="line-309"></a><a name="uncoveredWithTy"><a href="Check.html#uncoveredWithTy"><span class="hs-identifier">uncoveredWithTy</span></a></a><span> </span><a name="local-6989586621680278558"><a href="#local-6989586621680278558"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a href="Check.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Check.html#TypeOfUncovered"><span class="hs-identifier hs-var">TypeOfUncovered</span></a><span> </span><a href="#local-6989586621680278558"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
       Entry points to the checker: checkSingle and checkMatches
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">-- | Check a single pattern binding (let)</span><span>
</span><a name="line-320"></a><span class="hs-identifier">checkSingle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-type">DsMatchContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-321"></a><a name="checkSingle"><a href="Check.html#checkSingle"><span class="hs-identifier">checkSingle</span></a></a><span> </span><a name="local-6989586621680278559"><a href="#local-6989586621680278559"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680278560"><a href="#local-6989586621680278560"><span class="hs-identifier">ctxt</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-var">DsMatchContext</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278561"><a href="#local-6989586621680278561"><span class="hs-identifier">locn</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278562"><a href="#local-6989586621680278562"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621680278563"><a href="#local-6989586621680278563"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-322"></a><span>  </span><a href="Check.html#tracePmD"><span class="hs-identifier hs-var">tracePmD</span></a><span> </span><span class="hs-string">&quot;checkSingle&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278560"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278562"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278563"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-323"></a><span>  </span><a name="local-6989586621680278564"><a href="#local-6989586621680278564"><span class="hs-identifier">mb_pm_res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#tryM"><span class="hs-identifier hs-var">tryM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#getResult"><span class="hs-identifier hs-var">getResult</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#checkSingle%27"><span class="hs-identifier hs-var">checkSingle'</span></a><span> </span><a href="#local-6989586621680278561"><span class="hs-identifier hs-var">locn</span></a><span> </span><a href="#local-6989586621680278562"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621680278563"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-324"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278564"><span class="hs-identifier hs-var">mb_pm_res</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-325"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span>  </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#warnPmIters"><span class="hs-identifier hs-var">warnPmIters</span></a><span> </span><a href="#local-6989586621680278559"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680278560"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-326"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621680278565"><a href="#local-6989586621680278565"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#dsPmWarn"><span class="hs-identifier hs-var">dsPmWarn</span></a><span> </span><a href="#local-6989586621680278559"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680278560"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621680278565"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- | Check a single pattern binding (let)</span><span>
</span><a name="line-329"></a><span class="hs-identifier">checkSingle'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span>
</span><a name="line-330"></a><a name="checkSingle%27"><a href="Check.html#checkSingle%27"><span class="hs-identifier">checkSingle'</span></a></a><span> </span><a name="local-6989586621680278566"><a href="#local-6989586621680278566"><span class="hs-identifier">locn</span></a></a><span> </span><a name="local-6989586621680278567"><a href="#local-6989586621680278567"><span class="hs-identifier">var</span></a></a><span> </span><a name="local-6989586621680278568"><a href="#local-6989586621680278568"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-331"></a><span>  </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#resetPmIterDs"><span class="hs-identifier hs-var">resetPmIterDs</span></a><span> </span><span class="hs-comment">-- set the iter-no to zero</span><span>
</span><a name="line-332"></a><span>  </span><a name="local-6989586621680278570"><a href="#local-6989586621680278570"><span class="hs-identifier">fam_insts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-var">dsGetFamInstEnvs</span></a><span>
</span><a name="line-333"></a><span>  </span><a name="local-6989586621680278571"><a href="#local-6989586621680278571"><span class="hs-identifier">clause</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278570"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278568"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-334"></a><span>  </span><a name="local-6989586621680278572"><a href="#local-6989586621680278572"><span class="hs-identifier">missing</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkInitialUncovered"><span class="hs-identifier hs-var">mkInitialUncovered</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278567"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">]</span><span>
</span><a name="line-335"></a><span>  </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;checkSingle: missing&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprValVecDebug"><span class="hs-identifier hs-var">pprValVecDebug</span></a><span> </span><a href="#local-6989586621680278572"><span class="hs-identifier hs-var">missing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-336"></a><span>                                 </span><span class="hs-comment">-- no guards</span><span>
</span><a name="line-337"></a><span>  </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a name="local-6989586621680278573"><a href="#local-6989586621680278573"><span class="hs-identifier">prov</span></a></a><span> </span><a name="local-6989586621680278574"><a href="#local-6989586621680278574"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621680278575"><a href="#local-6989586621680278575"><span class="hs-identifier">us</span></a></a><span> </span><a name="local-6989586621680278576"><a href="#local-6989586621680278576"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#runMany"><span class="hs-identifier hs-var">runMany</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><a href="#local-6989586621680278571"><span class="hs-identifier hs-var">clause</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278572"><span class="hs-identifier hs-var">missing</span></a><span>
</span><a name="line-338"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278577"><a href="#local-6989586621680278577"><span class="hs-identifier">us'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><a href="#local-6989586621680278575"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-339"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278574"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><a href="#local-6989586621680278576"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-340"></a><span>    </span><span class="hs-special">(</span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">_</span><span>    </span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a href="#local-6989586621680278573"><span class="hs-identifier hs-var">prov</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621680278577"><span class="hs-identifier hs-var">us'</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- useful</span><span>
</span><a name="line-341"></a><span>    </span><span class="hs-special">(</span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#NotDiverged"><span class="hs-identifier hs-var">NotDiverged</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a href="#local-6989586621680278573"><span class="hs-identifier hs-var">prov</span></a><span> </span><a href="#local-6989586621680278569"><span class="hs-identifier hs-var">m</span></a><span>  </span><a href="#local-6989586621680278577"><span class="hs-identifier hs-var">us'</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- redundant</span><span>
</span><a name="line-342"></a><span>    </span><span class="hs-special">(</span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a href="#local-6989586621680278573"><span class="hs-identifier hs-var">prov</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621680278577"><span class="hs-identifier hs-var">us'</span></a><span> </span><a href="#local-6989586621680278569"><span class="hs-identifier hs-var">m</span></a><span>  </span><span class="hs-comment">-- inaccessible rhs</span><span>
</span><a name="line-343"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621680278569"><a href="#local-6989586621680278569"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680278566"><span class="hs-identifier hs-var">locn</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680278566"><span class="hs-identifier hs-var">locn</span></a><span> </span><a href="#local-6989586621680278568"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-comment">-- | Exhaustive for guard matches, is used for guards in pattern bindings and</span><span>
</span><a name="line-346"></a><span class="hs-comment">-- in @MultiIf@ expressions.</span><span>
</span><a name="line-347"></a><span class="hs-identifier">checkGuardMatches</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>          </span><span class="hs-comment">-- Match context</span><span>
</span><a name="line-348"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-type">GRHSs</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Guarded RHSs</span><span>
</span><a name="line-349"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-350"></a><a name="checkGuardMatches"><a href="Check.html#checkGuardMatches"><span class="hs-identifier">checkGuardMatches</span></a></a><span> </span><a name="local-6989586621680278578"><a href="#local-6989586621680278578"><span class="hs-identifier">hs_ctx</span></a></a><span> </span><a name="local-6989586621680278579"><a href="#local-6989586621680278579"><span class="hs-identifier">guards</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsExpr.html#GRHSs"><span class="hs-identifier hs-var">GRHSs</span></a><span> </span><a name="local-6989586621680278580"><a href="#local-6989586621680278580"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-351"></a><span>    </span><a name="local-6989586621680278581"><a href="#local-6989586621680278581"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-352"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278582"><a href="#local-6989586621680278582"><span class="hs-identifier">combinedLoc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621680278580"><span class="hs-identifier hs-var">grhss</span></a><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>        </span><a name="local-6989586621680278583"><a href="#local-6989586621680278583"><span class="hs-identifier">dsMatchContext</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-var">DsMatchContext</span></a><span> </span><a href="#local-6989586621680278578"><span class="hs-identifier hs-var">hs_ctx</span></a><span> </span><a href="#local-6989586621680278582"><span class="hs-identifier hs-var">combinedLoc</span></a><span>
</span><a name="line-354"></a><span>        </span><a name="local-6989586621680278584"><a href="#local-6989586621680278584"><span class="hs-identifier">match</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680278582"><span class="hs-identifier hs-var">combinedLoc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-355"></a><span>                  </span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278578"><span class="hs-identifier hs-var">hs_ctx</span></a><span>
</span><a name="line-356"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-357"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278579"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-358"></a><span>    </span><a href="Check.html#checkMatches"><span class="hs-identifier hs-var">checkMatches</span></a><span> </span><a href="#local-6989586621680278581"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680278583"><span class="hs-identifier hs-var">dsMatchContext</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278584"><span class="hs-identifier hs-var">match</span></a><span class="hs-special">]</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">-- | Check a matchgroup (case, functions, etc.)</span><span>
</span><a name="line-361"></a><span class="hs-identifier">checkMatches</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-type">DsMatchContext</span></a><span>
</span><a name="line-362"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-363"></a><a name="checkMatches"><a href="Check.html#checkMatches"><span class="hs-identifier">checkMatches</span></a></a><span> </span><a name="local-6989586621680278585"><a href="#local-6989586621680278585"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680278586"><a href="#local-6989586621680278586"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621680278587"><a href="#local-6989586621680278587"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621680278588"><a href="#local-6989586621680278588"><span class="hs-identifier">matches</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-364"></a><span>  </span><a href="Check.html#tracePmD"><span class="hs-identifier hs-var">tracePmD</span></a><span> </span><span class="hs-string">&quot;checkMatches&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278586"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-365"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278587"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-366"></a><span>                               </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Matches:&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-367"></a><span>                               </span><span class="hs-number">2</span><span>
</span><a name="line-368"></a><span>                               </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278588"><span class="hs-identifier hs-var">matches</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>  </span><a name="local-6989586621680278591"><a href="#local-6989586621680278591"><span class="hs-identifier">mb_pm_res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="IOEnv.html#tryM"><span class="hs-identifier hs-var">tryM</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#getResult"><span class="hs-identifier hs-var">getResult</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278588"><span class="hs-identifier hs-var">matches</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-370"></a><span>    </span><span class="hs-comment">-- Check EmptyCase separately</span><span>
</span><a name="line-371"></a><span>    </span><span class="hs-comment">-- See Note [Checking EmptyCase Expressions]</span><span>
</span><a name="line-372"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680278589"><a href="#local-6989586621680278589"><span class="hs-identifier">var</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278587"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#checkEmptyCase%27"><span class="hs-identifier hs-var">checkEmptyCase'</span></a><span> </span><a href="#local-6989586621680278589"><span class="hs-identifier hs-var">var</span></a><span>
</span><a name="line-373"></a><span>    </span><a name="local-6989586621680278590"><a href="#local-6989586621680278590"><span class="hs-identifier">_normal_match</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#checkMatches%27"><span class="hs-identifier hs-var">checkMatches'</span></a><span> </span><a href="#local-6989586621680278587"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621680278588"><span class="hs-identifier hs-var">matches</span></a><span>
</span><a name="line-374"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278591"><span class="hs-identifier hs-var">mb_pm_res</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-375"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span>  </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#warnPmIters"><span class="hs-identifier hs-var">warnPmIters</span></a><span> </span><a href="#local-6989586621680278585"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680278586"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-376"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621680278592"><a href="#local-6989586621680278592"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#dsPmWarn"><span class="hs-identifier hs-var">dsPmWarn</span></a><span> </span><a href="#local-6989586621680278585"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680278586"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621680278592"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span class="hs-comment">-- | Check a matchgroup (case, functions, etc.). To be called on a non-empty</span><span>
</span><a name="line-379"></a><span class="hs-comment">-- list of matches. For empty case expressions, use checkEmptyCase' instead.</span><span>
</span><a name="line-380"></a><span class="hs-identifier">checkMatches'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span>
</span><a name="line-381"></a><a name="checkMatches%27"><a href="Check.html#checkMatches%27"><span class="hs-identifier">checkMatches'</span></a></a><span> </span><a name="local-6989586621680278593"><a href="#local-6989586621680278593"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621680278594"><a href="#local-6989586621680278594"><span class="hs-identifier">matches</span></a></a><span>
</span><a name="line-382"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278594"><span class="hs-identifier hs-var">matches</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;checkMatches': EmptyCase&quot;</span><span>
</span><a name="line-383"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-384"></a><span>      </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#resetPmIterDs"><span class="hs-identifier hs-var">resetPmIterDs</span></a><span> </span><span class="hs-comment">-- set the iter-no to zero</span><span>
</span><a name="line-385"></a><span>      </span><a name="local-6989586621680278618"><a href="#local-6989586621680278618"><span class="hs-identifier">missing</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkInitialUncovered"><span class="hs-identifier hs-var">mkInitialUncovered</span></a><span> </span><a href="#local-6989586621680278593"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-386"></a><span>      </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;checkMatches': missing&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprValVecDebug"><span class="hs-identifier hs-var">pprValVecDebug</span></a><span> </span><a href="#local-6989586621680278618"><span class="hs-identifier hs-var">missing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621680278619"><a href="#local-6989586621680278619"><span class="hs-identifier">prov</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278620"><a href="#local-6989586621680278620"><span class="hs-identifier">rs</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278621"><a href="#local-6989586621680278621"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278622"><a href="#local-6989586621680278622"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278595"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680278594"><span class="hs-identifier hs-var">matches</span></a><span> </span><a href="#local-6989586621680278618"><span class="hs-identifier hs-var">missing</span></a><span>
</span><a name="line-388"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-389"></a><span>                   </span><span class="hs-identifier">pmresultProvenance</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278619"><span class="hs-identifier hs-var">prov</span></a><span>
</span><a name="line-390"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pmresultRedundant</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621680278596"><span class="hs-identifier hs-var">hsLMatchToLPats</span></a><span> </span><a href="#local-6989586621680278620"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-391"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pmresultUncovered</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><a href="#local-6989586621680278621"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-392"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pmresultInaccessible</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621680278596"><span class="hs-identifier hs-var">hsLMatchToLPats</span></a><span> </span><a href="#local-6989586621680278622"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-393"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-394"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#Uncovered"><span class="hs-identifier hs-type">Uncovered</span></a><span>
</span><a name="line-395"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span>
</span><a name="line-396"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-397"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Check.html#Uncovered"><span class="hs-identifier hs-type">Uncovered</span></a><span>
</span><a name="line-398"></a><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>    </span><a name="local-6989586621680278595"><a href="#local-6989586621680278595"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-6989586621680278599"><a href="#local-6989586621680278599"><span class="hs-identifier">missing</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278599"><span class="hs-identifier hs-var">missing</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-400"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278600"><a href="#local-6989586621680278600"><span class="hs-identifier">m</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680278601"><a href="#local-6989586621680278601"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278602"><a href="#local-6989586621680278602"><span class="hs-identifier">missing</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-401"></a><span>      </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;checMatches': go&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278600"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278602"><span class="hs-identifier hs-var">missing</span></a><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span>      </span><a name="local-6989586621680278603"><a href="#local-6989586621680278603"><span class="hs-identifier">fam_insts</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-var">dsGetFamInstEnvs</span></a><span>
</span><a name="line-403"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621680278604"><a href="#local-6989586621680278604"><span class="hs-identifier">clause</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278605"><a href="#local-6989586621680278605"><span class="hs-identifier">guards</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#translateMatch"><span class="hs-identifier hs-var">translateMatch</span></a><span> </span><a href="#local-6989586621680278603"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278600"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-404"></a><span>      </span><a name="local-6989586621680278606"><a href="#local-6989586621680278606"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a name="local-6989586621680278607"><a href="#local-6989586621680278607"><span class="hs-identifier">prov</span></a></a><span> </span><a name="local-6989586621680278608"><a href="#local-6989586621680278608"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621680278609"><a href="#local-6989586621680278609"><span class="hs-identifier">missing'</span></a></a><span> </span><a name="local-6989586621680278610"><a href="#local-6989586621680278610"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-405"></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#runMany"><span class="hs-identifier hs-var">runMany</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><a href="#local-6989586621680278604"><span class="hs-identifier hs-var">clause</span></a><span> </span><a href="#local-6989586621680278605"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278602"><span class="hs-identifier hs-var">missing</span></a><span>
</span><a name="line-406"></a><span>      </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;checMatches': go: res&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278606"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621680278611"><a href="#local-6989586621680278611"><span class="hs-identifier">ms_prov</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278612"><a href="#local-6989586621680278612"><span class="hs-identifier">rs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278613"><a href="#local-6989586621680278613"><span class="hs-identifier">final_u</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278614"><a href="#local-6989586621680278614"><span class="hs-identifier">is</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278595"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680278601"><span class="hs-identifier hs-var">ms</span></a><span> </span><a href="#local-6989586621680278609"><span class="hs-identifier hs-var">missing'</span></a><span>
</span><a name="line-408"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278615"><a href="#local-6989586621680278615"><span class="hs-identifier">final_prov</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278607"><span class="hs-identifier hs-var">prov</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680278611"><span class="hs-identifier hs-var">ms_prov</span></a><span>
</span><a name="line-409"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278608"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278610"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-410"></a><span>        </span><span class="hs-comment">-- useful</span><span>
</span><a name="line-411"></a><span>        </span><span class="hs-special">(</span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span class="hs-special">,</span><span>  </span><span class="hs-identifier">_</span><span>    </span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278615"><span class="hs-identifier hs-var">final_prov</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621680278612"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278613"><span class="hs-identifier hs-var">final_u</span></a><span class="hs-special">,</span><span>   </span><a href="#local-6989586621680278614"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>        </span><span class="hs-comment">-- redundant</span><span>
</span><a name="line-413"></a><span>        </span><span class="hs-special">(</span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#NotDiverged"><span class="hs-identifier hs-var">NotDiverged</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278615"><span class="hs-identifier hs-var">final_prov</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278600"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680278612"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278613"><span class="hs-identifier hs-var">final_u</span></a><span class="hs-special">,</span><a href="#local-6989586621680278614"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>        </span><span class="hs-comment">-- inaccessible</span><span>
</span><a name="line-415"></a><span>        </span><span class="hs-special">(</span><a href="Check.html#NotCovered"><span class="hs-identifier hs-var">NotCovered</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278615"><span class="hs-identifier hs-var">final_prov</span></a><span class="hs-special">,</span><span>  </span><a href="#local-6989586621680278612"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278613"><span class="hs-identifier hs-var">final_u</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278600"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680278614"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span>    </span><span class="hs-identifier">hsLMatchToLPats</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="#local-6989586621680278597"><span class="hs-identifier hs-type">id</span></a><span> </span><a href="#local-6989586621680278598"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="#local-6989586621680278597"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">]</span><span>
</span><a name="line-418"></a><span>    </span><a name="local-6989586621680278596"><a href="#local-6989586621680278596"><span class="hs-identifier">hsLMatchToLPats</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680278616"><a href="#local-6989586621680278616"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278617"><a href="#local-6989586621680278617"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680278616"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621680278617"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-comment">-- | Check an empty case expression. Since there are no clauses to process, we</span><span>
</span><a name="line-421"></a><span class="hs-comment">--   only compute the uncovered set. See Note [Checking EmptyCase Expressions]</span><span>
</span><a name="line-422"></a><span class="hs-comment">--   for details.</span><span>
</span><a name="line-423"></a><span class="hs-identifier">checkEmptyCase'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span>
</span><a name="line-424"></a><a name="checkEmptyCase%27"><a href="Check.html#checkEmptyCase%27"><span class="hs-identifier">checkEmptyCase'</span></a></a><span> </span><a name="local-6989586621680278623"><a href="#local-6989586621680278623"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-425"></a><span>  </span><a name="local-6989586621680278624"><a href="#local-6989586621680278624"><span class="hs-identifier">tm_css</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="PmExpr.html#toComplex"><span class="hs-identifier hs-var">toComplex</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#getTmCsDs"><span class="hs-identifier hs-var">getTmCsDs</span></a><span>
</span><a name="line-426"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="TmOracle.html#tmOracle"><span class="hs-identifier hs-var">tmOracle</span></a><span> </span><a href="TmOracle.html#initialTmState"><span class="hs-identifier hs-var">initialTmState</span></a><span> </span><a href="#local-6989586621680278624"><span class="hs-identifier hs-var">tm_css</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-427"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278625"><a href="#local-6989586621680278625"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-428"></a><span>      </span><a name="local-6989586621680278626"><a href="#local-6989586621680278626"><span class="hs-identifier">ty_css</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#getDictsDs"><span class="hs-identifier hs-var">getDictsDs</span></a><span>
</span><a name="line-429"></a><span>      </span><a name="local-6989586621680278627"><a href="#local-6989586621680278627"><span class="hs-identifier">fam_insts</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-var">dsGetFamInstEnvs</span></a><span>
</span><a name="line-430"></a><span>      </span><a name="local-6989586621680278628"><a href="#local-6989586621680278628"><span class="hs-identifier">mb_candidates</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#inhabitationCandidates"><span class="hs-identifier hs-var">inhabitationCandidates</span></a><span> </span><a href="#local-6989586621680278627"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621680278623"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278628"><span class="hs-identifier hs-var">mb_candidates</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-432"></a><span>        </span><span class="hs-comment">-- Inhabitation checking failed / the type is trivially inhabited</span><span>
</span><a name="line-433"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-6989586621680278629"><a href="#local-6989586621680278629"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#uncoveredWithTy"><span class="hs-identifier hs-var">uncoveredWithTy</span></a><span> </span><a href="#local-6989586621680278629"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span>        </span><span class="hs-comment">-- A list of inhabitant candidates is available: Check for each</span><span>
</span><a name="line-436"></a><span>        </span><span class="hs-comment">-- one for the satisfiability of the constraints it gives rise to.</span><span>
</span><a name="line-437"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621680278630"><a href="#local-6989586621680278630"><span class="hs-identifier">candidates</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-438"></a><span>          </span><a name="local-6989586621680278638"><a href="#local-6989586621680278638"><span class="hs-identifier">missing_m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="MonadUtils.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a><span> </span><a href="#local-6989586621680278630"><span class="hs-identifier hs-var">candidates</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680278631"><a href="#local-6989586621680278631"><span class="hs-identifier">va</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278632"><a href="#local-6989586621680278632"><span class="hs-identifier">tm_ct</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278633"><a href="#local-6989586621680278633"><span class="hs-identifier">ty_cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-439"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278634"><a href="#local-6989586621680278634"><span class="hs-identifier">all_ty_cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span> </span><a href="#local-6989586621680278633"><span class="hs-identifier hs-var">ty_cs</span></a><span> </span><a href="#local-6989586621680278626"><span class="hs-identifier hs-var">ty_css</span></a><span>
</span><a name="line-440"></a><span>            </span><a name="local-6989586621680278635"><a href="#local-6989586621680278635"><span class="hs-identifier">sat_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#tyOracle"><span class="hs-identifier hs-var">tyOracle</span></a><span> </span><a href="#local-6989586621680278634"><span class="hs-identifier hs-var">all_ty_cs</span></a><span>
</span><a name="line-441"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278635"><span class="hs-identifier hs-var">sat_ty</span></a><span class="hs-special">,</span><span> </span><a href="TmOracle.html#tmOracle"><span class="hs-identifier hs-var">tmOracle</span></a><span> </span><a href="#local-6989586621680278625"><span class="hs-identifier hs-var">tm_state</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278632"><span class="hs-identifier hs-var">tm_ct</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680278624"><span class="hs-identifier hs-var">tm_css</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-442"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278636"><a href="#local-6989586621680278636"><span class="hs-identifier">tm_state'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621680278631"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278634"><span class="hs-identifier hs-var">all_ty_cs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278636"><span class="hs-identifier hs-var">tm_state'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-443"></a><span>              </span><a name="local-6989586621680278637"><a href="#local-6989586621680278637"><span class="hs-identifier">_non_sat</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-444"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278639"><a href="#local-6989586621680278639"><span class="hs-identifier">mkValVec</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278641"><a href="#local-6989586621680278641"><span class="hs-identifier">va</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278642"><a href="#local-6989586621680278642"><span class="hs-identifier">all_ty_cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278643"><a href="#local-6989586621680278643"><span class="hs-identifier">tm_state'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-445"></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278641"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Check.html#MkDelta"><span class="hs-identifier hs-var">MkDelta</span></a><span> </span><a href="#local-6989586621680278642"><span class="hs-identifier hs-var">all_ty_cs</span></a><span> </span><a href="#local-6989586621680278643"><span class="hs-identifier hs-var">tm_state'</span></a><span class="hs-special">)</span><span>
</span><a name="line-446"></a><span>              </span><a name="local-6989586621680278640"><a href="#local-6989586621680278640"><span class="hs-identifier">uncovered</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621680278639"><span class="hs-identifier hs-var">mkValVec</span></a><span> </span><a href="#local-6989586621680278638"><span class="hs-identifier hs-var">missing_m</span></a><span class="hs-special">)</span><span>
</span><a name="line-447"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">if</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278638"><span class="hs-identifier hs-var">missing_m</span></a><span>
</span><a name="line-448"></a><span>            </span><span class="hs-keyword">then</span><span> </span><a href="Check.html#emptyPmResult"><span class="hs-identifier hs-var">emptyPmResult</span></a><span>
</span><a name="line-449"></a><span>            </span><span class="hs-keyword">else</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span> </span><a href="Check.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621680278640"><span class="hs-identifier hs-var">uncovered</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-450"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="Check.html#emptyPmResult"><span class="hs-identifier hs-var">emptyPmResult</span></a><span>
</span><a name="line-451"></a><span>
</span><a name="line-452"></a><span class="hs-comment">-- | Returns 'True' if the argument 'Type' is a fully saturated application of</span><span>
</span><a name="line-453"></a><span class="hs-comment">-- a closed type constructor.</span><span>
</span><a name="line-454"></a><span class="hs-comment">--</span><span>
</span><a name="line-455"></a><span class="hs-comment">-- Closed type constructors are those with a fixed right hand side, as</span><span>
</span><a name="line-456"></a><span class="hs-comment">-- opposed to e.g. associated types. These are of particular interest for</span><span>
</span><a name="line-457"></a><span class="hs-comment">-- pattern-match coverage checking, because GHC can exhaustively consider all</span><span>
</span><a name="line-458"></a><span class="hs-comment">-- possible forms that values of a closed type can take on.</span><span>
</span><a name="line-459"></a><span class="hs-comment">--</span><span>
</span><a name="line-460"></a><span class="hs-comment">-- Note that this function is intended to be used to check types of value-level</span><span>
</span><a name="line-461"></a><span class="hs-comment">-- patterns, so as a consequence, the 'Type' supplied as an argument to this</span><span>
</span><a name="line-462"></a><span class="hs-comment">-- function should be of kind @Type@.</span><span>
</span><a name="line-463"></a><span class="hs-identifier">pmIsClosedType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-464"></a><a name="pmIsClosedType"><a href="Check.html#pmIsClosedType"><span class="hs-identifier">pmIsClosedType</span></a></a><span> </span><a name="local-6989586621680278644"><a href="#local-6989586621680278644"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-465"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621680278644"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-466"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278647"><a href="#local-6989586621680278647"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278648"><a href="#local-6989586621680278648"><span class="hs-identifier">ty_args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-467"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680278645"><span class="hs-identifier hs-var">is_algebraic_like</span></a><span> </span><a href="#local-6989586621680278647"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isFamilyTyCon"><span class="hs-identifier hs-var">isFamilyTyCon</span></a><span> </span><a href="#local-6989586621680278647"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><span class="hs-identifier">tc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">True</span><span>
</span><a name="line-469"></a><span>      </span><a name="local-6989586621680278649"><a href="#local-6989586621680278649"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-470"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-471"></a><span>    </span><span class="hs-comment">-- This returns True for TyCons which /act like/ algebraic types.</span><span>
</span><a name="line-472"></a><span>    </span><span class="hs-comment">-- (See &quot;Type#type_classification&quot; for what an algebraic type is.)</span><span>
</span><a name="line-473"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-474"></a><span>    </span><span class="hs-comment">-- This is qualified with \&quot;like\&quot; because of a particular special</span><span>
</span><a name="line-475"></a><span>    </span><span class="hs-comment">-- case: TYPE (the underlyind kind behind Type, among others). TYPE</span><span>
</span><a name="line-476"></a><span>    </span><span class="hs-comment">-- is conceptually a datatype (and thus algebraic), but in practice it is</span><span>
</span><a name="line-477"></a><span>    </span><span class="hs-comment">-- a primitive builtin type, so we must check for it specially.</span><span>
</span><a name="line-478"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-479"></a><span>    </span><span class="hs-comment">-- NB: it makes sense to think of TYPE as a closed type in a value-level,</span><span>
</span><a name="line-480"></a><span>    </span><span class="hs-comment">-- pattern-matching context. However, at the kind level, TYPE is certainly</span><span>
</span><a name="line-481"></a><span>    </span><span class="hs-comment">-- not closed! Since this function is specifically tailored towards pattern</span><span>
</span><a name="line-482"></a><span>    </span><span class="hs-comment">-- matching, however, it's OK to label TYPE as closed.</span><span>
</span><a name="line-483"></a><span>    </span><span class="hs-identifier">is_algebraic_like</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-484"></a><span>    </span><a name="local-6989586621680278645"><a href="#local-6989586621680278645"><span class="hs-identifier">is_algebraic_like</span></a></a><span> </span><a name="local-6989586621680278646"><a href="#local-6989586621680278646"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span> </span><a href="#local-6989586621680278646"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680278646"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysPrim.html#tYPETyCon"><span class="hs-identifier hs-var">tYPETyCon</span></a><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-identifier">pmTopNormaliseType_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-487"></a><span class="hs-comment">-- ^ Get rid of *outermost* (or toplevel)</span><span>
</span><a name="line-488"></a><span class="hs-comment">--      * type function redex</span><span>
</span><a name="line-489"></a><span class="hs-comment">--      * data family redex</span><span>
</span><a name="line-490"></a><span class="hs-comment">--      * newtypes</span><span>
</span><a name="line-491"></a><span class="hs-comment">--</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- Behaves exactly like `topNormaliseType_maybe`, but instead of returning a</span><span>
</span><a name="line-493"></a><span class="hs-comment">-- coercion, it returns useful information for issuing pattern matching</span><span>
</span><a name="line-494"></a><span class="hs-comment">-- warnings. See Note [Type normalisation for EmptyCase] for details.</span><span>
</span><a name="line-495"></a><a name="pmTopNormaliseType_maybe"><a href="Check.html#pmTopNormaliseType_maybe"><span class="hs-identifier">pmTopNormaliseType_maybe</span></a></a><span> </span><a name="local-6989586621680278650"><a href="#local-6989586621680278650"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680278651"><a href="#local-6989586621680278651"><span class="hs-identifier">typ</span></a></a><span>
</span><a name="line-496"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621680278680"><a href="#local-6989586621680278680"><span class="hs-identifier">ty_f</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278681"><a href="#local-6989586621680278681"><span class="hs-identifier">tm_f</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680278682"><a href="#local-6989586621680278682"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Coercion.html#topNormaliseTypeX"><span class="hs-identifier hs-var">topNormaliseTypeX</span></a><span> </span><a href="#local-6989586621680278655"><span class="hs-identifier hs-var">stepper</span></a><span> </span><a href="#local-6989586621680278654"><span class="hs-identifier hs-var">comb</span></a><span> </span><a href="#local-6989586621680278651"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-497"></a><span>       </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278652"><span class="hs-identifier hs-var">eq_src_ty</span></a><span> </span><a href="#local-6989586621680278682"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278651"><span class="hs-identifier hs-var">typ</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680278680"><span class="hs-identifier hs-var">ty_f</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278682"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278681"><span class="hs-identifier hs-var">tm_f</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278682"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-499"></a><span>    </span><span class="hs-comment">-- Find the first type in the sequence of rewrites that is a data type,</span><span>
</span><a name="line-500"></a><span>    </span><span class="hs-comment">-- newtype, or a data family application (not the representation tycon!).</span><span>
</span><a name="line-501"></a><span>    </span><span class="hs-comment">-- This is the one that is equal (in source Haskell) to the initial type.</span><span>
</span><a name="line-502"></a><span>    </span><span class="hs-comment">-- If none is found in the list, then all of them are type family</span><span>
</span><a name="line-503"></a><span>    </span><span class="hs-comment">-- applications, so we simply return the last one, which is the *simplest*.</span><span>
</span><a name="line-504"></a><span>    </span><span class="hs-identifier">eq_src_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-505"></a><span>    </span><a name="local-6989586621680278652"><a href="#local-6989586621680278652"><span class="hs-identifier">eq_src_ty</span></a></a><span> </span><a name="local-6989586621680278658"><a href="#local-6989586621680278658"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680278659"><a href="#local-6989586621680278659"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><a href="#local-6989586621680278658"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621680278653"><span class="hs-identifier hs-var">is_closed_or_data_family</span></a><span> </span><a href="#local-6989586621680278659"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span>
</span><a name="line-507"></a><span>    </span><span class="hs-identifier">is_closed_or_data_family</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-508"></a><span>    </span><a name="local-6989586621680278653"><a href="#local-6989586621680278653"><span class="hs-identifier">is_closed_or_data_family</span></a></a><span> </span><a name="local-6989586621680278660"><a href="#local-6989586621680278660"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#pmIsClosedType"><span class="hs-identifier hs-var">pmIsClosedType</span></a><span> </span><a href="#local-6989586621680278660"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Type.html#isDataFamilyAppType"><span class="hs-identifier hs-var">isDataFamilyAppType</span></a><span> </span><a href="#local-6989586621680278660"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span>    </span><span class="hs-comment">-- For efficiency, represent both lists as difference lists.</span><span>
</span><a name="line-511"></a><span>    </span><span class="hs-comment">-- comb performs the concatenation, for both lists.</span><span>
</span><a name="line-512"></a><span>    </span><a name="local-6989586621680278654"><a href="#local-6989586621680278654"><span class="hs-identifier">comb</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278661"><a href="#local-6989586621680278661"><span class="hs-identifier">tyf1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278662"><a href="#local-6989586621680278662"><span class="hs-identifier">tmf1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278663"><a href="#local-6989586621680278663"><span class="hs-identifier">tyf2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278664"><a href="#local-6989586621680278664"><span class="hs-identifier">tmf2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278661"><span class="hs-identifier hs-var">tyf1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621680278663"><span class="hs-identifier hs-var">tyf2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278662"><span class="hs-identifier hs-var">tmf1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621680278664"><span class="hs-identifier hs-var">tmf2</span></a><span class="hs-special">)</span><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span>    </span><a name="local-6989586621680278655"><a href="#local-6989586621680278655"><span class="hs-identifier">stepper</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278656"><span class="hs-identifier hs-var">newTypeStepper</span></a><span> </span><span class="hs-special">`</span><a href="Coercion.html#composeSteppers"><span class="hs-identifier hs-var">composeSteppers</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680278657"><span class="hs-identifier hs-var">tyFamStepper</span></a><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span>    </span><span class="hs-comment">-- A 'NormaliseStepper' that unwraps newtypes, careful not to fall into</span><span>
</span><a name="line-517"></a><span>    </span><span class="hs-comment">-- a loop. If it would fall into a loop, it produces 'NS_Abort'.</span><span>
</span><a name="line-518"></a><span>    </span><span class="hs-identifier">newTypeStepper</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Coercion.html#NormaliseStepper"><span class="hs-identifier hs-type">NormaliseStepper</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>    </span><a name="local-6989586621680278656"><a href="#local-6989586621680278656"><span class="hs-identifier">newTypeStepper</span></a></a><span> </span><a name="local-6989586621680278665"><a href="#local-6989586621680278665"><span class="hs-identifier">rec_nts</span></a></a><span> </span><a name="local-6989586621680278666"><a href="#local-6989586621680278666"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621680278667"><a href="#local-6989586621680278667"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-520"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278668"><a href="#local-6989586621680278668"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278669"><a href="#local-6989586621680278669"><span class="hs-identifier">_co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Coercion.html#instNewTyCon_maybe"><span class="hs-identifier hs-var">instNewTyCon_maybe</span></a><span> </span><a href="#local-6989586621680278666"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621680278667"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-521"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#checkRecTc"><span class="hs-identifier hs-var">checkRecTc</span></a><span> </span><a href="#local-6989586621680278665"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-6989586621680278666"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-522"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278670"><a href="#local-6989586621680278670"><span class="hs-identifier">rec_nts'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278671"><a href="#local-6989586621680278671"><span class="hs-identifier">tyf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621680278666"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621680278667"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-523"></a><span>                               </span><a name="local-6989586621680278672"><a href="#local-6989586621680278672"><span class="hs-identifier">tmf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="TyCon.html#tyConSingleDataCon"><span class="hs-identifier hs-var">tyConSingleDataCon</span></a><span> </span><a href="#local-6989586621680278666"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-524"></a><span>                           </span><span class="hs-keyword">in</span><span>  </span><a href="Coercion.html#NS_Step"><span class="hs-identifier hs-var">NS_Step</span></a><span> </span><a href="#local-6989586621680278670"><span class="hs-identifier hs-var">rec_nts'</span></a><span> </span><a href="#local-6989586621680278668"><span class="hs-identifier hs-var">ty'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278671"><span class="hs-identifier hs-var">tyf</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278672"><span class="hs-identifier hs-var">tmf</span></a><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Coercion.html#NS_Abort"><span class="hs-identifier hs-var">NS_Abort</span></a><span>
</span><a name="line-526"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-527"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#NS_Done"><span class="hs-identifier hs-var">NS_Done</span></a><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span>    </span><span class="hs-identifier">tyFamStepper</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Coercion.html#NormaliseStepper"><span class="hs-identifier hs-type">NormaliseStepper</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-530"></a><span>    </span><a name="local-6989586621680278657"><a href="#local-6989586621680278657"><span class="hs-identifier">tyFamStepper</span></a></a><span> </span><a name="local-6989586621680278673"><a href="#local-6989586621680278673"><span class="hs-identifier">rec_nts</span></a></a><span> </span><a name="local-6989586621680278674"><a href="#local-6989586621680278674"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621680278675"><a href="#local-6989586621680278675"><span class="hs-identifier">tys</span></a></a><span>  </span><span class="hs-comment">-- Try to step a type/data family</span><span>
</span><a name="line-531"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278676"><a href="#local-6989586621680278676"><span class="hs-identifier">_args_co</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278677"><a href="#local-6989586621680278677"><span class="hs-identifier">ntys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="FamInstEnv.html#normaliseTcArgs"><span class="hs-identifier hs-var">normaliseTcArgs</span></a><span> </span><a href="#local-6989586621680278650"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><a href="#local-6989586621680278674"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621680278675"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-532"></a><span>          </span><span class="hs-comment">-- NB: It's OK to use normaliseTcArgs here instead of</span><span>
</span><a name="line-533"></a><span>          </span><span class="hs-comment">-- normalise_tc_args (which takes the LiftingContext described</span><span>
</span><a name="line-534"></a><span>          </span><span class="hs-comment">-- in Note [Normalising types]) because the reduceTyFamApp below</span><span>
</span><a name="line-535"></a><span>          </span><span class="hs-comment">-- works only at top level. We'll never recur in this function</span><span>
</span><a name="line-536"></a><span>          </span><span class="hs-comment">-- after reducing the kind of a bound tyvar.</span><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="FamInstEnv.html#reduceTyFamApp_maybe"><span class="hs-identifier hs-var">reduceTyFamApp_maybe</span></a><span> </span><a href="#local-6989586621680278650"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><a href="#local-6989586621680278674"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621680278677"><span class="hs-identifier hs-var">ntys</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-539"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278678"><a href="#local-6989586621680278678"><span class="hs-identifier">_co</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278679"><a href="#local-6989586621680278679"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Coercion.html#NS_Step"><span class="hs-identifier hs-var">NS_Step</span></a><span> </span><a href="#local-6989586621680278673"><span class="hs-identifier hs-var">rec_nts</span></a><span> </span><a href="#local-6989586621680278679"><span class="hs-identifier hs-var">rhs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621680278679"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-540"></a><span>          </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Coercion.html#NS_Done"><span class="hs-identifier hs-var">NS_Done</span></a><span>
</span><a name="line-541"></a><span>
</span><a name="line-542"></a><span class="hs-comment">{- Note [Type normalisation for EmptyCase]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EmptyCase is an exception for pattern matching, since it is strict. This means
that it boils down to checking whether the type of the scrutinee is inhabited.
Function pmTopNormaliseType_maybe gets rid of the outermost type function/data
family redex and newtypes, in search of an algebraic type constructor, which is
easier to check for inhabitation.

It returns 3 results instead of one, because there are 2 subtle points:
1. Newtypes are isomorphic to the underlying type in core but not in the source
   language,
2. The representational data family tycon is used internally but should not be
   shown to the user

Hence, if pmTopNormaliseType_maybe env ty = Just (src_ty, dcs, core_ty), then
  (a) src_ty is the rewritten type which we can show to the user. That is, the
      type we get if we rewrite type families but not data families or
      newtypes.
  (b) dcs is the list of data constructors &quot;skipped&quot;, every time we normalise a
      newtype to it's core representation, we keep track of the source data
      constructor.
  (c) core_ty is the rewritten type. That is,
        pmTopNormaliseType_maybe env ty = Just (src_ty, dcs, core_ty)
      implies
        topNormaliseType_maybe env ty = Just (co, core_ty)
      for some coercion co.

To see how all cases come into play, consider the following example:

  data family T a :: *
  data instance T Int = T1 | T2 Bool
  -- Which gives rise to FC:
  --   data T a
  --   data R:TInt = T1 | T2 Bool
  --   axiom ax_ti : T Int ~R R:TInt

  newtype G1 = MkG1 (T Int)
  newtype G2 = MkG2 G1

  type instance F Int  = F Char
  type instance F Char = G2

In this case pmTopNormaliseType_maybe env (F Int) results in

  Just (G2, [MkG2,MkG1], R:TInt)

Which means that in source Haskell:
  - G2 is equivalent to F Int (in contrast, G1 isn't).
  - if (x : R:TInt) then (MkG2 (MkG1 x) : F Int).
-}</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">-- | Generate all inhabitation candidates for a given type. The result is</span><span>
</span><a name="line-594"></a><span class="hs-comment">-- either (Left ty), if the type cannot be reduced to a closed algebraic type</span><span>
</span><a name="line-595"></a><span class="hs-comment">-- (or if it's one trivially inhabited, like Int), or (Right candidates), if it</span><span>
</span><a name="line-596"></a><span class="hs-comment">-- can. In this case, the candidates are the signature of the tycon, each one</span><span>
</span><a name="line-597"></a><span class="hs-comment">-- accompanied by the term- and type- constraints it gives rise to.</span><span>
</span><a name="line-598"></a><span class="hs-comment">-- See also Note [Checking EmptyCase Expressions]</span><span>
</span><a name="line-599"></a><span class="hs-identifier">inhabitationCandidates</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-600"></a><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">,</span><span> </span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-601"></a><a name="inhabitationCandidates"><a href="Check.html#inhabitationCandidates"><span class="hs-identifier">inhabitationCandidates</span></a></a><span> </span><a name="local-6989586621680278683"><a href="#local-6989586621680278683"><span class="hs-identifier">fam_insts</span></a></a><span> </span><a name="local-6989586621680278684"><a href="#local-6989586621680278684"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-602"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Check.html#pmTopNormaliseType_maybe"><span class="hs-identifier hs-var">pmTopNormaliseType_maybe</span></a><span> </span><a href="#local-6989586621680278683"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278684"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-603"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278702"><a href="#local-6989586621680278702"><span class="hs-identifier">src_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278703"><a href="#local-6989586621680278703"><span class="hs-identifier">dcs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278704"><a href="#local-6989586621680278704"><span class="hs-identifier">core_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278687"><span class="hs-identifier hs-var">alts_to_check</span></a><span> </span><a href="#local-6989586621680278702"><span class="hs-identifier hs-var">src_ty</span></a><span> </span><a href="#local-6989586621680278704"><span class="hs-identifier hs-var">core_ty</span></a><span> </span><a href="#local-6989586621680278703"><span class="hs-identifier hs-var">dcs</span></a><span>
</span><a name="line-604"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278687"><span class="hs-identifier hs-var">alts_to_check</span></a><span> </span><a href="#local-6989586621680278684"><span class="hs-identifier hs-var">ty</span></a><span>     </span><a href="#local-6989586621680278684"><span class="hs-identifier hs-var">ty</span></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-605"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-606"></a><span>    </span><span class="hs-comment">-- All these types are trivially inhabited</span><span>
</span><a name="line-607"></a><span>    </span><a name="local-6989586621680278685"><a href="#local-6989586621680278685"><span class="hs-identifier">trivially_inhabited</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="TysWiredIn.html#charTyCon"><span class="hs-identifier hs-var">charTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#doubleTyCon"><span class="hs-identifier hs-var">doubleTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#floatTyCon"><span class="hs-identifier hs-var">floatTyCon</span></a><span>
</span><a name="line-608"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#intTyCon"><span class="hs-identifier hs-var">intTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#wordTyCon"><span class="hs-identifier hs-var">wordTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#word8TyCon"><span class="hs-identifier hs-var">word8TyCon</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span>    </span><span class="hs-comment">-- Note: At the moment we leave all the typing and constraint fields of</span><span>
</span><a name="line-611"></a><span>    </span><span class="hs-comment">-- PmCon empty, since we know that they are not gonna be used. Is the</span><span>
</span><a name="line-612"></a><span>    </span><span class="hs-comment">-- right-thing-to-do to actually create them, even if they are never used?</span><span>
</span><a name="line-613"></a><span>    </span><span class="hs-identifier">build_tm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span>
</span><a name="line-614"></a><span>    </span><a name="local-6989586621680278686"><a href="#local-6989586621680278686"><span class="hs-identifier">build_tm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680278688"><a href="#local-6989586621680278688"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-6989586621680278689"><a href="#local-6989586621680278689"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a href="#local-6989586621680278688"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278689"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span>
</span><a name="line-616"></a><span>    </span><span class="hs-comment">-- Inhabitation candidates, using the result of pmTopNormaliseType_maybe</span><span>
</span><a name="line-617"></a><span>    </span><span class="hs-identifier">alts_to_check</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span>
</span><a name="line-618"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">,</span><span> </span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-619"></a><span>    </span><a name="local-6989586621680278687"><a href="#local-6989586621680278687"><span class="hs-identifier">alts_to_check</span></a></a><span> </span><a name="local-6989586621680278690"><a href="#local-6989586621680278690"><span class="hs-identifier">src_ty</span></a></a><span> </span><a name="local-6989586621680278691"><a href="#local-6989586621680278691"><span class="hs-identifier">core_ty</span></a></a><span> </span><a name="local-6989586621680278692"><a href="#local-6989586621680278692"><span class="hs-identifier">dcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621680278691"><span class="hs-identifier hs-var">core_ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-620"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278693"><a href="#local-6989586621680278693"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680278693"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680278685"><span class="hs-identifier hs-var">trivially_inhabited</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278692"><span class="hs-identifier hs-var">dcs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-622"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-6989586621680278690"><span class="hs-identifier hs-var">src_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-623"></a><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680278694"><a href="#local-6989586621680278694"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#mkPmId"><span class="hs-identifier hs-var">mkPmId</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#toTcType"><span class="hs-identifier hs-var">toTcType</span></a><span> </span><a href="#local-6989586621680278691"><span class="hs-identifier hs-var">core_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-624"></a><span>                        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278695"><a href="#local-6989586621680278695"><span class="hs-identifier">va</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278686"><span class="hs-identifier hs-var">build_tm</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="#local-6989586621680278694"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278692"><span class="hs-identifier hs-var">dcs</span></a><span>
</span><a name="line-625"></a><span>                        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621680278695"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#mkIdEq"><span class="hs-identifier hs-var">mkIdEq</span></a><span> </span><a href="#local-6989586621680278694"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#pmIsClosedType"><span class="hs-identifier hs-var">pmIsClosedType</span></a><span> </span><a href="#local-6989586621680278691"><span class="hs-identifier hs-var">core_ty</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-628"></a><span>            </span><a name="local-6989586621680278696"><a href="#local-6989586621680278696"><span class="hs-identifier">var</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkPmId"><span class="hs-identifier hs-var">mkPmId</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#toTcType"><span class="hs-identifier hs-var">toTcType</span></a><span> </span><a href="#local-6989586621680278691"><span class="hs-identifier hs-var">core_ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- it would be wrong to unify x</span><span>
</span><a name="line-629"></a><span>            </span><a name="local-6989586621680278697"><a href="#local-6989586621680278697"><span class="hs-identifier">alts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#mkOneConFull"><span class="hs-identifier hs-var">mkOneConFull</span></a><span> </span><a href="#local-6989586621680278696"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-6989586621680278693"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621680278686"><span class="hs-identifier hs-var">build_tm</span></a><span> </span><a href="#local-6989586621680278698"><span class="hs-identifier hs-var">va</span></a><span> </span><a href="#local-6989586621680278692"><span class="hs-identifier hs-var">dcs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278699"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278700"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278698"><a href="#local-6989586621680278698"><span class="hs-identifier">va</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278699"><a href="#local-6989586621680278699"><span class="hs-identifier">eq</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278700"><a href="#local-6989586621680278700"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278697"><span class="hs-identifier hs-var">alts</span></a><span class="hs-special">]</span><span>
</span><a name="line-631"></a><span>      </span><span class="hs-comment">-- For other types conservatively assume that they are inhabited.</span><span>
</span><a name="line-632"></a><span>      </span><a name="local-6989586621680278701"><a href="#local-6989586621680278701"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a href="#local-6989586621680278690"><span class="hs-identifier hs-var">src_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>
</span><a name="line-634"></a><span class="hs-comment">{- Note [Checking EmptyCase Expressions]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Empty case expressions are strict on the scrutinee. That is, `case x of {}`
will force argument `x`. Hence, `checkMatches` is not sufficient for checking
empty cases, because it assumes that the match is not strict (which is true
for all other cases, apart from EmptyCase). This gave rise to #10746. Instead,
we do the following:

1. We normalise the outermost type family redex, data family redex or newtype,
   using pmTopNormaliseType_maybe (in types/FamInstEnv.hs). This computes 3
   things:
   (a) A normalised type src_ty, which is equal to the type of the scrutinee in
       source Haskell (does not normalise newtypes or data families)
   (b) The actual normalised type core_ty, which coincides with the result
       topNormaliseType_maybe. This type is not necessarily equal to the input
       type in source Haskell. And this is precicely the reason we compute (a)
       and (c): the reasoning happens with the underlying types, but both the
       patterns and types we print should respect newtypes and also show the
       family type constructors and not the representation constructors.

   (c) A list of all newtype data constructors dcs, each one corresponding to a
       newtype rewrite performed in (b).

   For an example see also Note [Type normalisation for EmptyCase]
   in types/FamInstEnv.hs.

2. Function checkEmptyCase' performs the check:
   - If core_ty is not an algebraic type, then we cannot check for
     inhabitation, so we emit (_ :: src_ty) as missing, conservatively assuming
     that the type is inhabited.
   - If core_ty is an algebraic type, then we unfold the scrutinee to all
     possible constructor patterns, using inhabitationCandidates, and then
     check each one for constraint satisfiability, same as we for normal
     pattern match checking.

%************************************************************************
%*                                                                      *
              Transform source syntax to *our* syntax
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-comment">-- -----------------------------------------------------------------------</span><span>
</span><a name="line-677"></a><span class="hs-comment">-- * Utilities</span><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span class="hs-identifier">nullaryConPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-680"></a><span class="hs-comment">-- Nullary data constructor and nullary type constructor</span><span>
</span><a name="line-681"></a><a name="nullaryConPattern"><a href="Check.html#nullaryConPattern"><span class="hs-identifier">nullaryConPattern</span></a></a><span> </span><a name="local-6989586621680278705"><a href="#local-6989586621680278705"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-682"></a><span>  </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278705"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-683"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-684"></a><span class="hs-pragma">{-# INLINE nullaryConPattern #-}</span><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span class="hs-identifier">truePattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-687"></a><a name="truePattern"><a href="Check.html#truePattern"><span class="hs-identifier">truePattern</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#nullaryConPattern"><span class="hs-identifier hs-var">nullaryConPattern</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a href="TysWiredIn.html#trueDataCon"><span class="hs-identifier hs-var">trueDataCon</span></a><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span class="hs-pragma">{-# INLINE truePattern #-}</span><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-comment">-- | A fake guard pattern (True &lt;- _) used to represent cases we cannot handle</span><span>
</span><a name="line-691"></a><span class="hs-identifier">fake_pat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-692"></a><a name="fake_pat"><a href="Check.html#fake_pat"><span class="hs-identifier">fake_pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_grd_pv</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#truePattern"><span class="hs-identifier hs-var">truePattern</span></a><span class="hs-special">]</span><span>
</span><a name="line-693"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_grd_expr</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#PmExprOther"><span class="hs-identifier hs-var">PmExprOther</span></a><span> </span><a href="HsExpr.html#EWildPat"><span class="hs-identifier hs-var">EWildPat</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-694"></a><span class="hs-pragma">{-# INLINE fake_pat #-}</span><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-comment">-- | Check whether a guard pattern is generated by the checker (unhandled)</span><span>
</span><a name="line-697"></a><span class="hs-identifier">isFakeGuard</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PmExpr.html#PmExpr"><span class="hs-identifier hs-type">PmExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-698"></a><a name="isFakeGuard"><a href="Check.html#isFakeGuard"><span class="hs-identifier">isFakeGuard</span></a></a><span> </span><span class="hs-special">[</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-6989586621680278706"><a href="#local-6989586621680278706"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprOther"><span class="hs-identifier hs-var">PmExprOther</span></a><span> </span><a href="HsExpr.html#EWildPat"><span class="hs-identifier hs-var">EWildPat</span></a><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680278706"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysWiredIn.html#trueDataCon"><span class="hs-identifier hs-var">trueDataCon</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-700"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-701"></a><span class="hs-identifier">isFakeGuard</span><span> </span><a name="local-6989586621680278707"><a href="#local-6989586621680278707"><span class="hs-identifier">_pats</span></a></a><span> </span><a name="local-6989586621680278708"><a href="#local-6989586621680278708"><span class="hs-identifier">_e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-702"></a><span>
</span><a name="line-703"></a><span class="hs-comment">-- | Generate a `canFail` pattern vector of a specific type</span><span>
</span><a name="line-704"></a><span class="hs-identifier">mkCanFailPmPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-705"></a><a name="mkCanFailPmPat"><a href="Check.html#mkCanFailPmPat"><span class="hs-identifier">mkCanFailPmPat</span></a></a><span> </span><a name="local-6989586621680278709"><a href="#local-6989586621680278709"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-706"></a><span>  </span><a name="local-6989586621680278710"><a href="#local-6989586621680278710"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkPmVar"><span class="hs-identifier hs-var">mkPmVar</span></a><span> </span><a href="#local-6989586621680278709"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-707"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278710"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="Check.html#fake_pat"><span class="hs-identifier hs-var">fake_pat</span></a><span class="hs-special">]</span><span>
</span><a name="line-708"></a><span>
</span><a name="line-709"></a><span class="hs-identifier">vanillaConPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-710"></a><span class="hs-comment">-- ADT constructor pattern =&gt; no existentials, no local constraints</span><span>
</span><a name="line-711"></a><a name="vanillaConPattern"><a href="Check.html#vanillaConPattern"><span class="hs-identifier">vanillaConPattern</span></a></a><span> </span><a name="local-6989586621680278711"><a href="#local-6989586621680278711"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621680278712"><a href="#local-6989586621680278712"><span class="hs-identifier">arg_tys</span></a></a><span> </span><a name="local-6989586621680278713"><a href="#local-6989586621680278713"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-712"></a><span>  </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278711"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278712"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-713"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278713"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-714"></a><span class="hs-pragma">{-# INLINE vanillaConPattern #-}</span><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span class="hs-comment">-- | Create an empty list pattern of a given type</span><span>
</span><a name="line-717"></a><span class="hs-identifier">nilPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-718"></a><a name="nilPattern"><a href="Check.html#nilPattern"><span class="hs-identifier">nilPattern</span></a></a><span> </span><a name="local-6989586621680278714"><a href="#local-6989586621680278714"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-719"></a><span>  </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a href="TysWiredIn.html#nilDataCon"><span class="hs-identifier hs-var">nilDataCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278714"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-720"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-721"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-722"></a><span class="hs-pragma">{-# INLINE nilPattern #-}</span><span>
</span><a name="line-723"></a><span>
</span><a name="line-724"></a><span class="hs-identifier">mkListPatVec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-725"></a><a name="mkListPatVec"><a href="Check.html#mkListPatVec"><span class="hs-identifier">mkListPatVec</span></a></a><span> </span><a name="local-6989586621680278715"><a href="#local-6989586621680278715"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680278716"><a href="#local-6989586621680278716"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621680278717"><a href="#local-6989586621680278717"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a href="TysWiredIn.html#consDataCon"><span class="hs-identifier hs-var">consDataCon</span></a><span>
</span><a name="line-726"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278715"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-727"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-728"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278716"><span class="hs-identifier hs-var">xs</span></a><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><a href="#local-6989586621680278717"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-729"></a><span class="hs-pragma">{-# INLINE mkListPatVec #-}</span><span>
</span><a name="line-730"></a><span>
</span><a name="line-731"></a><span class="hs-comment">-- | Create a (non-overloaded) literal pattern</span><span>
</span><a name="line-732"></a><span class="hs-identifier">mkLitPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsLit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-733"></a><a name="mkLitPattern"><a href="Check.html#mkLitPattern"><span class="hs-identifier">mkLitPattern</span></a></a><span> </span><a name="local-6989586621680278718"><a href="#local-6989586621680278718"><span class="hs-identifier">lit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#PmSLit"><span class="hs-identifier hs-var">PmSLit</span></a><span> </span><a href="#local-6989586621680278718"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-734"></a><span class="hs-pragma">{-# INLINE mkLitPattern #-}</span><span>
</span><a name="line-735"></a><span>
</span><a name="line-736"></a><span class="hs-comment">-- -----------------------------------------------------------------------</span><span>
</span><a name="line-737"></a><span class="hs-comment">-- * Transform (Pat Id) into of (PmPat Id)</span><span>
</span><a name="line-738"></a><span>
</span><a name="line-739"></a><span class="hs-identifier">translatePat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-740"></a><a name="translatePat"><a href="Check.html#translatePat"><span class="hs-identifier">translatePat</span></a></a><span> </span><a name="local-6989586621680278719"><a href="#local-6989586621680278719"><span class="hs-identifier">fam_insts</span></a></a><span> </span><a name="local-6989586621680278720"><a href="#local-6989586621680278720"><span class="hs-identifier">pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278720"><span class="hs-identifier hs-var">pat</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-741"></a><span>  </span><a href="HsPat.html#WildPat"><span class="hs-identifier hs-var">WildPat</span></a><span> </span><a name="local-6989586621680278721"><a href="#local-6989586621680278721"><span class="hs-identifier">ty</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#mkPmVars"><span class="hs-identifier hs-var">mkPmVars</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278721"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-742"></a><span>  </span><a href="HsPat.html#VarPat"><span class="hs-identifier hs-var">VarPat</span></a><span>  </span><a name="local-6989586621680278722"><a href="#local-6989586621680278722"><span class="hs-identifier">id</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278722"><span class="hs-identifier hs-var">id</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-743"></a><span>  </span><a href="HsPat.html#ParPat"><span class="hs-identifier hs-var">ParPat</span></a><span> </span><a name="local-6989586621680278723"><a href="#local-6989586621680278723"><span class="hs-identifier">p</span></a></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278723"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-744"></a><span>  </span><a href="HsPat.html#LazyPat"><span class="hs-identifier hs-var">LazyPat</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#mkPmVars"><span class="hs-identifier hs-var">mkPmVars</span></a><span> </span><span class="hs-special">[</span><a href="TcHsSyn.html#hsPatType"><span class="hs-identifier hs-var">hsPatType</span></a><span> </span><a href="#local-6989586621680278720"><span class="hs-identifier hs-var">pat</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- like a variable</span><span>
</span><a name="line-745"></a><span>
</span><a name="line-746"></a><span>  </span><span class="hs-comment">-- ignore strictness annotations for now</span><span>
</span><a name="line-747"></a><span>  </span><a href="HsPat.html#BangPat"><span class="hs-identifier hs-var">BangPat</span></a><span> </span><a name="local-6989586621680278724"><a href="#local-6989586621680278724"><span class="hs-identifier">p</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278724"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span>  </span><a href="HsPat.html#AsPat"><span class="hs-identifier hs-var">AsPat</span></a><span> </span><a name="local-6989586621680278725"><a href="#local-6989586621680278725"><span class="hs-identifier">lid</span></a></a><span> </span><a name="local-6989586621680278726"><a href="#local-6989586621680278726"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-750"></a><span>     </span><span class="hs-comment">-- Note [Translating As Patterns]</span><span>
</span><a name="line-751"></a><span>    </span><a name="local-6989586621680278727"><a href="#local-6989586621680278727"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278726"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-752"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680278728"><a href="#local-6989586621680278728"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#vaToPmExpr"><span class="hs-identifier hs-var">vaToPmExpr</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#coercePatVec"><span class="hs-identifier hs-var">coercePatVec</span></a><span> </span><a href="#local-6989586621680278727"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-753"></a><span>        </span><a name="local-6989586621680278729"><a href="#local-6989586621680278729"><span class="hs-identifier">g</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278725"><span class="hs-identifier hs-var">lid</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621680278728"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-754"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278727"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278729"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-755"></a><span>
</span><a name="line-756"></a><span>  </span><a href="HsPat.html#SigPatOut"><span class="hs-identifier hs-var">SigPatOut</span></a><span> </span><a name="local-6989586621680278730"><a href="#local-6989586621680278730"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621680278731"><a href="#local-6989586621680278731"><span class="hs-identifier">_ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278730"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span>  </span><span class="hs-comment">-- See Note [Translate CoPats]</span><span>
</span><a name="line-759"></a><span>  </span><a href="HsPat.html#CoPat"><span class="hs-identifier hs-var">CoPat</span></a><span> </span><a name="local-6989586621680278732"><a href="#local-6989586621680278732"><span class="hs-identifier">wrapper</span></a></a><span> </span><a name="local-6989586621680278733"><a href="#local-6989586621680278733"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621680278734"><a href="#local-6989586621680278734"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-760"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#isIdHsWrapper"><span class="hs-identifier hs-var">isIdHsWrapper</span></a><span> </span><a href="#local-6989586621680278732"><span class="hs-identifier hs-var">wrapper</span></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278733"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-761"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="TcEvidence.html#WpCast"><span class="hs-identifier hs-var">WpCast</span></a><span> </span><a name="local-6989586621680278735"><a href="#local-6989586621680278735"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><a href="#local-6989586621680278732"><span class="hs-identifier hs-var">wrapper</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#isReflexiveCo"><span class="hs-identifier hs-var">isReflexiveCo</span></a><span> </span><a href="#local-6989586621680278735"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278733"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-762"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-763"></a><span>        </span><a name="local-6989586621680278736"><a href="#local-6989586621680278736"><span class="hs-identifier">ps</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278733"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-764"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621680278737"><a href="#local-6989586621680278737"><span class="hs-identifier">xp</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278738"><a href="#local-6989586621680278738"><span class="hs-identifier">xe</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkPmId2Forms"><span class="hs-identifier hs-var">mkPmId2Forms</span></a><span> </span><a href="#local-6989586621680278734"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-765"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278739"><a href="#local-6989586621680278739"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#mkGuard"><span class="hs-identifier hs-var">mkGuard</span></a><span> </span><a href="#local-6989586621680278736"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">(</span><a href="HsUtils.html#mkHsWrap"><span class="hs-identifier hs-var">mkHsWrap</span></a><span> </span><a href="#local-6989586621680278732"><span class="hs-identifier hs-var">wrapper</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278738"><span class="hs-identifier hs-var">xe</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-766"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278737"><span class="hs-identifier hs-var">xp</span></a><span class="hs-special">,</span><a href="#local-6989586621680278739"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">]</span><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span>  </span><span class="hs-comment">-- (n + k)  ===&gt;   x (True &lt;- x &gt;= k) (n &lt;- x-k)</span><span>
</span><a name="line-769"></a><span>  </span><a href="HsPat.html#NPlusKPat"><span class="hs-identifier hs-var">NPlusKPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278740"><a href="#local-6989586621680278740"><span class="hs-identifier">_n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278741"><a href="#local-6989586621680278741"><span class="hs-identifier">_k1</span></a></a><span> </span><a name="local-6989586621680278742"><a href="#local-6989586621680278742"><span class="hs-identifier">_k2</span></a></a><span> </span><a name="local-6989586621680278743"><a href="#local-6989586621680278743"><span class="hs-identifier">_ge</span></a></a><span> </span><a name="local-6989586621680278744"><a href="#local-6989586621680278744"><span class="hs-identifier">_minus</span></a></a><span> </span><a name="local-6989586621680278745"><a href="#local-6989586621680278745"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#mkCanFailPmPat"><span class="hs-identifier hs-var">mkCanFailPmPat</span></a><span> </span><a href="#local-6989586621680278745"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-770"></a><span>
</span><a name="line-771"></a><span>  </span><span class="hs-comment">-- (fun -&gt; pat)   ===&gt;   x (pat &lt;- fun x)</span><span>
</span><a name="line-772"></a><span>  </span><a href="HsPat.html#ViewPat"><span class="hs-identifier hs-var">ViewPat</span></a><span> </span><a name="local-6989586621680278746"><a href="#local-6989586621680278746"><span class="hs-identifier">lexpr</span></a></a><span> </span><a name="local-6989586621680278747"><a href="#local-6989586621680278747"><span class="hs-identifier">lpat</span></a></a><span> </span><a name="local-6989586621680278748"><a href="#local-6989586621680278748"><span class="hs-identifier">arg_ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-773"></a><span>    </span><a name="local-6989586621680278749"><a href="#local-6989586621680278749"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278747"><span class="hs-identifier hs-var">lpat</span></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>    </span><span class="hs-comment">-- See Note [Guards and Approximation]</span><span>
</span><a name="line-775"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Check.html#cantFailPattern"><span class="hs-identifier hs-var">cantFailPattern</span></a><span> </span><a href="#local-6989586621680278749"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-776"></a><span>      </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-777"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621680278750"><a href="#local-6989586621680278750"><span class="hs-identifier">xp</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278751"><a href="#local-6989586621680278751"><span class="hs-identifier">xe</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkPmId2Forms"><span class="hs-identifier hs-var">mkPmId2Forms</span></a><span> </span><a href="#local-6989586621680278748"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-778"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278752"><a href="#local-6989586621680278752"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#mkGuard"><span class="hs-identifier hs-var">mkGuard</span></a><span> </span><a href="#local-6989586621680278749"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsApp"><span class="hs-identifier hs-var">HsApp</span></a><span> </span><a href="#local-6989586621680278746"><span class="hs-identifier hs-var">lexpr</span></a><span> </span><a href="#local-6989586621680278751"><span class="hs-identifier hs-var">xe</span></a><span class="hs-special">)</span><span>
</span><a name="line-779"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278750"><span class="hs-identifier hs-var">xp</span></a><span class="hs-special">,</span><a href="#local-6989586621680278752"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">]</span><span>
</span><a name="line-780"></a><span>      </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#mkCanFailPmPat"><span class="hs-identifier hs-var">mkCanFailPmPat</span></a><span> </span><a href="#local-6989586621680278748"><span class="hs-identifier hs-var">arg_ty</span></a><span>
</span><a name="line-781"></a><span>
</span><a name="line-782"></a><span>  </span><span class="hs-comment">-- list</span><span>
</span><a name="line-783"></a><span>  </span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-6989586621680278753"><a href="#local-6989586621680278753"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680278754"><a href="#local-6989586621680278754"><span class="hs-identifier">ty</span></a></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-784"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#mkListPatVec"><span class="hs-identifier hs-var">mkListPatVec</span></a><span> </span><a href="#local-6989586621680278754"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Check.html#nilPattern"><span class="hs-identifier hs-var">nilPattern</span></a><span> </span><a href="#local-6989586621680278754"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-785"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#translatePatVec"><span class="hs-identifier hs-var">translatePatVec</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278753"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-786"></a><span>
</span><a name="line-787"></a><span>  </span><span class="hs-comment">-- overloaded list</span><span>
</span><a name="line-788"></a><span>  </span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a name="local-6989586621680278755"><a href="#local-6989586621680278755"><span class="hs-identifier">lpats</span></a></a><span> </span><a name="local-6989586621680278756"><a href="#local-6989586621680278756"><span class="hs-identifier">elem_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278757"><a href="#local-6989586621680278757"><span class="hs-identifier">pat_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278758"><a href="#local-6989586621680278758"><span class="hs-identifier">_to_list</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-789"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278759"><a href="#local-6989586621680278759"><span class="hs-identifier">e_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitListTyConApp_maybe"><span class="hs-identifier hs-var">splitListTyConApp_maybe</span></a><span> </span><a href="#local-6989586621680278757"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-790"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680278760"><a href="#local-6989586621680278760"><span class="hs-identifier">norm_elem_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="FamInstEnv.html#normaliseType"><span class="hs-identifier hs-var">normaliseType</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><a href="#local-6989586621680278756"><span class="hs-identifier hs-var">elem_ty</span></a><span>
</span><a name="line-791"></a><span>         </span><span class="hs-comment">-- elem_ty is frequently something like</span><span>
</span><a name="line-792"></a><span>         </span><span class="hs-comment">-- `Item [Int]`, but we prefer `Int`</span><span>
</span><a name="line-793"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278760"><span class="hs-identifier hs-var">norm_elem_ty</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680278759"><span class="hs-identifier hs-var">e_ty</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-794"></a><span>        </span><span class="hs-comment">-- We have to ensure that the element types are exactly the same.</span><span>
</span><a name="line-795"></a><span>        </span><span class="hs-comment">-- Otherwise, one may give an instance IsList [Int] (more specific than</span><span>
</span><a name="line-796"></a><span>        </span><span class="hs-comment">-- the default IsList [a]) with a different implementation for `toList'</span><span>
</span><a name="line-797"></a><span>        </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ListPat"><span class="hs-identifier hs-var">ListPat</span></a><span> </span><a href="#local-6989586621680278755"><span class="hs-identifier hs-var">lpats</span></a><span> </span><a href="#local-6989586621680278759"><span class="hs-identifier hs-var">e_ty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>
</span><a name="line-798"></a><span>      </span><span class="hs-comment">-- See Note [Guards and Approximation]</span><span>
</span><a name="line-799"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#mkCanFailPmPat"><span class="hs-identifier hs-var">mkCanFailPmPat</span></a><span> </span><a href="#local-6989586621680278757"><span class="hs-identifier hs-var">pat_ty</span></a><span>
</span><a name="line-800"></a><span>
</span><a name="line-801"></a><span>  </span><a href="HsPat.html#ConPatOut"><span class="hs-identifier hs-var">ConPatOut</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pat_con</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278761"><a href="#local-6989586621680278761"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-802"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278762"><a href="#local-6989586621680278762"><span class="hs-identifier">arg_tys</span></a></a><span>
</span><a name="line-803"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_tvs</span><span>     </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278763"><a href="#local-6989586621680278763"><span class="hs-identifier">ex_tvs</span></a></a><span>
</span><a name="line-804"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_dicts</span><span>   </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278764"><a href="#local-6989586621680278764"><span class="hs-identifier">dicts</span></a></a><span>
</span><a name="line-805"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pat_args</span><span>    </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278765"><a href="#local-6989586621680278765"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-806"></a><span>    </span><a name="local-6989586621680278766"><a href="#local-6989586621680278766"><span class="hs-identifier">groups</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#allCompleteMatches"><span class="hs-identifier hs-var">allCompleteMatches</span></a><span> </span><a href="#local-6989586621680278761"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621680278762"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-807"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278766"><span class="hs-identifier hs-var">groups</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-808"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#mkCanFailPmPat"><span class="hs-identifier hs-var">mkCanFailPmPat</span></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a><span> </span><a href="#local-6989586621680278761"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621680278762"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-809"></a><span>      </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-810"></a><span>        </span><a name="local-6989586621680278767"><a href="#local-6989586621680278767"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translateConPatVec"><span class="hs-identifier hs-var">translateConPatVec</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278762"><span class="hs-identifier hs-var">arg_tys</span></a><span> </span><a href="#local-6989586621680278763"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><a href="#local-6989586621680278761"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621680278765"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-811"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278761"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-812"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278762"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-813"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278763"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-814"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278764"><span class="hs-identifier hs-var">dicts</span></a><span>
</span><a name="line-815"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278767"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span>  </span><a href="HsPat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278768"><a href="#local-6989586621680278768"><span class="hs-identifier">ol</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278769"><a href="#local-6989586621680278769"><span class="hs-identifier">mb_neg</span></a></a><span> </span><a name="local-6989586621680278770"><a href="#local-6989586621680278770"><span class="hs-identifier">_eq</span></a></a><span> </span><a name="local-6989586621680278771"><a href="#local-6989586621680278771"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translateNPat"><span class="hs-identifier hs-var">translateNPat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278768"><span class="hs-identifier hs-var">ol</span></a><span> </span><a href="#local-6989586621680278769"><span class="hs-identifier hs-var">mb_neg</span></a><span> </span><a href="#local-6989586621680278771"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-818"></a><span>
</span><a name="line-819"></a><span>  </span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a name="local-6989586621680278772"><a href="#local-6989586621680278772"><span class="hs-identifier">lit</span></a></a><span>
</span><a name="line-820"></a><span>      </span><span class="hs-comment">-- If it is a string then convert it to a list of characters</span><span>
</span><a name="line-821"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><a name="local-6989586621680278773"><a href="#local-6989586621680278773"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680278774"><a href="#local-6989586621680278774"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278772"><span class="hs-identifier hs-var">lit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-822"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#mkListPatVec"><span class="hs-identifier hs-var">mkListPatVec</span></a><span> </span><a href="TysWiredIn.html#charTy"><span class="hs-identifier hs-var">charTy</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Check.html#nilPattern"><span class="hs-identifier hs-var">nilPattern</span></a><span> </span><a href="TysWiredIn.html#charTy"><span class="hs-identifier hs-var">charTy</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-823"></a><span>          </span><a href="Check.html#translatePatVec"><span class="hs-identifier hs-var">translatePatVec</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="HsLit.html#HsChar"><span class="hs-identifier hs-var">HsChar</span></a><span> </span><a href="#local-6989586621680278773"><span class="hs-identifier hs-var">src</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a><span> </span><a href="#local-6989586621680278774"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-824"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#mkLitPattern"><span class="hs-identifier hs-var">mkLitPattern</span></a><span> </span><a href="#local-6989586621680278772"><span class="hs-identifier hs-var">lit</span></a><span class="hs-special">]</span><span>
</span><a name="line-825"></a><span>
</span><a name="line-826"></a><span>  </span><a href="HsPat.html#PArrPat"><span class="hs-identifier hs-var">PArrPat</span></a><span> </span><a name="local-6989586621680278775"><a href="#local-6989586621680278775"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680278776"><a href="#local-6989586621680278776"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-827"></a><span>    </span><a name="local-6989586621680278777"><a href="#local-6989586621680278777"><span class="hs-identifier">tidy_ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePatVec"><span class="hs-identifier hs-var">translatePatVec</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278775"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-828"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278778"><a href="#local-6989586621680278778"><span class="hs-identifier">fake_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#parrFakeCon"><span class="hs-identifier hs-var">parrFakeCon</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621680278775"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-829"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#vanillaConPattern"><span class="hs-identifier hs-var">vanillaConPattern</span></a><span> </span><a href="#local-6989586621680278778"><span class="hs-identifier hs-var">fake_con</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278776"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="#local-6989586621680278777"><span class="hs-identifier hs-var">tidy_ps</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span>  </span><a href="HsPat.html#TuplePat"><span class="hs-identifier hs-var">TuplePat</span></a><span> </span><a name="local-6989586621680278779"><a href="#local-6989586621680278779"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680278780"><a href="#local-6989586621680278780"><span class="hs-identifier">boxity</span></a></a><span> </span><a name="local-6989586621680278781"><a href="#local-6989586621680278781"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-832"></a><span>    </span><a name="local-6989586621680278782"><a href="#local-6989586621680278782"><span class="hs-identifier">tidy_ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePatVec"><span class="hs-identifier hs-var">translatePatVec</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278779"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-833"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278783"><a href="#local-6989586621680278783"><span class="hs-identifier">tuple_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#tupleDataCon"><span class="hs-identifier hs-var">tupleDataCon</span></a><span> </span><a href="#local-6989586621680278780"><span class="hs-identifier hs-var">boxity</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621680278779"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-834"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#vanillaConPattern"><span class="hs-identifier hs-var">vanillaConPattern</span></a><span> </span><a href="#local-6989586621680278783"><span class="hs-identifier hs-var">tuple_con</span></a><span> </span><a href="#local-6989586621680278781"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="#local-6989586621680278782"><span class="hs-identifier hs-var">tidy_ps</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-835"></a><span>
</span><a name="line-836"></a><span>  </span><a href="HsPat.html#SumPat"><span class="hs-identifier hs-var">SumPat</span></a><span> </span><a name="local-6989586621680278784"><a href="#local-6989586621680278784"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621680278785"><a href="#local-6989586621680278785"><span class="hs-identifier">alt</span></a></a><span> </span><a name="local-6989586621680278786"><a href="#local-6989586621680278786"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621680278787"><a href="#local-6989586621680278787"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-837"></a><span>    </span><a name="local-6989586621680278788"><a href="#local-6989586621680278788"><span class="hs-identifier">tidy_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278719"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278784"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-838"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278789"><a href="#local-6989586621680278789"><span class="hs-identifier">sum_con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><span class="hs-special">(</span><a href="TysWiredIn.html#sumDataCon"><span class="hs-identifier hs-var">sumDataCon</span></a><span> </span><a href="#local-6989586621680278785"><span class="hs-identifier hs-var">alt</span></a><span> </span><a href="#local-6989586621680278786"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-839"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#vanillaConPattern"><span class="hs-identifier hs-var">vanillaConPattern</span></a><span> </span><a href="#local-6989586621680278789"><span class="hs-identifier hs-var">sum_con</span></a><span> </span><a href="#local-6989586621680278787"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680278788"><span class="hs-identifier hs-var">tidy_p</span></a><span class="hs-special">]</span><span>
</span><a name="line-840"></a><span>
</span><a name="line-841"></a><span>  </span><span class="hs-comment">-- --------------------------------------------------------------------------</span><span>
</span><a name="line-842"></a><span>  </span><span class="hs-comment">-- Not supposed to happen</span><span>
</span><a name="line-843"></a><span>  </span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span>  </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;Check.translatePat: ConPatIn&quot;</span><span>
</span><a name="line-844"></a><span>  </span><a href="HsPat.html#SplicePat"><span class="hs-identifier hs-var">SplicePat</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;Check.translatePat: SplicePat&quot;</span><span>
</span><a name="line-845"></a><span>  </span><a href="HsPat.html#SigPatIn"><span class="hs-identifier hs-var">SigPatIn</span></a><span>  </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;Check.translatePat: SigPatIn&quot;</span><span>
</span><a name="line-846"></a><span>
</span><a name="line-847"></a><span class="hs-comment">-- | Translate an overloaded literal (see `tidyNPat' in deSugar/MatchLit.hs)</span><span>
</span><a name="line-848"></a><span class="hs-identifier">translateNPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span>
</span><a name="line-849"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-850"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-851"></a><a name="translateNPat"><a href="Check.html#translateNPat"><span class="hs-identifier">translateNPat</span></a></a><span> </span><a name="local-6989586621680278790"><a href="#local-6989586621680278790"><span class="hs-identifier">fam_insts</span></a></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#OverLit"><span class="hs-identifier hs-var">OverLit</span></a><span> </span><a name="local-6989586621680278791"><a href="#local-6989586621680278791"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278792"><a href="#local-6989586621680278792"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278793"><a href="#local-6989586621680278793"><span class="hs-identifier">mb_neg</span></a></a><span> </span><a name="local-6989586621680278794"><a href="#local-6989586621680278794"><span class="hs-identifier">outer_ty</span></a></a><span>
</span><a name="line-852"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680278795"><span class="hs-identifier hs-var">type_change</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a><span> </span><a href="#local-6989586621680278792"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="HsLit.html#HsIsString"><span class="hs-identifier hs-var">HsIsString</span></a><span> </span><a name="local-6989586621680278796"><a href="#local-6989586621680278796"><span class="hs-identifier">src</span></a></a><span> </span><a name="local-6989586621680278797"><a href="#local-6989586621680278797"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278791"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278793"><span class="hs-identifier hs-var">mb_neg</span></a><span>
</span><a name="line-853"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278790"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><span class="hs-special">(</span><a href="HsLit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a><span> </span><a href="#local-6989586621680278796"><span class="hs-identifier hs-var">src</span></a><span> </span><a href="#local-6989586621680278797"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-854"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680278795"><span class="hs-identifier hs-var">type_change</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#isIntTy"><span class="hs-identifier hs-var">isIntTy</span></a><span>    </span><a href="#local-6989586621680278792"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span> </span><a name="local-6989586621680278798"><a href="#local-6989586621680278798"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278791"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-855"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278790"><span class="hs-identifier hs-var">fam_insts</span></a><span>
</span><a name="line-856"></a><span>                 </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278793"><span class="hs-identifier hs-var">mb_neg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-857"></a><span>                             </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><a href="HsExtension.html#def"><span class="hs-identifier hs-var">def</span></a><span> </span><a href="#local-6989586621680278798"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-858"></a><span>                             </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsInt"><span class="hs-identifier hs-var">HsInt</span></a><span> </span><a href="HsExtension.html#def"><span class="hs-identifier hs-var">def</span></a><span> </span><span class="hs-special">(</span><a href="BasicTypes.html#negateIntegralLit"><span class="hs-identifier hs-var">negateIntegralLit</span></a><span> </span><a href="#local-6989586621680278798"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-859"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680278795"><span class="hs-identifier hs-var">type_change</span></a><span class="hs-special">,</span><span> </span><a href="TcType.html#isWordTy"><span class="hs-identifier hs-var">isWordTy</span></a><span>   </span><a href="#local-6989586621680278792"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="HsLit.html#HsIntegral"><span class="hs-identifier hs-var">HsIntegral</span></a><span> </span><a name="local-6989586621680278799"><a href="#local-6989586621680278799"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278791"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-860"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278790"><span class="hs-identifier hs-var">fam_insts</span></a><span>
</span><a name="line-861"></a><span>                 </span><span class="hs-special">(</span><a href="HsPat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278793"><span class="hs-identifier hs-var">mb_neg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-862"></a><span>                             </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsLit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">il_text</span><span> </span><a href="#local-6989586621680278799"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">il_value</span><span> </span><a href="#local-6989586621680278799"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-863"></a><span>                             </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278800"><a href="#local-6989586621680278800"><span class="hs-identifier">ni</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#negateIntegralLit"><span class="hs-identifier hs-var">negateIntegralLit</span></a><span> </span><a href="#local-6989586621680278799"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-864"></a><span>                                        </span><a href="HsLit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">il_text</span><span> </span><a href="#local-6989586621680278800"><span class="hs-identifier hs-var">ni</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">il_value</span><span> </span><a href="#local-6989586621680278800"><span class="hs-identifier hs-var">ni</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-866"></a><span>    </span><a name="local-6989586621680278795"><a href="#local-6989586621680278795"><span class="hs-identifier">type_change</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278794"><span class="hs-identifier hs-var">outer_ty</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680278792"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-867"></a><span>
</span><a name="line-868"></a><span class="hs-identifier">translateNPat</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278801"><a href="#local-6989586621680278801"><span class="hs-identifier">ol</span></a></a><span> </span><a name="local-6989586621680278802"><a href="#local-6989586621680278802"><span class="hs-identifier">mb_neg</span></a></a><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-869"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#PmOLit"><span class="hs-identifier hs-var">PmOLit</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="#local-6989586621680278802"><span class="hs-identifier hs-var">mb_neg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278801"><span class="hs-identifier hs-var">ol</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-870"></a><span>
</span><a name="line-871"></a><span class="hs-comment">-- | Translate a list of patterns (Note: each pattern is translated</span><span>
</span><a name="line-872"></a><span class="hs-comment">-- to a pattern vector but we do not concatenate the results).</span><span>
</span><a name="line-873"></a><span class="hs-identifier">translatePatVec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span>
</span><a name="line-874"></a><a name="translatePatVec"><a href="Check.html#translatePatVec"><span class="hs-identifier">translatePatVec</span></a></a><span> </span><a name="local-6989586621680278803"><a href="#local-6989586621680278803"><span class="hs-identifier">fam_insts</span></a></a><span> </span><a name="local-6989586621680278804"><a href="#local-6989586621680278804"><span class="hs-identifier">pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278803"><span class="hs-identifier hs-var">fam_insts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278804"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-875"></a><span>
</span><a name="line-876"></a><span class="hs-comment">-- | Translate a constructor pattern</span><span>
</span><a name="line-877"></a><span class="hs-identifier">translateConPatVec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-878"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#HsConPatDetails"><span class="hs-identifier hs-type">HsConPatDetails</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-879"></a><a name="translateConPatVec"><a href="Check.html#translateConPatVec"><span class="hs-identifier">translateConPatVec</span></a></a><span> </span><a name="local-6989586621680278805"><a href="#local-6989586621680278805"><span class="hs-identifier">fam_insts</span></a></a><span> </span><a name="local-6989586621680278806"><a href="#local-6989586621680278806"><span class="hs-identifier">_univ_tys</span></a></a><span> </span><a name="local-6989586621680278807"><a href="#local-6989586621680278807"><span class="hs-identifier">_ex_tvs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#PrefixCon"><span class="hs-identifier hs-var">PrefixCon</span></a><span> </span><a name="local-6989586621680278808"><a href="#local-6989586621680278808"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-880"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#translatePatVec"><span class="hs-identifier hs-var">translatePatVec</span></a><span> </span><a href="#local-6989586621680278805"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278808"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-881"></a><span class="hs-identifier">translateConPatVec</span><span> </span><a name="local-6989586621680278809"><a href="#local-6989586621680278809"><span class="hs-identifier">fam_insts</span></a></a><span> </span><a name="local-6989586621680278810"><a href="#local-6989586621680278810"><span class="hs-identifier">_univ_tys</span></a></a><span> </span><a name="local-6989586621680278811"><a href="#local-6989586621680278811"><span class="hs-identifier">_ex_tvs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621680278812"><a href="#local-6989586621680278812"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621680278813"><a href="#local-6989586621680278813"><span class="hs-identifier">p2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-882"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#translatePatVec"><span class="hs-identifier hs-var">translatePatVec</span></a><span> </span><a href="#local-6989586621680278809"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278812"><span class="hs-identifier hs-var">p1</span></a><span class="hs-special">,</span><a href="#local-6989586621680278813"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-883"></a><span class="hs-identifier">translateConPatVec</span><span> </span><a name="local-6989586621680278814"><a href="#local-6989586621680278814"><span class="hs-identifier">fam_insts</span></a></a><span>  </span><a name="local-6989586621680278815"><a href="#local-6989586621680278815"><span class="hs-identifier">univ_tys</span></a></a><span>  </span><a name="local-6989586621680278816"><a href="#local-6989586621680278816"><span class="hs-identifier">ex_tvs</span></a></a><span> </span><a name="local-6989586621680278817"><a href="#local-6989586621680278817"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#RecCon"><span class="hs-identifier hs-var">RecCon</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#HsRecFields"><span class="hs-identifier hs-var">HsRecFields</span></a><span> </span><a name="local-6989586621680278818"><a href="#local-6989586621680278818"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-884"></a><span>    </span><span class="hs-comment">-- Nothing matched. Make up some fresh term variables</span><span>
</span><a name="line-885"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278818"><span class="hs-identifier hs-var">fs</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#mkPmVars"><span class="hs-identifier hs-var">mkPmVars</span></a><span> </span><a href="#local-6989586621680278819"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-886"></a><span>    </span><span class="hs-comment">-- The data constructor was not defined using record syntax. For the</span><span>
</span><a name="line-887"></a><span>    </span><span class="hs-comment">-- pattern to be in record syntax it should be empty (e.g. Just {}).</span><span>
</span><a name="line-888"></a><span>    </span><span class="hs-comment">-- So just like the previous case.</span><span>
</span><a name="line-889"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278820"><span class="hs-identifier hs-var">orig_lbls</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">matched_lbls</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278822"><span class="hs-identifier hs-var">mkPmVars</span></a><span> </span><span class="hs-identifier">arg_tys</span><span>
</span><a name="line-890"></a><span>    </span><span class="hs-comment">-- Some of the fields appear, in the original order (there may be holes).</span><span>
</span><a name="line-891"></a><span>    </span><span class="hs-comment">-- Generate a simple constructor pattern and make up fresh variables for</span><span>
</span><a name="line-892"></a><span>    </span><span class="hs-comment">-- the rest of the fields</span><span>
</span><a name="line-893"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680278822"><span class="hs-identifier hs-var">matched_lbls</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621680278823"><span class="hs-identifier hs-var">subsetOf</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680278820"><span class="hs-identifier hs-var">orig_lbls</span></a><span>
</span><a name="line-894"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">orig_lbls</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><a href="Util.html#equalLength"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-895"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278832"><a href="#local-6989586621680278832"><span class="hs-identifier">translateOne</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278833"><a href="#local-6989586621680278833"><span class="hs-identifier">lbl</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278834"><a href="#local-6989586621680278834"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621680278833"><span class="hs-identifier hs-var">lbl</span></a><span> </span><a href="#local-6989586621680278821"><span class="hs-identifier hs-var">matched_pats</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-896"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278835"><a href="#local-6989586621680278835"><span class="hs-identifier">p</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278814"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278835"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-897"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#mkPmVars"><span class="hs-identifier hs-var">mkPmVars</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278834"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">]</span><span>
</span><a name="line-898"></a><span>      </span><span class="hs-keyword">in</span><span>  </span><a href="MonadUtils.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a><span> </span><a href="#local-6989586621680278832"><span class="hs-identifier hs-var">translateOne</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-6989586621680278820"><span class="hs-identifier hs-var">orig_lbls</span></a><span> </span><a href="#local-6989586621680278819"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>    </span><span class="hs-comment">-- The fields that appear are not in the correct order. Make up fresh</span><span>
</span><a name="line-900"></a><span>    </span><span class="hs-comment">-- variables for all fields and add guards after matching, to force the</span><span>
</span><a name="line-901"></a><span>    </span><span class="hs-comment">-- evaluation in the correct order.</span><span>
</span><a name="line-902"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-903"></a><span>      </span><a name="local-6989586621680278836"><a href="#local-6989586621680278836"><span class="hs-identifier">arg_var_pats</span></a></a><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkPmVars"><span class="hs-identifier hs-var">mkPmVars</span></a><span> </span><a href="#local-6989586621680278819"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-904"></a><span>      </span><a name="local-6989586621680278840"><a href="#local-6989586621680278840"><span class="hs-identifier">translated_pats</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a><span> </span><a href="#local-6989586621680278821"><span class="hs-identifier hs-var">matched_pats</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680278837"><a href="#local-6989586621680278837"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278838"><a href="#local-6989586621680278838"><span class="hs-identifier">pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-905"></a><span>        </span><a name="local-6989586621680278839"><a href="#local-6989586621680278839"><span class="hs-identifier">pvec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278814"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278838"><span class="hs-identifier hs-var">pat</span></a><span>
</span><a name="line-906"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278837"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278839"><span class="hs-identifier hs-var">pvec</span></a><span class="hs-special">)</span><span>
</span><a name="line-907"></a><span>
</span><a name="line-908"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278841"><a href="#local-6989586621680278841"><span class="hs-identifier">zipped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-6989586621680278820"><span class="hs-identifier hs-var">orig_lbls</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680278843"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a name="local-6989586621680278843"><a href="#local-6989586621680278843"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278836"><span class="hs-identifier hs-var">arg_var_pats</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-909"></a><span>          </span><a name="local-6989586621680278842"><a href="#local-6989586621680278842"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680278844"><a href="#local-6989586621680278844"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><a name="local-6989586621680278845"><a href="#local-6989586621680278845"><span class="hs-identifier">pvec</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621680278844"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680278841"><span class="hs-identifier hs-var">zipped</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-910"></a><span>                            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278846"><a href="#local-6989586621680278846"><span class="hs-identifier">x</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><a href="#local-6989586621680278845"><span class="hs-identifier hs-var">pvec</span></a><span> </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680278846"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-911"></a><span>                            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;translateConPatVec: lookup&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-912"></a><span>                       </span><a href="#local-6989586621680278840"><span class="hs-identifier hs-var">translated_pats</span></a><span>
</span><a name="line-913"></a><span>
</span><a name="line-914"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278836"><span class="hs-identifier hs-var">arg_var_pats</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680278842"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span>
</span><a name="line-915"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-916"></a><span>    </span><span class="hs-comment">-- The actual argument types (instantiated)</span><span>
</span><a name="line-917"></a><span>    </span><a name="local-6989586621680278819"><a href="#local-6989586621680278819"><span class="hs-identifier">arg_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#conLikeInstOrigArgTys"><span class="hs-identifier hs-var">conLikeInstOrigArgTys</span></a><span> </span><a href="#local-6989586621680278817"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278815"><span class="hs-identifier hs-var">univ_tys</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span> </span><a href="#local-6989586621680278816"><span class="hs-identifier hs-var">ex_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span>    </span><span class="hs-comment">-- Some label information</span><span>
</span><a name="line-920"></a><span>    </span><a name="local-6989586621680278820"><a href="#local-6989586621680278820"><span class="hs-identifier">orig_lbls</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-identifier">flSelector</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="ConLike.html#conLikeFieldLabels"><span class="hs-identifier hs-var">conLikeFieldLabels</span></a><span> </span><a href="#local-6989586621680278817"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-921"></a><span>    </span><a name="local-6989586621680278821"><a href="#local-6989586621680278821"><span class="hs-identifier">matched_pats</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#hsRecFieldId"><span class="hs-identifier hs-var">hsRecFieldId</span></a><span> </span><a href="#local-6989586621680278825"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">hsRecFieldArg</span><span> </span><a href="#local-6989586621680278825"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-922"></a><span>                   </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278825"><a href="#local-6989586621680278825"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278818"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">]</span><span>
</span><a name="line-923"></a><span>    </span><a name="local-6989586621680278822"><a href="#local-6989586621680278822"><span class="hs-identifier">matched_lbls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680278826"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278826"><a href="#local-6989586621680278826"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278827"><a href="#local-6989586621680278827"><span class="hs-identifier">_pat</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278821"><span class="hs-identifier hs-var">matched_pats</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-924"></a><span>
</span><a name="line-925"></a><span>    </span><span class="hs-identifier">subsetOf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680278824"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278824"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278824"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-926"></a><span>    </span><a name="local-6989586621680278823"><a href="#local-6989586621680278823"><span class="hs-identifier">subsetOf</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-927"></a><span>    </span><span class="hs-identifier">subsetOf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-928"></a><span>    </span><span class="hs-identifier">subsetOf</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278828"><a href="#local-6989586621680278828"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680278829"><a href="#local-6989586621680278829"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278830"><a href="#local-6989586621680278830"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680278831"><a href="#local-6989586621680278831"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-929"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680278828"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680278830"><span class="hs-identifier hs-var">y</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278823"><span class="hs-identifier hs-var">subsetOf</span></a><span>    </span><a href="#local-6989586621680278829"><span class="hs-identifier hs-var">xs</span></a><span>  </span><a href="#local-6989586621680278831"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-930"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278823"><span class="hs-identifier hs-var">subsetOf</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278828"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680278829"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278831"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span class="hs-comment">-- Translate a single match</span><span>
</span><a name="line-933"></a><span class="hs-identifier">translateMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LMatch"><span class="hs-identifier hs-type">LMatch</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span>
</span><a name="line-934"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-935"></a><a name="translateMatch"><a href="Check.html#translateMatch"><span class="hs-identifier">translateMatch</span></a></a><span> </span><a name="local-6989586621680278847"><a href="#local-6989586621680278847"><span class="hs-identifier">fam_insts</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278848"><a href="#local-6989586621680278848"><span class="hs-identifier">lpats</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">m_grhss</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278849"><a href="#local-6989586621680278849"><span class="hs-identifier">grhss</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-936"></a><span>  </span><a name="local-6989586621680278854"><a href="#local-6989586621680278854"><span class="hs-identifier">pats'</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#translatePatVec"><span class="hs-identifier hs-var">translatePatVec</span></a><span> </span><a href="#local-6989586621680278847"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278851"><span class="hs-identifier hs-var">pats</span></a><span>
</span><a name="line-937"></a><span>  </span><a name="local-6989586621680278855"><a href="#local-6989586621680278855"><span class="hs-identifier">guards'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#translateGuards"><span class="hs-identifier hs-var">translateGuards</span></a><span> </span><a href="#local-6989586621680278847"><span class="hs-identifier hs-var">fam_insts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278852"><span class="hs-identifier hs-var">guards</span></a><span>
</span><a name="line-938"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278854"><span class="hs-identifier hs-var">pats'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278855"><span class="hs-identifier hs-var">guards'</span></a><span class="hs-special">)</span><span>
</span><a name="line-939"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-940"></a><span>    </span><span class="hs-identifier">extractGuards</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LGRHS"><span class="hs-identifier hs-type">LGRHS</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#GuardStmt"><span class="hs-identifier hs-type">GuardStmt</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span>
</span><a name="line-941"></a><span>    </span><a name="local-6989586621680278850"><a href="#local-6989586621680278850"><span class="hs-identifier">extractGuards</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#GRHS"><span class="hs-identifier hs-var">GRHS</span></a><span> </span><a name="local-6989586621680278853"><a href="#local-6989586621680278853"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278853"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-942"></a><span>
</span><a name="line-943"></a><span>    </span><a name="local-6989586621680278851"><a href="#local-6989586621680278851"><span class="hs-identifier">pats</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278848"><span class="hs-identifier hs-var">lpats</span></a><span>
</span><a name="line-944"></a><span>    </span><a name="local-6989586621680278852"><a href="#local-6989586621680278852"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621680278850"><span class="hs-identifier hs-var">extractGuards</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">grhssGRHSs</span><span> </span><a href="#local-6989586621680278849"><span class="hs-identifier hs-var">grhss</span></a><span class="hs-special">)</span><span>
</span><a name="line-945"></a><span>
</span><a name="line-946"></a><span class="hs-comment">-- -----------------------------------------------------------------------</span><span>
</span><a name="line-947"></a><span class="hs-comment">-- * Transform source guards (GuardStmt Id) to PmPats (Pattern)</span><span>
</span><a name="line-948"></a><span>
</span><a name="line-949"></a><span class="hs-comment">-- | Translate a list of guard statements to a pattern vector</span><span>
</span><a name="line-950"></a><span class="hs-identifier">translateGuards</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsExpr.html#GuardStmt"><span class="hs-identifier hs-type">GuardStmt</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-951"></a><a name="translateGuards"><a href="Check.html#translateGuards"><span class="hs-identifier">translateGuards</span></a></a><span> </span><a name="local-6989586621680278856"><a href="#local-6989586621680278856"><span class="hs-identifier">fam_insts</span></a></a><span> </span><a name="local-6989586621680278857"><a href="#local-6989586621680278857"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-952"></a><span>  </span><a name="local-6989586621680278868"><a href="#local-6989586621680278868"><span class="hs-identifier">all_guards</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#translateGuard"><span class="hs-identifier hs-var">translateGuard</span></a><span> </span><a href="#local-6989586621680278856"><span class="hs-identifier hs-var">fam_insts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278857"><span class="hs-identifier hs-var">guards</span></a><span>
</span><a name="line-953"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278858"><span class="hs-identifier hs-var">replace_unhandled</span></a><span> </span><a href="#local-6989586621680278868"><span class="hs-identifier hs-var">all_guards</span></a><span class="hs-special">)</span><span>
</span><a name="line-954"></a><span>  </span><span class="hs-comment">-- It should have been (return all_guards) but it is too expressive.</span><span>
</span><a name="line-955"></a><span>  </span><span class="hs-comment">-- Since the term oracle does not handle all constraints we generate,</span><span>
</span><a name="line-956"></a><span>  </span><span class="hs-comment">-- we (hackily) replace all constraints the oracle cannot handle with a</span><span>
</span><a name="line-957"></a><span>  </span><span class="hs-comment">-- single one (we need to know if there is a possibility of falure).</span><span>
</span><a name="line-958"></a><span>  </span><span class="hs-comment">-- See Note [Guards and Approximation] for all guard-related approximations</span><span>
</span><a name="line-959"></a><span>  </span><span class="hs-comment">-- we implement.</span><span>
</span><a name="line-960"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-961"></a><span>    </span><span class="hs-identifier">replace_unhandled</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-962"></a><span>    </span><a name="local-6989586621680278858"><a href="#local-6989586621680278858"><span class="hs-identifier">replace_unhandled</span></a></a><span> </span><a name="local-6989586621680278861"><a href="#local-6989586621680278861"><span class="hs-identifier">gv</span></a></a><span>
</span><a name="line-963"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680278859"><span class="hs-identifier hs-var">any_unhandled</span></a><span> </span><a href="#local-6989586621680278861"><span class="hs-identifier hs-var">gv</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#fake_pat"><span class="hs-identifier hs-var">fake_pat</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621680278862"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621680278862"><a href="#local-6989586621680278862"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278861"><span class="hs-identifier hs-var">gv</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278860"><span class="hs-identifier hs-var">shouldKeep</span></a><span> </span><a href="#local-6989586621680278862"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-964"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278861"><span class="hs-identifier hs-var">gv</span></a><span>
</span><a name="line-965"></a><span>
</span><a name="line-966"></a><span>    </span><span class="hs-identifier">any_unhandled</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-967"></a><span>    </span><a name="local-6989586621680278859"><a href="#local-6989586621680278859"><span class="hs-identifier">any_unhandled</span></a></a><span> </span><a name="local-6989586621680278863"><a href="#local-6989586621680278863"><span class="hs-identifier">gv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621680278860"><span class="hs-identifier hs-var">shouldKeep</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278863"><span class="hs-identifier hs-var">gv</span></a><span>
</span><a name="line-968"></a><span>
</span><a name="line-969"></a><span>    </span><span class="hs-identifier">shouldKeep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-970"></a><span>    </span><a name="local-6989586621680278860"><a href="#local-6989586621680278860"><span class="hs-identifier">shouldKeep</span></a></a><span> </span><a name="local-6989586621680278864"><a href="#local-6989586621680278864"><span class="hs-identifier">p</span></a></a><span>
</span><a name="line-971"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278864"><span class="hs-identifier hs-var">p</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-972"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278864"><span class="hs-identifier hs-var">p</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#singleConstructor"><span class="hs-identifier hs-var">singleConstructor</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pm_con_con</span><span> </span><a href="#local-6989586621680278864"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-973"></a><span>                             </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="#local-6989586621680278860"><span class="hs-identifier hs-var">shouldKeep</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pm_con_args</span><span> </span><a href="#local-6989586621680278864"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-974"></a><span>    </span><span class="hs-identifier">shouldKeep</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><a name="local-6989586621680278865"><a href="#local-6989586621680278865"><span class="hs-identifier">pv</span></a></a><span> </span><a name="local-6989586621680278866"><a href="#local-6989586621680278866"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-975"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="#local-6989586621680278860"><span class="hs-identifier hs-var">shouldKeep</span></a><span> </span><a href="#local-6989586621680278865"><span class="hs-identifier hs-var">pv</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-976"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="PmExpr.html#isNotPmExprOther"><span class="hs-identifier hs-var">isNotPmExprOther</span></a><span> </span><a href="#local-6989586621680278866"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-comment">-- expensive but we want it</span><span>
</span><a name="line-977"></a><span>    </span><span class="hs-identifier">shouldKeep</span><span> </span><a name="local-6989586621680278867"><a href="#local-6989586621680278867"><span class="hs-identifier">_other_pat</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-comment">-- let the rest..</span><span>
</span><a name="line-978"></a><span>
</span><a name="line-979"></a><span class="hs-comment">-- | Check whether a pattern can fail to match</span><span>
</span><a name="line-980"></a><span class="hs-identifier">cantFailPattern</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-981"></a><a name="cantFailPattern"><a href="Check.html#cantFailPattern"><span class="hs-identifier">cantFailPattern</span></a></a><span> </span><a name="local-6989586621680278869"><a href="#local-6989586621680278869"><span class="hs-identifier">p</span></a></a><span>
</span><a name="line-982"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278869"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-983"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278869"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#singleConstructor"><span class="hs-identifier hs-var">singleConstructor</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pm_con_con</span><span> </span><a href="#local-6989586621680278869"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-984"></a><span>                    </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Check.html#cantFailPattern"><span class="hs-identifier hs-var">cantFailPattern</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pm_con_args</span><span> </span><a href="#local-6989586621680278869"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-985"></a><span class="hs-identifier">cantFailPattern</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><a name="local-6989586621680278870"><a href="#local-6989586621680278870"><span class="hs-identifier">pv</span></a></a><span> </span><a name="local-6989586621680278871"><a href="#local-6989586621680278871"><span class="hs-identifier">_e</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-986"></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Check.html#cantFailPattern"><span class="hs-identifier hs-var">cantFailPattern</span></a><span> </span><a href="#local-6989586621680278870"><span class="hs-identifier hs-var">pv</span></a><span>
</span><a name="line-987"></a><span class="hs-identifier">cantFailPattern</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-988"></a><span>
</span><a name="line-989"></a><span class="hs-comment">-- | Translate a guard statement to Pattern</span><span>
</span><a name="line-990"></a><span class="hs-identifier">translateGuard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#GuardStmt"><span class="hs-identifier hs-type">GuardStmt</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-991"></a><a name="translateGuard"><a href="Check.html#translateGuard"><span class="hs-identifier">translateGuard</span></a></a><span> </span><a name="local-6989586621680278872"><a href="#local-6989586621680278872"><span class="hs-identifier">fam_insts</span></a></a><span> </span><a name="local-6989586621680278873"><a href="#local-6989586621680278873"><span class="hs-identifier">guard</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278873"><span class="hs-identifier hs-var">guard</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-992"></a><span>  </span><a href="HsExpr.html#BodyStmt"><span class="hs-identifier hs-var">BodyStmt</span></a><span>   </span><a name="local-6989586621680278874"><a href="#local-6989586621680278874"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translateBoolGuard"><span class="hs-identifier hs-var">translateBoolGuard</span></a><span> </span><a href="#local-6989586621680278874"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-993"></a><span>  </span><a href="HsExpr.html#LetStmt"><span class="hs-identifier hs-var">LetStmt</span></a><span>      </span><a name="local-6989586621680278875"><a href="#local-6989586621680278875"><span class="hs-identifier">binds</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translateLet"><span class="hs-identifier hs-var">translateLet</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278875"><span class="hs-identifier hs-var">binds</span></a><span class="hs-special">)</span><span>
</span><a name="line-994"></a><span>  </span><a href="HsExpr.html#BindStmt"><span class="hs-identifier hs-var">BindStmt</span></a><span> </span><a name="local-6989586621680278876"><a href="#local-6989586621680278876"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621680278877"><a href="#local-6989586621680278877"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#translateBind"><span class="hs-identifier hs-var">translateBind</span></a><span> </span><a href="#local-6989586621680278872"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278876"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680278877"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-995"></a><span>  </span><a href="HsExpr.html#LastStmt"><span class="hs-identifier hs-var">LastStmt</span></a><span>        </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;translateGuard LastStmt&quot;</span><span>
</span><a name="line-996"></a><span>  </span><a href="HsExpr.html#ParStmt"><span class="hs-identifier hs-var">ParStmt</span></a><span>         </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;translateGuard ParStmt&quot;</span><span>
</span><a name="line-997"></a><span>  </span><a href="HsExpr.html#TransStmt"><span class="hs-identifier hs-var">TransStmt</span></a><span>       </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;translateGuard TransStmt&quot;</span><span>
</span><a name="line-998"></a><span>  </span><a href="HsExpr.html#RecStmt"><span class="hs-identifier hs-var">RecStmt</span></a><span>         </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;translateGuard RecStmt&quot;</span><span>
</span><a name="line-999"></a><span>  </span><a href="HsExpr.html#ApplicativeStmt"><span class="hs-identifier hs-var">ApplicativeStmt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;translateGuard ApplicativeLastStmt&quot;</span><span>
</span><a name="line-1000"></a><span>
</span><a name="line-1001"></a><span class="hs-comment">-- | Translate let-bindings</span><span>
</span><a name="line-1002"></a><span class="hs-identifier">translateLet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsBinds.html#HsLocalBinds"><span class="hs-identifier hs-type">HsLocalBinds</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-1003"></a><a name="translateLet"><a href="Check.html#translateLet"><span class="hs-identifier">translateLet</span></a></a><span> </span><a name="local-6989586621680278878"><a href="#local-6989586621680278878"><span class="hs-identifier">_binds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1004"></a><span>
</span><a name="line-1005"></a><span class="hs-comment">-- | Translate a pattern guard</span><span>
</span><a name="line-1006"></a><span class="hs-identifier">translateBind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-1007"></a><a name="translateBind"><a href="Check.html#translateBind"><span class="hs-identifier">translateBind</span></a></a><span> </span><a name="local-6989586621680278879"><a href="#local-6989586621680278879"><span class="hs-identifier">fam_insts</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680278880"><a href="#local-6989586621680278880"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278881"><a href="#local-6989586621680278881"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1008"></a><span>  </span><a name="local-6989586621680278882"><a href="#local-6989586621680278882"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680278879"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680278880"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1009"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#mkGuard"><span class="hs-identifier hs-var">mkGuard</span></a><span> </span><a href="#local-6989586621680278882"><span class="hs-identifier hs-var">ps</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278881"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1010"></a><span>
</span><a name="line-1011"></a><span class="hs-comment">-- | Translate a boolean guard</span><span>
</span><a name="line-1012"></a><span class="hs-identifier">translateBoolGuard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-1013"></a><a name="translateBoolGuard"><a href="Check.html#translateBoolGuard"><span class="hs-identifier">translateBoolGuard</span></a></a><span> </span><a name="local-6989586621680278883"><a href="#local-6989586621680278883"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-1014"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><span class="hs-special">(</span><a href="DsGRHSs.html#isTrueLHsExpr"><span class="hs-identifier hs-var">isTrueLHsExpr</span></a><span> </span><a href="#local-6989586621680278883"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1015"></a><span>    </span><span class="hs-comment">-- The formal thing to do would be to generate (True &lt;- True)</span><span>
</span><a name="line-1016"></a><span>    </span><span class="hs-comment">-- but it is trivial to solve so instead we give back an empty</span><span>
</span><a name="line-1017"></a><span>    </span><span class="hs-comment">-- PatVec for efficiency</span><span>
</span><a name="line-1018"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#mkGuard"><span class="hs-identifier hs-var">mkGuard</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#truePattern"><span class="hs-identifier hs-var">truePattern</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680278883"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1019"></a><span>
</span><a name="line-1020"></a><span class="hs-comment">{- Note [Guards and Approximation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Even if the algorithm is really expressive, the term oracle we use is not.
Hence, several features are not translated *properly* but we approximate.
The list includes:

1. View Patterns
----------------
A view pattern @(f -&gt; p)@ should be translated to @x (p &lt;- f x)@. The term
oracle does not handle function applications so we know that the generated
constraints will not be handled at the end. Hence, we distinguish between two
cases:
  a) Pattern @p@ cannot fail. Then this is just a binding and we do the *right
     thing*.
  b) Pattern @p@ can fail. This means that when checking the guard, we will
     generate several cases, with no useful information. E.g.:

       h (f -&gt; [a,b]) = ...
       h x ([a,b] &lt;- f x) = ...

       uncovered set = { [x |&gt; { False ~ (f x ~ [])            }]
                       , [x |&gt; { False ~ (f x ~ (t1:[]))       }]
                       , [x |&gt; { False ~ (f x ~ (t1:t2:t3:t4)) }] }

     So we have two problems:
       1) Since we do not print the constraints in the general case (they may
          be too many), the warning will look like this:

            Pattern match(es) are non-exhaustive
            In an equation for `h':
                Patterns not matched:
                    _
                    _
                    _
          Which is not short and not more useful than a single underscore.
       2) The size of the uncovered set increases a lot, without gaining more
          expressivity in our warnings.

     Hence, in this case, we replace the guard @([a,b] &lt;- f x)@ with a *dummy*
     @fake_pat@: @True &lt;- _@. That is, we record that there is a possibility
     of failure but we minimize it to a True/False. This generates a single
     warning and much smaller uncovered sets.

2. Overloaded Lists
-------------------
An overloaded list @[...]@ should be translated to @x ([...] &lt;- toList x)@. The
problem is exactly like above, as its solution. For future reference, the code
below is the *right thing to do*:

   ListPat lpats elem_ty (Just (pat_ty, to_list))
     otherwise -&gt; do
       (xp, xe) &lt;- mkPmId2Forms pat_ty
       ps       &lt;- translatePatVec (map unLoc lpats)
       let pats = foldr (mkListPatVec elem_ty) [nilPattern elem_ty] ps
           g    = mkGuard pats (HsApp (noLoc to_list) xe)
       return [xp,g]

3. Overloaded Literals
----------------------
The case with literals is a bit different. a literal @l@ should be translated
to @x (True &lt;- x == from l)@. Since we want to have better warnings for
overloaded literals as it is a very common feature, we treat them differently.
They are mainly covered in Note [Undecidable Equality on Overloaded Literals]
in PmExpr.

4. N+K Patterns &amp; Pattern Synonyms
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
An n+k pattern (n+k) should be translated to @x (True &lt;- x &gt;= k) (n &lt;- x-k)@.
Since the only pattern of the three that causes failure is guard @(n &lt;- x-k)@,
and has two possible outcomes. Hence, there is no benefit in using a dummy and
we implement the proper thing. Pattern synonyms are simply not implemented yet.
Hence, to be conservative, we generate a dummy pattern, assuming that the
pattern can fail.

5. Actual Guards
----------------
During translation, boolean guards and pattern guards are translated properly.
Let bindings though are omitted by function @translateLet@. Since they are lazy
bindings, we do not actually want to generate a (strict) equality (like we do
in the pattern bind case). Hence, we safely drop them.

Additionally, top-level guard translation (performed by @translateGuards@)
replaces guards that cannot be reasoned about (like the ones we described in
1-4) with a single @fake_pat@ to record the possibility of failure to match.

Note [Translate CoPats]
~~~~~~~~~~~~~~~~~~~~~~~
The pattern match checker did not know how to handle coerced patterns `CoPat`
efficiently, which gave rise to #11276. The original approach translated
`CoPat`s:

    pat |&gt; co    ===&gt;    x (pat &lt;- (e |&gt; co))

Instead, we now check whether the coercion is a hole or if it is just refl, in
which case we can drop it. Unfortunately, data families generate useful
coercions so guards are still generated in these cases and checking data
families is not really efficient.

%************************************************************************
%*                                                                      *
                 Utilities for Pattern Match Checking
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-1124"></a><span>
</span><a name="line-1125"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1126"></a><span class="hs-comment">-- * Basic utilities</span><span>
</span><a name="line-1127"></a><span>
</span><a name="line-1128"></a><span class="hs-comment">-- | Get the type out of a PmPat. For guard patterns (ps &lt;- e) we use the type</span><span>
</span><a name="line-1129"></a><span class="hs-comment">-- of the first (or the single -WHEREVER IT IS- valid to use?) pattern</span><span>
</span><a name="line-1130"></a><span class="hs-identifier">pmPatType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><a href="#local-6989586621680278532"><span class="hs-identifier hs-type">p</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1131"></a><a name="pmPatType"><a href="Check.html#pmPatType"><span class="hs-identifier">pmPatType</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278884"><a href="#local-6989586621680278884"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278885"><a href="#local-6989586621680278885"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1132"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a><span> </span><a href="#local-6989586621680278884"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621680278885"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1133"></a><span class="hs-identifier">pmPatType</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_var_id</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278886"><a href="#local-6989586621680278886"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621680278886"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1134"></a><span class="hs-identifier">pmPatType</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278887"><a href="#local-6989586621680278887"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TmOracle.html#pmLitType"><span class="hs-identifier hs-var">pmLitType</span></a><span> </span><a href="#local-6989586621680278887"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1135"></a><span class="hs-identifier">pmPatType</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmNLit"><span class="hs-identifier hs-var">PmNLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_id</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278888"><a href="#local-6989586621680278888"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621680278888"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1136"></a><span class="hs-identifier">pmPatType</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_grd_pv</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278889"><a href="#local-6989586621680278889"><span class="hs-identifier">pv</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1137"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">patVecArity</span><span> </span><span class="hs-identifier">pv</span><span> </span><a href="Check.html#patVecArity"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pmPatType</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-1138"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278890"><a href="#local-6989586621680278890"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Check.html#patternArity"><span class="hs-identifier hs-var">patternArity</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278889"><span class="hs-identifier hs-var">pv</span></a><span>
</span><a name="line-1139"></a><span>
</span><a name="line-1140"></a><span class="hs-comment">-- | Generate a value abstraction for a given constructor (generate</span><span>
</span><a name="line-1141"></a><span class="hs-comment">-- fresh variables of the appropriate type for arguments)</span><span>
</span><a name="line-1142"></a><span class="hs-identifier">mkOneConFull</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">,</span><span> </span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span class="hs-special">,</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-1143"></a><span class="hs-comment">--  *  x :: T tys, where T is an algebraic data type</span><span>
</span><a name="line-1144"></a><span class="hs-comment">--     NB: in the case of a data family, T is the *representation* TyCon</span><span>
</span><a name="line-1145"></a><span class="hs-comment">--     e.g.   data instance T (a,b) = T1 a b</span><span>
</span><a name="line-1146"></a><span class="hs-comment">--       leads to</span><span>
</span><a name="line-1147"></a><span class="hs-comment">--            data TPair a b = T1 a b  -- The &quot;representation&quot; type</span><span>
</span><a name="line-1148"></a><span class="hs-comment">--       It is TPair, not T, that is given to mkOneConFull</span><span>
</span><a name="line-1149"></a><span class="hs-comment">--</span><span>
</span><a name="line-1150"></a><span class="hs-comment">--  * 'con' K is a constructor of data type T</span><span>
</span><a name="line-1151"></a><span class="hs-comment">--</span><span>
</span><a name="line-1152"></a><span class="hs-comment">-- After instantiating the universal tyvars of K we get</span><span>
</span><a name="line-1153"></a><span class="hs-comment">--          K tys :: forall bs. Q =&gt; s1 .. sn -&gt; T tys</span><span>
</span><a name="line-1154"></a><span class="hs-comment">--</span><span>
</span><a name="line-1155"></a><span class="hs-comment">-- Results: ValAbs:          K (y1::s1) .. (yn::sn)</span><span>
</span><a name="line-1156"></a><span class="hs-comment">--          ComplexEq:       x ~ K y1..yn</span><span>
</span><a name="line-1157"></a><span class="hs-comment">--          [EvVar]:         Q</span><span>
</span><a name="line-1158"></a><a name="mkOneConFull"><a href="Check.html#mkOneConFull"><span class="hs-identifier">mkOneConFull</span></a></a><span> </span><a name="local-6989586621680278891"><a href="#local-6989586621680278891"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680278892"><a href="#local-6989586621680278892"><span class="hs-identifier">con</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1159"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278893"><a href="#local-6989586621680278893"><span class="hs-identifier">res_ty</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idType"><span class="hs-identifier hs-var">idType</span></a><span> </span><a href="#local-6989586621680278891"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1160"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621680278894"><a href="#local-6989586621680278894"><span class="hs-identifier">univ_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278895"><a href="#local-6989586621680278895"><span class="hs-identifier">ex_tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278896"><a href="#local-6989586621680278896"><span class="hs-identifier">eq_spec</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278897"><a href="#local-6989586621680278897"><span class="hs-identifier">thetas</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278898"><a href="#local-6989586621680278898"><span class="hs-identifier">_req_theta</span></a></a><span> </span><span class="hs-special">,</span><span> </span><a name="local-6989586621680278899"><a href="#local-6989586621680278899"><span class="hs-identifier">arg_tys</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278900"><a href="#local-6989586621680278900"><span class="hs-identifier">con_res_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1161"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#conLikeFullSig"><span class="hs-identifier hs-var">conLikeFullSig</span></a><span> </span><a href="#local-6989586621680278892"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1162"></a><span>      </span><a name="local-6989586621680278901"><a href="#local-6989586621680278901"><span class="hs-identifier">tc_args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppArgs"><span class="hs-identifier hs-var">tyConAppArgs</span></a><span> </span><a href="#local-6989586621680278893"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-1163"></a><span>      </span><a name="local-6989586621680278902"><a href="#local-6989586621680278902"><span class="hs-identifier">subst1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278892"><span class="hs-identifier hs-var">con</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1164"></a><span>                  </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a><span> </span><a href="#local-6989586621680278894"><span class="hs-identifier hs-var">univ_tvs</span></a><span> </span><a href="#local-6989586621680278901"><span class="hs-identifier hs-var">tc_args</span></a><span>
</span><a name="line-1165"></a><span>                  </span><a href="ConLike.html#PatSynCon"><span class="hs-identifier hs-var">PatSynCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Maybes.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a><span> </span><span class="hs-string">&quot;mkOneConFull&quot;</span><span> </span><span class="hs-special">(</span><a href="Unify.html#tcMatchTy"><span class="hs-identifier hs-var">tcMatchTy</span></a><span> </span><a href="#local-6989586621680278900"><span class="hs-identifier hs-var">con_res_ty</span></a><span> </span><a href="#local-6989586621680278893"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1166"></a><span>                                    </span><span class="hs-comment">-- See Note [Pattern synonym result type] in PatSyn</span><span>
</span><a name="line-1167"></a><span>
</span><a name="line-1168"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621680278903"><a href="#local-6989586621680278903"><span class="hs-identifier">subst</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278904"><a href="#local-6989586621680278904"><span class="hs-identifier">ex_tvs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCoRep.html#cloneTyVarBndrs"><span class="hs-identifier hs-var">cloneTyVarBndrs</span></a><span> </span><a href="#local-6989586621680278902"><span class="hs-identifier hs-var">subst1</span></a><span> </span><a href="#local-6989586621680278895"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="UniqSupply.html#getUniqueSupplyM"><span class="hs-identifier hs-var">getUniqueSupplyM</span></a><span>
</span><a name="line-1169"></a><span>
</span><a name="line-1170"></a><span>  </span><span class="hs-comment">-- Fresh term variables (VAs) as arguments to the constructor</span><span>
</span><a name="line-1171"></a><span>  </span><a name="local-6989586621680278905"><a href="#local-6989586621680278905"><span class="hs-identifier">arguments</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="Check.html#mkPmVar"><span class="hs-identifier hs-var">mkPmVar</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span> </span><a href="#local-6989586621680278903"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621680278899"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1172"></a><span>  </span><span class="hs-comment">-- All constraints bound by the constructor (alpha-renamed)</span><span>
</span><a name="line-1173"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278906"><a href="#local-6989586621680278906"><span class="hs-identifier">theta_cs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTheta"><span class="hs-identifier hs-var">substTheta</span></a><span> </span><a href="#local-6989586621680278903"><span class="hs-identifier hs-var">subst</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#eqSpecPreds"><span class="hs-identifier hs-var">eqSpecPreds</span></a><span> </span><a href="#local-6989586621680278896"><span class="hs-identifier hs-var">eq_spec</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680278897"><span class="hs-identifier hs-var">thetas</span></a><span class="hs-special">)</span><span>
</span><a name="line-1174"></a><span>  </span><a name="local-6989586621680278907"><a href="#local-6989586621680278907"><span class="hs-identifier">evvars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#nameType"><span class="hs-identifier hs-var">nameType</span></a><span> </span><span class="hs-string">&quot;pm&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278906"><span class="hs-identifier hs-var">theta_cs</span></a><span>
</span><a name="line-1175"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278908"><a href="#local-6989586621680278908"><span class="hs-identifier">con_abs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278892"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1176"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278901"><span class="hs-identifier hs-var">tc_args</span></a><span>
</span><a name="line-1177"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278904"><span class="hs-identifier hs-var">ex_tvs'</span></a><span>
</span><a name="line-1178"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278907"><span class="hs-identifier hs-var">evvars</span></a><span>
</span><a name="line-1179"></a><span>                       </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278905"><span class="hs-identifier hs-var">arguments</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1180"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278908"><span class="hs-identifier hs-var">con_abs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680278891"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Check.html#vaToPmExpr"><span class="hs-identifier hs-var">vaToPmExpr</span></a><span> </span><a href="#local-6989586621680278908"><span class="hs-identifier hs-var">con_abs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><a href="#local-6989586621680278907"><span class="hs-identifier hs-var">evvars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1181"></a><span>
</span><a name="line-1182"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1183"></a><span class="hs-comment">-- * More smart constructors and fresh variable generation</span><span>
</span><a name="line-1184"></a><span>
</span><a name="line-1185"></a><span class="hs-comment">-- | Create a guard pattern</span><span>
</span><a name="line-1186"></a><span class="hs-identifier">mkGuard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span>
</span><a name="line-1187"></a><a name="mkGuard"><a href="Check.html#mkGuard"><span class="hs-identifier">mkGuard</span></a></a><span> </span><a name="local-6989586621680278909"><a href="#local-6989586621680278909"><span class="hs-identifier">pv</span></a></a><span> </span><a name="local-6989586621680278910"><a href="#local-6989586621680278910"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-1188"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Check.html#cantFailPattern"><span class="hs-identifier hs-var">cantFailPattern</span></a><span> </span><a href="#local-6989586621680278909"><span class="hs-identifier hs-var">pv</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><a href="#local-6989586621680278909"><span class="hs-identifier hs-var">pv</span></a><span> </span><a href="#local-6989586621680278911"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1189"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="PmExpr.html#PmExprOther"><span class="hs-identifier hs-var">PmExprOther</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680278911"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#fake_pat"><span class="hs-identifier hs-var">fake_pat</span></a><span>
</span><a name="line-1190"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><a href="#local-6989586621680278909"><span class="hs-identifier hs-var">pv</span></a><span> </span><a href="#local-6989586621680278911"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-1191"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1192"></a><span>    </span><a name="local-6989586621680278911"><a href="#local-6989586621680278911"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#hsExprToPmExpr"><span class="hs-identifier hs-var">hsExprToPmExpr</span></a><span> </span><a href="#local-6989586621680278910"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1193"></a><span>
</span><a name="line-1194"></a><span class="hs-comment">-- | Create a term equality of the form: `(False ~ (x ~ lit))`</span><span>
</span><a name="line-1195"></a><span class="hs-identifier">mkNegEq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PmExpr.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span>
</span><a name="line-1196"></a><a name="mkNegEq"><a href="Check.html#mkNegEq"><span class="hs-identifier">mkNegEq</span></a></a><span> </span><a name="local-6989586621680278912"><a href="#local-6989586621680278912"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680278913"><a href="#local-6989586621680278913"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="PmExpr.html#falsePmExpr"><span class="hs-identifier hs-var">falsePmExpr</span></a><span class="hs-special">,</span><span> </span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680278912"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="PmExpr.html#PmExprEq"><span class="hs-identifier hs-var">PmExprEq</span></a><span class="hs-special">`</span><span> </span><a href="PmExpr.html#PmExprLit"><span class="hs-identifier hs-var">PmExprLit</span></a><span> </span><a href="#local-6989586621680278913"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1197"></a><span class="hs-pragma">{-# INLINE mkNegEq #-}</span><span>
</span><a name="line-1198"></a><span>
</span><a name="line-1199"></a><span class="hs-comment">-- | Create a term equality of the form: `(x ~ lit)`</span><span>
</span><a name="line-1200"></a><span class="hs-identifier">mkPosEq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PmExpr.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span>
</span><a name="line-1201"></a><a name="mkPosEq"><a href="Check.html#mkPosEq"><span class="hs-identifier">mkPosEq</span></a></a><span> </span><a name="local-6989586621680278914"><a href="#local-6989586621680278914"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621680278915"><a href="#local-6989586621680278915"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680278914"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="PmExpr.html#PmExprLit"><span class="hs-identifier hs-var">PmExprLit</span></a><span> </span><a href="#local-6989586621680278915"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1202"></a><span class="hs-pragma">{-# INLINE mkPosEq #-}</span><span>
</span><a name="line-1203"></a><span>
</span><a name="line-1204"></a><span class="hs-comment">-- | Create a term equality of the form: `(x ~ x)`</span><span>
</span><a name="line-1205"></a><span class="hs-comment">-- (always discharged by the term oracle)</span><span>
</span><a name="line-1206"></a><span class="hs-identifier">mkIdEq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span>
</span><a name="line-1207"></a><a name="mkIdEq"><a href="Check.html#mkIdEq"><span class="hs-identifier">mkIdEq</span></a></a><span> </span><a name="local-6989586621680278916"><a href="#local-6989586621680278916"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><a href="#local-6989586621680278917"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">,</span><span> </span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><a href="#local-6989586621680278917"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621680278917"><a href="#local-6989586621680278917"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680278916"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1209"></a><span class="hs-pragma">{-# INLINE mkIdEq #-}</span><span>
</span><a name="line-1210"></a><span>
</span><a name="line-1211"></a><span class="hs-comment">-- | Generate a variable pattern of a given type</span><span>
</span><a name="line-1212"></a><span class="hs-identifier">mkPmVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><a href="#local-6989586621680278531"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1213"></a><a name="mkPmVar"><a href="Check.html#mkPmVar"><span class="hs-identifier">mkPmVar</span></a></a><span> </span><a name="local-6989586621680278918"><a href="#local-6989586621680278918"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#mkPmId"><span class="hs-identifier hs-var">mkPmId</span></a><span> </span><a href="#local-6989586621680278918"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1214"></a><span class="hs-pragma">{-# INLINE mkPmVar #-}</span><span>
</span><a name="line-1215"></a><span>
</span><a name="line-1216"></a><span class="hs-comment">-- | Generate many variable patterns, given a list of types</span><span>
</span><a name="line-1217"></a><span class="hs-identifier">mkPmVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span>
</span><a name="line-1218"></a><a name="mkPmVars"><a href="Check.html#mkPmVars"><span class="hs-identifier">mkPmVars</span></a></a><span> </span><a name="local-6989586621680278919"><a href="#local-6989586621680278919"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="Check.html#mkPmVar"><span class="hs-identifier hs-var">mkPmVar</span></a><span> </span><a href="#local-6989586621680278919"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1219"></a><span class="hs-pragma">{-# INLINE mkPmVars #-}</span><span>
</span><a name="line-1220"></a><span>
</span><a name="line-1221"></a><span class="hs-comment">-- | Generate a fresh `Id` of a given type</span><span>
</span><a name="line-1222"></a><span class="hs-identifier">mkPmId</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span>
</span><a name="line-1223"></a><a name="mkPmId"><a href="Check.html#mkPmId"><span class="hs-identifier">mkPmId</span></a></a><span> </span><a name="local-6989586621680278920"><a href="#local-6989586621680278920"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqSupply.html#getUniqueM"><span class="hs-identifier hs-var">getUniqueM</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680278921"><a href="#local-6989586621680278921"><span class="hs-identifier">unique</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1224"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278922"><a href="#local-6989586621680278922"><span class="hs-identifier">occname</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-string">&quot;$pm&quot;</span><span>
</span><a name="line-1225"></a><span>      </span><a name="local-6989586621680278923"><a href="#local-6989586621680278923"><span class="hs-identifier">name</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-6989586621680278921"><span class="hs-identifier hs-var">unique</span></a><span> </span><a href="#local-6989586621680278922"><span class="hs-identifier hs-var">occname</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span>
</span><a name="line-1226"></a><span>  </span><span class="hs-keyword">in</span><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#mkLocalId"><span class="hs-identifier hs-var">mkLocalId</span></a><span> </span><a href="#local-6989586621680278923"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621680278920"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1227"></a><span>
</span><a name="line-1228"></a><span class="hs-comment">-- | Generate a fresh term variable of a given and return it in two forms:</span><span>
</span><a name="line-1229"></a><span class="hs-comment">-- * A variable pattern</span><span>
</span><a name="line-1230"></a><span class="hs-comment">-- * A variable expression</span><span>
</span><a name="line-1231"></a><span class="hs-identifier">mkPmId2Forms</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">,</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1232"></a><a name="mkPmId2Forms"><a href="Check.html#mkPmId2Forms"><span class="hs-identifier">mkPmId2Forms</span></a></a><span> </span><a name="local-6989586621680278924"><a href="#local-6989586621680278924"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1233"></a><span>  </span><a name="local-6989586621680278925"><a href="#local-6989586621680278925"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#mkPmId"><span class="hs-identifier hs-var">mkPmId</span></a><span> </span><a href="#local-6989586621680278924"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1234"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="#local-6989586621680278925"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621680278925"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1235"></a><span>
</span><a name="line-1236"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1237"></a><span class="hs-comment">-- * Converting between Value Abstractions, Patterns and PmExpr</span><span>
</span><a name="line-1238"></a><span>
</span><a name="line-1239"></a><span class="hs-comment">-- | Convert a value abstraction an expression</span><span>
</span><a name="line-1240"></a><span class="hs-identifier">vaToPmExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="PmExpr.html#PmExpr"><span class="hs-identifier hs-type">PmExpr</span></a><span>
</span><a name="line-1241"></a><a name="vaToPmExpr"><a href="Check.html#vaToPmExpr"><span class="hs-identifier">vaToPmExpr</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278926"><a href="#local-6989586621680278926"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278927"><a href="#local-6989586621680278927"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1242"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#PmExprCon"><span class="hs-identifier hs-var">PmExprCon</span></a><span> </span><a href="#local-6989586621680278926"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#vaToPmExpr"><span class="hs-identifier hs-var">vaToPmExpr</span></a><span> </span><a href="#local-6989586621680278927"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-1243"></a><span class="hs-identifier">vaToPmExpr</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_var_id</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278928"><a href="#local-6989586621680278928"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680278928"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1244"></a><span class="hs-identifier">vaToPmExpr</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278929"><a href="#local-6989586621680278929"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#PmExprLit"><span class="hs-identifier hs-var">PmExprLit</span></a><span> </span><a href="#local-6989586621680278929"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-1245"></a><span class="hs-identifier">vaToPmExpr</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmNLit"><span class="hs-identifier hs-var">PmNLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_id</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278930"><a href="#local-6989586621680278930"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680278930"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1246"></a><span>
</span><a name="line-1247"></a><span class="hs-comment">-- | Convert a pattern vector to a list of value abstractions by dropping the</span><span>
</span><a name="line-1248"></a><span class="hs-comment">-- guards (See Note [Translating As Patterns])</span><span>
</span><a name="line-1249"></a><span class="hs-identifier">coercePatVec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1250"></a><a name="coercePatVec"><a href="Check.html#coercePatVec"><span class="hs-identifier">coercePatVec</span></a></a><span> </span><a name="local-6989586621680278931"><a href="#local-6989586621680278931"><span class="hs-identifier">pv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><a href="Check.html#coercePmPat"><span class="hs-identifier hs-var">coercePmPat</span></a><span> </span><a href="#local-6989586621680278931"><span class="hs-identifier hs-var">pv</span></a><span>
</span><a name="line-1251"></a><span>
</span><a name="line-1252"></a><span class="hs-comment">-- | Convert a pattern to a list of value abstractions (will be either an empty</span><span>
</span><a name="line-1253"></a><span class="hs-comment">-- list if the pattern is a guard pattern, or a singleton list in all other</span><span>
</span><a name="line-1254"></a><span class="hs-comment">-- cases) by dropping the guards (See Note [Translating As Patterns])</span><span>
</span><a name="line-1255"></a><span class="hs-identifier">coercePmPat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1256"></a><a name="coercePmPat"><a href="Check.html#coercePmPat"><span class="hs-identifier">coercePmPat</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_var_id</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278932"><a href="#local-6989586621680278932"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_var_id</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278932"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-1257"></a><span class="hs-identifier">coercePmPat</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278933"><a href="#local-6989586621680278933"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_lit</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278933"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-1258"></a><span class="hs-identifier">coercePmPat</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278934"><a href="#local-6989586621680278934"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278935"><a href="#local-6989586621680278935"><span class="hs-identifier">arg_tys</span></a></a><span>
</span><a name="line-1259"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278936"><a href="#local-6989586621680278936"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278937"><a href="#local-6989586621680278937"><span class="hs-identifier">dicts</span></a></a><span>
</span><a name="line-1260"></a><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680278938"><a href="#local-6989586621680278938"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1261"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278934"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278935"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-1262"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278936"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278937"><span class="hs-identifier hs-var">dicts</span></a><span>
</span><a name="line-1263"></a><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#coercePatVec"><span class="hs-identifier hs-var">coercePatVec</span></a><span> </span><a href="#local-6989586621680278938"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><a name="line-1264"></a><span class="hs-identifier">coercePmPat</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- drop the guards</span><span>
</span><a name="line-1265"></a><span>
</span><a name="line-1266"></a><span class="hs-comment">-- | Check whether a data constructor is the only way to construct</span><span>
</span><a name="line-1267"></a><span class="hs-comment">-- a data type.</span><span>
</span><a name="line-1268"></a><span class="hs-identifier">singleConstructor</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1269"></a><a name="singleConstructor"><a href="Check.html#singleConstructor"><span class="hs-identifier">singleConstructor</span></a></a><span> </span><span class="hs-special">(</span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-6989586621680278939"><a href="#local-6989586621680278939"><span class="hs-identifier">dc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1270"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-6989586621680278939"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1271"></a><span>    </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1272"></a><span>    </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1273"></a><span class="hs-identifier">singleConstructor</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1274"></a><span>
</span><a name="line-1275"></a><span class="hs-comment">-- | For a given conlike, finds all the sets of patterns which could</span><span>
</span><a name="line-1276"></a><span class="hs-comment">-- be relevant to that conlike by consulting the result type.</span><span>
</span><a name="line-1277"></a><span class="hs-comment">--</span><span>
</span><a name="line-1278"></a><span class="hs-comment">-- These come from two places.</span><span>
</span><a name="line-1279"></a><span class="hs-comment">--  1. From data constructors defined with the result type constructor.</span><span>
</span><a name="line-1280"></a><span class="hs-comment">--  2. From `COMPLETE` pragmas which have the same type as the result</span><span>
</span><a name="line-1281"></a><span class="hs-comment">--     type constructor. Note that we only use `COMPLETE` pragmas</span><span>
</span><a name="line-1282"></a><span class="hs-comment">--     *all* of whose pattern types match. See #14135</span><span>
</span><a name="line-1283"></a><span class="hs-identifier">allCompleteMatches</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1284"></a><a name="allCompleteMatches"><a href="Check.html#allCompleteMatches"><span class="hs-identifier">allCompleteMatches</span></a></a><span> </span><a name="local-6989586621680278940"><a href="#local-6989586621680278940"><span class="hs-identifier">cl</span></a></a><span> </span><a name="local-6989586621680278941"><a href="#local-6989586621680278941"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1285"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278946"><a href="#local-6989586621680278946"><span class="hs-identifier">fam</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278940"><span class="hs-identifier hs-var">cl</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1286"></a><span>           </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><a name="local-6989586621680278948"><a href="#local-6989586621680278948"><span class="hs-identifier">dc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1287"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Check.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="ConLike.html#RealDataCon"><span class="hs-identifier hs-var">RealDataCon</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConTyCon"><span class="hs-identifier hs-var">dataConTyCon</span></a><span> </span><a href="#local-6989586621680278948"><span class="hs-identifier hs-var">dc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1288"></a><span>           </span><a href="ConLike.html#PatSynCon"><span class="hs-identifier hs-var">PatSynCon</span></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1289"></a><span>      </span><a name="local-6989586621680278947"><a href="#local-6989586621680278947"><span class="hs-identifier">ty</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#conLikeResTy"><span class="hs-identifier hs-var">conLikeResTy</span></a><span> </span><a href="#local-6989586621680278940"><span class="hs-identifier hs-var">cl</span></a><span> </span><a href="#local-6989586621680278941"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1290"></a><span>  </span><a name="local-6989586621680278950"><a href="#local-6989586621680278950"><span class="hs-identifier">pragmas</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621680278947"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1291"></a><span>               </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278949"><a href="#local-6989586621680278949"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#dsGetCompleteMatches"><span class="hs-identifier hs-var">dsGetCompleteMatches</span></a><span> </span><a href="#local-6989586621680278949"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1292"></a><span>               </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1293"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278951"><a href="#local-6989586621680278951"><span class="hs-identifier">fams</span></a></a><span> </span><a name="local-6989586621680278952"><a href="#local-6989586621680278952"><span class="hs-identifier">cm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Check.html#FromComplete"><span class="hs-identifier hs-var">FromComplete</span></a><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1294"></a><span>                </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="DsMonad.html#dsLookupConLike"><span class="hs-identifier hs-var">dsLookupConLike</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">completeMatchConLikes</span><span> </span><a href="#local-6989586621680278952"><span class="hs-identifier hs-var">cm</span></a><span class="hs-special">)</span><span>
</span><a name="line-1295"></a><span>  </span><a name="local-6989586621680278954"><a href="#local-6989586621680278954"><span class="hs-identifier">from_pragma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621680278953"><a href="#local-6989586621680278953"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680278942"><span class="hs-identifier hs-var">isValidCompleteMatch</span></a><span> </span><a href="#local-6989586621680278947"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680278953"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1296"></a><span>                </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621680278951"><span class="hs-identifier hs-var">fams</span></a><span> </span><a href="#local-6989586621680278950"><span class="hs-identifier hs-var">pragmas</span></a><span>
</span><a name="line-1297"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278955"><a href="#local-6989586621680278955"><span class="hs-identifier">final_groups</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278946"><span class="hs-identifier hs-var">fam</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680278954"><span class="hs-identifier hs-var">from_pragma</span></a><span>
</span><a name="line-1298"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680278955"><span class="hs-identifier hs-var">final_groups</span></a><span>
</span><a name="line-1299"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-1300"></a><span>      </span><span class="hs-comment">-- Check that all the pattern types in a `COMPLETE`</span><span>
</span><a name="line-1301"></a><span>      </span><span class="hs-comment">-- pragma subsume the type we're matching. See #14135.</span><span>
</span><a name="line-1302"></a><span>      </span><span class="hs-identifier">isValidCompleteMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1303"></a><span>      </span><a name="local-6989586621680278942"><a href="#local-6989586621680278942"><span class="hs-identifier">isValidCompleteMatch</span></a></a><span> </span><a name="local-6989586621680278943"><a href="#local-6989586621680278943"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1304"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="Unify.html#tcMatchTy"><span class="hs-identifier hs-var">tcMatchTy</span></a><span> </span><a href="#local-6989586621680278943"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621680278944"><span class="hs-identifier hs-var">resTy</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="ConLike.html#conLikeFullSig"><span class="hs-identifier hs-var">conLikeFullSig</span></a><span class="hs-special">)</span><span>
</span><a name="line-1305"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-1306"></a><span>          </span><a name="local-6989586621680278944"><a href="#local-6989586621680278944"><span class="hs-identifier">resTy</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680278945"><a href="#local-6989586621680278945"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680278945"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-1307"></a><span>
</span><a name="line-1308"></a><span class="hs-comment">-- -----------------------------------------------------------------------</span><span>
</span><a name="line-1309"></a><span class="hs-comment">-- * Types and constraints</span><span>
</span><a name="line-1310"></a><span>
</span><a name="line-1311"></a><span class="hs-identifier">newEvVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-1312"></a><a name="newEvVar"><a href="Check.html#newEvVar"><span class="hs-identifier">newEvVar</span></a></a><span> </span><a name="local-6989586621680278956"><a href="#local-6989586621680278956"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621680278957"><a href="#local-6989586621680278957"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Id.html#mkLocalId"><span class="hs-identifier hs-var">mkLocalId</span></a><span> </span><a href="#local-6989586621680278956"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><a href="TcType.html#toTcType"><span class="hs-identifier hs-var">toTcType</span></a><span> </span><a href="#local-6989586621680278957"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1313"></a><span>
</span><a name="line-1314"></a><span class="hs-identifier">nameType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span>
</span><a name="line-1315"></a><a name="nameType"><a href="Check.html#nameType"><span class="hs-identifier">nameType</span></a></a><span> </span><a name="local-6989586621680278958"><a href="#local-6989586621680278958"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621680278959"><a href="#local-6989586621680278959"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1316"></a><span>  </span><a name="local-6989586621680278960"><a href="#local-6989586621680278960"><span class="hs-identifier">unique</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="UniqSupply.html#getUniqueM"><span class="hs-identifier hs-var">getUniqueM</span></a><span>
</span><a name="line-1317"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278961"><a href="#local-6989586621680278961"><span class="hs-identifier">occname</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#mkVarOccFS"><span class="hs-identifier hs-var">mkVarOccFS</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278958"><span class="hs-identifier hs-var">name</span></a><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-string">&quot;_&quot;</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-6989586621680278960"><span class="hs-identifier hs-var">unique</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1318"></a><span>      </span><a name="local-6989586621680278962"><a href="#local-6989586621680278962"><span class="hs-identifier">idname</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-6989586621680278960"><span class="hs-identifier hs-var">unique</span></a><span> </span><a href="#local-6989586621680278961"><span class="hs-identifier hs-var">occname</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span>
</span><a name="line-1319"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#newEvVar"><span class="hs-identifier hs-var">newEvVar</span></a><span> </span><a href="#local-6989586621680278962"><span class="hs-identifier hs-var">idname</span></a><span> </span><a href="#local-6989586621680278959"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1320"></a><span>
</span><a name="line-1321"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                              The type oracle
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-1328"></a><span>
</span><a name="line-1329"></a><span class="hs-comment">-- | Check whether a set of type constraints is satisfiable.</span><span>
</span><a name="line-1330"></a><span class="hs-identifier">tyOracle</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1331"></a><a name="tyOracle"><a href="Check.html#tyOracle"><span class="hs-identifier">tyOracle</span></a></a><span> </span><a name="local-6989586621680278963"><a href="#local-6989586621680278963"><span class="hs-identifier">evs</span></a></a><span>
</span><a name="line-1332"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1333"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621680278964"><a href="#local-6989586621680278964"><span class="hs-identifier">_warns</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278965"><a href="#local-6989586621680278965"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680278966"><a href="#local-6989586621680278966"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#initTcDsForSolver"><span class="hs-identifier hs-var">initTcDsForSolver</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcSimplify.html#tcCheckSatisfiability"><span class="hs-identifier hs-var">tcCheckSatisfiability</span></a><span> </span><a href="#local-6989586621680278963"><span class="hs-identifier hs-var">evs</span></a><span>
</span><a name="line-1334"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680278966"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1335"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680278967"><a href="#local-6989586621680278967"><span class="hs-identifier">sat</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680278967"><span class="hs-identifier hs-var">sat</span></a><span>
</span><a name="line-1336"></a><span>            </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyOracle&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="ErrUtils.html#pprErrMsgBagWithLoc"><span class="hs-identifier hs-var">pprErrMsgBagWithLoc</span></a><span> </span><a href="#local-6989586621680278965"><span class="hs-identifier hs-var">errs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1337"></a><span>
</span><a name="line-1338"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                             Sanity Checks
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-1345"></a><span>
</span><a name="line-1346"></a><span class="hs-comment">-- | The arity of a pattern/pattern vector is the</span><span>
</span><a name="line-1347"></a><span class="hs-comment">-- number of top-level patterns that are not guards</span><span>
</span><a name="line-1348"></a><span class="hs-keyword">type</span><span> </span><a name="PmArity"><a href="Check.html#PmArity"><span class="hs-identifier">PmArity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1349"></a><span>
</span><a name="line-1350"></a><span class="hs-comment">-- | Compute the arity of a pattern vector</span><span>
</span><a name="line-1351"></a><span class="hs-identifier">patVecArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmArity"><span class="hs-identifier hs-type">PmArity</span></a><span>
</span><a name="line-1352"></a><a name="patVecArity"><a href="Check.html#patVecArity"><span class="hs-identifier">patVecArity</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#patternArity"><span class="hs-identifier hs-var">patternArity</span></a><span>
</span><a name="line-1353"></a><span>
</span><a name="line-1354"></a><span class="hs-comment">-- | Compute the arity of a pattern</span><span>
</span><a name="line-1355"></a><span class="hs-identifier">patternArity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmArity"><span class="hs-identifier hs-type">PmArity</span></a><span>
</span><a name="line-1356"></a><a name="patternArity"><a href="Check.html#patternArity"><span class="hs-identifier">patternArity</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-1357"></a><span class="hs-identifier">patternArity</span><span> </span><a name="local-6989586621680278968"><a href="#local-6989586621680278968"><span class="hs-identifier">_other_pat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-1358"></a><span>
</span><a name="line-1359"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
            Heart of the algorithm: Function pmcheck
%*                                                                      *
%************************************************************************

Main functions are:

* mkInitialUncovered :: [Id] -&gt; PmM Uncovered

  Generates the initial uncovered set. Term and type constraints in scope
  are checked, if they are inconsistent, the set is empty, otherwise, the
  set contains only a vector of variables with the constraints in scope.

* pmcheck :: PatVec -&gt; [PatVec] -&gt; ValVec -&gt; PmM PartialResult

  Checks redundancy, coverage and inaccessibility, using auxilary functions
  `pmcheckGuards` and `pmcheckHd`. Mainly handles the guard case which is
  common in all three checks (see paper) and calls `pmcheckGuards` when the
  whole clause is checked, or `pmcheckHd` when the pattern vector does not
  start with a guard.

* pmcheckGuards :: [PatVec] -&gt; ValVec -&gt; PmM PartialResult

  Processes the guards.

* pmcheckHd :: Pattern -&gt; PatVec -&gt; [PatVec]
          -&gt; ValAbs -&gt; ValVec -&gt; PmM PartialResult

  Worker: This function implements functions `covered`, `uncovered` and
  `divergent` from the paper at once. Slightly different from the paper because
  it does not even produce the covered and uncovered sets. Since we only care
  about whether a clause covers SOMETHING or if it may forces ANY argument, we
  only store a boolean in both cases, for efficiency.
-}</span><span>
</span><a name="line-1395"></a><span>
</span><a name="line-1396"></a><span class="hs-comment">-- | Lift a pattern matching action from a single value vector abstration to a</span><span>
</span><a name="line-1397"></a><span class="hs-comment">-- value set abstraction, but calling it on every vector and the combining the</span><span>
</span><a name="line-1398"></a><span class="hs-comment">-- results.</span><span>
</span><a name="line-1399"></a><span class="hs-identifier">runMany</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Check.html#Uncovered"><span class="hs-identifier hs-type">Uncovered</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span class="hs-special">)</span><span>
</span><a name="line-1400"></a><a name="runMany"><a href="Check.html#runMany"><span class="hs-identifier">runMany</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1401"></a><span class="hs-identifier">runMany</span><span> </span><a name="local-6989586621680278969"><a href="#local-6989586621680278969"><span class="hs-identifier">pm</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680278970"><a href="#local-6989586621680278970"><span class="hs-identifier">m</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680278971"><a href="#local-6989586621680278971"><span class="hs-identifier">ms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621680278969"><span class="hs-identifier hs-var">pm</span></a><span> </span><a href="#local-6989586621680278970"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Check.html#runMany"><span class="hs-identifier hs-var">runMany</span></a><span> </span><a href="#local-6989586621680278969"><span class="hs-identifier hs-var">pm</span></a><span> </span><a href="#local-6989586621680278971"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-1402"></a><span>
</span><a name="line-1403"></a><span class="hs-comment">-- | Generate the initial uncovered set. It initializes the</span><span>
</span><a name="line-1404"></a><span class="hs-comment">-- delta with all term and type constraints in scope.</span><span>
</span><a name="line-1405"></a><span class="hs-identifier">mkInitialUncovered</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#Uncovered"><span class="hs-identifier hs-type">Uncovered</span></a><span>
</span><a name="line-1406"></a><a name="mkInitialUncovered"><a href="Check.html#mkInitialUncovered"><span class="hs-identifier">mkInitialUncovered</span></a></a><span> </span><a name="local-6989586621680278972"><a href="#local-6989586621680278972"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1407"></a><span>  </span><a name="local-6989586621680278973"><a href="#local-6989586621680278973"><span class="hs-identifier">ty_cs</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#getDictsDs"><span class="hs-identifier hs-var">getDictsDs</span></a><span>
</span><a name="line-1408"></a><span>  </span><a name="local-6989586621680278974"><a href="#local-6989586621680278974"><span class="hs-identifier">tm_cs</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="PmExpr.html#toComplex"><span class="hs-identifier hs-var">toComplex</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Bag.html#bagToList"><span class="hs-identifier hs-var">bagToList</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#getTmCsDs"><span class="hs-identifier hs-var">getTmCsDs</span></a><span>
</span><a name="line-1409"></a><span>  </span><a name="local-6989586621680278975"><a href="#local-6989586621680278975"><span class="hs-identifier">sat_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#tyOracle"><span class="hs-identifier hs-var">tyOracle</span></a><span> </span><a href="#local-6989586621680278973"><span class="hs-identifier hs-var">ty_cs</span></a><span>
</span><a name="line-1410"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680278976"><a href="#local-6989586621680278976"><span class="hs-identifier">initTyCs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621680278975"><span class="hs-identifier hs-var">sat_ty</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621680278973"><span class="hs-identifier hs-var">ty_cs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-1411"></a><span>      </span><a name="local-6989586621680278977"><a href="#local-6989586621680278977"><span class="hs-identifier">initTmState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a><span> </span><a href="TmOracle.html#initialTmState"><span class="hs-identifier hs-var">initialTmState</span></a><span> </span><span class="hs-special">(</span><a href="TmOracle.html#tmOracle"><span class="hs-identifier hs-var">tmOracle</span></a><span> </span><a href="TmOracle.html#initialTmState"><span class="hs-identifier hs-var">initialTmState</span></a><span> </span><a href="#local-6989586621680278974"><span class="hs-identifier hs-var">tm_cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><span>      </span><a name="local-6989586621680278978"><a href="#local-6989586621680278978"><span class="hs-identifier">patterns</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="#local-6989586621680278972"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-1413"></a><span>    </span><span class="hs-comment">-- If any of the term/type constraints are non</span><span>
</span><a name="line-1414"></a><span>    </span><span class="hs-comment">-- satisfiable then return with the initialTmState. See #12957</span><span>
</span><a name="line-1415"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680278978"><span class="hs-identifier hs-var">patterns</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#MkDelta"><span class="hs-identifier hs-var">MkDelta</span></a><span> </span><a href="#local-6989586621680278976"><span class="hs-identifier hs-var">initTyCs</span></a><span> </span><a href="#local-6989586621680278977"><span class="hs-identifier hs-var">initTmState</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1416"></a><span>
</span><a name="line-1417"></a><span class="hs-comment">-- | Increase the counter for elapsed algorithm iterations, check that the</span><span>
</span><a name="line-1418"></a><span class="hs-comment">-- limit is not exceeded and call `pmcheck`</span><span>
</span><a name="line-1419"></a><span class="hs-identifier">pmcheckI</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1420"></a><a name="pmcheckI"><a href="Check.html#pmcheckI"><span class="hs-identifier">pmcheckI</span></a></a><span> </span><a name="local-6989586621680278979"><a href="#local-6989586621680278979"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680278980"><a href="#local-6989586621680278980"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621680278981"><a href="#local-6989586621680278981"><span class="hs-identifier">vva</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1421"></a><span>  </span><a name="local-6989586621680278982"><a href="#local-6989586621680278982"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#incrCheckPmIterDs"><span class="hs-identifier hs-var">incrCheckPmIterDs</span></a><span>
</span><a name="line-1422"></a><span>  </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;pmCheck&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278982"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Check.html#pprPatVec"><span class="hs-identifier hs-var">pprPatVec</span></a><span> </span><a href="#local-6989586621680278979"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1423"></a><span>                        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;guards:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprPatVec"><span class="hs-identifier hs-var">pprPatVec</span></a><span> </span><a href="#local-6989586621680278980"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1424"></a><span>                        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Check.html#pprValVecDebug"><span class="hs-identifier hs-var">pprValVecDebug</span></a><span> </span><a href="#local-6989586621680278981"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span>
</span><a name="line-1425"></a><span>  </span><a name="local-6989586621680278983"><a href="#local-6989586621680278983"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#pmcheck"><span class="hs-identifier hs-var">pmcheck</span></a><span> </span><a href="#local-6989586621680278979"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680278980"><span class="hs-identifier hs-var">guards</span></a><span> </span><a href="#local-6989586621680278981"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1426"></a><span>  </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;pmCheckResult:&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278983"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-1427"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680278983"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1428"></a><span class="hs-pragma">{-# INLINE pmcheckI #-}</span><span>
</span><a name="line-1429"></a><span>
</span><a name="line-1430"></a><span class="hs-comment">-- | Increase the counter for elapsed algorithm iterations, check that the</span><span>
</span><a name="line-1431"></a><span class="hs-comment">-- limit is not exceeded and call `pmcheckGuards`</span><span>
</span><a name="line-1432"></a><span class="hs-identifier">pmcheckGuardsI</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1433"></a><a name="pmcheckGuardsI"><a href="Check.html#pmcheckGuardsI"><span class="hs-identifier">pmcheckGuardsI</span></a></a><span> </span><a name="local-6989586621680278984"><a href="#local-6989586621680278984"><span class="hs-identifier">gvs</span></a></a><span> </span><a name="local-6989586621680278985"><a href="#local-6989586621680278985"><span class="hs-identifier">vva</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#incrCheckPmIterDs"><span class="hs-identifier hs-var">incrCheckPmIterDs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="Check.html#pmcheckGuards"><span class="hs-identifier hs-var">pmcheckGuards</span></a><span> </span><a href="#local-6989586621680278984"><span class="hs-identifier hs-var">gvs</span></a><span> </span><a href="#local-6989586621680278985"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1434"></a><span class="hs-pragma">{-# INLINE pmcheckGuardsI #-}</span><span>
</span><a name="line-1435"></a><span>
</span><a name="line-1436"></a><span class="hs-comment">-- | Increase the counter for elapsed algorithm iterations, check that the</span><span>
</span><a name="line-1437"></a><span class="hs-comment">-- limit is not exceeded and call `pmcheckHd`</span><span>
</span><a name="line-1438"></a><span class="hs-identifier">pmcheckHdI</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span>
</span><a name="line-1439"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1440"></a><a name="pmcheckHdI"><a href="Check.html#pmcheckHdI"><span class="hs-identifier">pmcheckHdI</span></a></a><span> </span><a name="local-6989586621680278986"><a href="#local-6989586621680278986"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621680278987"><a href="#local-6989586621680278987"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680278988"><a href="#local-6989586621680278988"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621680278989"><a href="#local-6989586621680278989"><span class="hs-identifier">va</span></a></a><span> </span><a name="local-6989586621680278990"><a href="#local-6989586621680278990"><span class="hs-identifier">vva</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1441"></a><span>  </span><a name="local-6989586621680278991"><a href="#local-6989586621680278991"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="DsMonad.html#incrCheckPmIterDs"><span class="hs-identifier hs-var">incrCheckPmIterDs</span></a><span>
</span><a name="line-1442"></a><span>  </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;pmCheckHdI&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278991"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Check.html#pprPmPatDebug"><span class="hs-identifier hs-var">pprPmPatDebug</span></a><span> </span><a href="#local-6989586621680278986"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1443"></a><span>                        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Check.html#pprPatVec"><span class="hs-identifier hs-var">pprPatVec</span></a><span> </span><a href="#local-6989586621680278987"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-1444"></a><span>                        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;guards:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprPatVec"><span class="hs-identifier hs-var">pprPatVec</span></a><span> </span><a href="#local-6989586621680278988"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1445"></a><span>                        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Check.html#pprPmPatDebug"><span class="hs-identifier hs-var">pprPmPatDebug</span></a><span> </span><a href="#local-6989586621680278989"><span class="hs-identifier hs-var">va</span></a><span>
</span><a name="line-1446"></a><span>                        </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Check.html#pprValVecDebug"><span class="hs-identifier hs-var">pprValVecDebug</span></a><span> </span><a href="#local-6989586621680278990"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span>
</span><a name="line-1448"></a><span>  </span><a name="local-6989586621680278992"><a href="#local-6989586621680278992"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#pmcheckHd"><span class="hs-identifier hs-var">pmcheckHd</span></a><span> </span><a href="#local-6989586621680278986"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680278987"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680278988"><span class="hs-identifier hs-var">guards</span></a><span> </span><a href="#local-6989586621680278989"><span class="hs-identifier hs-var">va</span></a><span> </span><a href="#local-6989586621680278990"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1449"></a><span>  </span><a href="Check.html#tracePm"><span class="hs-identifier hs-var">tracePm</span></a><span> </span><span class="hs-string">&quot;pmCheckHdI: res&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680278992"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-1450"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680278992"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1451"></a><span class="hs-pragma">{-# INLINE pmcheckHdI #-}</span><span>
</span><a name="line-1452"></a><span>
</span><a name="line-1453"></a><span class="hs-comment">-- | Matching function: Check simultaneously a clause (takes separately the</span><span>
</span><a name="line-1454"></a><span class="hs-comment">-- patterns and the list of guards) for exhaustiveness, redundancy and</span><span>
</span><a name="line-1455"></a><span class="hs-comment">-- inaccessibility.</span><span>
</span><a name="line-1456"></a><span class="hs-identifier">pmcheck</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1457"></a><a name="pmcheck"><a href="Check.html#pmcheck"><span class="hs-identifier">pmcheck</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621680278993"><a href="#local-6989586621680278993"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621680278994"><a href="#local-6989586621680278994"><span class="hs-identifier">vva</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1458"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680278993"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">presultCovered</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#Covered"><span class="hs-identifier hs-var">Covered</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1459"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#pmcheckGuardsI"><span class="hs-identifier hs-var">pmcheckGuardsI</span></a><span> </span><a href="#local-6989586621680278993"><span class="hs-identifier hs-var">guards</span></a><span> </span><a href="#local-6989586621680278994"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1460"></a><span>
</span><a name="line-1461"></a><span class="hs-comment">-- Guard</span><span>
</span><a name="line-1462"></a><span class="hs-identifier">pmcheck</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278995"><a href="#local-6989586621680278995"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><a name="local-6989586621680278996"><a href="#local-6989586621680278996"><span class="hs-identifier">pv</span></a></a><span> </span><a name="local-6989586621680278997"><a href="#local-6989586621680278997"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680278998"><a href="#local-6989586621680278998"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680278999"><a href="#local-6989586621680278999"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621680279000"><a href="#local-6989586621680279000"><span class="hs-identifier">vva</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279001"><a href="#local-6989586621680279001"><span class="hs-identifier">vas</span></a></a><span> </span><a name="local-6989586621680279002"><a href="#local-6989586621680279002"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1463"></a><span>    </span><span class="hs-comment">-- short-circuit if the guard pattern is useless.</span><span>
</span><a name="line-1464"></a><span>    </span><span class="hs-comment">-- we just have two possible outcomes: fail here or match and recurse</span><span>
</span><a name="line-1465"></a><span>    </span><span class="hs-comment">-- none of the two contains any useful information about the failure</span><span>
</span><a name="line-1466"></a><span>    </span><span class="hs-comment">-- though. So just have these two cases but do not do all the boilerplate</span><span>
</span><a name="line-1467"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#isFakeGuard"><span class="hs-identifier hs-var">isFakeGuard</span></a><span> </span><a href="#local-6989586621680278996"><span class="hs-identifier hs-var">pv</span></a><span> </span><a href="#local-6989586621680278997"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#forces"><span class="hs-identifier hs-var">forces</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Check.html#mkCons"><span class="hs-identifier hs-var">mkCons</span></a><span> </span><a href="#local-6989586621680279000"><span class="hs-identifier hs-var">vva</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><a href="#local-6989586621680278998"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680278999"><span class="hs-identifier hs-var">guards</span></a><span> </span><a href="#local-6989586621680279000"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1468"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1469"></a><span>      </span><a name="local-6989586621680279003"><a href="#local-6989586621680279003"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#mkPmId"><span class="hs-identifier hs-var">mkPmId</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pmPatType"><span class="hs-identifier hs-var">pmPatType</span></a><span> </span><a href="#local-6989586621680278995"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1470"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279004"><a href="#local-6989586621680279004"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TmOracle.html#extendSubst"><span class="hs-identifier hs-var">extendSubst</span></a><span> </span><a href="#local-6989586621680279003"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621680278997"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279002"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span>
</span><a name="line-1471"></a><span>          </span><a name="local-6989586621680279005"><a href="#local-6989586621680279005"><span class="hs-identifier">delta'</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279002"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279004"><span class="hs-identifier hs-var">tm_state</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1472"></a><span>      </span><a href="Check.html#utail"><span class="hs-identifier hs-var">utail</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278996"><span class="hs-identifier hs-var">pv</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680278998"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680278999"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="#local-6989586621680279003"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680279001"><span class="hs-identifier hs-var">vas</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279005"><span class="hs-identifier hs-var">delta'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1473"></a><span>
</span><a name="line-1474"></a><span class="hs-identifier">pmcheck</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;pmcheck: nil-cons&quot;</span><span>
</span><a name="line-1475"></a><span class="hs-identifier">pmcheck</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;pmcheck: cons-nil&quot;</span><span>
</span><a name="line-1476"></a><span>
</span><a name="line-1477"></a><span class="hs-identifier">pmcheck</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279006"><a href="#local-6989586621680279006"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680279007"><a href="#local-6989586621680279007"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279008"><a href="#local-6989586621680279008"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680279009"><a href="#local-6989586621680279009"><span class="hs-identifier">va</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680279010"><a href="#local-6989586621680279010"><span class="hs-identifier">vva</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279011"><a href="#local-6989586621680279011"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1478"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#pmcheckHdI"><span class="hs-identifier hs-var">pmcheckHdI</span></a><span> </span><a href="#local-6989586621680279006"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680279007"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279008"><span class="hs-identifier hs-var">guards</span></a><span> </span><a href="#local-6989586621680279009"><span class="hs-identifier hs-var">va</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680279010"><span class="hs-identifier hs-var">vva</span></a><span> </span><a href="#local-6989586621680279011"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span>
</span><a name="line-1479"></a><span>
</span><a name="line-1480"></a><span class="hs-comment">-- | Check the list of guards</span><span>
</span><a name="line-1481"></a><span class="hs-identifier">pmcheckGuards</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1482"></a><a name="pmcheckGuards"><a href="Check.html#pmcheckGuards"><span class="hs-identifier">pmcheckGuards</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><a name="local-6989586621680279012"><a href="#local-6989586621680279012"><span class="hs-identifier">vva</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#usimple"><span class="hs-identifier hs-var">usimple</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680279012"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1483"></a><span class="hs-identifier">pmcheckGuards</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279013"><a href="#local-6989586621680279013"><span class="hs-identifier">gv</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680279014"><a href="#local-6989586621680279014"><span class="hs-identifier">gvs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279015"><a href="#local-6989586621680279015"><span class="hs-identifier">vva</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1484"></a><span>  </span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a name="local-6989586621680279016"><a href="#local-6989586621680279016"><span class="hs-identifier">prov1</span></a></a><span> </span><a name="local-6989586621680279017"><a href="#local-6989586621680279017"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621680279018"><a href="#local-6989586621680279018"><span class="hs-identifier">vsa</span></a></a><span> </span><a name="local-6989586621680279019"><a href="#local-6989586621680279019"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><a href="#local-6989586621680279013"><span class="hs-identifier hs-var">gv</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621680279015"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1485"></a><span>  </span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><a name="local-6989586621680279020"><a href="#local-6989586621680279020"><span class="hs-identifier">prov2</span></a></a><span> </span><a name="local-6989586621680279021"><a href="#local-6989586621680279021"><span class="hs-identifier">css</span></a></a><span> </span><a name="local-6989586621680279022"><a href="#local-6989586621680279022"><span class="hs-identifier">vsas</span></a></a><span> </span><a name="local-6989586621680279023"><a href="#local-6989586621680279023"><span class="hs-identifier">dss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#runMany"><span class="hs-identifier hs-var">runMany</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pmcheckGuardsI"><span class="hs-identifier hs-var">pmcheckGuardsI</span></a><span> </span><a href="#local-6989586621680279014"><span class="hs-identifier hs-var">gvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279018"><span class="hs-identifier hs-var">vsa</span></a><span>
</span><a name="line-1486"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279016"><span class="hs-identifier hs-var">prov1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680279020"><span class="hs-identifier hs-var">prov2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1487"></a><span>                         </span><span class="hs-special">(</span><a href="#local-6989586621680279017"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680279021"><span class="hs-identifier hs-var">css</span></a><span class="hs-special">)</span><span>
</span><a name="line-1488"></a><span>                         </span><a href="#local-6989586621680279022"><span class="hs-identifier hs-var">vsas</span></a><span>
</span><a name="line-1489"></a><span>                         </span><span class="hs-special">(</span><a href="#local-6989586621680279019"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680279023"><span class="hs-identifier hs-var">dss</span></a><span class="hs-special">)</span><span>
</span><a name="line-1490"></a><span>
</span><a name="line-1491"></a><span class="hs-comment">-- | Worker function: Implements all cases described in the paper for all three</span><span>
</span><a name="line-1492"></a><span class="hs-comment">-- functions (`covered`, `uncovered` and `divergent`) apart from the `Guard`</span><span>
</span><a name="line-1493"></a><span class="hs-comment">-- cases which are handled by `pmcheck`</span><span>
</span><a name="line-1494"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span>
</span><a name="line-1495"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1496"></a><span>
</span><a name="line-1497"></a><span class="hs-comment">-- Var</span><span>
</span><a name="line-1498"></a><a name="pmcheckHd"><a href="Check.html#pmcheckHd"><span class="hs-identifier">pmcheckHd</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a name="local-6989586621680279024"><a href="#local-6989586621680279024"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279025"><a href="#local-6989586621680279025"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279026"><a href="#local-6989586621680279026"><span class="hs-identifier">guards</span></a></a><span> </span><a name="local-6989586621680279027"><a href="#local-6989586621680279027"><span class="hs-identifier">va</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279028"><a href="#local-6989586621680279028"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279029"><a href="#local-6989586621680279029"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1499"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279030"><a href="#local-6989586621680279030"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TmOracle.html#solveOneEq"><span class="hs-identifier hs-var">solveOneEq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279029"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span>
</span><a name="line-1500"></a><span>                                </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprVar"><span class="hs-identifier hs-var">PmExprVar</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680279024"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Check.html#vaToPmExpr"><span class="hs-identifier hs-var">vaToPmExpr</span></a><span> </span><a href="#local-6989586621680279027"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">)</span><span>
</span><a name="line-1501"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#ucon"><span class="hs-identifier hs-var">ucon</span></a><span> </span><a href="#local-6989586621680279027"><span class="hs-identifier hs-var">va</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><a href="#local-6989586621680279025"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279026"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680279028"><span class="hs-identifier hs-var">vva</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279029"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279030"><span class="hs-identifier hs-var">tm_state</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1502"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1503"></a><span>
</span><a name="line-1504"></a><span class="hs-comment">-- ConCon</span><span>
</span><a name="line-1505"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><span> </span><a name="local-6989586621680279031"><a href="#local-6989586621680279031"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279032"><a href="#local-6989586621680279032"><span class="hs-identifier">c1</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279033"><a href="#local-6989586621680279033"><span class="hs-identifier">ex_tvs1</span></a></a><span>
</span><a name="line-1506"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279034"><a href="#local-6989586621680279034"><span class="hs-identifier">args1</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680279035"><a href="#local-6989586621680279035"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279036"><a href="#local-6989586621680279036"><span class="hs-identifier">guards</span></a></a><span>
</span><a name="line-1507"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621680279037"><a href="#local-6989586621680279037"><span class="hs-identifier">va</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279038"><a href="#local-6989586621680279038"><span class="hs-identifier">c2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279039"><a href="#local-6989586621680279039"><span class="hs-identifier">ex_tvs2</span></a></a><span>
</span><a name="line-1508"></a><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279040"><a href="#local-6989586621680279040"><span class="hs-identifier">args2</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279041"><a href="#local-6989586621680279041"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279042"><a href="#local-6989586621680279042"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1509"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680279032"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621680279038"><span class="hs-identifier hs-var">c2</span></a><span>  </span><span class="hs-glyph">=</span><span>
</span><a name="line-1510"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#usimple"><span class="hs-identifier hs-var">usimple</span></a><span> </span><span class="hs-special">[</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279037"><span class="hs-identifier hs-var">va</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680279041"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279042"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1511"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1512"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279043"><a href="#local-6989586621680279043"><span class="hs-identifier">to_evvar</span></a></a><span> </span><a name="local-6989586621680279045"><a href="#local-6989586621680279045"><span class="hs-identifier">tv1</span></a></a><span> </span><a name="local-6989586621680279046"><a href="#local-6989586621680279046"><span class="hs-identifier">tv2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#nameType"><span class="hs-identifier hs-var">nameType</span></a><span> </span><span class="hs-string">&quot;pmConCon&quot;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1513"></a><span>                           </span><a href="Type.html#mkPrimEqPred"><span class="hs-identifier hs-var">mkPrimEqPred</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-6989586621680279045"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span> </span><a href="#local-6989586621680279046"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1514"></a><span>        </span><a name="local-6989586621680279044"><a href="#local-6989586621680279044"><span class="hs-identifier">mb_to_evvar</span></a></a><span> </span><a name="local-6989586621680279047"><a href="#local-6989586621680279047"><span class="hs-identifier">tv1</span></a></a><span> </span><a name="local-6989586621680279048"><a href="#local-6989586621680279048"><span class="hs-identifier">tv2</span></a></a><span>
</span><a name="line-1515"></a><span>            </span><span class="hs-comment">-- If we have identical constructors but different existential</span><span>
</span><a name="line-1516"></a><span>            </span><span class="hs-comment">-- tyvars, then generate extra equality constraints to ensure the</span><span>
</span><a name="line-1517"></a><span>            </span><span class="hs-comment">-- existential tyvars.</span><span>
</span><a name="line-1518"></a><span>            </span><span class="hs-comment">-- See Note [Coverage checking and existential tyvars].</span><span>
</span><a name="line-1519"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680279047"><span class="hs-identifier hs-var">tv1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680279048"><span class="hs-identifier hs-var">tv2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1520"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621680279043"><span class="hs-identifier hs-var">to_evvar</span></a><span> </span><a href="#local-6989586621680279047"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-6989586621680279048"><span class="hs-identifier hs-var">tv2</span></a><span>
</span><a name="line-1521"></a><span>    </span><a name="local-6989586621680279049"><a href="#local-6989586621680279049"><span class="hs-identifier">evvars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1522"></a><span>              </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">ex_tvs1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><a href="Util.html#equalLength"><span class="hs-identifier hs-var">ex_tvs2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1523"></a><span>              </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#zipWithM"><span class="hs-identifier hs-var">zipWithM</span></a><span> </span><a href="#local-6989586621680279044"><span class="hs-identifier hs-var">mb_to_evvar</span></a><span> </span><a href="#local-6989586621680279033"><span class="hs-identifier hs-var">ex_tvs1</span></a><span> </span><a href="#local-6989586621680279039"><span class="hs-identifier hs-var">ex_tvs2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1524"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279050"><a href="#local-6989586621680279050"><span class="hs-identifier">delta'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279042"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">delta_ty_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279049"><span class="hs-identifier hs-var">evvars</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">delta_ty_cs</span><span> </span><a href="#local-6989586621680279042"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1525"></a><span>    </span><a href="Check.html#kcon"><span class="hs-identifier hs-var">kcon</span></a><span> </span><a href="#local-6989586621680279032"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><a href="#local-6989586621680279031"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pm_con_tvs</span><span> </span><a href="#local-6989586621680279031"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pm_con_dicts</span><span> </span><a href="#local-6989586621680279031"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1526"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279034"><span class="hs-identifier hs-var">args1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680279035"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279036"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279040"><span class="hs-identifier hs-var">args2</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680279041"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279050"><span class="hs-identifier hs-var">delta'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1527"></a><span>
</span><a name="line-1528"></a><span class="hs-comment">-- LitLit</span><span>
</span><a name="line-1529"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a name="local-6989586621680279051"><a href="#local-6989586621680279051"><span class="hs-identifier">l1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279052"><a href="#local-6989586621680279052"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279053"><a href="#local-6989586621680279053"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680279054"><a href="#local-6989586621680279054"><span class="hs-identifier">va</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a name="local-6989586621680279055"><a href="#local-6989586621680279055"><span class="hs-identifier">l2</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680279056"><a href="#local-6989586621680279056"><span class="hs-identifier">vva</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1530"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="PmExpr.html#eqPmLit"><span class="hs-identifier hs-var">eqPmLit</span></a><span> </span><a href="#local-6989586621680279051"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621680279055"><span class="hs-identifier hs-var">l2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1531"></a><span>    </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ucon"><span class="hs-identifier hs-var">ucon</span></a><span> </span><a href="#local-6989586621680279054"><span class="hs-identifier hs-var">va</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><a href="#local-6989586621680279052"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279053"><span class="hs-identifier hs-var">guards</span></a><span> </span><a href="#local-6989586621680279056"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1532"></a><span>    </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#ucon"><span class="hs-identifier hs-var">ucon</span></a><span> </span><a href="#local-6989586621680279054"><span class="hs-identifier hs-var">va</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#usimple"><span class="hs-identifier hs-var">usimple</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680279056"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1533"></a><span>
</span><a name="line-1534"></a><span class="hs-comment">-- ConVar</span><span>
</span><a name="line-1535"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279057"><a href="#local-6989586621680279057"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279058"><a href="#local-6989586621680279058"><span class="hs-identifier">con</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279059"><a href="#local-6989586621680279059"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1536"></a><span>          </span><a name="local-6989586621680279060"><a href="#local-6989586621680279060"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279061"><a href="#local-6989586621680279061"><span class="hs-identifier">guards</span></a></a><span>
</span><a name="line-1537"></a><span>          </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a name="local-6989586621680279062"><a href="#local-6989586621680279062"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279063"><a href="#local-6989586621680279063"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279064"><a href="#local-6989586621680279064"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1538"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621680279065"><a href="#local-6989586621680279065"><span class="hs-identifier">prov</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680279066"><a href="#local-6989586621680279066"><span class="hs-identifier">complete_match</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="ListT.html#select"><span class="hs-identifier hs-var">select</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#allCompleteMatches"><span class="hs-identifier hs-var">allCompleteMatches</span></a><span> </span><a href="#local-6989586621680279058"><span class="hs-identifier hs-var">con</span></a><span> </span><a href="#local-6989586621680279059"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1539"></a><span>
</span><a name="line-1540"></a><span>  </span><a name="local-6989586621680279067"><a href="#local-6989586621680279067"><span class="hs-identifier">cons_cs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Check.html#mkOneConFull"><span class="hs-identifier hs-var">mkOneConFull</span></a><span> </span><a href="#local-6989586621680279062"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279066"><span class="hs-identifier hs-var">complete_match</span></a><span>
</span><a name="line-1541"></a><span>
</span><a name="line-1542"></a><span>  </span><a name="local-6989586621680279075"><a href="#local-6989586621680279075"><span class="hs-identifier">inst_vsa</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="MonadUtils.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a><span> </span><a href="#local-6989586621680279067"><span class="hs-identifier hs-var">cons_cs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621680279068"><a href="#local-6989586621680279068"><span class="hs-identifier">va</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680279069"><a href="#local-6989586621680279069"><span class="hs-identifier">tm_ct</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680279070"><a href="#local-6989586621680279070"><span class="hs-identifier">ty_cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1543"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279071"><a href="#local-6989586621680279071"><span class="hs-identifier">ty_state</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279070"><span class="hs-identifier hs-var">ty_cs</span></a><span> </span><span class="hs-special">`</span><a href="Bag.html#unionBags"><span class="hs-identifier hs-var">unionBags</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">delta_ty_cs</span><span> </span><a href="#local-6989586621680279064"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-comment">-- not actually a state</span><span>
</span><a name="line-1544"></a><span>    </span><a name="local-6989586621680279072"><a href="#local-6989586621680279072"><span class="hs-identifier">sat_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Bag.html#isEmptyBag"><span class="hs-identifier hs-var">isEmptyBag</span></a><span> </span><a href="#local-6989586621680279070"><span class="hs-identifier hs-var">ty_cs</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1545"></a><span>                                  </span><span class="hs-keyword">else</span><span> </span><a href="Check.html#tyOracle"><span class="hs-identifier hs-var">tyOracle</span></a><span> </span><a href="#local-6989586621680279071"><span class="hs-identifier hs-var">ty_state</span></a><span>
</span><a name="line-1546"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279072"><span class="hs-identifier hs-var">sat_ty</span></a><span class="hs-special">,</span><span> </span><a href="TmOracle.html#solveOneEq"><span class="hs-identifier hs-var">solveOneEq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279064"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279069"><span class="hs-identifier hs-var">tm_ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1547"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">True</span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279073"><a href="#local-6989586621680279073"><span class="hs-identifier">tm_state</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279068"><span class="hs-identifier hs-var">va</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680279063"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#MkDelta"><span class="hs-identifier hs-var">MkDelta</span></a><span> </span><a href="#local-6989586621680279071"><span class="hs-identifier hs-var">ty_state</span></a><span> </span><a href="#local-6989586621680279073"><span class="hs-identifier hs-var">tm_state</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1548"></a><span>      </span><a name="local-6989586621680279074"><a href="#local-6989586621680279074"><span class="hs-identifier">_ty_or_tm_failed</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1549"></a><span>
</span><a name="line-1550"></a><span>  </span><a href="Check.html#set_provenance"><span class="hs-identifier hs-var">set_provenance</span></a><span> </span><a href="#local-6989586621680279065"><span class="hs-identifier hs-var">prov</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span>
</span><a name="line-1551"></a><span>    </span><a href="Check.html#force_if"><span class="hs-identifier hs-var">force_if</span></a><span> </span><span class="hs-special">(</span><a href="TmOracle.html#canDiverge"><span class="hs-identifier hs-var">canDiverge</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680279062"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279064"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1552"></a><span>      </span><a href="Check.html#runMany"><span class="hs-identifier hs-var">runMany</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pmcheckI"><span class="hs-identifier hs-var">pmcheckI</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279057"><span class="hs-identifier hs-var">p</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680279060"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279061"><span class="hs-identifier hs-var">guards</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279075"><span class="hs-identifier hs-var">inst_vsa</span></a><span>
</span><a name="line-1553"></a><span>
</span><a name="line-1554"></a><span class="hs-comment">-- LitVar</span><span>
</span><a name="line-1555"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279076"><a href="#local-6989586621680279076"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a name="local-6989586621680279077"><a href="#local-6989586621680279077"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680279078"><a href="#local-6989586621680279078"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279079"><a href="#local-6989586621680279079"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a name="local-6989586621680279080"><a href="#local-6989586621680279080"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279081"><a href="#local-6989586621680279081"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279082"><a href="#local-6989586621680279082"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1556"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#force_if"><span class="hs-identifier hs-var">force_if</span></a><span> </span><span class="hs-special">(</span><a href="TmOracle.html#canDiverge"><span class="hs-identifier hs-var">canDiverge</span></a><span> </span><span class="hs-special">(</span><a href="Id.html#idName"><span class="hs-identifier hs-var">idName</span></a><span> </span><a href="#local-6989586621680279080"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279082"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1557"></a><span>      </span><a href="Check.html#mkUnion"><span class="hs-identifier hs-var">mkUnion</span></a><span> </span><a href="#local-6989586621680279084"><span class="hs-identifier hs-var">non_matched</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1558"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="TmOracle.html#solveOneEq"><span class="hs-identifier hs-var">solveOneEq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279082"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#mkPosEq"><span class="hs-identifier hs-var">mkPosEq</span></a><span> </span><a href="#local-6989586621680279080"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621680279077"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1559"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279086"><a href="#local-6989586621680279086"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#pmcheckHdI"><span class="hs-identifier hs-var">pmcheckHdI</span></a><span> </span><a href="#local-6989586621680279076"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680279078"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279079"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a href="#local-6989586621680279077"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1560"></a><span>                             </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680279081"><span class="hs-identifier hs-var">vva</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279082"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279086"><span class="hs-identifier hs-var">tm_state</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1561"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1562"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1563"></a><span>    </span><a name="local-6989586621680279083"><a href="#local-6989586621680279083"><span class="hs-identifier">us</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279085"><a href="#local-6989586621680279085"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TmOracle.html#solveOneEq"><span class="hs-identifier hs-var">solveOneEq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279082"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#mkNegEq"><span class="hs-identifier hs-var">mkNegEq</span></a><span> </span><a href="#local-6989586621680279080"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621680279077"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1564"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmNLit"><span class="hs-identifier hs-var">PmNLit</span></a><span> </span><a href="#local-6989586621680279080"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680279077"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680279081"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279082"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279085"><span class="hs-identifier hs-var">tm_state</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1565"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1566"></a><span>
</span><a name="line-1567"></a><span>    </span><a name="local-6989586621680279084"><a href="#local-6989586621680279084"><span class="hs-identifier">non_matched</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#usimple"><span class="hs-identifier hs-var">usimple</span></a><span> </span><a href="#local-6989586621680279083"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-1568"></a><span>
</span><a name="line-1569"></a><span class="hs-comment">-- LitNLit</span><span>
</span><a name="line-1570"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279087"><a href="#local-6989586621680279087"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a name="local-6989586621680279088"><a href="#local-6989586621680279088"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680279089"><a href="#local-6989586621680279089"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279090"><a href="#local-6989586621680279090"><span class="hs-identifier">guards</span></a></a><span>
</span><a name="line-1571"></a><span>          </span><span class="hs-special">(</span><a href="Check.html#PmNLit"><span class="hs-identifier hs-var">PmNLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279091"><a href="#local-6989586621680279091"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_lit_not</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279092"><a href="#local-6989586621680279092"><span class="hs-identifier">lits</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279093"><a href="#local-6989586621680279093"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279094"><a href="#local-6989586621680279094"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1572"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="PmExpr.html#eqPmLit"><span class="hs-identifier hs-var">eqPmLit</span></a><span> </span><a href="#local-6989586621680279088"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279092"><span class="hs-identifier hs-var">lits</span></a><span>
</span><a name="line-1573"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279098"><a href="#local-6989586621680279098"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TmOracle.html#solveOneEq"><span class="hs-identifier hs-var">solveOneEq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279094"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#mkPosEq"><span class="hs-identifier hs-var">mkPosEq</span></a><span> </span><a href="#local-6989586621680279091"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621680279088"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1574"></a><span>    </span><span class="hs-comment">-- Both guards check the same so it would be sufficient to have only</span><span>
</span><a name="line-1575"></a><span>    </span><span class="hs-comment">-- the second one. Nevertheless, it is much cheaper to check whether</span><span>
</span><a name="line-1576"></a><span>    </span><span class="hs-comment">-- the literal is in the list so we check it first, to avoid calling</span><span>
</span><a name="line-1577"></a><span>    </span><span class="hs-comment">-- the term oracle (`solveOneEq`) if possible</span><span>
</span><a name="line-1578"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#mkUnion"><span class="hs-identifier hs-var">mkUnion</span></a><span> </span><a href="#local-6989586621680279096"><span class="hs-identifier hs-var">non_matched</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1579"></a><span>      </span><a href="Check.html#pmcheckHdI"><span class="hs-identifier hs-var">pmcheckHdI</span></a><span> </span><a href="#local-6989586621680279087"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680279089"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279090"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a href="#local-6989586621680279088"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1580"></a><span>                </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680279093"><span class="hs-identifier hs-var">vva</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279094"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279098"><span class="hs-identifier hs-var">tm_state</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1581"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680279096"><span class="hs-identifier hs-var">non_matched</span></a><span>
</span><a name="line-1582"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1583"></a><span>    </span><a name="local-6989586621680279095"><a href="#local-6989586621680279095"><span class="hs-identifier">us</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279097"><a href="#local-6989586621680279097"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TmOracle.html#solveOneEq"><span class="hs-identifier hs-var">solveOneEq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279094"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#mkNegEq"><span class="hs-identifier hs-var">mkNegEq</span></a><span> </span><a href="#local-6989586621680279091"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621680279088"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-1584"></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmNLit"><span class="hs-identifier hs-var">PmNLit</span></a><span> </span><a href="#local-6989586621680279091"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279088"><span class="hs-identifier hs-var">l</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680279092"><span class="hs-identifier hs-var">lits</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680279093"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279094"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279097"><span class="hs-identifier hs-var">tm_state</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1585"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1586"></a><span>
</span><a name="line-1587"></a><span>    </span><a name="local-6989586621680279096"><a href="#local-6989586621680279096"><span class="hs-identifier">non_matched</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#usimple"><span class="hs-identifier hs-var">usimple</span></a><span> </span><a href="#local-6989586621680279095"><span class="hs-identifier hs-var">us</span></a><span>
</span><a name="line-1588"></a><span>
</span><a name="line-1589"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1590"></a><span class="hs-comment">-- The following three can happen only in cases like #322 where constructors</span><span>
</span><a name="line-1591"></a><span class="hs-comment">-- and overloaded literals appear in the same match. The general strategy is</span><span>
</span><a name="line-1592"></a><span class="hs-comment">-- to replace the literal (positive/negative) by a variable and recurse. The</span><span>
</span><a name="line-1593"></a><span class="hs-comment">-- fact that the variable is equal to the literal is recorded in `delta` so</span><span>
</span><a name="line-1594"></a><span class="hs-comment">-- no information is lost</span><span>
</span><a name="line-1595"></a><span>
</span><a name="line-1596"></a><span class="hs-comment">-- LitCon</span><span>
</span><a name="line-1597"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a name="local-6989586621680279099"><a href="#local-6989586621680279099"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279100"><a href="#local-6989586621680279100"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279101"><a href="#local-6989586621680279101"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680279102"><a href="#local-6989586621680279102"><span class="hs-identifier">va</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279103"><a href="#local-6989586621680279103"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279104"><a href="#local-6989586621680279104"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1598"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680279105"><a href="#local-6989586621680279105"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#mkPmId"><span class="hs-identifier hs-var">mkPmId</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pmPatType"><span class="hs-identifier hs-var">pmPatType</span></a><span> </span><a href="#local-6989586621680279102"><span class="hs-identifier hs-var">va</span></a><span class="hs-special">)</span><span>
</span><a name="line-1599"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279106"><a href="#local-6989586621680279106"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TmOracle.html#extendSubst"><span class="hs-identifier hs-var">extendSubst</span></a><span> </span><a href="#local-6989586621680279105"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprLit"><span class="hs-identifier hs-var">PmExprLit</span></a><span> </span><a href="#local-6989586621680279099"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279104"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span>
</span><a name="line-1600"></a><span>           </span><a name="local-6989586621680279107"><a href="#local-6989586621680279107"><span class="hs-identifier">delta'</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279104"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279106"><span class="hs-identifier hs-var">tm_state</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1601"></a><span>       </span><a href="Check.html#pmcheckHdI"><span class="hs-identifier hs-var">pmcheckHdI</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="#local-6989586621680279105"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279100"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279101"><span class="hs-identifier hs-var">guards</span></a><span> </span><a href="#local-6989586621680279102"><span class="hs-identifier hs-var">va</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680279103"><span class="hs-identifier hs-var">vva</span></a><span> </span><a href="#local-6989586621680279107"><span class="hs-identifier hs-var">delta'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1602"></a><span>
</span><a name="line-1603"></a><span class="hs-comment">-- ConLit</span><span>
</span><a name="line-1604"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279108"><a href="#local-6989586621680279108"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680279109"><a href="#local-6989586621680279109"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279110"><a href="#local-6989586621680279110"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a name="local-6989586621680279111"><a href="#local-6989586621680279111"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279112"><a href="#local-6989586621680279112"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279113"><a href="#local-6989586621680279113"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1605"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680279114"><a href="#local-6989586621680279114"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#mkPmId"><span class="hs-identifier hs-var">mkPmId</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pmPatType"><span class="hs-identifier hs-var">pmPatType</span></a><span> </span><a href="#local-6989586621680279108"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-1606"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279115"><a href="#local-6989586621680279115"><span class="hs-identifier">tm_state</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TmOracle.html#extendSubst"><span class="hs-identifier hs-var">extendSubst</span></a><span> </span><a href="#local-6989586621680279114"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="PmExpr.html#PmExprLit"><span class="hs-identifier hs-var">PmExprLit</span></a><span> </span><a href="#local-6989586621680279111"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680279113"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span>
</span><a name="line-1607"></a><span>           </span><a name="local-6989586621680279116"><a href="#local-6989586621680279116"><span class="hs-identifier">delta'</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279113"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">delta_tm_cs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279115"><span class="hs-identifier hs-var">tm_state</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1608"></a><span>       </span><a href="Check.html#pmcheckHdI"><span class="hs-identifier hs-var">pmcheckHdI</span></a><span> </span><a href="#local-6989586621680279108"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680279109"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279110"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="#local-6989586621680279114"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680279112"><span class="hs-identifier hs-var">vva</span></a><span> </span><a href="#local-6989586621680279116"><span class="hs-identifier hs-var">delta'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1609"></a><span>
</span><a name="line-1610"></a><span class="hs-comment">-- ConNLit</span><span>
</span><a name="line-1611"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279117"><a href="#local-6989586621680279117"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680279118"><a href="#local-6989586621680279118"><span class="hs-identifier">ps</span></a></a><span> </span><a name="local-6989586621680279119"><a href="#local-6989586621680279119"><span class="hs-identifier">guards</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmNLit"><span class="hs-identifier hs-var">PmNLit</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_lit_id</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279120"><a href="#local-6989586621680279120"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680279121"><a href="#local-6989586621680279121"><span class="hs-identifier">vva</span></a></a><span>
</span><a name="line-1612"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#pmcheckHdI"><span class="hs-identifier hs-var">pmcheckHdI</span></a><span> </span><a href="#local-6989586621680279117"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621680279118"><span class="hs-identifier hs-var">ps</span></a><span> </span><a href="#local-6989586621680279119"><span class="hs-identifier hs-var">guards</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a href="#local-6989586621680279120"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279121"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1613"></a><span>
</span><a name="line-1614"></a><span class="hs-comment">-- Impossible: handled by pmcheck</span><span>
</span><a name="line-1615"></a><span class="hs-identifier">pmcheckHd</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;pmcheckHd: Guard&quot;</span><span>
</span><a name="line-1616"></a><span>
</span><a name="line-1617"></a><span class="hs-comment">{-
Note [Coverage checking and existential tyvars]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
GHC's implementation of the pattern-match coverage algorithm (as described in
the GADTs Meet Their Match paper) must take some care to emit enough type
constraints when handling data constructors with exisentially quantified type
variables. To better explain what the challenge is, consider a constructor K
of the form:

  K @e_1 ... @e_m ev_1 ... ev_v ty_1 ... ty_n :: T u_1 ... u_p

Where:

* e_1, ..., e_m are the existentially bound type variables.
* ev_1, ..., ev_v are evidence variables, which may inhabit a dictionary type
  (e.g., Eq) or an equality constraint (e.g., e_1 ~ Int).
* ty_1, ..., ty_n are the types of K's fields.
* T u_1 ... u_p is the return type, where T is the data type constructor, and
  u_1, ..., u_p are the universally quantified type variables.

In the ConVar case, the coverage algorithm will have in hand the constructor
K as well as a pattern variable (pv :: T PV_1 ... PV_p), where PV_1, ..., PV_p
are some types that instantiate u_1, ... u_p. The idea is that we should
substitute PV_1 for u_1, ..., and PV_p for u_p when forming a PmCon (the
mkOneConFull function accomplishes this) and then hand this PmCon off to the
ConCon case.

The presence of existentially quantified type variables adds a significant
wrinkle. We always grab e_1, ..., e_m from the definition of K to begin with,
but we don't want them to appear in the final PmCon, because then
calling (mkOneConFull K) for other pattern variables might reuse the same
existential tyvars, which is certainly wrong.

Previously, GHC's solution to this wrinkle was to always create fresh names
for the existential tyvars and put them into the PmCon. This works well for
many cases, but it can break down if you nest GADT pattern matches in just
the right way. For instance, consider the following program:

    data App f a where
      App :: f a -&gt; App f (Maybe a)

    data Ty a where
      TBool :: Ty Bool
      TInt  :: Ty Int

    data T f a where
      C :: T Ty (Maybe Bool)

    foo :: T f a -&gt; App f a -&gt; ()
    foo C (App TBool) = ()

foo is a total program, but with the previous approach to handling existential
tyvars, GHC would mark foo's patterns as non-exhaustive.

When foo is desugared to Core, it looks roughly like so:

    foo @f @a (C co1 _co2) (App @a1 _co3 (TBool |&gt; co1)) = ()

(Where `a1` is an existential tyvar.)

That, in turn, is processed by the coverage checker to become:

    foo @f @a (C co1 _co2) (App @a1 _co3 (pmvar123 :: f a1))
      | TBool &lt;- pmvar123 |&gt; co1
      = ()

Note that the type of pmvar123 is `f a1`&#8212;this will be important later.

Now, we proceed with coverage-checking as usual. When we come to the
ConVar case for App, we create a fresh variable `a2` to represent its
existential tyvar. At this point, we have the equality constraints
`(a ~ Maybe a2, a ~ Maybe Bool, f ~ Ty)` in scope.

However, when we check the guard, it will use the type of pmvar123, which is
`f a1`. Thus, when considering if pmvar123 can match the constructor TInt,
it will generate the constraint `a1 ~ Int`. This means our final set of
equality constraints would be:

    f  ~ Ty
    a  ~ Maybe Bool
    a  ~ Maybe a2
    a1 ~ Int

Which is satisfiable! Freshening the existential tyvar `a` to `a2` doomed us,
because GHC is unable to relate `a2` to `a1`, which really should be the same
tyvar.

Luckily, we can avoid this pitfall. Recall that the ConVar case was where we
generated a PmCon with too-fresh existentials. But after ConVar, we have the
ConCon case, which considers whether each constructor of a particular data type
can be matched on in a particular spot.

In the case of App, when we get to the ConCon case, we will compare our
original App PmCon (from the source program) to the App PmCon created from the
ConVar case. In the former PmCon, we have `a1` in hand, which is exactly the
existential tyvar we want! Thus, we can force `a1` to be the same as `a2` here
by emitting an additional `a1 ~ a2` constraint. Now our final set of equality
constraints will be:

    f  ~ Ty
    a  ~ Maybe Bool
    a  ~ Maybe a2
    a1 ~ Int
    a1 ~ a2

Which is unsatisfiable, as we desired, since we now have that
Int ~ a1 ~ a2 ~ Bool.

In general, App might have more than one constructor, in which case we
couldn't reuse the existential tyvar for App for a different constructor. This
means that we can only use this trick in ConCon when the constructors are the
same. But this is fine, since this is the only scenario where this situation
arises in the first place!
-}</span><span>
</span><a name="line-1731"></a><span>
</span><a name="line-1732"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1733"></a><span class="hs-comment">-- * Utilities for main checking</span><span>
</span><a name="line-1734"></a><span>
</span><a name="line-1735"></a><span class="hs-identifier">updateVsa</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Check.html#ValSetAbs"><span class="hs-identifier hs-type">ValSetAbs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ValSetAbs"><span class="hs-identifier hs-type">ValSetAbs</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span class="hs-special">)</span><span>
</span><a name="line-1736"></a><a name="updateVsa"><a href="Check.html#updateVsa"><span class="hs-identifier">updateVsa</span></a></a><span> </span><a name="local-6989586621680279122"><a href="#local-6989586621680279122"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621680279123"><a href="#local-6989586621680279123"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Check.html#PartialResult"><span class="hs-identifier hs-var">PartialResult</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">presultUncovered</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279124"><a href="#local-6989586621680279124"><span class="hs-identifier">old</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1737"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279123"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">presultUncovered</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279122"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680279124"><span class="hs-identifier hs-var">old</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1738"></a><span>
</span><a name="line-1739"></a><span>
</span><a name="line-1740"></a><span class="hs-comment">-- | Initialise with default values for covering and divergent information.</span><span>
</span><a name="line-1741"></a><span class="hs-identifier">usimple</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#ValSetAbs"><span class="hs-identifier hs-type">ValSetAbs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1742"></a><a name="usimple"><a href="Check.html#usimple"><span class="hs-identifier">usimple</span></a></a><span> </span><a name="local-6989586621680279125"><a href="#local-6989586621680279125"><span class="hs-identifier">vsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">presultUncovered</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279125"><span class="hs-identifier hs-var">vsa</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1743"></a><span>
</span><a name="line-1744"></a><span class="hs-comment">-- | Take the tail of all value vector abstractions in the uncovered set</span><span>
</span><a name="line-1745"></a><span class="hs-identifier">utail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1746"></a><a name="utail"><a href="Check.html#utail"><span class="hs-identifier">utail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#updateVsa"><span class="hs-identifier hs-var">updateVsa</span></a><span> </span><a href="#local-6989586621680279126"><span class="hs-identifier hs-var">upd</span></a><span>
</span><a name="line-1747"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621680279126"><a href="#local-6989586621680279126"><span class="hs-identifier">upd</span></a></a><span> </span><a name="local-6989586621680279127"><a href="#local-6989586621680279127"><span class="hs-identifier">vsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a href="#local-6989586621680279128"><span class="hs-identifier hs-var">vva</span></a><span> </span><a href="#local-6989586621680279129"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621680279128"><a href="#local-6989586621680279128"><span class="hs-identifier">vva</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279129"><a href="#local-6989586621680279129"><span class="hs-identifier">delta</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680279127"><span class="hs-identifier hs-var">vsa</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1748"></a><span>
</span><a name="line-1749"></a><span class="hs-comment">-- | Prepend a value abstraction to all value vector abstractions in the</span><span>
</span><a name="line-1750"></a><span class="hs-comment">-- uncovered set</span><span>
</span><a name="line-1751"></a><span class="hs-identifier">ucon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1752"></a><a name="ucon"><a href="Check.html#ucon"><span class="hs-identifier">ucon</span></a></a><span> </span><a name="local-6989586621680279130"><a href="#local-6989586621680279130"><span class="hs-identifier">va</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#updateVsa"><span class="hs-identifier hs-var">updateVsa</span></a><span> </span><a href="#local-6989586621680279131"><span class="hs-identifier hs-var">upd</span></a><span>
</span><a name="line-1753"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1754"></a><span>    </span><a name="local-6989586621680279131"><a href="#local-6989586621680279131"><span class="hs-identifier">upd</span></a></a><span> </span><a name="local-6989586621680279132"><a href="#local-6989586621680279132"><span class="hs-identifier">vsa</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279130"><span class="hs-identifier hs-var">va</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680279133"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279134"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279133"><a href="#local-6989586621680279133"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680279134"><a href="#local-6989586621680279134"><span class="hs-identifier">delta</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680279132"><span class="hs-identifier hs-var">vsa</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1755"></a><span>
</span><a name="line-1756"></a><span class="hs-comment">-- | Given a data constructor of arity `a` and an uncovered set containing</span><span>
</span><a name="line-1757"></a><span class="hs-comment">-- value vector abstractions of length `(a+n)`, pass the first `n` value</span><span>
</span><a name="line-1758"></a><span class="hs-comment">-- abstractions to the constructor (Hence, the resulting value vector</span><span>
</span><a name="line-1759"></a><span class="hs-comment">-- abstractions will have length `n+1`)</span><span>
</span><a name="line-1760"></a><span class="hs-identifier">kcon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="ConLike.html#ConLike"><span class="hs-identifier hs-type">ConLike</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#EvVar"><span class="hs-identifier hs-type">EvVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1761"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1762"></a><a name="kcon"><a href="Check.html#kcon"><span class="hs-identifier">kcon</span></a></a><span> </span><a name="local-6989586621680279135"><a href="#local-6989586621680279135"><span class="hs-identifier">con</span></a></a><span> </span><a name="local-6989586621680279136"><a href="#local-6989586621680279136"><span class="hs-identifier">arg_tys</span></a></a><span> </span><a name="local-6989586621680279137"><a href="#local-6989586621680279137"><span class="hs-identifier">ex_tvs</span></a></a><span> </span><a name="local-6989586621680279138"><a href="#local-6989586621680279138"><span class="hs-identifier">dicts</span></a></a><span>
</span><a name="line-1763"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279139"><a href="#local-6989586621680279139"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="ConLike.html#conLikeArity"><span class="hs-identifier hs-var">conLikeArity</span></a><span> </span><a href="#local-6989586621680279135"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1764"></a><span>        </span><a name="local-6989586621680279140"><a href="#local-6989586621680279140"><span class="hs-identifier">upd</span></a></a><span> </span><a name="local-6989586621680279141"><a href="#local-6989586621680279141"><span class="hs-identifier">vsa</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1765"></a><span>          </span><span class="hs-special">[</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279146"><span class="hs-identifier hs-var">va</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680279145"><span class="hs-identifier hs-var">vva</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680279143"><span class="hs-identifier hs-var">delta</span></a><span>
</span><a name="line-1766"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279142"><a href="#local-6989586621680279142"><span class="hs-identifier">vva'</span></a></a><span> </span><a name="local-6989586621680279143"><a href="#local-6989586621680279143"><span class="hs-identifier">delta</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680279141"><span class="hs-identifier hs-var">vsa</span></a><span>
</span><a name="line-1767"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680279144"><a href="#local-6989586621680279144"><span class="hs-identifier">args</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680279145"><a href="#local-6989586621680279145"><span class="hs-identifier">vva</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span> </span><a href="#local-6989586621680279139"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680279142"><span class="hs-identifier hs-var">vva'</span></a><span>
</span><a name="line-1768"></a><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279146"><a href="#local-6989586621680279146"><span class="hs-identifier">va</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pm_con_con</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279135"><span class="hs-identifier hs-var">con</span></a><span>
</span><a name="line-1769"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_arg_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279136"><span class="hs-identifier hs-var">arg_tys</span></a><span>
</span><a name="line-1770"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_tvs</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279137"><span class="hs-identifier hs-var">ex_tvs</span></a><span>
</span><a name="line-1771"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_dicts</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279138"><span class="hs-identifier hs-var">dicts</span></a><span>
</span><a name="line-1772"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pm_con_args</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279144"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1773"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="Check.html#updateVsa"><span class="hs-identifier hs-var">updateVsa</span></a><span> </span><a href="#local-6989586621680279140"><span class="hs-identifier hs-var">upd</span></a><span>
</span><a name="line-1774"></a><span>
</span><a name="line-1775"></a><span class="hs-comment">-- | Get the union of two covered, uncovered and divergent value set</span><span>
</span><a name="line-1776"></a><span class="hs-comment">-- abstractions. Since the covered and divergent sets are represented by a</span><span>
</span><a name="line-1777"></a><span class="hs-comment">-- boolean, union means computing the logical or (at least one of the two is</span><span>
</span><a name="line-1778"></a><span class="hs-comment">-- non-empty).</span><span>
</span><a name="line-1779"></a><span>
</span><a name="line-1780"></a><span class="hs-identifier">mkUnion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1781"></a><a name="mkUnion"><a href="Check.html#mkUnion"><span class="hs-identifier">mkUnion</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span>
</span><a name="line-1782"></a><span>
</span><a name="line-1783"></a><span class="hs-comment">-- | Add a value vector abstraction to a value set abstraction (uncovered).</span><span>
</span><a name="line-1784"></a><span class="hs-identifier">mkCons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1785"></a><a name="mkCons"><a href="Check.html#mkCons"><span class="hs-identifier">mkCons</span></a></a><span> </span><a name="local-6989586621680279147"><a href="#local-6989586621680279147"><span class="hs-identifier">vva</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#updateVsa"><span class="hs-identifier hs-var">updateVsa</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279147"><span class="hs-identifier hs-var">vva</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><a name="line-1786"></a><span>
</span><a name="line-1787"></a><span class="hs-comment">-- | Set the divergent set to not empty</span><span>
</span><a name="line-1788"></a><span class="hs-identifier">forces</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1789"></a><a name="forces"><a href="Check.html#forces"><span class="hs-identifier">forces</span></a></a><span> </span><a name="local-6989586621680279148"><a href="#local-6989586621680279148"><span class="hs-identifier">pres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279148"><span class="hs-identifier hs-var">pres</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">presultDivergent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#Diverged"><span class="hs-identifier hs-var">Diverged</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1790"></a><span>
</span><a name="line-1791"></a><span class="hs-comment">-- | Set the divergent set to non-empty if the flag is `True`</span><span>
</span><a name="line-1792"></a><span class="hs-identifier">force_if</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1793"></a><a name="force_if"><a href="Check.html#force_if"><span class="hs-identifier">force_if</span></a></a><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><a name="local-6989586621680279149"><a href="#local-6989586621680279149"><span class="hs-identifier">pres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#forces"><span class="hs-identifier hs-var">forces</span></a><span> </span><a href="#local-6989586621680279149"><span class="hs-identifier hs-var">pres</span></a><span>
</span><a name="line-1794"></a><span class="hs-identifier">force_if</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a name="local-6989586621680279150"><a href="#local-6989586621680279150"><span class="hs-identifier">pres</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279150"><span class="hs-identifier hs-var">pres</span></a><span>
</span><a name="line-1795"></a><span>
</span><a name="line-1796"></a><span class="hs-identifier">set_provenance</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#Provenance"><span class="hs-identifier hs-type">Provenance</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PartialResult"><span class="hs-identifier hs-type">PartialResult</span></a><span>
</span><a name="line-1797"></a><a name="set_provenance"><a href="Check.html#set_provenance"><span class="hs-identifier">set_provenance</span></a></a><span> </span><a name="local-6989586621680279151"><a href="#local-6989586621680279151"><span class="hs-identifier">prov</span></a></a><span> </span><a name="local-6989586621680279152"><a href="#local-6989586621680279152"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279152"><span class="hs-identifier hs-var">pr</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">presultProvenance</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279151"><span class="hs-identifier hs-var">prov</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1798"></a><span>
</span><a name="line-1799"></a><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><a name="line-1800"></a><span class="hs-comment">-- * Propagation of term constraints inwards when checking nested matches</span><span>
</span><a name="line-1801"></a><span>
</span><a name="line-1802"></a><span class="hs-comment">{- Note [Type and Term Equality Propagation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When checking a match it would be great to have all type and term information
available so we can get more precise results. For this reason we have functions
`addDictsDs' and `addTmCsDs' in PmMonad that store in the environment type and
term constraints (respectively) as we go deeper.

The type constraints we propagate inwards are collected by `collectEvVarsPats'
in HsPat.hs. This handles bug #4139 ( see example
  https://ghc.haskell.org/trac/ghc/attachment/ticket/4139/GADTbug.hs )
where this is needed.

For term equalities we do less, we just generate equalities for HsCase. For
example we accurately give 2 redundancy warnings for the marked cases:

f :: [a] -&gt; Bool
f x = case x of

  []    -&gt; case x of        -- brings (x ~ []) in scope
             []    -&gt; True
             (_:_) -&gt; False -- can't happen

  (_:_) -&gt; case x of        -- brings (x ~ (_:_)) in scope
             (_:_) -&gt; True
             []    -&gt; False -- can't happen

Functions `genCaseTmCs1' and `genCaseTmCs2' are responsible for generating
these constraints.
-}</span><span>
</span><a name="line-1831"></a><span>
</span><a name="line-1832"></a><span class="hs-comment">-- | Generate equalities when checking a case expression:</span><span>
</span><a name="line-1833"></a><span class="hs-comment">--     case x of { p1 -&gt; e1; ... pn -&gt; en }</span><span>
</span><a name="line-1834"></a><span class="hs-comment">-- When we go deeper to check e.g. e1 we record two equalities:</span><span>
</span><a name="line-1835"></a><span class="hs-comment">-- (x ~ y), where y is the initial uncovered when checking (p1; .. ; pn)</span><span>
</span><a name="line-1836"></a><span class="hs-comment">-- and (x ~ p1).</span><span>
</span><a name="line-1837"></a><span class="hs-identifier">genCaseTmCs2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Scrutinee</span><span>
</span><a name="line-1838"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span>           </span><span class="hs-comment">-- LHS       (should have length 1)</span><span>
</span><a name="line-1839"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span>                  </span><span class="hs-comment">-- MatchVars (should have length 1)</span><span>
</span><a name="line-1840"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="PmExpr.html#SimpleEq"><span class="hs-identifier hs-type">SimpleEq</span></a><span class="hs-special">)</span><span>
</span><a name="line-1841"></a><a name="genCaseTmCs2"><a href="Check.html#genCaseTmCs2"><span class="hs-identifier">genCaseTmCs2</span></a></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-1842"></a><span class="hs-identifier">genCaseTmCs2</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279153"><a href="#local-6989586621680279153"><span class="hs-identifier">scr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680279154"><a href="#local-6989586621680279154"><span class="hs-identifier">p</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680279155"><a href="#local-6989586621680279155"><span class="hs-identifier">var</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1843"></a><span>  </span><a name="local-6989586621680279156"><a href="#local-6989586621680279156"><span class="hs-identifier">fam_insts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-var">dsGetFamInstEnvs</span></a><span>
</span><a name="line-1844"></a><span>  </span><span class="hs-special">[</span><a name="local-6989586621680279157"><a href="#local-6989586621680279157"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#vaToPmExpr"><span class="hs-identifier hs-var">vaToPmExpr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Check.html#coercePatVec"><span class="hs-identifier hs-var">coercePatVec</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Check.html#translatePat"><span class="hs-identifier hs-var">translatePat</span></a><span> </span><a href="#local-6989586621680279156"><span class="hs-identifier hs-var">fam_insts</span></a><span> </span><a href="#local-6989586621680279154"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-1845"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279158"><a href="#local-6989586621680279158"><span class="hs-identifier">scr_e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#lhsExprToPmExpr"><span class="hs-identifier hs-var">lhsExprToPmExpr</span></a><span> </span><a href="#local-6989586621680279153"><span class="hs-identifier hs-var">scr</span></a><span>
</span><a name="line-1846"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Bag.html#listToBag"><span class="hs-identifier hs-var">listToBag</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621680279155"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680279157"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279155"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680279158"><span class="hs-identifier hs-var">scr_e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1847"></a><span class="hs-identifier">genCaseTmCs2</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;genCaseTmCs2: HsCase&quot;</span><span>
</span><a name="line-1848"></a><span>
</span><a name="line-1849"></a><span class="hs-comment">-- | Generate a simple equality when checking a case expression:</span><span>
</span><a name="line-1850"></a><span class="hs-comment">--     case x of { matches }</span><span>
</span><a name="line-1851"></a><span class="hs-comment">-- When checking matches we record that (x ~ y) where y is the initial</span><span>
</span><a name="line-1852"></a><span class="hs-comment">-- uncovered. All matches will have to satisfy this equality.</span><span>
</span><a name="line-1853"></a><span class="hs-identifier">genCaseTmCs1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Bag.html#Bag"><span class="hs-identifier hs-type">Bag</span></a><span> </span><a href="PmExpr.html#SimpleEq"><span class="hs-identifier hs-type">SimpleEq</span></a><span>
</span><a name="line-1854"></a><a name="genCaseTmCs1"><a href="Check.html#genCaseTmCs1"><span class="hs-identifier">genCaseTmCs1</span></a></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#emptyBag"><span class="hs-identifier hs-var">emptyBag</span></a><span>
</span><a name="line-1855"></a><span class="hs-identifier">genCaseTmCs1</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680279159"><a href="#local-6989586621680279159"><span class="hs-identifier">scr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680279160"><a href="#local-6989586621680279160"><span class="hs-identifier">var</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Bag.html#unitBag"><span class="hs-identifier hs-var">unitBag</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279160"><span class="hs-identifier hs-var">var</span></a><span class="hs-special">,</span><span> </span><a href="PmExpr.html#lhsExprToPmExpr"><span class="hs-identifier hs-var">lhsExprToPmExpr</span></a><span> </span><a href="#local-6989586621680279159"><span class="hs-identifier hs-var">scr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1856"></a><span class="hs-identifier">genCaseTmCs1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;genCaseTmCs1: HsCase&quot;</span><span>
</span><a name="line-1857"></a><span>
</span><a name="line-1858"></a><span class="hs-comment">{- Note [Literals in PmPat]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Instead of translating a literal to a variable accompanied with a guard, we
treat them like constructor patterns. The following example from
&quot;./libraries/base/GHC/IO/Encoding.hs&quot; shows why:

mkTextEncoding' :: CodingFailureMode -&gt; String -&gt; IO TextEncoding
mkTextEncoding' cfm enc = case [toUpper c | c &lt;- enc, c /= '-'] of
    &quot;UTF8&quot;    -&gt; return $ UTF8.mkUTF8 cfm
    &quot;UTF16&quot;   -&gt; return $ UTF16.mkUTF16 cfm
    &quot;UTF16LE&quot; -&gt; return $ UTF16.mkUTF16le cfm
    ...

Each clause gets translated to a list of variables with an equal number of
guards. For every guard we generate two cases (equals True/equals False) which
means that we generate 2^n cases to feed the oracle with, where n is the sum of
the length of all strings that appear in the patterns. For this particular
example this means over 2^40 cases. Instead, by representing them like with
constructor we get the following:
  1. We exploit the common prefix with our representation of VSAs
  2. We prune immediately non-reachable cases
     (e.g. False == (x == &quot;U&quot;), True == (x == &quot;U&quot;))

Note [Translating As Patterns]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Instead of translating x@p as:  x (p &lt;- x)
we instead translate it as:     p (x &lt;- coercePattern p)
for performance reasons. For example:

  f x@True  = 1
  f y@False = 2

Gives the following with the first translation:

  x |&gt; {x == False, x == y, y == True}

If we use the second translation we get an empty set, independently of the
oracle. Since the pattern `p' may contain guard patterns though, it cannot be
used as an expression. That's why we call `coercePatVec' to drop the guard and
`vaToPmExpr' to transform the value abstraction to an expression in the
guard pattern (value abstractions are a subset of expressions). We keep the
guards in the first pattern `p' though.


%************************************************************************
%*                                                                      *
      Pretty printing of exhaustiveness/redundancy check warnings
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-1908"></a><span>
</span><a name="line-1909"></a><span class="hs-comment">-- | Check whether any part of pattern match checking is enabled (does not</span><span>
</span><a name="line-1910"></a><span class="hs-comment">-- matter whether it is the redundancy check or the exhaustiveness check).</span><span>
</span><a name="line-1911"></a><span class="hs-identifier">isAnyPmCheckEnabled</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-type">DsMatchContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1912"></a><a name="isAnyPmCheckEnabled"><a href="Check.html#isAnyPmCheckEnabled"><span class="hs-identifier">isAnyPmCheckEnabled</span></a></a><span> </span><a name="local-6989586621680279161"><a href="#local-6989586621680279161"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-var">DsMatchContext</span></a><span> </span><a name="local-6989586621680279162"><a href="#local-6989586621680279162"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621680279163"><a href="#local-6989586621680279163"><span class="hs-identifier">_loc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1913"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a><span> </span><a href="DynFlags.html#Opt_WarnOverlappingPatterns"><span class="hs-identifier hs-var">Opt_WarnOverlappingPatterns</span></a><span> </span><a href="#local-6989586621680279161"><span class="hs-identifier hs-var">dflags</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Check.html#exhaustive"><span class="hs-identifier hs-var">exhaustive</span></a><span> </span><a href="#local-6989586621680279161"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680279162"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-1914"></a><span>
</span><a name="line-1915"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1916"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680278510"><a href="#local-6989586621680278510"><span class="hs-identifier">vva</span></a></a><span> </span><a name="local-6989586621680278511"><a href="#local-6989586621680278511"><span class="hs-identifier">delta</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1917"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680278512"><a href="#local-6989586621680278512"><span class="hs-identifier">residual_eqs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680278513"><a href="#local-6989586621680278513"><span class="hs-identifier">subst</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#wrapUpTmState"><span class="hs-identifier hs-var">wrapUpTmState</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">delta_tm_cs</span><span> </span><a href="#local-6989586621680278511"><span class="hs-identifier hs-var">delta</span></a><span class="hs-special">)</span><span>
</span><a name="line-1918"></a><span>          </span><a name="local-6989586621680278514"><a href="#local-6989586621680278514"><span class="hs-identifier">vector</span></a></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#substInValAbs"><span class="hs-identifier hs-var">substInValAbs</span></a><span> </span><a href="#local-6989586621680278513"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621680278510"><span class="hs-identifier hs-var">vva</span></a><span>
</span><a name="line-1919"></a><span>      </span><span class="hs-keyword">in</span><span>  </span><a href="Check.html#ppr_uncovered"><span class="hs-identifier hs-var">ppr_uncovered</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680278514"><span class="hs-identifier hs-var">vector</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680278512"><span class="hs-identifier hs-var">residual_eqs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1920"></a><span>
</span><a name="line-1921"></a><span class="hs-comment">-- | Apply a term substitution to a value vector abstraction. All VAs are</span><span>
</span><a name="line-1922"></a><span class="hs-comment">-- transformed to PmExpr (used only before pretty printing).</span><span>
</span><a name="line-1923"></a><span class="hs-identifier">substInValAbs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TmOracle.html#PmVarEnv"><span class="hs-identifier hs-type">PmVarEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="PmExpr.html#PmExpr"><span class="hs-identifier hs-type">PmExpr</span></a><span class="hs-special">]</span><span>
</span><a name="line-1924"></a><a name="substInValAbs"><a href="Check.html#substInValAbs"><span class="hs-identifier">substInValAbs</span></a></a><span> </span><a name="local-6989586621680279164"><a href="#local-6989586621680279164"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="TmOracle.html#exprDeepLookup"><span class="hs-identifier hs-var">exprDeepLookup</span></a><span> </span><a href="#local-6989586621680279164"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Check.html#vaToPmExpr"><span class="hs-identifier hs-var">vaToPmExpr</span></a><span class="hs-special">)</span><span>
</span><a name="line-1925"></a><span>
</span><a name="line-1926"></a><span class="hs-comment">-- | Wrap up the term oracle's state once solving is complete. Drop any</span><span>
</span><a name="line-1927"></a><span class="hs-comment">-- information about unhandled constraints (involving HsExprs) and flatten</span><span>
</span><a name="line-1928"></a><span class="hs-comment">-- (height 1) the substitution.</span><span>
</span><a name="line-1929"></a><span class="hs-identifier">wrapUpTmState</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TmOracle.html#TmState"><span class="hs-identifier hs-type">TmState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TmOracle.html#PmVarEnv"><span class="hs-identifier hs-type">PmVarEnv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1930"></a><a name="wrapUpTmState"><a href="Check.html#wrapUpTmState"><span class="hs-identifier">wrapUpTmState</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680279165"><a href="#local-6989586621680279165"><span class="hs-identifier">residual</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680279166"><a href="#local-6989586621680279166"><span class="hs-identifier">subst</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279165"><span class="hs-identifier hs-var">residual</span></a><span class="hs-special">,</span><span> </span><a href="TmOracle.html#flattenPmVarEnv"><span class="hs-identifier hs-var">flattenPmVarEnv</span></a><span> </span><a href="#local-6989586621680279166"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span>
</span><a name="line-1931"></a><span>
</span><a name="line-1932"></a><span class="hs-comment">-- | Issue all the warnings (coverage, exhaustiveness, inaccessibility)</span><span>
</span><a name="line-1933"></a><span class="hs-identifier">dsPmWarn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-type">DsMatchContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmResult"><span class="hs-identifier hs-type">PmResult</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1934"></a><a name="dsPmWarn"><a href="Check.html#dsPmWarn"><span class="hs-identifier">dsPmWarn</span></a></a><span> </span><a name="local-6989586621680279167"><a href="#local-6989586621680279167"><span class="hs-identifier">dflags</span></a></a><span> </span><a name="local-6989586621680279168"><a href="#local-6989586621680279168"><span class="hs-identifier">ctx</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-var">DsMatchContext</span></a><span> </span><a name="local-6989586621680279169"><a href="#local-6989586621680279169"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621680279170"><a href="#local-6989586621680279170"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279171"><a href="#local-6989586621680279171"><span class="hs-identifier">pm_result</span></a></a><span>
</span><a name="line-1935"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279176"><span class="hs-identifier hs-var">flag_i</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680279177"><span class="hs-identifier hs-var">flag_u</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1936"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279192"><a href="#local-6989586621680279192"><span class="hs-identifier">exists_r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279176"><span class="hs-identifier hs-var">flag_i</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Util.html#notNull"><span class="hs-identifier hs-var">notNull</span></a><span> </span><a href="#local-6989586621680279173"><span class="hs-identifier hs-var">redundant</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680279180"><span class="hs-identifier hs-var">onlyBuiltin</span></a><span>
</span><a name="line-1937"></a><span>          </span><a name="local-6989586621680279193"><a href="#local-6989586621680279193"><span class="hs-identifier">exists_i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279176"><span class="hs-identifier hs-var">flag_i</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Util.html#notNull"><span class="hs-identifier hs-var">notNull</span></a><span> </span><a href="#local-6989586621680279175"><span class="hs-identifier hs-var">inaccessible</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680279180"><span class="hs-identifier hs-var">onlyBuiltin</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680279179"><span class="hs-identifier hs-var">is_rec_upd</span></a><span>
</span><a name="line-1938"></a><span>          </span><a name="local-6989586621680279194"><a href="#local-6989586621680279194"><span class="hs-identifier">exists_u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279177"><span class="hs-identifier hs-var">flag_u</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680279174"><span class="hs-identifier hs-var">uncovered</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1939"></a><span>                                  </span><a href="Check.html#TypeOfUncovered"><span class="hs-identifier hs-var">TypeOfUncovered</span></a><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1940"></a><span>                                  </span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><a name="local-6989586621680279195"><a href="#local-6989586621680279195"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Util.html#notNull"><span class="hs-identifier hs-var">notNull</span></a><span> </span><a href="#local-6989586621680279195"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span>
</span><a name="line-1941"></a><span>
</span><a name="line-1942"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><a href="#local-6989586621680279192"><span class="hs-identifier hs-var">exists_r</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a><span> </span><a href="#local-6989586621680279173"><span class="hs-identifier hs-var">redundant</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680279196"><a href="#local-6989586621680279196"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621680279197"><a href="#local-6989586621680279197"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1943"></a><span>        </span><a href="DsMonad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a><span> </span><a href="#local-6989586621680279196"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="DsMonad.html#warnDs"><span class="hs-identifier hs-var">warnDs</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnOverlappingPatterns"><span class="hs-identifier hs-var">Opt_WarnOverlappingPatterns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1944"></a><span>                               </span><span class="hs-special">(</span><a href="#local-6989586621680279182"><span class="hs-identifier hs-var">pprEqn</span></a><span> </span><a href="#local-6989586621680279197"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-string">&quot;is redundant&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1945"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><a href="#local-6989586621680279193"><span class="hs-identifier hs-var">exists_i</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a><span> </span><a href="#local-6989586621680279175"><span class="hs-identifier hs-var">inaccessible</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680279198"><a href="#local-6989586621680279198"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621680279199"><a href="#local-6989586621680279199"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1946"></a><span>        </span><a href="DsMonad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a><span> </span><a href="#local-6989586621680279198"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="DsMonad.html#warnDs"><span class="hs-identifier hs-var">warnDs</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnOverlappingPatterns"><span class="hs-identifier hs-var">Opt_WarnOverlappingPatterns</span></a><span class="hs-special">)</span><span>
</span><a name="line-1947"></a><span>                               </span><span class="hs-special">(</span><a href="#local-6989586621680279182"><span class="hs-identifier hs-var">pprEqn</span></a><span> </span><a href="#local-6989586621680279199"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-string">&quot;has inaccessible right hand side&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1948"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><a href="#local-6989586621680279194"><span class="hs-identifier hs-var">exists_u</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="DsMonad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a><span> </span><a href="#local-6989586621680279170"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="DsMonad.html#warnDs"><span class="hs-identifier hs-var">warnDs</span></a><span> </span><a href="#local-6989586621680279178"><span class="hs-identifier hs-var">flag_u_reason</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1949"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680279174"><span class="hs-identifier hs-var">uncovered</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1950"></a><span>          </span><a href="Check.html#TypeOfUncovered"><span class="hs-identifier hs-var">TypeOfUncovered</span></a><span> </span><a name="local-6989586621680279200"><a href="#local-6989586621680279200"><span class="hs-identifier">ty</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680279184"><span class="hs-identifier hs-var">warnEmptyCase</span></a><span> </span><a href="#local-6989586621680279200"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1951"></a><span>          </span><a href="Check.html#UncoveredPatterns"><span class="hs-identifier hs-var">UncoveredPatterns</span></a><span> </span><a name="local-6989586621680279201"><a href="#local-6989586621680279201"><span class="hs-identifier">candidates</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680279183"><span class="hs-identifier hs-var">pprEqns</span></a><span> </span><a href="#local-6989586621680279201"><span class="hs-identifier hs-var">candidates</span></a><span>
</span><a name="line-1952"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1953"></a><span>    </span><a href="Check.html#PmResult"><span class="hs-identifier hs-var">PmResult</span></a><span>
</span><a name="line-1954"></a><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">pmresultProvenance</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279172"><a href="#local-6989586621680279172"><span class="hs-identifier">prov</span></a></a><span>
</span><a name="line-1955"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pmresultRedundant</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279173"><a href="#local-6989586621680279173"><span class="hs-identifier">redundant</span></a></a><span>
</span><a name="line-1956"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pmresultUncovered</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279174"><a href="#local-6989586621680279174"><span class="hs-identifier">uncovered</span></a></a><span>
</span><a name="line-1957"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pmresultInaccessible</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680279175"><a href="#local-6989586621680279175"><span class="hs-identifier">inaccessible</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279171"><span class="hs-identifier hs-var">pm_result</span></a><span>
</span><a name="line-1958"></a><span>
</span><a name="line-1959"></a><span>    </span><a name="local-6989586621680279176"><a href="#local-6989586621680279176"><span class="hs-identifier">flag_i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a><span> </span><a href="DynFlags.html#Opt_WarnOverlappingPatterns"><span class="hs-identifier hs-var">Opt_WarnOverlappingPatterns</span></a><span> </span><a href="#local-6989586621680279167"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1960"></a><span>    </span><a name="local-6989586621680279177"><a href="#local-6989586621680279177"><span class="hs-identifier">flag_u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#exhaustive"><span class="hs-identifier hs-var">exhaustive</span></a><span> </span><a href="#local-6989586621680279167"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680279169"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-1961"></a><span>    </span><a name="local-6989586621680279178"><a href="#local-6989586621680279178"><span class="hs-identifier">flag_u_reason</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><a href="DynFlags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a><span> </span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#exhaustiveWarningFlag"><span class="hs-identifier hs-var">exhaustiveWarningFlag</span></a><span> </span><a href="#local-6989586621680279169"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1962"></a><span>
</span><a name="line-1963"></a><span>    </span><a name="local-6989586621680279179"><a href="#local-6989586621680279179"><span class="hs-identifier">is_rec_upd</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680279169"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><a href="HsExpr.html#RecUpd"><span class="hs-identifier hs-var">RecUpd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1964"></a><span>       </span><span class="hs-comment">-- See Note [Inaccessible warnings for record updates]</span><span>
</span><a name="line-1965"></a><span>
</span><a name="line-1966"></a><span>    </span><a name="local-6989586621680279180"><a href="#local-6989586621680279180"><span class="hs-identifier">onlyBuiltin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279172"><span class="hs-identifier hs-var">prov</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Check.html#FromBuiltin"><span class="hs-identifier hs-var">FromBuiltin</span></a><span>
</span><a name="line-1967"></a><span>
</span><a name="line-1968"></a><span>    </span><a name="local-6989586621680279181"><a href="#local-6989586621680279181"><span class="hs-identifier">maxPatterns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">maxUncoveredPatterns</span><span> </span><a href="#local-6989586621680279167"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-1969"></a><span>
</span><a name="line-1970"></a><span>    </span><span class="hs-comment">-- Print a single clause (for redundant/with-inaccessible-rhs)</span><span>
</span><a name="line-1971"></a><span>    </span><a name="local-6989586621680279182"><a href="#local-6989586621680279182"><span class="hs-identifier">pprEqn</span></a></a><span> </span><a name="local-6989586621680279185"><a href="#local-6989586621680279185"><span class="hs-identifier">q</span></a></a><span> </span><a name="local-6989586621680279186"><a href="#local-6989586621680279186"><span class="hs-identifier">txt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#pp_context"><span class="hs-identifier hs-var">pp_context</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621680279168"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621680279186"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680279187"><a href="#local-6989586621680279187"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#ppr_eqn"><span class="hs-identifier hs-var">ppr_eqn</span></a><span> </span><a href="#local-6989586621680279187"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680279169"><span class="hs-identifier hs-var">kind</span></a><span> </span><a href="#local-6989586621680279185"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-1972"></a><span>
</span><a name="line-1973"></a><span>    </span><span class="hs-comment">-- Print several clauses (for uncovered clauses)</span><span>
</span><a name="line-1974"></a><span>    </span><a name="local-6989586621680279183"><a href="#local-6989586621680279183"><span class="hs-identifier">pprEqns</span></a></a><span> </span><a name="local-6989586621680279188"><a href="#local-6989586621680279188"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#pp_context"><span class="hs-identifier hs-var">pp_context</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621680279168"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;are non-exhaustive&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1975"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680279188"><span class="hs-identifier hs-var">qs</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- See #11245</span><span>
</span><a name="line-1976"></a><span>           </span><span class="hs-special">[</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">]</span><span>
</span><a name="line-1977"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Guards do not cover entire pattern space&quot;</span><span>
</span><a name="line-1978"></a><span>           </span><a name="local-6989586621680279189"><a href="#local-6989586621680279189"><span class="hs-identifier">_missing</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680279190"><a href="#local-6989586621680279190"><span class="hs-identifier">us</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279188"><span class="hs-identifier hs-var">qs</span></a><span>
</span><a name="line-1979"></a><span>                       </span><span class="hs-keyword">in</span><span>  </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Patterns not matched:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-1980"></a><span>                                </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621680279181"><span class="hs-identifier hs-var">maxPatterns</span></a><span> </span><a href="#local-6989586621680279190"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">)</span><span>
</span><a name="line-1981"></a><span>                                 </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Check.html#dots"><span class="hs-identifier hs-var">dots</span></a><span> </span><a href="#local-6989586621680279181"><span class="hs-identifier hs-var">maxPatterns</span></a><span> </span><a href="#local-6989586621680279190"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">)</span><span>
</span><a name="line-1982"></a><span>
</span><a name="line-1983"></a><span>    </span><span class="hs-comment">-- Print a type-annotated wildcard (for non-exhaustive `EmptyCase`s for</span><span>
</span><a name="line-1984"></a><span>    </span><span class="hs-comment">-- which we only know the type and have no inhabitants at hand)</span><span>
</span><a name="line-1985"></a><span>    </span><a name="local-6989586621680279184"><a href="#local-6989586621680279184"><span class="hs-identifier">warnEmptyCase</span></a></a><span> </span><a name="local-6989586621680279191"><a href="#local-6989586621680279191"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#pp_context"><span class="hs-identifier hs-var">pp_context</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621680279168"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;are non-exhaustive&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1986"></a><span>      </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Patterns not matched:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#underscore"><span class="hs-identifier hs-var">underscore</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279191"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1987"></a><span>
</span><a name="line-1988"></a><span class="hs-comment">{- Note [Inaccessible warnings for record updates]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider (Trac #12957)
  data T a where
    T1 :: { x :: Int } -&gt; T Bool
    T2 :: { x :: Int } -&gt; T a
    T3 :: T a

  f :: T Char -&gt; T a
  f r = r { x = 3 }

The desugarer will (conservatively generate a case for T1 even though
it's impossible:
  f r = case r of
          T1 x -&gt; T1 3   -- Inaccessible branch
          T2 x -&gt; T2 3
          _    -&gt; error &quot;Missing&quot;

We don't want to warn about the inaccessible branch because the programmer
didn't put it there!  So we filter out the warning here.
-}</span><span>
</span><a name="line-2009"></a><span>
</span><a name="line-2010"></a><span class="hs-comment">-- | Issue a warning when the predefined number of iterations is exceeded</span><span>
</span><a name="line-2011"></a><span class="hs-comment">-- for the pattern match checker</span><span>
</span><a name="line-2012"></a><span class="hs-identifier">warnPmIters</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-type">DsMatchContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2013"></a><a name="warnPmIters"><a href="Check.html#warnPmIters"><span class="hs-identifier">warnPmIters</span></a></a><span> </span><a name="local-6989586621680279202"><a href="#local-6989586621680279202"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-var">DsMatchContext</span></a><span> </span><a name="local-6989586621680279203"><a href="#local-6989586621680279203"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621680279204"><a href="#local-6989586621680279204"><span class="hs-identifier">loc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2014"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279207"><span class="hs-identifier hs-var">flag_i</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680279208"><span class="hs-identifier hs-var">flag_u</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2015"></a><span>      </span><a name="local-6989586621680279210"><a href="#local-6989586621680279210"><span class="hs-identifier">iters</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maxPmCheckIterations</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-2016"></a><span>      </span><a href="DsMonad.html#putSrcSpanDs"><span class="hs-identifier hs-var">putSrcSpanDs</span></a><span> </span><a href="#local-6989586621680279204"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="DsMonad.html#warnDs"><span class="hs-identifier hs-var">warnDs</span></a><span> </span><a href="DynFlags.html#NoReason"><span class="hs-identifier hs-var">NoReason</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279206"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="#local-6989586621680279210"><span class="hs-identifier hs-var">iters</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2017"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2018"></a><span>    </span><a name="local-6989586621680279205"><a href="#local-6989586621680279205"><span class="hs-identifier">ctxt</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="HsExpr.html#pprMatchContext"><span class="hs-identifier hs-var">pprMatchContext</span></a><span> </span><a href="#local-6989586621680279203"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-2019"></a><span>    </span><a name="local-6989586621680279206"><a href="#local-6989586621680279206"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621680279209"><a href="#local-6989586621680279209"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#fsep"><span class="hs-identifier hs-var">fsep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern match checker exceeded&quot;</span><span>
</span><a name="line-2020"></a><span>                  </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279209"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;iterations in&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680279205"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#dot"><span class="hs-identifier hs-var">dot</span></a><span>
</span><a name="line-2021"></a><span>                  </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;(Use -fmax-pmcheck-iterations=n&quot;</span><span>
</span><a name="line-2022"></a><span>                  </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;to set the maximun number of iterations to n)&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-2023"></a><span>
</span><a name="line-2024"></a><span>    </span><a name="local-6989586621680279207"><a href="#local-6989586621680279207"><span class="hs-identifier">flag_i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a><span> </span><a href="DynFlags.html#Opt_WarnOverlappingPatterns"><span class="hs-identifier hs-var">Opt_WarnOverlappingPatterns</span></a><span> </span><a href="#local-6989586621680279202"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2025"></a><span>    </span><a name="local-6989586621680279208"><a href="#local-6989586621680279208"><span class="hs-identifier">flag_u</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#exhaustive"><span class="hs-identifier hs-var">exhaustive</span></a><span> </span><a href="#local-6989586621680279202"><span class="hs-identifier hs-var">dflags</span></a><span> </span><a href="#local-6989586621680279203"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-2026"></a><span>
</span><a name="line-2027"></a><span class="hs-identifier">dots</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680278530"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2028"></a><a name="dots"><a href="Check.html#dots"><span class="hs-identifier">dots</span></a></a><span> </span><a name="local-6989586621680279211"><a href="#local-6989586621680279211"><span class="hs-identifier">maxPatterns</span></a></a><span> </span><a name="local-6989586621680279212"><a href="#local-6989586621680279212"><span class="hs-identifier">qs</span></a></a><span>
</span><a name="line-2029"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680279212"><span class="hs-identifier hs-var">qs</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680279211"><span class="hs-identifier hs-var">maxPatterns</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;...&quot;</span><span>
</span><a name="line-2030"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-2031"></a><span>
</span><a name="line-2032"></a><span class="hs-comment">-- | Check whether the exhaustiveness checker should run (exhaustiveness only)</span><span>
</span><a name="line-2033"></a><span class="hs-identifier">exhaustive</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="#local-6989586621680278529"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2034"></a><a name="exhaustive"><a href="Check.html#exhaustive"><span class="hs-identifier">exhaustive</span></a></a><span>  </span><a name="local-6989586621680279213"><a href="#local-6989586621680279213"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680279213"><span class="hs-identifier hs-var">dflags</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Check.html#exhaustiveWarningFlag"><span class="hs-identifier hs-var">exhaustiveWarningFlag</span></a><span>
</span><a name="line-2035"></a><span>
</span><a name="line-2036"></a><span class="hs-comment">-- | Denotes whether an exhaustiveness check is supported, and if so,</span><span>
</span><a name="line-2037"></a><span class="hs-comment">-- via which 'WarningFlag' it's controlled.</span><span>
</span><a name="line-2038"></a><span class="hs-comment">-- Returns 'Nothing' if check is not supported.</span><span>
</span><a name="line-2039"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="#local-6989586621680278528"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="DynFlags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a><span>
</span><a name="line-2040"></a><a name="exhaustiveWarningFlag"><a href="Check.html#exhaustiveWarningFlag"><span class="hs-identifier">exhaustiveWarningFlag</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompletePatterns"><span class="hs-identifier hs-var">Opt_WarnIncompletePatterns</span></a><span>
</span><a name="line-2041"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#CaseAlt"><span class="hs-identifier hs-var">CaseAlt</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompletePatterns"><span class="hs-identifier hs-var">Opt_WarnIncompletePatterns</span></a><span>
</span><a name="line-2042"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#IfAlt"><span class="hs-identifier hs-var">IfAlt</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompletePatterns"><span class="hs-identifier hs-var">Opt_WarnIncompletePatterns</span></a><span>
</span><a name="line-2043"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#LambdaExpr"><span class="hs-identifier hs-var">LambdaExpr</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompleteUniPatterns"><span class="hs-identifier hs-var">Opt_WarnIncompleteUniPatterns</span></a><span>
</span><a name="line-2044"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#PatBindRhs"><span class="hs-identifier hs-var">PatBindRhs</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompleteUniPatterns"><span class="hs-identifier hs-var">Opt_WarnIncompleteUniPatterns</span></a><span>
</span><a name="line-2045"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#PatBindGuards"><span class="hs-identifier hs-var">PatBindGuards</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompletePatterns"><span class="hs-identifier hs-var">Opt_WarnIncompletePatterns</span></a><span>
</span><a name="line-2046"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#ProcExpr"><span class="hs-identifier hs-var">ProcExpr</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompleteUniPatterns"><span class="hs-identifier hs-var">Opt_WarnIncompleteUniPatterns</span></a><span>
</span><a name="line-2047"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#RecUpd"><span class="hs-identifier hs-var">RecUpd</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="DynFlags.html#Opt_WarnIncompletePatternsRecUpd"><span class="hs-identifier hs-var">Opt_WarnIncompletePatternsRecUpd</span></a><span>
</span><a name="line-2048"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#ThPatSplice"><span class="hs-identifier hs-var">ThPatSplice</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2049"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#PatSyn"><span class="hs-identifier hs-var">PatSyn</span></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2050"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><a href="HsExpr.html#ThPatQuote"><span class="hs-identifier hs-var">ThPatQuote</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2051"></a><span class="hs-identifier">exhaustiveWarningFlag</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#StmtCtxt"><span class="hs-identifier hs-var">StmtCtxt</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-comment">-- Don't warn about incomplete patterns</span><span>
</span><a name="line-2052"></a><span>                                       </span><span class="hs-comment">-- in list comprehensions, pattern guards</span><span>
</span><a name="line-2053"></a><span>                                       </span><span class="hs-comment">-- etc. They are often *supposed* to be</span><span>
</span><a name="line-2054"></a><span>                                       </span><span class="hs-comment">-- incomplete</span><span>
</span><a name="line-2055"></a><span>
</span><a name="line-2056"></a><span class="hs-comment">-- True &lt;==&gt; singular</span><span>
</span><a name="line-2057"></a><span class="hs-identifier">pp_context</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-type">DsMatchContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2058"></a><a name="pp_context"><a href="Check.html#pp_context"><span class="hs-identifier">pp_context</span></a></a><span> </span><a name="local-6989586621680279214"><a href="#local-6989586621680279214"><span class="hs-identifier">singular</span></a></a><span> </span><span class="hs-special">(</span><a href="DsMonad.html#DsMatchContext"><span class="hs-identifier hs-var">DsMatchContext</span></a><span> </span><a name="local-6989586621680279215"><a href="#local-6989586621680279215"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621680279216"><a href="#local-6989586621680279216"><span class="hs-identifier">_loc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680279217"><a href="#local-6989586621680279217"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621680279218"><a href="#local-6989586621680279218"><span class="hs-identifier">rest_of_msg_fun</span></a></a><span>
</span><a name="line-2059"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621680279219"><span class="hs-identifier hs-var">txt</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621680279217"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">,</span><span>
</span><a name="line-2060"></a><span>          </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621680279220"><span class="hs-identifier hs-var">ppr_match</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">':'</span><span>
</span><a name="line-2061"></a><span>              </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680279218"><span class="hs-identifier hs-var">rest_of_msg_fun</span></a><span> </span><a href="#local-6989586621680279221"><span class="hs-identifier hs-var">pref</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-2062"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2063"></a><span>    </span><a name="local-6989586621680279219"><a href="#local-6989586621680279219"><span class="hs-identifier">txt</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680279214"><span class="hs-identifier hs-var">singular</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Pattern match&quot;</span><span>
</span><a name="line-2064"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Pattern match(es)&quot;</span><span>
</span><a name="line-2065"></a><span>
</span><a name="line-2066"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680279220"><a href="#local-6989586621680279220"><span class="hs-identifier">ppr_match</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680279221"><a href="#local-6989586621680279221"><span class="hs-identifier">pref</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2067"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680279215"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2068"></a><span>             </span><a href="HsExpr.html#FunRhs"><span class="hs-identifier hs-var">FunRhs</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mc_fun</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680279222"><a href="#local-6989586621680279222"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-2069"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#pprMatchContext"><span class="hs-identifier hs-var">pprMatchContext</span></a><span> </span><a href="#local-6989586621680279215"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680279223"><a href="#local-6989586621680279223"><span class="hs-identifier">pp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279222"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621680279223"><span class="hs-identifier hs-var">pp</span></a><span class="hs-special">)</span><span>
</span><a name="line-2070"></a><span>             </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#pprMatchContext"><span class="hs-identifier hs-var">pprMatchContext</span></a><span> </span><a href="#local-6989586621680279215"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680279224"><a href="#local-6989586621680279224"><span class="hs-identifier">pp</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680279224"><span class="hs-identifier hs-var">pp</span></a><span class="hs-special">)</span><span>
</span><a name="line-2071"></a><span>
</span><a name="line-2072"></a><span class="hs-identifier">ppr_pats</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2073"></a><a name="ppr_pats"><a href="Check.html#ppr_pats"><span class="hs-identifier">ppr_pats</span></a></a><span> </span><a name="local-6989586621680279225"><a href="#local-6989586621680279225"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621680279226"><a href="#local-6989586621680279226"><span class="hs-identifier">pats</span></a></a><span>
</span><a name="line-2074"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279226"><span class="hs-identifier hs-var">pats</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="HsExpr.html#matchSeparator"><span class="hs-identifier hs-var">matchSeparator</span></a><span> </span><a href="#local-6989586621680279225"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;...&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-2075"></a><span>
</span><a name="line-2076"></a><span class="hs-identifier">ppr_eqn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsMatchContext"><span class="hs-identifier hs-type">HsMatchContext</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2077"></a><a name="ppr_eqn"><a href="Check.html#ppr_eqn"><span class="hs-identifier">ppr_eqn</span></a></a><span> </span><a name="local-6989586621680279227"><a href="#local-6989586621680279227"><span class="hs-identifier">prefixF</span></a></a><span> </span><a name="local-6989586621680279228"><a href="#local-6989586621680279228"><span class="hs-identifier">kind</span></a></a><span> </span><a name="local-6989586621680279229"><a href="#local-6989586621680279229"><span class="hs-identifier">eqn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279227"><span class="hs-identifier hs-var">prefixF</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#ppr_pats"><span class="hs-identifier hs-var">ppr_pats</span></a><span> </span><a href="#local-6989586621680279228"><span class="hs-identifier hs-var">kind</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680279229"><span class="hs-identifier hs-var">eqn</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2078"></a><span>
</span><a name="line-2079"></a><span class="hs-identifier">ppr_constraint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="PmExpr.html#PmLit"><span class="hs-identifier hs-type">PmLit</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2080"></a><a name="ppr_constraint"><a href="Check.html#ppr_constraint"><span class="hs-identifier">ppr_constraint</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680279230"><a href="#local-6989586621680279230"><span class="hs-identifier">var</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680279231"><a href="#local-6989586621680279231"><span class="hs-identifier">lits</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680279230"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;is not one of&quot;</span><span>
</span><a name="line-2081"></a><span>                                 </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279231"><span class="hs-identifier hs-var">lits</span></a><span class="hs-special">)</span><span>
</span><a name="line-2082"></a><span>
</span><a name="line-2083"></a><span class="hs-identifier">ppr_uncovered</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="PmExpr.html#PmExpr"><span class="hs-identifier hs-type">PmExpr</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="PmExpr.html#ComplexEq"><span class="hs-identifier hs-type">ComplexEq</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2084"></a><a name="ppr_uncovered"><a href="Check.html#ppr_uncovered"><span class="hs-identifier">ppr_uncovered</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680279232"><a href="#local-6989586621680279232"><span class="hs-identifier">expr_vec</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680279233"><a href="#local-6989586621680279233"><span class="hs-identifier">complex</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2085"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680279236"><span class="hs-identifier hs-var">cs</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#fsep"><span class="hs-identifier hs-var">fsep</span></a><span> </span><a href="#local-6989586621680279235"><span class="hs-identifier hs-var">vec</span></a><span> </span><span class="hs-comment">-- there are no literal constraints</span><span>
</span><a name="line-2086"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#fsep"><span class="hs-identifier hs-var">fsep</span></a><span> </span><a href="#local-6989586621680279235"><span class="hs-identifier hs-var">vec</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">4</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-2087"></a><span>                  </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;where&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#ppr_constraint"><span class="hs-identifier hs-var">ppr_constraint</span></a><span> </span><a href="#local-6989586621680279236"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-2088"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2089"></a><span>    </span><a name="local-6989586621680279234"><a href="#local-6989586621680279234"><span class="hs-identifier">sdoc_vec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="PmExpr.html#pprPmExprWithParens"><span class="hs-identifier hs-var">pprPmExprWithParens</span></a><span> </span><a href="#local-6989586621680279232"><span class="hs-identifier hs-var">expr_vec</span></a><span>
</span><a name="line-2090"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680279235"><a href="#local-6989586621680279235"><span class="hs-identifier">vec</span></a></a><span class="hs-special">,</span><a name="local-6989586621680279236"><a href="#local-6989586621680279236"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PmExpr.html#runPmPprM"><span class="hs-identifier hs-var">runPmPprM</span></a><span> </span><a href="#local-6989586621680279234"><span class="hs-identifier hs-var">sdoc_vec</span></a><span> </span><span class="hs-special">(</span><a href="PmExpr.html#filterComplex"><span class="hs-identifier hs-var">filterComplex</span></a><span> </span><a href="#local-6989586621680279233"><span class="hs-identifier hs-var">complex</span></a><span class="hs-special">)</span><span>
</span><a name="line-2091"></a><span>
</span><a name="line-2092"></a><span class="hs-comment">{- Note [Representation of Term Equalities]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In the paper, term constraints always take the form (x ~ e). Of course, a more
general constraint of the form (e1 ~ e1) can always be transformed to an
equivalent set of the former constraints, by introducing a fresh, intermediate
variable: { y ~ e1, y ~ e1 }. Yet, implementing this representation gave rise
to #11160 (incredibly bad performance for literal pattern matching). Two are
the main sources of this problem (the actual problem is how these two interact
with each other):

1. Pattern matching on literals generates twice as many constraints as needed.
   Consider the following (tests/ghci/should_run/ghcirun004):

    foo :: Int -&gt; Int
    foo 1    = 0
    ...
    foo 5000 = 4999

   The covered and uncovered set *should* look like:
     U0 = { x |&gt; {} }

     C1  = { 1  |&gt; { x ~ 1 } }
     U1  = { x  |&gt; { False ~ (x ~ 1) } }
     ...
     C10 = { 10 |&gt; { False ~ (x ~ 1), .., False ~ (x ~ 9), x ~ 10 } }
     U10 = { x  |&gt; { False ~ (x ~ 1), .., False ~ (x ~ 9), False ~ (x ~ 10) } }
     ...

     If we replace { False ~ (x ~ 1) } with { y ~ False, y ~ (x ~ 1) }
     we get twice as many constraints. Also note that half of them are just the
     substitution [x |-&gt; False].

2. The term oracle (`tmOracle` in deSugar/TmOracle) uses equalities of the form
   (x ~ e) as substitutions [x |-&gt; e]. More specifically, function
   `extendSubstAndSolve` applies such substitutions in the residual constraints
   and partitions them in the affected and non-affected ones, which are the new
   worklist. Essentially, this gives quadradic behaviour on the number of the
   residual constraints. (This would not be the case if the term oracle used
   mutable variables but, since we use it to handle disjunctions on value set
   abstractions (`Union` case), we chose a pure, incremental interface).

Now the problem becomes apparent (e.g. for clause 300):
  * Set U300 contains 300 substituting constraints [y_i |-&gt; False] and 300
    constraints that we know that will not reduce (stay in the worklist).
  * To check for consistency, we apply the substituting constraints ONE BY ONE
    (since `tmOracle` is called incrementally, it does not have all of them
    available at once). Hence, we go through the (non-progressing) constraints
    over and over, achieving over-quadradic behaviour.

If instead we allow constraints of the form (e ~ e),
  * All uncovered sets Ui contain no substituting constraints and i
    non-progressing constraints of the form (False ~ (x ~ lit)) so the oracle
    behaves linearly.
  * All covered sets Ci contain exactly (i-1) non-progressing constraints and
    a single substituting constraint. So the term oracle goes through the
    constraints only once.

The performance improvement becomes even more important when more arguments are
involved.
-}</span><span>
</span><a name="line-2152"></a><span>
</span><a name="line-2153"></a><span class="hs-comment">-- Debugging Infrastructre</span><span>
</span><a name="line-2154"></a><span>
</span><a name="line-2155"></a><span class="hs-identifier">tracePm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Check.html#PmM"><span class="hs-identifier hs-type">PmM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2156"></a><a name="tracePm"><a href="Check.html#tracePm"><span class="hs-identifier">tracePm</span></a></a><span> </span><a name="local-6989586621680279237"><a href="#local-6989586621680279237"><span class="hs-identifier">herald</span></a></a><span> </span><a name="local-6989586621680279238"><a href="#local-6989586621680279238"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Check.html#liftD"><span class="hs-identifier hs-var">liftD</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Check.html#tracePmD"><span class="hs-identifier hs-var">tracePmD</span></a><span> </span><a href="#local-6989586621680279237"><span class="hs-identifier hs-var">herald</span></a><span> </span><a href="#local-6989586621680279238"><span class="hs-identifier hs-var">doc</span></a><span>
</span><a name="line-2157"></a><span>
</span><a name="line-2158"></a><span>
</span><a name="line-2159"></a><span class="hs-identifier">tracePmD</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#DsM"><span class="hs-identifier hs-type">DsM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2160"></a><a name="tracePmD"><a href="Check.html#tracePmD"><span class="hs-identifier">tracePmD</span></a></a><span> </span><a name="local-6989586621680279239"><a href="#local-6989586621680279239"><span class="hs-identifier">herald</span></a></a><span> </span><a name="local-6989586621680279240"><a href="#local-6989586621680279240"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-2161"></a><span>  </span><a name="local-6989586621680279241"><a href="#local-6989586621680279241"><span class="hs-identifier">dflags</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-2162"></a><span>  </span><a name="local-6989586621680279242"><a href="#local-6989586621680279242"><span class="hs-identifier">printer</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="DsMonad.html#mkPrintUnqualifiedDs"><span class="hs-identifier hs-var">mkPrintUnqualifiedDs</span></a><span>
</span><a name="line-2163"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="ErrUtils.html#dumpIfSet_dyn_printer"><span class="hs-identifier hs-var">dumpIfSet_dyn_printer</span></a><span> </span><a href="#local-6989586621680279242"><span class="hs-identifier hs-var">printer</span></a><span> </span><a href="#local-6989586621680279241"><span class="hs-identifier hs-var">dflags</span></a><span>
</span><a name="line-2164"></a><span>            </span><a href="DynFlags.html#Opt_D_dump_ec_trace"><span class="hs-identifier hs-var">Opt_D_dump_ec_trace</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><a href="#local-6989586621680279239"><span class="hs-identifier hs-var">herald</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621680279240"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2165"></a><span>
</span><a name="line-2166"></a><span>
</span><a name="line-2167"></a><span class="hs-identifier">pprPmPatDebug</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PmPat"><span class="hs-identifier hs-type">PmPat</span></a><span> </span><a href="#local-6989586621680278527"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2168"></a><a name="pprPmPatDebug"><a href="Check.html#pprPmPatDebug"><span class="hs-identifier">pprPmPatDebug</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#PmCon"><span class="hs-identifier hs-var">PmCon</span></a><span> </span><a name="local-6989586621680279243"><a href="#local-6989586621680279243"><span class="hs-identifier">cc</span></a></a><span> </span><a name="local-6989586621680279244"><a href="#local-6989586621680279244"><span class="hs-identifier">_arg_tys</span></a></a><span> </span><a name="local-6989586621680279245"><a href="#local-6989586621680279245"><span class="hs-identifier">_con_tvs</span></a></a><span> </span><a name="local-6989586621680279246"><a href="#local-6989586621680279246"><span class="hs-identifier">_con_dicts</span></a></a><span> </span><a name="local-6989586621680279247"><a href="#local-6989586621680279247"><span class="hs-identifier">con_args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2169"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PmCon&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279243"><span class="hs-identifier hs-var">cc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprPmPatDebug"><span class="hs-identifier hs-var">pprPmPatDebug</span></a><span> </span><a href="#local-6989586621680279247"><span class="hs-identifier hs-var">con_args</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-2170"></a><span class="hs-identifier">pprPmPatDebug</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmVar"><span class="hs-identifier hs-var">PmVar</span></a><span> </span><a name="local-6989586621680279248"><a href="#local-6989586621680279248"><span class="hs-identifier">vid</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PmVar&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279248"><span class="hs-identifier hs-var">vid</span></a><span>
</span><a name="line-2171"></a><span class="hs-identifier">pprPmPatDebug</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmLit"><span class="hs-identifier hs-var">PmLit</span></a><span> </span><a name="local-6989586621680279249"><a href="#local-6989586621680279249"><span class="hs-identifier">li</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PmLit&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279249"><span class="hs-identifier hs-var">li</span></a><span>
</span><a name="line-2172"></a><span class="hs-identifier">pprPmPatDebug</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmNLit"><span class="hs-identifier hs-var">PmNLit</span></a><span> </span><a name="local-6989586621680279250"><a href="#local-6989586621680279250"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621680279251"><a href="#local-6989586621680279251"><span class="hs-identifier">nl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PmNLit&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279250"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279251"><span class="hs-identifier hs-var">nl</span></a><span>
</span><a name="line-2173"></a><span class="hs-identifier">pprPmPatDebug</span><span> </span><span class="hs-special">(</span><a href="Check.html#PmGrd"><span class="hs-identifier hs-var">PmGrd</span></a><span> </span><a name="local-6989586621680279252"><a href="#local-6989586621680279252"><span class="hs-identifier">pv</span></a></a><span> </span><a name="local-6989586621680279253"><a href="#local-6989586621680279253"><span class="hs-identifier">ge</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;PmGrd&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprPmPatDebug"><span class="hs-identifier hs-var">pprPmPatDebug</span></a><span> </span><a href="#local-6989586621680279252"><span class="hs-identifier hs-var">pv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2174"></a><span>                                           </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680279253"><span class="hs-identifier hs-var">ge</span></a><span>
</span><a name="line-2175"></a><span>
</span><a name="line-2176"></a><span class="hs-identifier">pprPatVec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#PatVec"><span class="hs-identifier hs-type">PatVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2177"></a><a name="pprPatVec"><a href="Check.html#pprPatVec"><span class="hs-identifier">pprPatVec</span></a></a><span> </span><a name="local-6989586621680279254"><a href="#local-6989586621680279254"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Pattern:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-2178"></a><span>                </span><span class="hs-special">(</span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span>
</span><a name="line-2179"></a><span>                  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'\n'</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprPmPatDebug"><span class="hs-identifier hs-var">pprPmPatDebug</span></a><span> </span><a href="#local-6989586621680279254"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2180"></a><span>
</span><a name="line-2181"></a><span class="hs-identifier">pprValAbs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Check.html#ValAbs"><span class="hs-identifier hs-type">ValAbs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2182"></a><a name="pprValAbs"><a href="Check.html#pprValAbs"><span class="hs-identifier">pprValAbs</span></a></a><span> </span><a name="local-6989586621680279255"><a href="#local-6989586621680279255"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;ValAbs:&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-2183"></a><span>                </span><span class="hs-special">(</span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span>
</span><a name="line-2184"></a><span>                  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#comma"><span class="hs-identifier hs-var">comma</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Check.html#pprPmPatDebug"><span class="hs-identifier hs-var">pprPmPatDebug</span></a><span> </span><a href="#local-6989586621680279255"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2185"></a><span>
</span><a name="line-2186"></a><span class="hs-identifier">pprValVecDebug</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Check.html#ValVec"><span class="hs-identifier hs-type">ValVec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-2187"></a><a name="pprValVecDebug"><a href="Check.html#pprValVecDebug"><span class="hs-identifier">pprValVecDebug</span></a></a><span> </span><span class="hs-special">(</span><a href="Check.html#ValVec"><span class="hs-identifier hs-var">ValVec</span></a><span> </span><a name="local-6989586621680279256"><a href="#local-6989586621680279256"><span class="hs-identifier">vas</span></a></a><span> </span><a name="local-6989586621680279257"><a href="#local-6989586621680279257"><span class="hs-identifier">_d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;ValVec&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span>
</span><a name="line-2188"></a><span>                                  </span><a href="Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a><span> </span><span class="hs-special">(</span><a href="Check.html#pprValAbs"><span class="hs-identifier hs-var">pprValAbs</span></a><span> </span><a href="#local-6989586621680279256"><span class="hs-identifier hs-var">vas</span></a><span class="hs-special">)</span><span>
</span><a name="line-2189"></a></pre></body></html>