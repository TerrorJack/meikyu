<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |Compute a description of the generic representation that we use for a user defined data type.</span><span>
</span><a name="line-2"></a><span class="hs-comment">--</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- During vectorisation, we generate a PRepr and PA instance for each user defined</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- data type. The PA dictionary contains methods to convert the user type to and</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- from our generic representation. This module computes a description of what</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- that generic representation is.</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Vectorise</span><span class="hs-operator">.</span><span class="hs-identifier">Generic</span><span class="hs-operator">.</span><span class="hs-identifier">Description</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Vectorise.Generic.Description.html#CompRepr"><span class="hs-identifier hs-type">CompRepr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Generic.Description.html#ProdRepr"><span class="hs-identifier hs-type">ProdRepr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-type">ConRepr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Generic.Description.html#SumRepr"><span class="hs-identifier hs-type">SumRepr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Generic.Description.html#tyConRepr"><span class="hs-identifier hs-var">tyConRepr</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Generic.Description.html#sumReprType"><span class="hs-identifier hs-var">sumReprType</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Generic.Description.html#compOrigType"><span class="hs-identifier hs-var">compOrigType</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">where</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><a href="Vectorise.Utils.html"><span class="hs-identifier">Vectorise</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Vectorise.Monad.html"><span class="hs-identifier">Vectorise</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Vectorise.Builtins.html"><span class="hs-identifier">Vectorise</span><span class="hs-operator">.</span><span class="hs-identifier">Builtins</span></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="CoreSyn.html"><span class="hs-identifier">CoreSyn</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="DataCon.html"><span class="hs-identifier">DataCon</span></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- | Describes the generic representation of a data type.</span><span>
</span><a name="line-34"></a><span class="hs-comment">--   If the data type has multiple constructors then we bundle them</span><span>
</span><a name="line-35"></a><span class="hs-comment">--   together into a generic sum type.</span><span>
</span><a name="line-36"></a><span class="hs-keyword">data</span><span> </span><a name="SumRepr"><a href="Vectorise.Generic.Description.html#SumRepr"><span class="hs-identifier">SumRepr</span></a></a><span>
</span><a name="line-37"></a><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-comment">-- | Data type has no data constructors.</span><span>
</span><a name="line-38"></a><span>           </span><a name="EmptySum"><a href="Vectorise.Generic.Description.html#EmptySum"><span class="hs-identifier">EmptySum</span></a></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>        </span><span class="hs-comment">-- | Data type has a single constructor.</span><span>
</span><a name="line-41"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="UnarySum"><a href="Vectorise.Generic.Description.html#UnarySum"><span class="hs-identifier">UnarySum</span></a></a><span> </span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-type">ConRepr</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>        </span><span class="hs-comment">-- | Data type has multiple constructors.</span><span>
</span><a name="line-44"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="Sum"><a href="Vectorise.Generic.Description.html#Sum"><span class="hs-identifier">Sum</span></a></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Representation tycon for the sum (eg Sum2)</span><span>
</span><a name="line-45"></a><span>                 </span><a name="repr_sum_tc"><a href="Vectorise.Generic.Description.html#repr_sum_tc"><span class="hs-identifier">repr_sum_tc</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>               </span><span class="hs-comment">-- | PData version of the sum tycon     (eg PDataSum2)</span><span>
</span><a name="line-48"></a><span>               </span><span class="hs-comment">--   This TyCon doesn't appear explicitly in the source program.</span><span>
</span><a name="line-49"></a><span>               </span><span class="hs-comment">--   See Note [PData TyCons].</span><span>
</span><a name="line-50"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_psum_tc"><a href="Vectorise.Generic.Description.html#repr_psum_tc"><span class="hs-identifier">repr_psum_tc</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>               </span><span class="hs-comment">-- | PDatas version of the sum tycon    (eg PDatasSum2)</span><span>
</span><a name="line-53"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_psums_tc"><a href="Vectorise.Generic.Description.html#repr_psums_tc"><span class="hs-identifier">repr_psums_tc</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>               </span><span class="hs-comment">-- | Type of the selector               (eg Sel2)</span><span>
</span><a name="line-56"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_sel_ty"><a href="Vectorise.Generic.Description.html#repr_sel_ty"><span class="hs-identifier">repr_sel_ty</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>               </span><span class="hs-comment">-- | Type of multi-selector             (eg Sel2s)</span><span>
</span><a name="line-59"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_sels_ty"><a href="Vectorise.Generic.Description.html#repr_sels_ty"><span class="hs-identifier">repr_sels_ty</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>               </span><span class="hs-comment">-- | Function to get the length of a Sels of this type.</span><span>
</span><a name="line-62"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_selsLength_v"><a href="Vectorise.Generic.Description.html#repr_selsLength_v"><span class="hs-identifier">repr_selsLength_v</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span>               </span><span class="hs-comment">-- | Type of each data constructor.</span><span>
</span><a name="line-65"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_con_tys"><a href="Vectorise.Generic.Description.html#repr_con_tys"><span class="hs-identifier">repr_con_tys</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>               </span><span class="hs-comment">-- | Generic representation types of each data constructor.</span><span>
</span><a name="line-68"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_cons"><a href="Vectorise.Generic.Description.html#repr_cons"><span class="hs-identifier">repr_cons</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-type">ConRepr</span></a><span class="hs-special">]</span><span>
</span><a name="line-69"></a><span>               </span><span class="hs-special">}</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Describes the representation type of a data constructor.</span><span>
</span><a name="line-73"></a><span class="hs-keyword">data</span><span> </span><a name="ConRepr"><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier">ConRepr</span></a></a><span>
</span><a name="line-74"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="ConRepr"><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier">ConRepr</span></a></a><span>
</span><a name="line-75"></a><span>                </span><span class="hs-special">{</span><span> </span><a name="repr_dc"><a href="Vectorise.Generic.Description.html#repr_dc"><span class="hs-identifier">repr_dc</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span>
</span><a name="line-76"></a><span>                </span><span class="hs-special">,</span><span> </span><a name="repr_prod"><a href="Vectorise.Generic.Description.html#repr_prod"><span class="hs-identifier">repr_prod</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Generic.Description.html#ProdRepr"><span class="hs-identifier hs-type">ProdRepr</span></a><span>
</span><a name="line-77"></a><span>                </span><span class="hs-special">}</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-comment">-- | Describes the representation type of the fields \/ components of a constructor.</span><span>
</span><a name="line-80"></a><span class="hs-comment">--   If the data constructor has multiple fields then we bundle them</span><span>
</span><a name="line-81"></a><span class="hs-comment">--   together into a generic product type.</span><span>
</span><a name="line-82"></a><span class="hs-keyword">data</span><span> </span><a name="ProdRepr"><a href="Vectorise.Generic.Description.html#ProdRepr"><span class="hs-identifier">ProdRepr</span></a></a><span>
</span><a name="line-83"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Data constructor has no fields.</span><span>
</span><a name="line-84"></a><span>          </span><a name="EmptyProd"><a href="Vectorise.Generic.Description.html#EmptyProd"><span class="hs-identifier">EmptyProd</span></a></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span>        </span><span class="hs-comment">-- | Data constructor has a single field.</span><span>
</span><a name="line-87"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="UnaryProd"><a href="Vectorise.Generic.Description.html#UnaryProd"><span class="hs-identifier">UnaryProd</span></a></a><span> </span><a href="Vectorise.Generic.Description.html#CompRepr"><span class="hs-identifier hs-type">CompRepr</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>        </span><span class="hs-comment">-- | Data constructor has several fields.</span><span>
</span><a name="line-90"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="Prod"><a href="Vectorise.Generic.Description.html#Prod"><span class="hs-identifier">Prod</span></a></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Representation tycon for the product (eg Tuple2)</span><span>
</span><a name="line-91"></a><span>                 </span><a name="repr_tup_tc"><a href="Vectorise.Generic.Description.html#repr_tup_tc"><span class="hs-identifier">repr_tup_tc</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>                 </span><span class="hs-comment">-- | PData  version of the product tycon  (eg PDataTuple2)</span><span>
</span><a name="line-94"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_ptup_tc"><a href="Vectorise.Generic.Description.html#repr_ptup_tc"><span class="hs-identifier">repr_ptup_tc</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>                 </span><span class="hs-comment">-- | PDatas version of the product tycon  (eg PDatasTuple2s)</span><span>
</span><a name="line-97"></a><span>                 </span><span class="hs-comment">--   Not all lifted backends use `PDatas`.</span><span>
</span><a name="line-98"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_ptups_tc"><a href="Vectorise.Generic.Description.html#repr_ptups_tc"><span class="hs-identifier">repr_ptups_tc</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>                 </span><span class="hs-comment">-- | Types of each field.</span><span>
</span><a name="line-101"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_comp_tys"><a href="Vectorise.Generic.Description.html#repr_comp_tys"><span class="hs-identifier">repr_comp_tys</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>                 </span><span class="hs-comment">-- | Generic representation types for each field.</span><span>
</span><a name="line-104"></a><span>               </span><span class="hs-special">,</span><span> </span><a name="repr_comps"><a href="Vectorise.Generic.Description.html#repr_comps"><span class="hs-identifier">repr_comps</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Vectorise.Generic.Description.html#CompRepr"><span class="hs-identifier hs-type">CompRepr</span></a><span class="hs-special">]</span><span>
</span><a name="line-105"></a><span>               </span><span class="hs-special">}</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-comment">-- | Describes the representation type of a data constructor field.</span><span>
</span><a name="line-109"></a><span class="hs-keyword">data</span><span> </span><a name="CompRepr"><a href="Vectorise.Generic.Description.html#CompRepr"><span class="hs-identifier">CompRepr</span></a></a><span>
</span><a name="line-110"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a name="Keep"><a href="Vectorise.Generic.Description.html#Keep"><span class="hs-identifier">Keep</span></a></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-111"></a><span>               </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>     </span><span class="hs-comment">-- PR dictionary for the type</span><span>
</span><a name="line-112"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a name="Wrap"><a href="Vectorise.Generic.Description.html#Wrap"><span class="hs-identifier">Wrap</span></a></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- |Determine the generic representation of a data type, given its tycon.</span><span>
</span><a name="line-118"></a><span class="hs-comment">--</span><span>
</span><a name="line-119"></a><span class="hs-identifier">tyConRepr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Monad.Base.html#VM"><span class="hs-identifier hs-type">VM</span></a><span> </span><a href="Vectorise.Generic.Description.html#SumRepr"><span class="hs-identifier hs-type">SumRepr</span></a><span>
</span><a name="line-120"></a><a name="tyConRepr"><a href="Vectorise.Generic.Description.html#tyConRepr"><span class="hs-identifier">tyConRepr</span></a></a><span> </span><a name="local-6989586621680342256"><a href="#local-6989586621680342256"><span class="hs-identifier">tc</span></a></a><span>
</span><a name="line-121"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342257"><span class="hs-identifier hs-var">sum_repr</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a><span> </span><a href="#local-6989586621680342256"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-comment">-- Build the representation type for a data type with the given constructors.</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-comment">-- The representation types for each individual constructor are bundled</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-comment">-- together into a generic sum type.</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-identifier">sum_repr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Monad.Base.html#VM"><span class="hs-identifier hs-type">VM</span></a><span> </span><a href="Vectorise.Generic.Description.html#SumRepr"><span class="hs-identifier hs-type">SumRepr</span></a><span>
</span><a name="line-127"></a><span>    </span><a name="local-6989586621680342257"><a href="#local-6989586621680342257"><span class="hs-identifier">sum_repr</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="Vectorise.Generic.Description.html#EmptySum"><span class="hs-identifier hs-var">EmptySum</span></a><span>
</span><a name="line-128"></a><span>    </span><span class="hs-identifier">sum_repr</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680342261"><a href="#local-6989586621680342261"><span class="hs-identifier">con</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><a href="Vectorise.Generic.Description.html#UnarySum"><span class="hs-identifier hs-var">UnarySum</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680342258"><span class="hs-identifier hs-var">con_repr</span></a><span> </span><a href="#local-6989586621680342261"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-identifier">sum_repr</span><span> </span><a name="local-6989586621680342262"><a href="#local-6989586621680342262"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-130"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680342263"><a href="#local-6989586621680342263"><span class="hs-identifier">arity</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621680342262"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-131"></a><span>           </span><a name="local-6989586621680342264"><a href="#local-6989586621680342264"><span class="hs-identifier">rs</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621680342258"><span class="hs-identifier hs-var">con_repr</span></a><span> </span><a href="#local-6989586621680342262"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-132"></a><span>           </span><a name="local-6989586621680342265"><a href="#local-6989586621680342265"><span class="hs-identifier">tys</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="Vectorise.Generic.Description.html#conReprType"><span class="hs-identifier hs-var">conReprType</span></a><span> </span><a href="#local-6989586621680342264"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span>           </span><span class="hs-comment">-- Get the 'Sum' tycon of this arity (eg Sum2).</span><span>
</span><a name="line-135"></a><span>           </span><a name="local-6989586621680342266"><a href="#local-6989586621680342266"><span class="hs-identifier">sum_tc</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Monad.html#builtin"><span class="hs-identifier hs-var">builtin</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Builtins.Base.html#sumTyCon"><span class="hs-identifier hs-var">sumTyCon</span></a><span> </span><a href="#local-6989586621680342263"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>           </span><span class="hs-comment">-- Get the 'PData' and 'PDatas' tycons for the sum.</span><span>
</span><a name="line-138"></a><span>           </span><a name="local-6989586621680342267"><a href="#local-6989586621680342267"><span class="hs-identifier">psum_tc</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Utils.Base.html#pdataReprTyConExact"><span class="hs-identifier hs-var">pdataReprTyConExact</span></a><span>  </span><a href="#local-6989586621680342266"><span class="hs-identifier hs-var">sum_tc</span></a><span>
</span><a name="line-139"></a><span>           </span><a name="local-6989586621680342268"><a href="#local-6989586621680342268"><span class="hs-identifier">psums_tc</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Utils.Base.html#pdatasReprTyConExact"><span class="hs-identifier hs-var">pdatasReprTyConExact</span></a><span> </span><a href="#local-6989586621680342266"><span class="hs-identifier hs-var">sum_tc</span></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span>           </span><a name="local-6989586621680342269"><a href="#local-6989586621680342269"><span class="hs-identifier">sel_ty</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Monad.html#builtin"><span class="hs-identifier hs-var">builtin</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Builtins.Base.html#selTy"><span class="hs-identifier hs-var">selTy</span></a><span>      </span><a href="#local-6989586621680342263"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>           </span><a name="local-6989586621680342270"><a href="#local-6989586621680342270"><span class="hs-identifier">sels_ty</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Monad.html#builtin"><span class="hs-identifier hs-var">builtin</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Builtins.Base.html#selsTy"><span class="hs-identifier hs-var">selsTy</span></a><span>     </span><a href="#local-6989586621680342263"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>           </span><a name="local-6989586621680342271"><a href="#local-6989586621680342271"><span class="hs-identifier">selsLength_v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Monad.html#builtin"><span class="hs-identifier hs-var">builtin</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Builtins.Base.html#selsLength"><span class="hs-identifier hs-var">selsLength</span></a><span> </span><a href="#local-6989586621680342263"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>           </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Vectorise.Generic.Description.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span>
</span><a name="line-145"></a><span>                  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">repr_sum_tc</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342266"><span class="hs-identifier hs-var">sum_tc</span></a><span>
</span><a name="line-146"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_psum_tc</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342267"><span class="hs-identifier hs-var">psum_tc</span></a><span>
</span><a name="line-147"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_psums_tc</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342268"><span class="hs-identifier hs-var">psums_tc</span></a><span>
</span><a name="line-148"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_sel_ty</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342269"><span class="hs-identifier hs-var">sel_ty</span></a><span>
</span><a name="line-149"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_sels_ty</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342270"><span class="hs-identifier hs-var">sels_ty</span></a><span>
</span><a name="line-150"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_selsLength_v</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342271"><span class="hs-identifier hs-var">selsLength_v</span></a><span>
</span><a name="line-151"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_con_tys</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342265"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-152"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_cons</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342264"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-153"></a><span>                  </span><span class="hs-special">}</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span>    </span><span class="hs-comment">-- Build the representation type for a single data constructor.</span><span>
</span><a name="line-156"></a><span>    </span><a name="local-6989586621680342258"><a href="#local-6989586621680342258"><span class="hs-identifier">con_repr</span></a></a><span> </span><a name="local-6989586621680342272"><a href="#local-6989586621680342272"><span class="hs-identifier">con</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-var">ConRepr</span></a><span> </span><a href="#local-6989586621680342272"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680342259"><span class="hs-identifier hs-var">prod_repr</span></a><span> </span><span class="hs-special">(</span><a href="DataCon.html#dataConRepArgTys"><span class="hs-identifier hs-var">dataConRepArgTys</span></a><span> </span><a href="#local-6989586621680342272"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-comment">-- Build the representation type for the fields of a data constructor.</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-comment">-- The representation types for each individual field are bundled</span><span>
</span><a name="line-160"></a><span>    </span><span class="hs-comment">-- together into a generic product type.</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-identifier">prod_repr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Monad.Base.html#VM"><span class="hs-identifier hs-type">VM</span></a><span> </span><a href="Vectorise.Generic.Description.html#ProdRepr"><span class="hs-identifier hs-type">ProdRepr</span></a><span>
</span><a name="line-162"></a><span>    </span><a name="local-6989586621680342259"><a href="#local-6989586621680342259"><span class="hs-identifier">prod_repr</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="Vectorise.Generic.Description.html#EmptyProd"><span class="hs-identifier hs-var">EmptyProd</span></a><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier">prod_repr</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680342273"><a href="#local-6989586621680342273"><span class="hs-identifier">ty</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><a href="Vectorise.Generic.Description.html#UnaryProd"><span class="hs-identifier hs-var">UnaryProd</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680342260"><span class="hs-identifier hs-var">comp_repr</span></a><span> </span><a href="#local-6989586621680342273"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-identifier">prod_repr</span><span> </span><a name="local-6989586621680342274"><a href="#local-6989586621680342274"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-165"></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680342275"><a href="#local-6989586621680342275"><span class="hs-identifier">arity</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621680342274"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-166"></a><span>           </span><a name="local-6989586621680342276"><a href="#local-6989586621680342276"><span class="hs-identifier">rs</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621680342260"><span class="hs-identifier hs-var">comp_repr</span></a><span> </span><a href="#local-6989586621680342274"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-167"></a><span>           </span><a name="local-6989586621680342277"><a href="#local-6989586621680342277"><span class="hs-identifier">tys'</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="Vectorise.Generic.Description.html#compReprType"><span class="hs-identifier hs-var">compReprType</span></a><span> </span><a href="#local-6989586621680342276"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span>           </span><span class="hs-comment">-- Get the Prod \/ Tuple tycon of this arity (eg Tuple2)</span><span>
</span><a name="line-170"></a><span>           </span><a name="local-6989586621680342278"><a href="#local-6989586621680342278"><span class="hs-identifier">tup_tc</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Monad.html#builtin"><span class="hs-identifier hs-var">builtin</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Builtins.Base.html#prodTyCon"><span class="hs-identifier hs-var">prodTyCon</span></a><span> </span><a href="#local-6989586621680342275"><span class="hs-identifier hs-var">arity</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>           </span><span class="hs-comment">-- Get the 'PData' and 'PDatas' tycons for the product.</span><span>
</span><a name="line-173"></a><span>           </span><a name="local-6989586621680342279"><a href="#local-6989586621680342279"><span class="hs-identifier">ptup_tc</span></a></a><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Utils.Base.html#pdataReprTyConExact"><span class="hs-identifier hs-var">pdataReprTyConExact</span></a><span>  </span><a href="#local-6989586621680342278"><span class="hs-identifier hs-var">tup_tc</span></a><span>
</span><a name="line-174"></a><span>           </span><a name="local-6989586621680342280"><a href="#local-6989586621680342280"><span class="hs-identifier">ptups_tc</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Vectorise.Utils.Base.html#pdatasReprTyConExact"><span class="hs-identifier hs-var">pdatasReprTyConExact</span></a><span> </span><a href="#local-6989586621680342278"><span class="hs-identifier hs-var">tup_tc</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span>           </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Vectorise.Generic.Description.html#Prod"><span class="hs-identifier hs-var">Prod</span></a><span>
</span><a name="line-177"></a><span>                  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">repr_tup_tc</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342278"><span class="hs-identifier hs-var">tup_tc</span></a><span>
</span><a name="line-178"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_ptup_tc</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342279"><span class="hs-identifier hs-var">ptup_tc</span></a><span>
</span><a name="line-179"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_ptups_tc</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342280"><span class="hs-identifier hs-var">ptups_tc</span></a><span>
</span><a name="line-180"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_comp_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342277"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-181"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_comps</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342276"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-182"></a><span>                  </span><span class="hs-special">}</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>    </span><span class="hs-comment">-- Build the representation type for a single data constructor field.</span><span>
</span><a name="line-185"></a><span>    </span><a name="local-6989586621680342260"><a href="#local-6989586621680342260"><span class="hs-identifier">comp_repr</span></a></a><span> </span><a name="local-6989586621680342281"><a href="#local-6989586621680342281"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Keep"><span class="hs-identifier hs-var">Keep</span></a><span> </span><a href="#local-6989586621680342281"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Vectorise.Utils.PADict.html#prDictOfReprType"><span class="hs-identifier hs-var">prDictOfReprType</span></a><span> </span><a href="#local-6989586621680342281"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>                   </span><span class="hs-special">`</span><a href="Vectorise.Monad.Base.html#orElseV"><span class="hs-identifier hs-var">orElseV</span></a><span class="hs-special">`</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Wrap"><span class="hs-identifier hs-var">Wrap</span></a><span> </span><a href="#local-6989586621680342281"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- |Yield the type of this sum representation.</span><span>
</span><a name="line-189"></a><span class="hs-comment">--</span><span>
</span><a name="line-190"></a><span class="hs-identifier">sumReprType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Generic.Description.html#SumRepr"><span class="hs-identifier hs-type">SumRepr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Monad.Base.html#VM"><span class="hs-identifier hs-type">VM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-191"></a><a name="sumReprType"><a href="Vectorise.Generic.Description.html#sumReprType"><span class="hs-identifier">sumReprType</span></a></a><span> </span><a href="Vectorise.Generic.Description.html#EmptySum"><span class="hs-identifier hs-var">EmptySum</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Utils.Base.html#voidType"><span class="hs-identifier hs-var">voidType</span></a><span>
</span><a name="line-192"></a><span class="hs-identifier">sumReprType</span><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#UnarySum"><span class="hs-identifier hs-var">UnarySum</span></a><span> </span><a name="local-6989586621680342282"><a href="#local-6989586621680342282"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Generic.Description.html#conReprType"><span class="hs-identifier hs-var">conReprType</span></a><span> </span><a href="#local-6989586621680342282"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-193"></a><span class="hs-identifier">sumReprType</span><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">repr_sum_tc</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680342283"><a href="#local-6989586621680342283"><span class="hs-identifier">sum_tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_con_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680342284"><a href="#local-6989586621680342284"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-6989586621680342283"><span class="hs-identifier hs-var">sum_tc</span></a><span> </span><a href="#local-6989586621680342284"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- Yield the type of this constructor representation.</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-identifier">conReprType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-type">ConRepr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Monad.Base.html#VM"><span class="hs-identifier hs-type">VM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-199"></a><a name="conReprType"><a href="Vectorise.Generic.Description.html#conReprType"><span class="hs-identifier">conReprType</span></a></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-var">ConRepr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680342285"><a href="#local-6989586621680342285"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Generic.Description.html#prodReprType"><span class="hs-identifier hs-var">prodReprType</span></a><span> </span><a href="#local-6989586621680342285"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- Yield the type of of this product representation.</span><span>
</span><a name="line-202"></a><span class="hs-comment">--</span><span>
</span><a name="line-203"></a><span class="hs-identifier">prodReprType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Generic.Description.html#ProdRepr"><span class="hs-identifier hs-type">ProdRepr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Monad.Base.html#VM"><span class="hs-identifier hs-type">VM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-204"></a><a name="prodReprType"><a href="Vectorise.Generic.Description.html#prodReprType"><span class="hs-identifier">prodReprType</span></a></a><span> </span><a href="Vectorise.Generic.Description.html#EmptyProd"><span class="hs-identifier hs-var">EmptyProd</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Utils.Base.html#voidType"><span class="hs-identifier hs-var">voidType</span></a><span>
</span><a name="line-205"></a><span class="hs-identifier">prodReprType</span><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#UnaryProd"><span class="hs-identifier hs-var">UnaryProd</span></a><span> </span><a name="local-6989586621680342286"><a href="#local-6989586621680342286"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Generic.Description.html#compReprType"><span class="hs-identifier hs-var">compReprType</span></a><span> </span><a href="#local-6989586621680342286"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-206"></a><span class="hs-identifier">prodReprType</span><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Prod"><span class="hs-identifier hs-var">Prod</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">repr_tup_tc</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680342287"><a href="#local-6989586621680342287"><span class="hs-identifier">tup_tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">repr_comp_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680342288"><a href="#local-6989586621680342288"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-6989586621680342287"><span class="hs-identifier hs-var">tup_tc</span></a><span> </span><a href="#local-6989586621680342288"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- Yield the type of this data constructor field \/ component representation.</span><span>
</span><a name="line-210"></a><span class="hs-comment">--</span><span>
</span><a name="line-211"></a><span class="hs-identifier">compReprType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Generic.Description.html#CompRepr"><span class="hs-identifier hs-type">CompRepr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Monad.Base.html#VM"><span class="hs-identifier hs-type">VM</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-212"></a><a name="compReprType"><a href="Vectorise.Generic.Description.html#compReprType"><span class="hs-identifier">compReprType</span></a></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Keep"><span class="hs-identifier hs-var">Keep</span></a><span> </span><a name="local-6989586621680342289"><a href="#local-6989586621680342289"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680342289"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-213"></a><span class="hs-identifier">compReprType</span><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Wrap"><span class="hs-identifier hs-var">Wrap</span></a><span> </span><a name="local-6989586621680342290"><a href="#local-6989586621680342290"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Utils.Base.html#mkWrapType"><span class="hs-identifier hs-var">mkWrapType</span></a><span> </span><a href="#local-6989586621680342290"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">-- |Yield the original component type of a data constructor component representation.</span><span>
</span><a name="line-216"></a><span class="hs-comment">--</span><span>
</span><a name="line-217"></a><span class="hs-identifier">compOrigType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Generic.Description.html#CompRepr"><span class="hs-identifier hs-type">CompRepr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-218"></a><a name="compOrigType"><a href="Vectorise.Generic.Description.html#compOrigType"><span class="hs-identifier">compOrigType</span></a></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Keep"><span class="hs-identifier hs-var">Keep</span></a><span> </span><a name="local-6989586621680342291"><a href="#local-6989586621680342291"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342291"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-219"></a><span class="hs-identifier">compOrigType</span><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#Wrap"><span class="hs-identifier hs-var">Wrap</span></a><span> </span><a name="local-6989586621680342292"><a href="#local-6989586621680342292"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680342292"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- Outputable instances -------------------------------------------------------</span><span>
</span><a name="line-223"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Vectorise.Generic.Description.html#SumRepr"><span class="hs-identifier hs-type">SumRepr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-224"></a><span> </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621680342246"><a href="#local-6989586621680342246"><span class="hs-identifier">ss</span></a></a><span>
</span><a name="line-225"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680342246"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-226"></a><span>        </span><a href="Vectorise.Generic.Description.html#EmptySum"><span class="hs-identifier hs-var">EmptySum</span></a><span>
</span><a name="line-227"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;EmptySum&quot;</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span>        </span><a href="Vectorise.Generic.Description.html#UnarySum"><span class="hs-identifier hs-var">UnarySum</span></a><span> </span><a name="local-6989586621680342247"><a href="#local-6989586621680342247"><span class="hs-identifier">con</span></a></a><span>
</span><a name="line-230"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;UnarySum&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342247"><span class="hs-identifier hs-var">con</span></a><span class="hs-special">]</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span>        </span><a href="Vectorise.Generic.Description.html#Sum"><span class="hs-identifier hs-var">Sum</span></a><span> </span><a name="local-6989586621680342248"><a href="#local-6989586621680342248"><span class="hs-identifier">sumtc</span></a></a><span> </span><a name="local-6989586621680342249"><a href="#local-6989586621680342249"><span class="hs-identifier">psumtc</span></a></a><span> </span><a name="local-6989586621680342250"><a href="#local-6989586621680342250"><span class="hs-identifier">psumstc</span></a></a><span> </span><a name="local-6989586621680342251"><a href="#local-6989586621680342251"><span class="hs-identifier">selty</span></a></a><span> </span><a name="local-6989586621680342252"><a href="#local-6989586621680342252"><span class="hs-identifier">selsty</span></a></a><span> </span><a name="local-6989586621680342253"><a href="#local-6989586621680342253"><span class="hs-identifier">selsLength</span></a></a><span> </span><a name="local-6989586621680342254"><a href="#local-6989586621680342254"><span class="hs-identifier">contys</span></a></a><span> </span><a name="local-6989586621680342255"><a href="#local-6989586621680342255"><span class="hs-identifier">cons</span></a></a><span>
</span><a name="line-233"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Sum&quot;</span><span> </span><a href="Outputable.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span>
</span><a name="line-234"></a><span>                </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span>   </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_sum_tc       = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342248"><span class="hs-identifier hs-var">sumtc</span></a><span>
</span><a name="line-235"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_psum_tc      = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342249"><span class="hs-identifier hs-var">psumtc</span></a><span>
</span><a name="line-236"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_psums_tc     = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342250"><span class="hs-identifier hs-var">psumstc</span></a><span>
</span><a name="line-237"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_sel_ty       = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342251"><span class="hs-identifier hs-var">selty</span></a><span>
</span><a name="line-238"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_sels_ty      = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342252"><span class="hs-identifier hs-var">selsty</span></a><span>
</span><a name="line-239"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_selsLength_v = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342253"><span class="hs-identifier hs-var">selsLength</span></a><span>
</span><a name="line-240"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_con_tys      = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342254"><span class="hs-identifier hs-var">contys</span></a><span>
</span><a name="line-241"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_cons         = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342255"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-type">ConRepr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-245"></a><span> </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="Vectorise.Generic.Description.html#ConRepr"><span class="hs-identifier hs-var">ConRepr</span></a><span> </span><a name="local-6989586621680342244"><a href="#local-6989586621680342244"><span class="hs-identifier">dc</span></a></a><span> </span><a name="local-6989586621680342245"><a href="#local-6989586621680342245"><span class="hs-identifier">pr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;ConRepr&quot;</span><span> </span><a href="Outputable.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span>
</span><a name="line-247"></a><span>                </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span>   </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_dc      = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342244"><span class="hs-identifier hs-var">dc</span></a><span>
</span><a name="line-248"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;repr_prod    = &quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342245"><span class="hs-identifier hs-var">pr</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Vectorise.Generic.Description.html#ProdRepr"><span class="hs-identifier hs-type">ProdRepr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-252"></a><span> </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621680342237"><a href="#local-6989586621680342237"><span class="hs-identifier">ss</span></a></a><span>
</span><a name="line-253"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680342237"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-254"></a><span>        </span><a href="Vectorise.Generic.Description.html#EmptyProd"><span class="hs-identifier hs-var">EmptyProd</span></a><span>
</span><a name="line-255"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;EmptyProd&quot;</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span>        </span><a href="Vectorise.Generic.Description.html#UnaryProd"><span class="hs-identifier hs-var">UnaryProd</span></a><span> </span><a name="local-6989586621680342238"><a href="#local-6989586621680342238"><span class="hs-identifier">cr</span></a></a><span>
</span><a name="line-258"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;UnaryProd&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342238"><span class="hs-identifier hs-var">cr</span></a><span class="hs-special">]</span><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span>        </span><a href="Vectorise.Generic.Description.html#Prod"><span class="hs-identifier hs-var">Prod</span></a><span> </span><a name="local-6989586621680342239"><a href="#local-6989586621680342239"><span class="hs-identifier">tuptcs</span></a></a><span> </span><a name="local-6989586621680342240"><a href="#local-6989586621680342240"><span class="hs-identifier">ptuptcs</span></a></a><span> </span><a name="local-6989586621680342241"><a href="#local-6989586621680342241"><span class="hs-identifier">ptupstcs</span></a></a><span> </span><a name="local-6989586621680342242"><a href="#local-6989586621680342242"><span class="hs-identifier">comptys</span></a></a><span> </span><a name="local-6989586621680342243"><a href="#local-6989586621680342243"><span class="hs-identifier">comps</span></a></a><span>
</span><a name="line-261"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Prod&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342239"><span class="hs-identifier hs-var">tuptcs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342240"><span class="hs-identifier hs-var">ptuptcs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342241"><span class="hs-identifier hs-var">ptupstcs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342242"><span class="hs-identifier hs-var">comptys</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342243"><span class="hs-identifier hs-var">comps</span></a><span class="hs-special">]</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Vectorise.Generic.Description.html#CompRepr"><span class="hs-identifier hs-type">CompRepr</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-265"></a><span> </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a name="local-6989586621680342233"><a href="#local-6989586621680342233"><span class="hs-identifier">ss</span></a></a><span>
</span><a name="line-266"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680342233"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-267"></a><span>        </span><a href="Vectorise.Generic.Description.html#Keep"><span class="hs-identifier hs-var">Keep</span></a><span> </span><a name="local-6989586621680342234"><a href="#local-6989586621680342234"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621680342235"><a href="#local-6989586621680342235"><span class="hs-identifier">ce</span></a></a><span>
</span><a name="line-268"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Keep&quot;</span><span> </span><a href="Outputable.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342234"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342235"><span class="hs-identifier hs-var">ce</span></a><span class="hs-special">]</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span>        </span><a href="Vectorise.Generic.Description.html#Wrap"><span class="hs-identifier hs-var">Wrap</span></a><span> </span><a name="local-6989586621680342236"><a href="#local-6989586621680342236"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-271"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Wrap&quot;</span><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680342236"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- Notes ----------------------------------------------------------------------</span><span>
</span><a name="line-275"></a><span class="hs-comment">{-
Note [PData TyCons]
~~~~~~~~~~~~~~~~~~~
When PData is a type family, the compiler generates a type constructor for each
instance, which is named after the family and instance type. This type
constructor does not appear in the source program. Rather, it is implicitly
defined by the data instance. For example with:

  data family PData a

  data instance PData (Sum2 a b)
        = PSum2  U.Sel2
                 (PData a)
                 (PData b)

The type constructor corresponding to the instance will be named 'PDataSum2',
and this is what we will get in the repr_psum_tc field of SumRepr.Sum.

-}</span><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a></pre></body></html>