<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-2"></a><span class="hs-comment">--</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- Pretty-printing TyThings</span><span>
</span><a name="line-4"></a><span class="hs-comment">--</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- (c) The GHC Team 2005</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PprTyThing</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><a href="PprTyThing.html#pprTyThing"><span class="hs-identifier hs-var">pprTyThing</span></a><span class="hs-special">,</span><span>
</span><a name="line-12"></a><span>        </span><a href="PprTyThing.html#pprTyThingInContext"><span class="hs-identifier hs-var">pprTyThingInContext</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>        </span><a href="PprTyThing.html#pprTyThingLoc"><span class="hs-identifier hs-var">pprTyThingLoc</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="PprTyThing.html#pprTyThingInContextLoc"><span class="hs-identifier hs-var">pprTyThingInContextLoc</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="PprTyThing.html#pprTyThingHdr"><span class="hs-identifier hs-var">pprTyThingHdr</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="PprTyThing.html#pprTypeForUser"><span class="hs-identifier hs-var">pprTypeForUser</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="PprTyThing.html#pprFamInst"><span class="hs-identifier hs-var">pprFamInst</span></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="IfaceSyn.html"><span class="hs-identifier">IfaceSyn</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="IfaceSyn.html#ShowSub"><span class="hs-identifier hs-type">ShowSub</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="IfaceSyn.html#ShowHowMuch"><span class="hs-identifier hs-type">ShowHowMuch</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="IfaceSyn.html#AltPpr"><span class="hs-identifier hs-type">AltPpr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="IfaceSyn.html#showToHeader"><span class="hs-identifier hs-var">showToHeader</span></a><span class="hs-special">,</span><span> </span><a href="IfaceSyn.html#pprIfaceDecl"><span class="hs-identifier hs-var">pprIfaceDecl</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="CoAxiom.html"><span class="hs-identifier">CoAxiom</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="CoAxiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><a href="HscTypes.html"><span class="hs-identifier">HscTypes</span></a><span class="hs-special">(</span><span> </span><a href="HscTypes.html#tyThingParent_maybe"><span class="hs-identifier hs-var">tyThingParent_maybe</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><a href="MkIface.html"><span class="hs-identifier">MkIface</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="MkIface.html#tyThingToIfaceDecl"><span class="hs-identifier hs-var">tyThingToIfaceDecl</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#tidyOpenType"><span class="hs-identifier hs-var">tidyOpenType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="FamInstEnv.html"><span class="hs-identifier">FamInstEnv</span></a><span class="hs-special">(</span><span> </span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-type">FamInst</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="FamInstEnv.html#FamFlavor"><span class="hs-identifier hs-type">FamFlavor</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTypeApp"><span class="hs-identifier hs-var">pprTypeApp</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprSigmaType"><span class="hs-identifier hs-var">pprSigmaType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span class="hs-special">(</span><span> </span><a href="VarEnv.html#emptyTidyEnv"><span class="hs-identifier hs-var">emptyTidyEnv</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- Pretty-printing entities that we get from the GHC API</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">{-  Note [Pretty-printing TyThings]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We pretty-print a TyThing by converting it to an IfaceDecl,
and pretty-printing that (see ppr_ty_thing below).
Here is why:

* When pretty-printing (a type, say), the idiomatic solution is not to
  &quot;rename type variables on the fly&quot;, but rather to &quot;tidy&quot; the type
  (which gives each variable a distinct print-name), and then
  pretty-print it (without renaming). Separate the two
  concerns. Functions like tidyType do this.

* Alas, for type constructors, TyCon, tidying does not work well,
  because a TyCon includes DataCons which include Types, which mention
  TyCons. And tidying can't tidy a mutually recursive data structure
  graph, only trees.

* One alternative would be to ensure that TyCons get type variables
  with distinct print-names. That's ok for type variables but less
  easy for kind variables. Processing data type declarations is
  already so complicated that I don't think it's sensible to add the
  extra requirement that it generates only &quot;pretty&quot; types and kinds.

*  One place the non-pretty names can show up is in GHCi. But another
   is in interface files. Look at MkIface.tyThingToIfaceDecl which
   converts a TyThing (i.e. TyCon, Class etc) to an IfaceDecl. And it
   already does tidying as part of that conversion!  Why? Because
   interface files contains fast-strings, not uniques, so the names
   must at least be distinct.

So if we convert to IfaceDecl, we get a nice tidy IfaceDecl, and can
print that.  Of course, that means that pretty-printing IfaceDecls
must be careful to display nice user-friendly results, but that's ok.

See #7730, #8776 for details   -}</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">--------------------</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Pretty-prints a 'FamInst' (type/data family instance) with its defining location.</span><span>
</span><a name="line-78"></a><span class="hs-identifier">pprFamInst</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-type">FamInst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-79"></a><span class="hs-comment">--  * For data instances we go via pprTyThing of the representational TyCon,</span><span>
</span><a name="line-80"></a><span class="hs-comment">--    because there is already much cleverness associated with printing</span><span>
</span><a name="line-81"></a><span class="hs-comment">--    data type declarations that I don't want to duplicate</span><span>
</span><a name="line-82"></a><span class="hs-comment">--  * For type instances we print directly here; there is no TyCon</span><span>
</span><a name="line-83"></a><span class="hs-comment">--    to give to pprTyThing</span><span>
</span><a name="line-84"></a><span class="hs-comment">--</span><span>
</span><a name="line-85"></a><span class="hs-comment">-- FamInstEnv.pprFamInst does a more quick-and-dirty job for internal purposes</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><a name="pprFamInst"><a href="PprTyThing.html#pprFamInst"><span class="hs-identifier">pprFamInst</span></a></a><span> </span><span class="hs-special">(</span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-var">FamInst</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fi_flavor</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="FamInstEnv.html#DataFamilyInst"><span class="hs-identifier hs-var">DataFamilyInst</span></a><span> </span><a name="local-6989586621680079989"><a href="#local-6989586621680079989"><span class="hs-identifier">rep_tc</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="PprTyThing.html#pprTyThingInContextLoc"><span class="hs-identifier hs-var">pprTyThingInContextLoc</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ATyCon"><span class="hs-identifier hs-var">ATyCon</span></a><span> </span><a href="#local-6989586621680079989"><span class="hs-identifier hs-var">rep_tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-identifier">pprFamInst</span><span> </span><span class="hs-special">(</span><a href="FamInstEnv.html#FamInst"><span class="hs-identifier hs-var">FamInst</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fi_flavor</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="FamInstEnv.html#SynFamilyInst"><span class="hs-identifier hs-var">SynFamilyInst</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fi_axiom</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680079990"><a href="#local-6989586621680079990"><span class="hs-identifier">axiom</span></a></a><span>
</span><a name="line-91"></a><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fi_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680079991"><a href="#local-6989586621680079991"><span class="hs-identifier">lhs_tys</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">fi_rhs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680079992"><a href="#local-6989586621680079992"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="PprTyThing.html#showWithLoc"><span class="hs-identifier hs-var">showWithLoc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#pprDefinedAt"><span class="hs-identifier hs-var">pprDefinedAt</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621680079990"><span class="hs-identifier hs-var">axiom</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-93"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type instance&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="TyCoRep.html#pprTypeApp"><span class="hs-identifier hs-var">pprTypeApp</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a><span> </span><a href="#local-6989586621680079990"><span class="hs-identifier hs-var">axiom</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680079991"><span class="hs-identifier hs-var">lhs_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#equals"><span class="hs-identifier hs-var">equals</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680079992"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">----------------------------</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- | Pretty-prints a 'TyThing' with its defining location.</span><span>
</span><a name="line-98"></a><span class="hs-identifier">pprTyThingLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-99"></a><a name="pprTyThingLoc"><a href="PprTyThing.html#pprTyThingLoc"><span class="hs-identifier">pprTyThingLoc</span></a></a><span> </span><a name="local-6989586621680079993"><a href="#local-6989586621680079993"><span class="hs-identifier">tyThing</span></a></a><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="PprTyThing.html#showWithLoc"><span class="hs-identifier hs-var">showWithLoc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#pprDefinedAt"><span class="hs-identifier hs-var">pprDefinedAt</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621680079993"><span class="hs-identifier hs-var">tyThing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>                </span><span class="hs-special">(</span><a href="PprTyThing.html#pprTyThing"><span class="hs-identifier hs-var">pprTyThing</span></a><span> </span><a href="IfaceSyn.html#showToHeader"><span class="hs-identifier hs-var">showToHeader</span></a><span> </span><a href="#local-6989586621680079993"><span class="hs-identifier hs-var">tyThing</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | Pretty-prints the 'TyThing' header. For functions and data constructors</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- the function is equivalent to 'pprTyThing' but for type constructors</span><span>
</span><a name="line-105"></a><span class="hs-comment">-- and classes it prints only the header part of the declaration.</span><span>
</span><a name="line-106"></a><span class="hs-identifier">pprTyThingHdr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-107"></a><a name="pprTyThingHdr"><a href="PprTyThing.html#pprTyThingHdr"><span class="hs-identifier">pprTyThingHdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="PprTyThing.html#pprTyThing"><span class="hs-identifier hs-var">pprTyThing</span></a><span> </span><a href="IfaceSyn.html#showToHeader"><span class="hs-identifier hs-var">showToHeader</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | Pretty-prints a 'TyThing' in context: that is, if the entity</span><span>
</span><a name="line-110"></a><span class="hs-comment">-- is a data constructor, record selector, or class method, then</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- the entity's parent declaration is pretty-printed with irrelevant</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- parts omitted.</span><span>
</span><a name="line-113"></a><span class="hs-identifier">pprTyThingInContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="IfaceSyn.html#ShowSub"><span class="hs-identifier hs-type">ShowSub</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-114"></a><a name="pprTyThingInContext"><a href="PprTyThing.html#pprTyThingInContext"><span class="hs-identifier">pprTyThingInContext</span></a></a><span> </span><a name="local-6989586621680079994"><a href="#local-6989586621680079994"><span class="hs-identifier">show_sub</span></a></a><span> </span><a name="local-6989586621680079995"><a href="#local-6989586621680079995"><span class="hs-identifier">thing</span></a></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680079996"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621680079995"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-116"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>    </span><a name="local-6989586621680079996"><a href="#local-6989586621680079996"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621680079997"><a href="#local-6989586621680079997"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621680079998"><a href="#local-6989586621680079998"><span class="hs-identifier">thing</span></a></a><span>
</span><a name="line-118"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="HscTypes.html#tyThingParent_maybe"><span class="hs-identifier hs-var">tyThingParent_maybe</span></a><span> </span><a href="#local-6989586621680079998"><span class="hs-identifier hs-var">thing</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-119"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680079999"><a href="#local-6989586621680079999"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-120"></a><span>            </span><a href="#local-6989586621680079996"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a><span> </span><a href="#local-6989586621680079998"><span class="hs-identifier hs-var">thing</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680079997"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680079999"><span class="hs-identifier hs-var">parent</span></a><span>
</span><a name="line-121"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-122"></a><span>            </span><a href="PprTyThing.html#pprTyThing"><span class="hs-identifier hs-var">pprTyThing</span></a><span>
</span><a name="line-123"></a><span>              </span><span class="hs-special">(</span><a href="#local-6989586621680079994"><span class="hs-identifier hs-var">show_sub</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ss_how_much</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="IfaceSyn.html#ShowSome"><span class="hs-identifier hs-var">ShowSome</span></a><span> </span><a href="#local-6989586621680079997"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">(</span><a href="IfaceSyn.html#AltPpr"><span class="hs-identifier hs-var">AltPpr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>              </span><a href="#local-6989586621680079998"><span class="hs-identifier hs-var">thing</span></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Like 'pprTyThingInContext', but adds the defining location.</span><span>
</span><a name="line-127"></a><span class="hs-identifier">pprTyThingInContextLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-128"></a><a name="pprTyThingInContextLoc"><a href="PprTyThing.html#pprTyThingInContextLoc"><span class="hs-identifier">pprTyThingInContextLoc</span></a></a><span> </span><a name="local-6989586621680080000"><a href="#local-6989586621680080000"><span class="hs-identifier">tyThing</span></a></a><span>
</span><a name="line-129"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="PprTyThing.html#showWithLoc"><span class="hs-identifier hs-var">showWithLoc</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#pprDefinedAt"><span class="hs-identifier hs-var">pprDefinedAt</span></a><span> </span><span class="hs-special">(</span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621680080000"><span class="hs-identifier hs-var">tyThing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>                </span><span class="hs-special">(</span><a href="PprTyThing.html#pprTyThingInContext"><span class="hs-identifier hs-var">pprTyThingInContext</span></a><span> </span><a href="IfaceSyn.html#showToHeader"><span class="hs-identifier hs-var">showToHeader</span></a><span> </span><a href="#local-6989586621680080000"><span class="hs-identifier hs-var">tyThing</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-comment">-- | Pretty-prints a 'TyThing'.</span><span>
</span><a name="line-133"></a><span class="hs-identifier">pprTyThing</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="IfaceSyn.html#ShowSub"><span class="hs-identifier hs-type">ShowSub</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- We pretty-print 'TyThing' via 'IfaceDecl'</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- See Note [Pretty-printing TyThings]</span><span>
</span><a name="line-136"></a><a name="pprTyThing"><a href="PprTyThing.html#pprTyThing"><span class="hs-identifier">pprTyThing</span></a></a><span> </span><a name="local-6989586621680080001"><a href="#local-6989586621680080001"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621680080002"><a href="#local-6989586621680080002"><span class="hs-identifier">ty_thing</span></a></a><span>
</span><a name="line-137"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="IfaceSyn.html#pprIfaceDecl"><span class="hs-identifier hs-var">pprIfaceDecl</span></a><span> </span><a href="#local-6989586621680080003"><span class="hs-identifier hs-var">ss'</span></a><span> </span><span class="hs-special">(</span><a href="MkIface.html#tyThingToIfaceDecl"><span class="hs-identifier hs-var">tyThingToIfaceDecl</span></a><span> </span><a href="#local-6989586621680080002"><span class="hs-identifier hs-var">ty_thing</span></a><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>    </span><a name="local-6989586621680080003"><a href="#local-6989586621680080003"><span class="hs-identifier">ss'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">ss_how_much</span><span> </span><a href="#local-6989586621680080001"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-140"></a><span>      </span><a href="IfaceSyn.html#ShowHeader"><span class="hs-identifier hs-var">ShowHeader</span></a><span> </span><span class="hs-special">(</span><a href="IfaceSyn.html#AltPpr"><span class="hs-identifier hs-var">AltPpr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680080001"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ss_how_much</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="IfaceSyn.html#ShowHeader"><span class="hs-identifier hs-var">ShowHeader</span></a><span> </span><a href="#local-6989586621680080004"><span class="hs-identifier hs-var">ppr'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-141"></a><span>      </span><a href="IfaceSyn.html#ShowSome"><span class="hs-identifier hs-var">ShowSome</span></a><span> </span><a name="local-6989586621680080006"><a href="#local-6989586621680080006"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">(</span><a href="IfaceSyn.html#AltPpr"><span class="hs-identifier hs-var">AltPpr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680080001"><span class="hs-identifier hs-var">ss</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ss_how_much</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="IfaceSyn.html#ShowSome"><span class="hs-identifier hs-var">ShowSome</span></a><span> </span><a href="#local-6989586621680080006"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621680080004"><span class="hs-identifier hs-var">ppr'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-142"></a><span>      </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680080001"><span class="hs-identifier hs-var">ss</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>    </span><a name="local-6989586621680080004"><a href="#local-6989586621680080004"><span class="hs-identifier">ppr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="IfaceSyn.html#AltPpr"><span class="hs-identifier hs-var">AltPpr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621680080005"><span class="hs-identifier hs-var">ppr_bndr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Name.html#getName"><span class="hs-identifier hs-var">getName</span></a><span> </span><a href="#local-6989586621680080002"><span class="hs-identifier hs-var">ty_thing</span></a><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span>    </span><span class="hs-identifier">ppr_bndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#OccName"><span class="hs-identifier hs-type">OccName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>    </span><a name="local-6989586621680080005"><a href="#local-6989586621680080005"><span class="hs-identifier">ppr_bndr</span></a></a><span> </span><a name="local-6989586621680080007"><a href="#local-6989586621680080007"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-148"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Name.html#isBuiltInSyntax"><span class="hs-identifier hs-var">isBuiltInSyntax</span></a><span> </span><a href="#local-6989586621680080007"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-149"></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-150"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-151"></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Name.html#nameModule_maybe"><span class="hs-identifier hs-var">nameModule_maybe</span></a><span> </span><a href="#local-6989586621680080007"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-152"></a><span>             </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680080008"><a href="#local-6989586621680080008"><span class="hs-identifier">mod</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680080009"><a href="#local-6989586621680080009"><span class="hs-identifier">occ</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#getPprStyle"><span class="hs-identifier hs-var">getPprStyle</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680080010"><a href="#local-6989586621680080010"><span class="hs-identifier">sty</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-153"></a><span>               </span><a href="Name.html#pprModulePrefix"><span class="hs-identifier hs-var">pprModulePrefix</span></a><span> </span><a href="#local-6989586621680080010"><span class="hs-identifier hs-var">sty</span></a><span> </span><a href="#local-6989586621680080008"><span class="hs-identifier hs-var">mod</span></a><span> </span><a href="#local-6989586621680080009"><span class="hs-identifier hs-var">occ</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680080009"><span class="hs-identifier hs-var">occ</span></a><span>
</span><a name="line-154"></a><span>             </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier hs-var">name</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-155"></a><span>             </span><span class="hs-comment">-- Nothing is unexpected here; TyThings have External names</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-identifier">pprTypeForUser</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- The type is tidied</span><span>
</span><a name="line-159"></a><a name="pprTypeForUser"><a href="PprTyThing.html#pprTypeForUser"><span class="hs-identifier">pprTypeForUser</span></a></a><span> </span><a name="local-6989586621680080011"><a href="#local-6989586621680080011"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-160"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#pprSigmaType"><span class="hs-identifier hs-var">pprSigmaType</span></a><span> </span><a href="#local-6989586621680080012"><span class="hs-identifier hs-var">tidy_ty</span></a><span>
</span><a name="line-161"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680080012"><a href="#local-6989586621680080012"><span class="hs-identifier">tidy_ty</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tidyOpenType"><span class="hs-identifier hs-var">tidyOpenType</span></a><span> </span><a href="VarEnv.html#emptyTidyEnv"><span class="hs-identifier hs-var">emptyTidyEnv</span></a><span> </span><a href="#local-6989586621680080011"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-163"></a><span>     </span><span class="hs-comment">-- Often the types/kinds we print in ghci are fully generalised</span><span>
</span><a name="line-164"></a><span>     </span><span class="hs-comment">-- and have no free variables, but it turns out that we sometimes</span><span>
</span><a name="line-165"></a><span>     </span><span class="hs-comment">-- print un-generalised kinds (eg when doing :k T), so it's</span><span>
</span><a name="line-166"></a><span>     </span><span class="hs-comment">-- better to use tidyOpenType here</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-identifier">showWithLoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-169"></a><a name="showWithLoc"><a href="PprTyThing.html#showWithLoc"><span class="hs-identifier">showWithLoc</span></a></a><span> </span><a name="local-6989586621680080013"><a href="#local-6989586621680080013"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680080014"><a href="#local-6989586621680080014"><span class="hs-identifier">doc</span></a></a><span>
</span><a name="line-170"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><a href="#local-6989586621680080014"><span class="hs-identifier hs-var">doc</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#char"><span class="hs-identifier hs-var">char</span></a><span> </span><span class="hs-char">'\t'</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-6989586621680080015"><span class="hs-identifier hs-var">comment</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621680080013"><span class="hs-identifier hs-var">loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>                </span><span class="hs-comment">-- The tab tries to make them line up a bit</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-173"></a><span>    </span><a name="local-6989586621680080015"><a href="#local-6989586621680080015"><span class="hs-identifier">comment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;--&quot;</span><span>
</span><a name="line-174"></a></pre></body></html>