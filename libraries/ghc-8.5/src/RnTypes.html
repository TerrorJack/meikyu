<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

\section[RnSource]{Main pass of renamer}
-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">RnTypes</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- Type related stuff</span><span>
</span><a name="line-12"></a><span>        </span><a href="RnTypes.html#rnHsType"><span class="hs-identifier hs-var">rnHsType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnLHsType"><span class="hs-identifier hs-var">rnLHsType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnLHsTypes"><span class="hs-identifier hs-var">rnLHsTypes</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnContext"><span class="hs-identifier hs-var">rnContext</span></a><span class="hs-special">,</span><span>
</span><a name="line-13"></a><span>        </span><a href="RnTypes.html#rnHsKind"><span class="hs-identifier hs-var">rnHsKind</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnLHsKind"><span class="hs-identifier hs-var">rnLHsKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-14"></a><span>        </span><a href="RnTypes.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnHsWcType"><span class="hs-identifier hs-var">rnHsWcType</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span>        </span><a href="RnTypes.html#rnHsSigWcType"><span class="hs-identifier hs-var">rnHsSigWcType</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnHsSigWcTypeScoped"><span class="hs-identifier hs-var">rnHsSigWcTypeScoped</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>        </span><a href="RnTypes.html#rnLHsInstType"><span class="hs-identifier hs-var">rnLHsInstType</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>        </span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier hs-var">collectAnonWildCards</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="RnTypes.html#rnConDeclFields"><span class="hs-identifier hs-var">rnConDeclFields</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>        </span><a href="RnTypes.html#rnLTyVar"><span class="hs-identifier hs-var">rnLTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>        </span><span class="hs-comment">-- Precence related stuff</span><span>
</span><a name="line-22"></a><span>        </span><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier hs-var">mkOpAppRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#mkNegAppRn"><span class="hs-identifier hs-var">mkNegAppRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#mkOpFormRn"><span class="hs-identifier hs-var">mkOpFormRn</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#mkConOpPatRn"><span class="hs-identifier hs-var">mkConOpPatRn</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>        </span><a href="RnTypes.html#checkPrecMatch"><span class="hs-identifier hs-var">checkPrecMatch</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#checkSectionPrec"><span class="hs-identifier hs-var">checkSectionPrec</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>        </span><span class="hs-comment">-- Binding related stuff</span><span>
</span><a name="line-26"></a><span>        </span><a href="RnTypes.html#bindLHsTyVarBndr"><span class="hs-identifier hs-var">bindLHsTyVarBndr</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rnImplicitBndrs"><span class="hs-identifier hs-var">rnImplicitBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>        </span><a href="RnTypes.html#bindSigTyVarsFV"><span class="hs-identifier hs-var">bindSigTyVarsFV</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#bindHsQTyVars"><span class="hs-identifier hs-var">bindHsQTyVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#bindLRdrNames"><span class="hs-identifier hs-var">bindLRdrNames</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier hs-var">extractFilteredRdrTyVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#extractFilteredRdrTyVarsDups"><span class="hs-identifier hs-var">extractFilteredRdrTyVarsDups</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>        </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#extractHsTyRdrTyVarsKindVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVarsKindVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>        </span><a href="RnTypes.html#extractHsTyRdrTyVarsDups"><span class="hs-identifier hs-var">extractHsTyRdrTyVarsDups</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#extractHsTysRdrTyVars"><span class="hs-identifier hs-var">extractHsTysRdrTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>        </span><a href="RnTypes.html#extractHsTysRdrTyVarsDups"><span class="hs-identifier hs-var">extractHsTysRdrTyVarsDups</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier hs-var">rmDupsInRdrTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="RnTypes.html#extractRdrKindSigVars"><span class="hs-identifier hs-var">extractRdrKindSigVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#extractDataDefnKindVars"><span class="hs-identifier hs-var">extractDataDefnKindVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="RnTypes.html#extractHsTvBndrs"><span class="hs-identifier hs-var">extractHsTvBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="RnTypes.html#freeKiTyVarsAllVars"><span class="hs-identifier hs-var">freeKiTyVarsAllVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier hs-var">freeKiTyVarsKindVars</span></a><span class="hs-special">,</span><span> </span><a href="RnTypes.html#freeKiTyVarsTypeVars"><span class="hs-identifier hs-var">freeKiTyVarsTypeVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>        </span><a href="RnTypes.html#elemRdr"><span class="hs-identifier hs-var">elemRdr</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="RnSplice.html"><span class="hs-identifier">RnSplice</span></a><span class="hs-special">(</span><span> </span><a href="RnSplice.html#rnSpliceType"><span class="hs-identifier hs-var">rnSpliceType</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="DynFlags.html"><span class="hs-identifier">DynFlags</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="HsSyn.html"><span class="hs-identifier">HsSyn</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="RnHsDoc.html"><span class="hs-identifier">RnHsDoc</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="RnHsDoc.html#rnLHsDoc"><span class="hs-identifier hs-var">rnLHsDoc</span></a><span class="hs-special">,</span><span> </span><a href="RnHsDoc.html#rnMbLHsDoc"><span class="hs-identifier hs-var">rnMbLHsDoc</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="RnEnv.html"><span class="hs-identifier">RnEnv</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="RnUnbound.html"><span class="hs-identifier">RnUnbound</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="RnUnbound.html#perhapsForallMsg"><span class="hs-identifier hs-var">perhapsForallMsg</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><a href="RnUtils.html"><span class="hs-identifier">RnUtils</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="RnUtils.html#withHsDocContext"><span class="hs-identifier hs-var">withHsDocContext</span></a><span class="hs-special">,</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span>
</span><a name="line-48"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="RnUtils.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span class="hs-special">,</span><span> </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span>
</span><a name="line-49"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="RnUtils.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span class="hs-special">,</span><span> </span><a href="RnUtils.html#checkDupRdrNames"><span class="hs-identifier hs-var">checkDupRdrNames</span></a><span class="hs-special">,</span><span> </span><a href="RnUtils.html#checkShadowedRdrNames"><span class="hs-identifier hs-var">checkShadowedRdrNames</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><a href="RnFixity.html"><span class="hs-identifier">RnFixity</span></a><span>         </span><span class="hs-special">(</span><span> </span><a href="RnFixity.html#lookupFieldFixityRn"><span class="hs-identifier hs-var">lookupFieldFixityRn</span></a><span class="hs-special">,</span><span> </span><a href="RnFixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span>
</span><a name="line-51"></a><span>                        </span><span class="hs-special">,</span><span> </span><a href="RnFixity.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><a href="TcRnMonad.html"><span class="hs-identifier">TcRnMonad</span></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><a href="RdrName.html"><span class="hs-identifier">RdrName</span></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="TysPrim.html#funTyConName"><span class="hs-identifier hs-var">funTyConName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#starKindTyConName"><span class="hs-identifier hs-var">starKindTyConName</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#unicodeStarKindTyConName"><span class="hs-identifier hs-var">unicodeStarKindTyConName</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><a href="Name.html"><span class="hs-identifier">Name</span></a><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="SrcLoc.html"><span class="hs-identifier">SrcLoc</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="NameSet.html"><span class="hs-identifier">NameSet</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="FieldLabel.html"><span class="hs-identifier">FieldLabel</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="ListSetOps.html#deleteBys"><span class="hs-identifier hs-var">deleteBys</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#funTyFixity"><span class="hs-identifier hs-var">funTyFixity</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>                          </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#FixityDirection"><span class="hs-identifier hs-type">FixityDirection</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#LexicalFixity"><span class="hs-identifier hs-type">LexicalFixity</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../ghc-boot-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">LanguageExtensions</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LangExt</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.List.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span>          </span><span class="hs-special">(</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>      </span><span class="hs-special">(</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">{-
These type renamers are in a separate module, rather than in (say) RnSource,
to break several loop.

*********************************************************
*                                                       *
           HsSigWcType (i.e with wildcards)
*                                                       *
*********************************************************
-}</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-identifier">rnHsSigWcType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-88"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><a name="rnHsSigWcType"><a href="RnTypes.html#rnHsSigWcType"><span class="hs-identifier">rnHsSigWcType</span></a></a><span> </span><a name="local-6989586621680035632"><a href="#local-6989586621680035632"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680035633"><a href="#local-6989586621680035633"><span class="hs-identifier">sig_ty</span></a></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rn_hs_sig_wc_type"><span class="hs-identifier hs-var">rn_hs_sig_wc_type</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621680035632"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621680035633"><span class="hs-identifier hs-var">sig_ty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621680035634"><a href="#local-6989586621680035634"><span class="hs-identifier">sig_ty'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-91"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035634"><span class="hs-identifier hs-var">sig_ty'</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-identifier">rnHsSigWcTypeScoped</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-94"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035631"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035631"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- Used for</span><span>
</span><a name="line-97"></a><span class="hs-comment">--   - Signatures on binders in a RULE</span><span>
</span><a name="line-98"></a><span class="hs-comment">--   - Pattern type signatures</span><span>
</span><a name="line-99"></a><span class="hs-comment">-- Wildcards are allowed</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- type signatures on binders only allowed with ScopedTypeVariables</span><span>
</span><a name="line-101"></a><a name="rnHsSigWcTypeScoped"><a href="RnTypes.html#rnHsSigWcTypeScoped"><span class="hs-identifier">rnHsSigWcTypeScoped</span></a></a><span> </span><a name="local-6989586621680035635"><a href="#local-6989586621680035635"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621680035636"><a href="#local-6989586621680035636"><span class="hs-identifier">sig_ty</span></a></a><span> </span><a name="local-6989586621680035637"><a href="#local-6989586621680035637"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-102"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035638"><a href="#local-6989586621680035638"><span class="hs-identifier">ty_sig_okay</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#ScopedTypeVariables"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ScopedTypeVariables</span></a><span>
</span><a name="line-103"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#checkErr"><span class="hs-identifier hs-var">checkErr</span></a><span> </span><a href="#local-6989586621680035638"><span class="hs-identifier hs-var">ty_sig_okay</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#unexpectedTypeSigErr"><span class="hs-identifier hs-var">unexpectedTypeSigErr</span></a><span> </span><a href="#local-6989586621680035636"><span class="hs-identifier hs-var">sig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rn_hs_sig_wc_type"><span class="hs-identifier hs-var">rn_hs_sig_wc_type</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><a href="#local-6989586621680035635"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621680035636"><span class="hs-identifier hs-var">sig_ty</span></a><span> </span><a href="#local-6989586621680035637"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-105"></a><span>       </span><span class="hs-special">}</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-comment">-- True: for pattern type sigs and rules we /do/ want</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-comment">--       to bring those type variables into scope, even</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-comment">--       if there's a forall at the top which usually</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-comment">--       stops that happening</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-comment">-- e.g  \ (x :: forall a. a-&gt; b) -&gt; e</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-comment">-- Here we do bring 'b' into scope</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-identifier">rn_hs_sig_wc_type</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>   </span><span class="hs-comment">-- True &lt;=&gt; always bind any free tyvars of the</span><span>
</span><a name="line-114"></a><span>                            </span><span class="hs-comment">--          type, regardless of whether it has</span><span>
</span><a name="line-115"></a><span>                            </span><span class="hs-comment">--          a forall at the top</span><span>
</span><a name="line-116"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-117"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-118"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035630"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035630"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- rn_hs_sig_wc_type is used for source-language type signatures</span><span>
</span><a name="line-121"></a><a name="rn_hs_sig_wc_type"><a href="RnTypes.html#rn_hs_sig_wc_type"><span class="hs-identifier">rn_hs_sig_wc_type</span></a></a><span> </span><a name="local-6989586621680035639"><a href="#local-6989586621680035639"><span class="hs-identifier">always_bind_free_tvs</span></a></a><span> </span><a name="local-6989586621680035640"><a href="#local-6989586621680035640"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-122"></a><span>                  </span><span class="hs-special">(</span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035641"><a href="#local-6989586621680035641"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>                  </span><a name="local-6989586621680035642"><a href="#local-6989586621680035642"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035643"><a href="#local-6989586621680035643"><span class="hs-identifier">free_vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extractFilteredRdrTyVarsDups"><span class="hs-identifier hs-var">extractFilteredRdrTyVarsDups</span></a><span> </span><a href="#local-6989586621680035641"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-125"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035644"><a href="#local-6989586621680035644"><span class="hs-identifier">tv_rdrs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035645"><a href="#local-6989586621680035645"><span class="hs-identifier">nwc_rdrs'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#partition_nwcs"><span class="hs-identifier hs-var">partition_nwcs</span></a><span> </span><a href="#local-6989586621680035643"><span class="hs-identifier hs-var">free_vars</span></a><span>
</span><a name="line-126"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035646"><a href="#local-6989586621680035646"><span class="hs-identifier">nwc_rdrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621680035645"><span class="hs-identifier hs-var">nwc_rdrs'</span></a><span>
</span><a name="line-127"></a><span>             </span><a name="local-6989586621680035647"><a href="#local-6989586621680035647"><span class="hs-identifier">bind_free_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035639"><span class="hs-identifier hs-var">always_bind_free_tvs</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#isLHsForAllTy"><span class="hs-identifier hs-var">isLHsForAllTy</span></a><span> </span><a href="#local-6989586621680035641"><span class="hs-identifier hs-var">hs_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnImplicitBndrs"><span class="hs-identifier hs-var">rnImplicitBndrs</span></a><span> </span><a href="#local-6989586621680035647"><span class="hs-identifier hs-var">bind_free_tvs</span></a><span> </span><a href="#local-6989586621680035640"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621680035644"><span class="hs-identifier hs-var">tv_rdrs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680035648"><a href="#local-6989586621680035648"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035649"><a href="#local-6989586621680035649"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035650"><a href="#local-6989586621680035650"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035651"><a href="#local-6989586621680035651"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnWcBody"><span class="hs-identifier hs-var">rnWcBody</span></a><span> </span><a href="#local-6989586621680035640"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621680035646"><span class="hs-identifier hs-var">nwc_rdrs</span></a><span> </span><a href="#local-6989586621680035641"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-130"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035652"><a href="#local-6989586621680035652"><span class="hs-identifier">sig_ty'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_wcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035649"><span class="hs-identifier hs-var">wcs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035653"><span class="hs-identifier hs-var">ib_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-131"></a><span>             </span><a name="local-6989586621680035653"><a href="#local-6989586621680035653"><span class="hs-identifier">ib_ty'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#mk_implicit_bndrs"><span class="hs-identifier hs-var">mk_implicit_bndrs</span></a><span> </span><a href="#local-6989586621680035648"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621680035650"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><a href="#local-6989586621680035651"><span class="hs-identifier hs-var">fvs1</span></a><span>
</span><a name="line-132"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035654"><a href="#local-6989586621680035654"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035655"><a href="#local-6989586621680035655"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680035642"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621680035652"><span class="hs-identifier hs-var">sig_ty'</span></a><span>
</span><a name="line-133"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035654"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035651"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035655"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-identifier">rnHsWcType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsWcType"><span class="hs-identifier hs-type">LHsWcType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><a name="rnHsWcType"><a href="RnTypes.html#rnHsWcType"><span class="hs-identifier">rnHsWcType</span></a></a><span> </span><a name="local-6989586621680035656"><a href="#local-6989586621680035656"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035657"><a href="#local-6989586621680035657"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-137"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035658"><a href="#local-6989586621680035658"><span class="hs-identifier">free_vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier hs-var">extractFilteredRdrTyVars</span></a><span> </span><a href="#local-6989586621680035657"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-138"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680035659"><a href="#local-6989586621680035659"><span class="hs-identifier">nwc_rdrs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#partition_nwcs"><span class="hs-identifier hs-var">partition_nwcs</span></a><span> </span><a href="#local-6989586621680035658"><span class="hs-identifier hs-var">free_vars</span></a><span>
</span><a name="line-139"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035660"><a href="#local-6989586621680035660"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035661"><a href="#local-6989586621680035661"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035662"><a href="#local-6989586621680035662"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnWcBody"><span class="hs-identifier hs-var">rnWcBody</span></a><span> </span><a href="#local-6989586621680035656"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621680035659"><span class="hs-identifier hs-var">nwc_rdrs</span></a><span> </span><a href="#local-6989586621680035657"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-140"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035663"><a href="#local-6989586621680035663"><span class="hs-identifier">sig_ty'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsWC"><span class="hs-identifier hs-var">HsWC</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hswc_wcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035660"><span class="hs-identifier hs-var">wcs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hswc_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035661"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-141"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035663"><span class="hs-identifier hs-var">sig_ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035662"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-identifier">rnWcBody</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-144"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><a name="rnWcBody"><a href="RnTypes.html#rnWcBody"><span class="hs-identifier">rnWcBody</span></a></a><span> </span><a name="local-6989586621680035664"><a href="#local-6989586621680035664"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621680035665"><a href="#local-6989586621680035665"><span class="hs-identifier">nwc_rdrs</span></a></a><span> </span><a name="local-6989586621680035666"><a href="#local-6989586621680035666"><span class="hs-identifier">hs_ty</span></a></a><span>
</span><a name="line-146"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035703"><a href="#local-6989586621680035703"><span class="hs-identifier">nwcs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="RnUtils.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span> </span><a href="#local-6989586621680035665"><span class="hs-identifier hs-var">nwc_rdrs</span></a><span>
</span><a name="line-147"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035704"><a href="#local-6989586621680035704"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span>
</span><a name="line-148"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_what</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>
</span><a name="line-149"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><a href="#local-6989586621680035703"><span class="hs-identifier hs-var">nwcs</span></a><span>
</span><a name="line-150"></a><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035664"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-151"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035705"><a href="#local-6989586621680035705"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035706"><a href="#local-6989586621680035706"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621680035703"><span class="hs-identifier hs-var">nwcs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-152"></a><span>                          </span><a href="#local-6989586621680035667"><span class="hs-identifier hs-var">rn_lty</span></a><span> </span><a href="#local-6989586621680035704"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035666"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-153"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035707"><a href="#local-6989586621680035707"><span class="hs-identifier">awcs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier hs-var">collectAnonWildCards</span></a><span> </span><a href="#local-6989586621680035705"><span class="hs-identifier hs-var">hs_ty'</span></a><span>
</span><a name="line-154"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035703"><span class="hs-identifier hs-var">nwcs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680035707"><span class="hs-identifier hs-var">awcs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035705"><span class="hs-identifier hs-var">hs_ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035706"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-156"></a><span>    </span><a name="local-6989586621680035667"><a href="#local-6989586621680035667"><span class="hs-identifier">rn_lty</span></a></a><span> </span><a name="local-6989586621680035670"><a href="#local-6989586621680035670"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035671"><a href="#local-6989586621680035671"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680035672"><a href="#local-6989586621680035672"><span class="hs-identifier">hs_ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621680035671"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-158"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035673"><a href="#local-6989586621680035673"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035674"><a href="#local-6989586621680035674"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680035668"><span class="hs-identifier hs-var">rn_ty</span></a><span> </span><a href="#local-6989586621680035670"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035672"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-159"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035671"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035673"><span class="hs-identifier hs-var">hs_ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035674"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span>    </span><span class="hs-identifier">rn_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-comment">-- A lot of faff just to allow the extra-constraints wildcard to appear</span><span>
</span><a name="line-163"></a><span>    </span><a name="local-6989586621680035668"><a href="#local-6989586621680035668"><span class="hs-identifier">rn_ty</span></a></a><span> </span><a name="local-6989586621680035675"><a href="#local-6989586621680035675"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035676"><a href="#local-6989586621680035676"><span class="hs-identifier">hs_ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035677"><a href="#local-6989586621680035677"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035678"><a href="#local-6989586621680035678"><span class="hs-identifier">hs_body</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621680035675"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RnTypes.html#inTypeDoc"><span class="hs-identifier hs-var">inTypeDoc</span></a><span> </span><a href="#local-6989586621680035676"><span class="hs-identifier hs-var">hs_ty</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-6989586621680035677"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680035679"><a href="#local-6989586621680035679"><span class="hs-identifier">tvs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-165"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035680"><a href="#local-6989586621680035680"><span class="hs-identifier">hs_body'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035681"><a href="#local-6989586621680035681"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680035667"><span class="hs-identifier hs-var">rn_lty</span></a><span> </span><a href="#local-6989586621680035675"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035678"><span class="hs-identifier hs-var">hs_body</span></a><span>
</span><a name="line-166"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035679"><span class="hs-identifier hs-var">tvs'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035680"><span class="hs-identifier hs-var">hs_body'</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035681"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span>    </span><span class="hs-identifier">rn_ty</span><span> </span><a name="local-6989586621680035682"><a href="#local-6989586621680035682"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035683"><a href="#local-6989586621680035683"><span class="hs-identifier">cx</span></a></a><span> </span><a name="local-6989586621680035684"><a href="#local-6989586621680035684"><span class="hs-identifier">hs_ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035685"><a href="#local-6989586621680035685"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680035686"><a href="#local-6989586621680035686"><span class="hs-identifier">hs_ctxt1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035687"><a href="#local-6989586621680035687"><span class="hs-identifier">hs_ctxt_last</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#snocView"><span class="hs-identifier hs-var">snocView</span></a><span> </span><a href="#local-6989586621680035684"><span class="hs-identifier hs-var">hs_ctxt</span></a><span>
</span><a name="line-170"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035688"><a href="#local-6989586621680035688"><span class="hs-identifier">lx</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a name="local-6989586621680035689"><a href="#local-6989586621680035689"><span class="hs-identifier">wc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="HsTypes.html#ignoreParens"><span class="hs-identifier hs-var">ignoreParens</span></a><span> </span><a href="#local-6989586621680035687"><span class="hs-identifier hs-var">hs_ctxt_last</span></a><span>
</span><a name="line-171"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035690"><a href="#local-6989586621680035690"><span class="hs-identifier">hs_ctxt1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035691"><a href="#local-6989586621680035691"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035669"><span class="hs-identifier hs-var">rn_top_constraint</span></a><span> </span><a href="#local-6989586621680035682"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035686"><span class="hs-identifier hs-var">hs_ctxt1</span></a><span>
</span><a name="line-172"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035692"><a href="#local-6989586621680035692"><span class="hs-identifier">wc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621680035688"><span class="hs-identifier hs-var">lx</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-173"></a><span>                    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkExtraConstraintWildCard"><span class="hs-identifier hs-var">checkExtraConstraintWildCard</span></a><span> </span><a href="#local-6989586621680035682"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035689"><span class="hs-identifier hs-var">wc</span></a><span>
</span><a name="line-174"></a><span>                       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnAnonWildCard"><span class="hs-identifier hs-var">rnAnonWildCard</span></a><span> </span><a href="#local-6989586621680035689"><span class="hs-identifier hs-var">wc</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-175"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035693"><a href="#local-6989586621680035693"><span class="hs-identifier">hs_ctxt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035690"><span class="hs-identifier hs-var">hs_ctxt1'</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035688"><span class="hs-identifier hs-var">lx</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a href="#local-6989586621680035692"><span class="hs-identifier hs-var">wc'</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-176"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035694"><a href="#local-6989586621680035694"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035695"><a href="#local-6989586621680035695"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035682"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035685"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-177"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035683"><span class="hs-identifier hs-var">cx</span></a><span> </span><a href="#local-6989586621680035693"><span class="hs-identifier hs-var">hs_ctxt'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035694"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-178"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035691"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035695"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-181"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035696"><a href="#local-6989586621680035696"><span class="hs-identifier">hs_ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035697"><a href="#local-6989586621680035697"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035669"><span class="hs-identifier hs-var">rn_top_constraint</span></a><span> </span><a href="#local-6989586621680035682"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035684"><span class="hs-identifier hs-var">hs_ctxt</span></a><span>
</span><a name="line-182"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035698"><a href="#local-6989586621680035698"><span class="hs-identifier">hs_ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035699"><a href="#local-6989586621680035699"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035682"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035685"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-183"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035683"><span class="hs-identifier hs-var">cx</span></a><span> </span><a href="#local-6989586621680035696"><span class="hs-identifier hs-var">hs_ctxt'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035698"><span class="hs-identifier hs-var">hs_ty'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-184"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035697"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035699"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span>    </span><span class="hs-identifier">rn_ty</span><span> </span><a name="local-6989586621680035700"><a href="#local-6989586621680035700"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035701"><a href="#local-6989586621680035701"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span> </span><a href="#local-6989586621680035700"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035701"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span>    </span><a name="local-6989586621680035669"><a href="#local-6989586621680035669"><span class="hs-identifier">rn_top_constraint</span></a></a><span> </span><a name="local-6989586621680035702"><a href="#local-6989586621680035702"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035702"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-identifier">checkExtraConstraintWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-192"></a><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- Rename the extra-constraint spot in a type signature</span><span>
</span><a name="line-194"></a><span class="hs-comment">--    (blah, _) =&gt; type</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- Check that extra-constraints are allowed at all, and</span><span>
</span><a name="line-196"></a><span class="hs-comment">-- if so that it's an anonymous wildcard</span><span>
</span><a name="line-197"></a><a name="checkExtraConstraintWildCard"><a href="RnTypes.html#checkExtraConstraintWildCard"><span class="hs-identifier">checkExtraConstraintWildCard</span></a></a><span> </span><a name="local-6989586621680035708"><a href="#local-6989586621680035708"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035709"><a href="#local-6989586621680035709"><span class="hs-identifier">wc</span></a></a><span>
</span><a name="line-198"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#checkWildCard"><span class="hs-identifier hs-var">checkWildCard</span></a><span> </span><a href="#local-6989586621680035708"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035710"><span class="hs-identifier hs-var">mb_bad</span></a><span>
</span><a name="line-199"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-200"></a><span>    </span><a name="local-6989586621680035710"><a href="#local-6989586621680035710"><span class="hs-identifier">mb_bad</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extraConstraintWildCardsAllowed"><span class="hs-identifier hs-var">extraConstraintWildCardsAllowed</span></a><span> </span><a href="#local-6989586621680035708"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Extra-constraint wildcard&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035709"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>                   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;not allowed&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-204"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-identifier">extraConstraintWildCardsAllowed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-207"></a><a name="extraConstraintWildCardsAllowed"><a href="RnTypes.html#extraConstraintWildCardsAllowed"><span class="hs-identifier">extraConstraintWildCardsAllowed</span></a></a><span> </span><a name="local-6989586621680035711"><a href="#local-6989586621680035711"><span class="hs-identifier">env</span></a></a><span>
</span><a name="line-208"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621680035711"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-209"></a><span>      </span><a href="RnUtils.html#TypeSigCtx"><span class="hs-identifier hs-var">TypeSigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-210"></a><span>      </span><a href="RnUtils.html#ExprWithTySigCtx"><span class="hs-identifier hs-var">ExprWithTySigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-211"></a><span>      </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- | Finds free type and kind variables in a type,</span><span>
</span><a name="line-214"></a><span class="hs-comment">--     without duplicates, and</span><span>
</span><a name="line-215"></a><span class="hs-comment">--     without variables that are already in scope in LocalRdrEnv</span><span>
</span><a name="line-216"></a><span class="hs-comment">--   NB: this includes named wildcards, which look like perfectly</span><span>
</span><a name="line-217"></a><span class="hs-comment">--       ordinary type variables at this point</span><span>
</span><a name="line-218"></a><span class="hs-identifier">extractFilteredRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsNoDups"><span class="hs-identifier hs-type">FreeKiTyVarsNoDups</span></a><span>
</span><a name="line-219"></a><a name="extractFilteredRdrTyVars"><a href="RnTypes.html#extractFilteredRdrTyVars"><span class="hs-identifier">extractFilteredRdrTyVars</span></a></a><span> </span><a name="local-6989586621680035712"><a href="#local-6989586621680035712"><span class="hs-identifier">hs_ty</span></a></a><span>
</span><a name="line-220"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035713"><a href="#local-6989586621680035713"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-221"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#filterInScope"><span class="hs-identifier hs-var">filterInScope</span></a><span> </span><a href="#local-6989586621680035713"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span> </span><a href="#local-6989586621680035712"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- | Finds free type and kind variables in a type,</span><span>
</span><a name="line-224"></a><span class="hs-comment">--     with duplicates, but</span><span>
</span><a name="line-225"></a><span class="hs-comment">--     without variables that are already in scope in LocalRdrEnv</span><span>
</span><a name="line-226"></a><span class="hs-comment">--   NB: this includes named wildcards, which look like perfectly</span><span>
</span><a name="line-227"></a><span class="hs-comment">--       ordinary type variables at this point</span><span>
</span><a name="line-228"></a><span class="hs-identifier">extractFilteredRdrTyVarsDups</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-229"></a><a name="extractFilteredRdrTyVarsDups"><a href="RnTypes.html#extractFilteredRdrTyVarsDups"><span class="hs-identifier">extractFilteredRdrTyVarsDups</span></a></a><span> </span><a name="local-6989586621680035714"><a href="#local-6989586621680035714"><span class="hs-identifier">hs_ty</span></a></a><span>
</span><a name="line-230"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035715"><a href="#local-6989586621680035715"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-231"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#filterInScope"><span class="hs-identifier hs-var">filterInScope</span></a><span> </span><a href="#local-6989586621680035715"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVarsDups"><span class="hs-identifier hs-var">extractHsTyRdrTyVarsDups</span></a><span> </span><a href="#local-6989586621680035714"><span class="hs-identifier hs-var">hs_ty</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- | When the NamedWildCards extension is enabled, partition_nwcs</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- removes type variables that start with an underscore from the</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- FreeKiTyVars in the argument and returns them in a separate list.</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- When the extension is disabled, the function returns the argument</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- and empty list.  See Note [Renaming named wild cards]</span><span>
</span><a name="line-238"></a><span class="hs-identifier">partition_nwcs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><a name="partition_nwcs"><a href="RnTypes.html#partition_nwcs"><span class="hs-identifier">partition_nwcs</span></a></a><span> </span><a name="local-6989586621680035716"><a href="#local-6989586621680035716"><span class="hs-identifier">free_vars</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fktv_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035717"><a href="#local-6989586621680035717"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035720"><a href="#local-6989586621680035720"><span class="hs-identifier">wildcards_enabled</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#xopt"><span class="hs-identifier hs-var">xopt</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#NamedWildCards"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">NamedWildCards</span></a><span class="hs-special">)</span><span> </span><a href="DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a><span>
</span><a name="line-241"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035721"><a href="#local-6989586621680035721"><span class="hs-identifier">nwcs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035722"><a href="#local-6989586621680035722"><span class="hs-identifier">no_nwcs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680035720"><span class="hs-identifier hs-var">wildcards_enabled</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="#local-6989586621680035718"><span class="hs-identifier hs-var">is_wildcard</span></a><span> </span><a href="#local-6989586621680035717"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-242"></a><span>                             </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035717"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>             </span><a name="local-6989586621680035723"><a href="#local-6989586621680035723"><span class="hs-identifier">free_vars'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035716"><span class="hs-identifier hs-var">free_vars</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fktv_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035722"><span class="hs-identifier hs-var">no_nwcs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-244"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035723"><span class="hs-identifier hs-var">free_vars'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035721"><span class="hs-identifier hs-var">nwcs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-245"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-246"></a><span>     </span><span class="hs-identifier">is_wildcard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-247"></a><span>     </span><a name="local-6989586621680035718"><a href="#local-6989586621680035718"><span class="hs-identifier">is_wildcard</span></a></a><span> </span><a name="local-6989586621680035719"><a href="#local-6989586621680035719"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="OccName.html#startsWithUnderscore"><span class="hs-identifier hs-var">startsWithUnderscore</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680035719"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">{- Note [Renaming named wild cards]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Identifiers starting with an underscore are always parsed as type variables.
It is only here in the renamer that we give the special treatment.
See Note [The wildcard story for types] in HsTypes.

It's easy!  When we collect the implicitly bound type variables, ready
to bring them into scope, and NamedWildCards is on, we partition the
variables into the ones that start with an underscore (the named
wildcards) and the rest. Then we just add them to the hswc_wcs field
of the HsWildCardBndrs structure, and we are done.


*********************************************************
*                                                       *
           HsSigtype (i.e. no wildcards)
*                                                       *
****************************************************** -}</span><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-identifier">rnHsSigType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-269"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- Used for source-language type signatures</span><span>
</span><a name="line-271"></a><span class="hs-comment">-- that cannot have wildcards</span><span>
</span><a name="line-272"></a><a name="rnHsSigType"><a href="RnTypes.html#rnHsSigType"><span class="hs-identifier">rnHsSigType</span></a></a><span> </span><a name="local-6989586621680035724"><a href="#local-6989586621680035724"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035725"><a href="#local-6989586621680035725"><span class="hs-identifier">hs_ty</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;rnHsSigType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035725"><span class="hs-identifier hs-var">hs_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035726"><a href="#local-6989586621680035726"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extractFilteredRdrTyVarsDups"><span class="hs-identifier hs-var">extractFilteredRdrTyVarsDups</span></a><span> </span><a href="#local-6989586621680035725"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-275"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#rnImplicitBndrs"><span class="hs-identifier hs-var">rnImplicitBndrs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#isLHsForAllTy"><span class="hs-identifier hs-var">isLHsForAllTy</span></a><span> </span><a href="#local-6989586621680035725"><span class="hs-identifier hs-var">hs_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035724"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621680035726"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680035727"><a href="#local-6989586621680035727"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-276"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035728"><a href="#local-6989586621680035728"><span class="hs-identifier">body'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035729"><a href="#local-6989586621680035729"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsType"><span class="hs-identifier hs-var">rnLHsType</span></a><span> </span><a href="#local-6989586621680035724"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621680035725"><span class="hs-identifier hs-var">hs_ty</span></a><span>
</span><a name="line-277"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="RnTypes.html#mk_implicit_bndrs"><span class="hs-identifier hs-var">mk_implicit_bndrs</span></a><span> </span><a href="#local-6989586621680035727"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621680035728"><span class="hs-identifier hs-var">body'</span></a><span> </span><a href="#local-6989586621680035729"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035729"><span class="hs-identifier hs-var">fvs</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-identifier">rnImplicitBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>    </span><span class="hs-comment">-- True &lt;=&gt; bring into scope any free type variables</span><span>
</span><a name="line-280"></a><span>                           </span><span class="hs-comment">-- E.g.  f :: forall a. a-&gt;b</span><span>
</span><a name="line-281"></a><span>                           </span><span class="hs-comment">--  we do not want to bring 'b' into scope, hence False</span><span>
</span><a name="line-282"></a><span>                           </span><span class="hs-comment">-- But   f :: a -&gt; b</span><span>
</span><a name="line-283"></a><span>                           </span><span class="hs-comment">--  we want to bring both 'a' and 'b' into scope</span><span>
</span><a name="line-284"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-285"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-286"></a><span>                                   </span><span class="hs-comment">-- Free vars of hs_ty (excluding wildcards)</span><span>
</span><a name="line-287"></a><span>                                   </span><span class="hs-comment">-- May have duplicates, which is</span><span>
</span><a name="line-288"></a><span>                                   </span><span class="hs-comment">-- checked here</span><span>
</span><a name="line-289"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035629"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035629"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-291"></a><a name="rnImplicitBndrs"><a href="RnTypes.html#rnImplicitBndrs"><span class="hs-identifier">rnImplicitBndrs</span></a></a><span> </span><a name="local-6989586621680035730"><a href="#local-6989586621680035730"><span class="hs-identifier">bind_free_tvs</span></a></a><span> </span><a name="local-6989586621680035731"><a href="#local-6989586621680035731"><span class="hs-identifier">doc</span></a></a><span>
</span><a name="line-292"></a><span>                </span><a name="local-6989586621680035732"><a href="#local-6989586621680035732"><span class="hs-identifier">fvs_with_dups</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fktv_kis</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035733"><a href="#local-6989586621680035733"><span class="hs-identifier">kvs_with_dups</span></a></a><span>
</span><a name="line-293"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fktv_tys</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035734"><a href="#local-6989586621680035734"><span class="hs-identifier">tvs_with_dups</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span>                </span><a name="local-6989586621680035735"><a href="#local-6989586621680035735"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-295"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680035736"><a href="#local-6989586621680035736"><span class="hs-identifier">kvs</span></a></a><span> </span><a name="local-6989586621680035737"><a href="#local-6989586621680035737"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier hs-var">rmDupsInRdrTyVars</span></a><span> </span><a href="#local-6989586621680035732"><span class="hs-identifier hs-var">fvs_with_dups</span></a><span>
</span><a name="line-296"></a><span>             </span><a name="local-6989586621680035738"><a href="#local-6989586621680035738"><span class="hs-identifier">real_tvs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680035730"><span class="hs-identifier hs-var">bind_free_tvs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035737"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-297"></a><span>                      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-298"></a><span>             </span><span class="hs-comment">-- We always bind over free /kind/ variables.</span><span>
</span><a name="line-299"></a><span>             </span><span class="hs-comment">-- Bind free /type/ variables only if there is no</span><span>
</span><a name="line-300"></a><span>             </span><span class="hs-comment">-- explicit forall.  E.g.</span><span>
</span><a name="line-301"></a><span>             </span><span class="hs-comment">--    f :: Proxy (a :: k) -&gt; b</span><span>
</span><a name="line-302"></a><span>             </span><span class="hs-comment">--         Quantify over {k} and {a,b}</span><span>
</span><a name="line-303"></a><span>             </span><span class="hs-comment">--    g :: forall a. Proxy (a :: k) -&gt; b</span><span>
</span><a name="line-304"></a><span>             </span><span class="hs-comment">--         Quantify over {k} and {}</span><span>
</span><a name="line-305"></a><span>             </span><span class="hs-comment">-- Note that we always do the implicit kind-quantification</span><span>
</span><a name="line-306"></a><span>             </span><span class="hs-comment">-- but, rather arbitrarily, we switch off the type-quantification</span><span>
</span><a name="line-307"></a><span>             </span><span class="hs-comment">-- if there is an explicit forall</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;rnImplicitBndrs&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035736"><span class="hs-identifier hs-var">kvs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035737"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035738"><span class="hs-identifier hs-var">real_tvs</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035739"><a href="#local-6989586621680035739"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getSrcSpanM"><span class="hs-identifier hs-var">getSrcSpanM</span></a><span>
</span><a name="line-312"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035740"><a href="#local-6989586621680035740"><span class="hs-identifier">vars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnUtils.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035739"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035736"><span class="hs-identifier hs-var">kvs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680035738"><span class="hs-identifier hs-var">real_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkBadKindBndrs"><span class="hs-identifier hs-var">checkBadKindBndrs</span></a><span> </span><a href="#local-6989586621680035731"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621680035736"><span class="hs-identifier hs-var">kvs</span></a><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;checkMixedVars2&quot;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-317"></a><span>           </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kvs_with_dups&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035733"><span class="hs-identifier hs-var">kvs_with_dups</span></a><span>
</span><a name="line-318"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;tvs_with_dups&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035734"><span class="hs-identifier hs-var">tvs_with_dups</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-319"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkMixedVars"><span class="hs-identifier hs-var">checkMixedVars</span></a><span> </span><a href="#local-6989586621680035733"><span class="hs-identifier hs-var">kvs_with_dups</span></a><span> </span><a href="#local-6989586621680035734"><span class="hs-identifier hs-var">tvs_with_dups</span></a><span>
</span><a name="line-320"></a><span>           </span><span class="hs-comment">-- E.g.  Either (Proxy (a :: k)) k</span><span>
</span><a name="line-321"></a><span>           </span><span class="hs-comment">-- Here 'k' is used at kind level and type level</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621680035740"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-324"></a><span>         </span><a href="#local-6989586621680035735"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621680035740"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-identifier">rnLHsInstType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsSigType"><span class="hs-identifier hs-type">LHsSigType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- Rename the type in an instance or standalone deriving decl</span><span>
</span><a name="line-328"></a><span class="hs-comment">-- The 'doc_str' is &quot;an instance declaration&quot; or &quot;a VECTORISE pragma&quot;</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- Do not try to decompose the inst_ty in case it is malformed</span><span>
</span><a name="line-330"></a><a name="rnLHsInstType"><a href="RnTypes.html#rnLHsInstType"><span class="hs-identifier">rnLHsInstType</span></a></a><span> </span><a name="local-6989586621680035741"><a href="#local-6989586621680035741"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680035742"><a href="#local-6989586621680035742"><span class="hs-identifier">inst_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnHsSigType"><span class="hs-identifier hs-var">rnHsSigType</span></a><span> </span><span class="hs-special">(</span><a href="RnUtils.html#GenericCtx"><span class="hs-identifier hs-var">GenericCtx</span></a><span> </span><a href="#local-6989586621680035741"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035742"><span class="hs-identifier hs-var">inst_ty</span></a><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span class="hs-identifier">mk_implicit_bndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- implicitly bound</span><span>
</span><a name="line-333"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680035628"><span class="hs-identifier hs-type">a</span></a><span>           </span><span class="hs-comment">-- payload</span><span>
</span><a name="line-334"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span>    </span><span class="hs-comment">-- FreeVars of payload</span><span>
</span><a name="line-335"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsImplicitBndrs"><span class="hs-identifier hs-type">HsImplicitBndrs</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><a href="#local-6989586621680035628"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-336"></a><a name="mk_implicit_bndrs"><a href="RnTypes.html#mk_implicit_bndrs"><span class="hs-identifier">mk_implicit_bndrs</span></a></a><span> </span><a name="local-6989586621680035743"><a href="#local-6989586621680035743"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621680035744"><a href="#local-6989586621680035744"><span class="hs-identifier">body</span></a></a><span> </span><a name="local-6989586621680035745"><a href="#local-6989586621680035745"><span class="hs-identifier">fvs</span></a></a><span>
</span><a name="line-337"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#HsIB"><span class="hs-identifier hs-var">HsIB</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsib_vars</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035743"><span class="hs-identifier hs-var">vars</span></a><span>
</span><a name="line-338"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035744"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-339"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsib_closed</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#nameSetAll"><span class="hs-identifier hs-var">nameSetAll</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Name.html#isTyVarName"><span class="hs-identifier hs-var">isTyVarName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035743"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#delFVs"><span class="hs-identifier hs-var">delFVs</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035745"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-340"></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span class="hs-comment">{- ******************************************************
*                                                       *
           LHsType and HsType
*                                                       *
****************************************************** -}</span><span>
</span><a name="line-348"></a><span>
</span><a name="line-349"></a><span class="hs-comment">{-
rnHsType is here because we call it from loadInstDecl, and I didn't
want a gratuitous knot.

Note [Context quantification]
-----------------------------
Variables in type signatures are implicitly quantified
when (1) they are in a type signature not beginning
with &quot;forall&quot; or (2) in any qualified type T =&gt; R.
We are phasing out (2) since it leads to inconsistencies
(Trac #4426):

data A = A (a -&gt; a)           is an error
data A = A (Eq a =&gt; a -&gt; a)   binds &quot;a&quot;
data A = A (Eq a =&gt; a -&gt; b)   binds &quot;a&quot; and &quot;b&quot;
data A = A (() =&gt; a -&gt; b)     binds &quot;a&quot; and &quot;b&quot;
f :: forall a. a -&gt; b         is an error
f :: forall a. () =&gt; a -&gt; b   is an error
f :: forall a. a -&gt; (() =&gt; b) binds &quot;a&quot; and &quot;b&quot;

This situation is now considered to be an error. See rnHsTyKi for case
HsForAllTy Qualified.

Note [Dealing with *]
~~~~~~~~~~~~~~~~~~~~~
As a legacy from the days when types and kinds were different, we use
the type * to mean what we now call GHC.Types.Type. The problem is that
* should associate just like an identifier, *not* a symbol.
Running example: the user has written

  T (Int, Bool) b + c * d

At this point, we have a bunch of stretches of types

  [[T, (Int, Bool), b], [c], [d]]

these are the [[LHsType Name]] and a bunch of operators

  [GHC.TypeLits.+, GHC.Types.*]

Note that the * is GHC.Types.*. So, we want to rearrange to have

  [[T, (Int, Bool), b], [c, *, d]]

and

  [GHC.TypeLits.+]

as our lists. We can then do normal fixity resolution on these. The fixities
must come along for the ride just so that the list stays in sync with the
operators.

Note [QualTy in kinds]
~~~~~~~~~~~~~~~~~~~~~~
I was wondering whether QualTy could occur only at TypeLevel.  But no,
we can have a qualified type in a kind too. Here is an example:

  type family F a where
    F Bool = Nat
    F Nat  = Type

  type family G a where
    G Type = Type -&gt; Type
    G ()   = Nat

  data X :: forall k1 k2. (F k1 ~ G k2) =&gt; k1 -&gt; k2 -&gt; Type where
    MkX :: X 'True '()

See that k1 becomes Bool and k2 becomes (), so the equality is
satisfied. If I write MkX :: X 'True 'False, compilation fails with a
suitable message:

  MkX :: X 'True '()
    &#8226; Couldn't match kind &#8216;G Bool&#8217; with &#8216;Nat&#8217;
      Expected kind: G Bool
        Actual kind: F Bool

However: in a kind, the constraints in the QualTy must all be
equalities; or at least, any kinds with a class constraint are
uninhabited.
-}</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-keyword">data</span><span> </span><a name="RnTyKiEnv"><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier">RnTyKiEnv</span></a></a><span>
</span><a name="line-432"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="RTKE"><a href="RnTypes.html#RTKE"><span class="hs-identifier">RTKE</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="rtke_ctxt"><a href="RnTypes.html#rtke_ctxt"><span class="hs-identifier">rtke_ctxt</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-433"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="rtke_level"><a href="RnTypes.html#rtke_level"><span class="hs-identifier">rtke_level</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>  </span><span class="hs-comment">-- Am I renaming a type or a kind?</span><span>
</span><a name="line-434"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="rtke_what"><a href="RnTypes.html#rtke_what"><span class="hs-identifier">rtke_what</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier hs-type">RnTyKiWhat</span></a><span>  </span><span class="hs-comment">-- And within that what am I renaming?</span><span>
</span><a name="line-435"></a><span>         </span><span class="hs-special">,</span><span> </span><a name="rtke_nwcs"><a href="RnTypes.html#rtke_nwcs"><span class="hs-identifier">rtke_nwcs</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="NameSet.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a><span>     </span><span class="hs-comment">-- These are the in-scope named wildcards</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span class="hs-keyword">data</span><span> </span><a name="RnTyKiWhat"><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier">RnTyKiWhat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RnTypeBody"><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier">RnTypeBody</span></a></a><span>
</span><a name="line-439"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="RnTopConstraint"><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier">RnTopConstraint</span></a></a><span>   </span><span class="hs-comment">-- Top-level context of HsSigWcTypes</span><span>
</span><a name="line-440"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="RnConstraint"><a href="RnTypes.html#RnConstraint"><span class="hs-identifier">RnConstraint</span></a></a><span>      </span><span class="hs-comment">-- All other constraints</span><span>
</span><a name="line-441"></a><span>
</span><a name="line-442"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-443"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035606"><a href="#local-6989586621680035606"><span class="hs-identifier">lev</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035607"><a href="#local-6989586621680035607"><span class="hs-identifier">what</span></a></a><span>
</span><a name="line-444"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035608"><a href="#local-6989586621680035608"><span class="hs-identifier">wcs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035609"><a href="#local-6989586621680035609"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-445"></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RTKE&quot;</span><span>
</span><a name="line-446"></a><span>      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#braces"><span class="hs-identifier hs-var">braces</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035606"><span class="hs-identifier hs-var">lev</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035607"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035608"><span class="hs-identifier hs-var">wcs</span></a><span>
</span><a name="line-447"></a><span>                      </span><span class="hs-special">,</span><span> </span><a href="RnUtils.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><a href="#local-6989586621680035609"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-448"></a><span>
</span><a name="line-449"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier hs-type">RnTyKiWhat</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-450"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RnTypeBody&quot;</span><span>
</span><a name="line-451"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RnTopConstraint&quot;</span><span>
</span><a name="line-452"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;RnConstraint&quot;</span><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-identifier">mkTyKiEnv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#RnTyKiWhat"><span class="hs-identifier hs-type">RnTyKiWhat</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span>
</span><a name="line-455"></a><a name="mkTyKiEnv"><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier">mkTyKiEnv</span></a></a><span> </span><a name="local-6989586621680035746"><a href="#local-6989586621680035746"><span class="hs-identifier">cxt</span></a></a><span> </span><a name="local-6989586621680035747"><a href="#local-6989586621680035747"><span class="hs-identifier">level</span></a></a><span> </span><a name="local-6989586621680035748"><a href="#local-6989586621680035748"><span class="hs-identifier">what</span></a></a><span>
</span><a name="line-456"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035747"><span class="hs-identifier hs-var">level</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a><span>
</span><a name="line-457"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035748"><span class="hs-identifier hs-var">what</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035746"><span class="hs-identifier hs-var">cxt</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span class="hs-identifier">isRnKindLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-460"></a><a name="isRnKindLevel"><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier">isRnKindLevel</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RTKE"><span class="hs-identifier hs-var">RTKE</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-461"></a><span class="hs-identifier">isRnKindLevel</span><span> </span><span class="hs-identifier">_</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-462"></a><span>
</span><a name="line-463"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-464"></a><span class="hs-identifier">rnLHsType</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-465"></a><a name="rnLHsType"><a href="RnTypes.html#rnLHsType"><span class="hs-identifier">rnLHsType</span></a></a><span> </span><a name="local-6989586621680035749"><a href="#local-6989586621680035749"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621680035750"><a href="#local-6989586621680035750"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621680035749"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035750"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-identifier">rnLHsTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-468"></a><a name="rnLHsTypes"><a href="RnTypes.html#rnLHsTypes"><span class="hs-identifier">rnLHsTypes</span></a></a><span> </span><a name="local-6989586621680035751"><a href="#local-6989586621680035751"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680035752"><a href="#local-6989586621680035752"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsType"><span class="hs-identifier hs-var">rnLHsType</span></a><span> </span><a href="#local-6989586621680035751"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035752"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span class="hs-identifier">rnHsType</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-471"></a><a name="rnHsType"><a href="RnTypes.html#rnHsType"><span class="hs-identifier">rnHsType</span></a></a><span> </span><a name="local-6989586621680035753"><a href="#local-6989586621680035753"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621680035754"><a href="#local-6989586621680035754"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621680035753"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035754"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-472"></a><span>
</span><a name="line-473"></a><span class="hs-identifier">rnLHsKind</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsKind"><span class="hs-identifier hs-type">LHsKind</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-474"></a><a name="rnLHsKind"><a href="RnTypes.html#rnLHsKind"><span class="hs-identifier">rnLHsKind</span></a></a><span> </span><a name="local-6989586621680035755"><a href="#local-6989586621680035755"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621680035756"><a href="#local-6989586621680035756"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621680035755"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035756"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-475"></a><span>
</span><a name="line-476"></a><span class="hs-identifier">rnHsKind</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsKind"><span class="hs-identifier hs-type">HsKind</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsKind"><span class="hs-identifier hs-type">HsKind</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><a name="rnHsKind"><a href="RnTypes.html#rnHsKind"><span class="hs-identifier">rnHsKind</span></a></a><span> </span><a name="local-6989586621680035757"><a href="#local-6989586621680035757"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621680035758"><a href="#local-6989586621680035758"><span class="hs-identifier">kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span>  </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621680035757"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035758"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-480"></a><span class="hs-identifier">rnTyKiContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-481"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><a name="rnTyKiContext"><a href="RnTypes.html#rnTyKiContext"><span class="hs-identifier">rnTyKiContext</span></a></a><span> </span><a name="local-6989586621680035759"><a href="#local-6989586621680035759"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035760"><a href="#local-6989586621680035760"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680035761"><a href="#local-6989586621680035761"><span class="hs-identifier">cxt</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-483"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;rncontext&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035761"><span class="hs-identifier hs-var">cxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035762"><a href="#local-6989586621680035762"><span class="hs-identifier">env'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035759"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-485"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035763"><a href="#local-6989586621680035763"><span class="hs-identifier">cxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035764"><a href="#local-6989586621680035764"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035762"><span class="hs-identifier hs-var">env'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035761"><span class="hs-identifier hs-var">cxt</span></a><span>
</span><a name="line-486"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035760"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035763"><span class="hs-identifier hs-var">cxt'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035764"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-identifier">rnContext</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-489"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-490"></a><a name="rnContext"><a href="RnTypes.html#rnContext"><span class="hs-identifier">rnContext</span></a></a><span> </span><a name="local-6989586621680035765"><a href="#local-6989586621680035765"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680035766"><a href="#local-6989586621680035766"><span class="hs-identifier">theta</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rnTyKiContext"><span class="hs-identifier hs-var">rnTyKiContext</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621680035765"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035766"><span class="hs-identifier hs-var">theta</span></a><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-493"></a><span class="hs-identifier">rnLHsTyKi</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-494"></a><a name="rnLHsTyKi"><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier">rnLHsTyKi</span></a></a><span> </span><a name="local-6989586621680035767"><a href="#local-6989586621680035767"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035768"><a href="#local-6989586621680035768"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680035769"><a href="#local-6989586621680035769"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-495"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621680035768"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-496"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035770"><a href="#local-6989586621680035770"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035771"><a href="#local-6989586621680035771"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier hs-var">rnHsTyKi</span></a><span> </span><a href="#local-6989586621680035767"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035769"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-497"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035768"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035770"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035771"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-498"></a><span>
</span><a name="line-499"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><a name="rnHsTyKi"><a href="RnTypes.html#rnHsTyKi"><span class="hs-identifier">rnHsTyKi</span></a></a><span> </span><a name="local-6989586621680035772"><a href="#local-6989586621680035772"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035773"><a href="#local-6989586621680035773"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035774"><a href="#local-6989586621680035774"><span class="hs-identifier">tyvars</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035775"><a href="#local-6989586621680035775"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-502"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621680035772"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035773"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-503"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621680035772"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RnTypes.html#inTypeDoc"><span class="hs-identifier hs-var">inTypeDoc</span></a><span> </span><a href="#local-6989586621680035773"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>                           </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><a href="#local-6989586621680035774"><span class="hs-identifier hs-var">tyvars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680035776"><a href="#local-6989586621680035776"><span class="hs-identifier">tyvars'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-505"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035777"><a href="#local-6989586621680035777"><span class="hs-identifier">tau'</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-6989586621680035778"><a href="#local-6989586621680035778"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035772"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035775"><span class="hs-identifier hs-var">tau</span></a><span>
</span><a name="line-506"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035776"><span class="hs-identifier hs-var">tyvars'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621680035777"><span class="hs-identifier hs-var">tau'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-507"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035778"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035779"><a href="#local-6989586621680035779"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035780"><a href="#local-6989586621680035780"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035781"><a href="#local-6989586621680035781"><span class="hs-identifier">lctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680035782"><a href="#local-6989586621680035782"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-510"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621680035779"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035780"><span class="hs-identifier hs-var">ty</span></a><span>  </span><span class="hs-comment">-- See Note [QualTy in kinds]</span><span>
</span><a name="line-511"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035783"><a href="#local-6989586621680035783"><span class="hs-identifier">ctxt'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035784"><a href="#local-6989586621680035784"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnTyKiContext"><span class="hs-identifier hs-var">rnTyKiContext</span></a><span> </span><a href="#local-6989586621680035779"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035781"><span class="hs-identifier hs-var">lctxt</span></a><span>
</span><a name="line-512"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035785"><a href="#local-6989586621680035785"><span class="hs-identifier">tau'</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-6989586621680035786"><a href="#local-6989586621680035786"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035779"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035782"><span class="hs-identifier hs-var">tau</span></a><span>
</span><a name="line-513"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035783"><span class="hs-identifier hs-var">ctxt'</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621680035785"><span class="hs-identifier hs-var">tau'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-514"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035784"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035786"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-515"></a><span>
</span><a name="line-516"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035787"><a href="#local-6989586621680035787"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a name="local-6989586621680035788"><a href="#local-6989586621680035788"><span class="hs-identifier">ip</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035789"><a href="#local-6989586621680035789"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680035790"><a href="#local-6989586621680035790"><span class="hs-identifier">rdr_name</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-517"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035791"><a href="#local-6989586621680035791"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnTyVar"><span class="hs-identifier hs-var">rnTyVar</span></a><span> </span><a href="#local-6989586621680035787"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035790"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-518"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a href="#local-6989586621680035788"><span class="hs-identifier hs-var">ip</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035789"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035791"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a><span> </span><a href="#local-6989586621680035791"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035792"><a href="#local-6989586621680035792"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035793"><a href="#local-6989586621680035793"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621680035794"><a href="#local-6989586621680035794"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680035795"><a href="#local-6989586621680035795"><span class="hs-identifier">l_op</span></a></a><span> </span><a name="local-6989586621680035796"><a href="#local-6989586621680035796"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-521"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621680035795"><span class="hs-identifier hs-var">l_op</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-522"></a><span>    </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035797"><a href="#local-6989586621680035797"><span class="hs-identifier">l_op'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035798"><a href="#local-6989586621680035798"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnHsTyOp"><span class="hs-identifier hs-var">rnHsTyOp</span></a><span> </span><a href="#local-6989586621680035792"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035793"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680035795"><span class="hs-identifier hs-var">l_op</span></a><span>
</span><a name="line-523"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035799"><a href="#local-6989586621680035799"><span class="hs-identifier">fix</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnFixity.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span> </span><a href="#local-6989586621680035797"><span class="hs-identifier hs-var">l_op'</span></a><span>
</span><a name="line-524"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035800"><a href="#local-6989586621680035800"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035801"><a href="#local-6989586621680035801"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035792"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035794"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-525"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035802"><a href="#local-6989586621680035802"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035803"><a href="#local-6989586621680035803"><span class="hs-identifier">fvs3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035792"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035796"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-526"></a><span>        </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035806"><a href="#local-6989586621680035806"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680035804"><a href="#local-6989586621680035804"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621680035805"><a href="#local-6989586621680035805"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a href="#local-6989586621680035804"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621680035797"><span class="hs-identifier hs-var">l_op'</span></a><span> </span><a href="#local-6989586621680035805"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-527"></a><span>                               </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680035797"><span class="hs-identifier hs-var">l_op'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035799"><span class="hs-identifier hs-var">fix</span></a><span> </span><a href="#local-6989586621680035800"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621680035802"><span class="hs-identifier hs-var">ty2'</span></a><span>
</span><a name="line-528"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035806"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#plusFVs"><span class="hs-identifier hs-var">plusFVs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680035798"><span class="hs-identifier hs-var">fvs1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035801"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035803"><span class="hs-identifier hs-var">fvs3</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035807"><a href="#local-6989586621680035807"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a name="local-6989586621680035808"><a href="#local-6989586621680035808"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035809"><a href="#local-6989586621680035809"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035810"><a href="#local-6989586621680035810"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035807"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035808"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-532"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a href="#local-6989586621680035809"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035810"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-533"></a><span>
</span><a name="line-534"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035811"><a href="#local-6989586621680035811"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><a name="local-6989586621680035812"><a href="#local-6989586621680035812"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621680035813"><a href="#local-6989586621680035813"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-535"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035814"><a href="#local-6989586621680035814"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035815"><a href="#local-6989586621680035815"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035811"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035813"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-536"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><a href="#local-6989586621680035812"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621680035814"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035815"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035816"><a href="#local-6989586621680035816"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035817"><a href="#local-6989586621680035817"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621680035818"><a href="#local-6989586621680035818"><span class="hs-identifier">flds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035821"><a href="#local-6989586621680035821"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621680035816"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-540"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035822"><a href="#local-6989586621680035822"><span class="hs-identifier">fls</span></a></a><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680035819"><span class="hs-identifier hs-var">get_fields</span></a><span> </span><a href="#local-6989586621680035821"><span class="hs-identifier hs-var">ctxt</span></a><span>
</span><a name="line-541"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035823"><a href="#local-6989586621680035823"><span class="hs-identifier">flds'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035824"><a href="#local-6989586621680035824"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnConDeclFields"><span class="hs-identifier hs-var">rnConDeclFields</span></a><span> </span><a href="#local-6989586621680035821"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621680035822"><span class="hs-identifier hs-var">fls</span></a><span> </span><a href="#local-6989586621680035818"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-542"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a href="#local-6989586621680035823"><span class="hs-identifier hs-var">flds'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035824"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-543"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-544"></a><span>    </span><a name="local-6989586621680035819"><a href="#local-6989586621680035819"><span class="hs-identifier">get_fields</span></a></a><span> </span><span class="hs-special">(</span><a href="RnUtils.html#ConDeclCtx"><span class="hs-identifier hs-var">ConDeclCtx</span></a><span> </span><a name="local-6989586621680035820"><a href="#local-6989586621680035820"><span class="hs-identifier">names</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-545"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#lookupConstructorFields"><span class="hs-identifier hs-var">lookupConstructorFields</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035820"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-546"></a><span>    </span><span class="hs-identifier">get_fields</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-547"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Record syntax is illegal here:&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>                                   </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035817"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-549"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-550"></a><span>
</span><a name="line-551"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035825"><a href="#local-6989586621680035825"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621680035826"><a href="#local-6989586621680035826"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680035827"><a href="#local-6989586621680035827"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-552"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035828"><a href="#local-6989586621680035828"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035829"><a href="#local-6989586621680035829"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035825"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035826"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-553"></a><span>        </span><span class="hs-comment">-- Might find a for-all as the arg of a function type</span><span>
</span><a name="line-554"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035830"><a href="#local-6989586621680035830"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035831"><a href="#local-6989586621680035831"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035825"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035827"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-555"></a><span>        </span><span class="hs-comment">-- Or as the result.  This happens when reading Prelude.hi</span><span>
</span><a name="line-556"></a><span>        </span><span class="hs-comment">-- when we find return :: forall m. Monad m -&gt; forall a. a -&gt; m a</span><span>
</span><a name="line-557"></a><span>
</span><a name="line-558"></a><span>        </span><span class="hs-comment">-- Check for fixity rearrangements</span><span>
</span><a name="line-559"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035832"><a href="#local-6989586621680035832"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a href="TysPrim.html#funTyConName"><span class="hs-identifier hs-var">funTyConName</span></a><span> </span><a href="BasicTypes.html#funTyFixity"><span class="hs-identifier hs-var">funTyFixity</span></a><span> </span><a href="#local-6989586621680035828"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621680035830"><span class="hs-identifier hs-var">ty2'</span></a><span>
</span><a name="line-560"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035832"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035829"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035831"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035833"><a href="#local-6989586621680035833"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035834"><a href="#local-6989586621680035834"><span class="hs-identifier">listTy</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a name="local-6989586621680035835"><a href="#local-6989586621680035835"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035836"><a href="#local-6989586621680035836"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-564"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680035836"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621680035833"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-565"></a><span>              </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621680035833"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035834"><span class="hs-identifier hs-var">listTy</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-566"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035837"><a href="#local-6989586621680035837"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035838"><a href="#local-6989586621680035838"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035833"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035835"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-567"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a href="#local-6989586621680035837"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035838"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035839"><a href="#local-6989586621680035839"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035840"><a href="#local-6989586621680035840"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a name="local-6989586621680035841"><a href="#local-6989586621680035841"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680035842"><a href="#local-6989586621680035842"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621680035839"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035840"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-571"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035843"><a href="#local-6989586621680035843"><span class="hs-identifier">kind_sigs_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#KindSignatures"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">KindSignatures</span></a><span>
</span><a name="line-572"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680035843"><span class="hs-identifier hs-var">kind_sigs_ok</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#badKindSigErr"><span class="hs-identifier hs-var">badKindSigErr</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621680035839"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035841"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-573"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035844"><a href="#local-6989586621680035844"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035845"><a href="#local-6989586621680035845"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035839"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035841"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-574"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035846"><a href="#local-6989586621680035846"><span class="hs-identifier">k'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035847"><a href="#local-6989586621680035847"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035839"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">rtke_level</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035842"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-575"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a href="#local-6989586621680035844"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621680035846"><span class="hs-identifier hs-var">k'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035845"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035847"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035848"><a href="#local-6989586621680035848"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035849"><a href="#local-6989586621680035849"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a name="local-6989586621680035850"><a href="#local-6989586621680035850"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-578"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#notInKinds"><span class="hs-identifier hs-var">notInKinds</span></a><span> </span><a href="#local-6989586621680035848"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035849"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-579"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035851"><a href="#local-6989586621680035851"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035852"><a href="#local-6989586621680035852"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035848"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035850"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-580"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a href="#local-6989586621680035851"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035852"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-comment">-- Unboxed tuples are allowed to have poly-typed arguments.  These</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- sometimes crop up as a result of CPR worker-wrappering dictionaries.</span><span>
</span><a name="line-584"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035853"><a href="#local-6989586621680035853"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035854"><a href="#local-6989586621680035854"><span class="hs-identifier">tupleTy</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><a name="local-6989586621680035855"><a href="#local-6989586621680035855"><span class="hs-identifier">tup_con</span></a></a><span> </span><a name="local-6989586621680035856"><a href="#local-6989586621680035856"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-585"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035857"><a href="#local-6989586621680035857"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-586"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680035857"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621680035853"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-587"></a><span>              </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621680035853"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035854"><span class="hs-identifier hs-var">tupleTy</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-588"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035858"><a href="#local-6989586621680035858"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035859"><a href="#local-6989586621680035859"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035853"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035856"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-589"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><a href="#local-6989586621680035855"><span class="hs-identifier hs-var">tup_con</span></a><span> </span><a href="#local-6989586621680035858"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035859"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035860"><a href="#local-6989586621680035860"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035861"><a href="#local-6989586621680035861"><span class="hs-identifier">sumTy</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a name="local-6989586621680035862"><a href="#local-6989586621680035862"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-592"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035863"><a href="#local-6989586621680035863"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-593"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680035863"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621680035860"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>              </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621680035860"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035861"><span class="hs-identifier hs-var">sumTy</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-595"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035864"><a href="#local-6989586621680035864"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035865"><a href="#local-6989586621680035865"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035860"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035862"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-596"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a href="#local-6989586621680035864"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035865"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span class="hs-comment">-- Ensure that a type-level integer is nonnegative (#8306, #8412)</span><span>
</span><a name="line-599"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035866"><a href="#local-6989586621680035866"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035867"><a href="#local-6989586621680035867"><span class="hs-identifier">tyLit</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><a name="local-6989586621680035868"><a href="#local-6989586621680035868"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-600"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035872"><a href="#local-6989586621680035872"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-601"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680035872"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621680035866"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035867"><span class="hs-identifier hs-var">tyLit</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035869"><span class="hs-identifier hs-var">negLit</span></a><span> </span><a href="#local-6989586621680035868"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="#local-6989586621680035870"><span class="hs-identifier hs-var">negLitErr</span></a><span class="hs-special">)</span><span>
</span><a name="line-603"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621680035866"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035867"><span class="hs-identifier hs-var">tyLit</span></a><span>
</span><a name="line-604"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><a href="#local-6989586621680035868"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-605"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-606"></a><span>    </span><a name="local-6989586621680035869"><a href="#local-6989586621680035869"><span class="hs-identifier">negLit</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsStrTy"><span class="hs-identifier hs-var">HsStrTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-607"></a><span>    </span><span class="hs-identifier">negLit</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsNumTy"><span class="hs-identifier hs-var">HsNumTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680035871"><a href="#local-6989586621680035871"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035871"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-608"></a><span>    </span><a name="local-6989586621680035870"><a href="#local-6989586621680035870"><span class="hs-identifier">negLitErr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal literal in type (type literals must not be negative):&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035867"><span class="hs-identifier hs-var">tyLit</span></a><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035873"><a href="#local-6989586621680035873"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035874"><a href="#local-6989586621680035874"><span class="hs-identifier">overall_ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsAppsTy"><span class="hs-identifier hs-var">HsAppsTy</span></a><span> </span><a name="local-6989586621680035875"><a href="#local-6989586621680035875"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Step 1: Break up the HsAppsTy into symbols and non-symbol regions</span><span>
</span><a name="line-612"></a><span>         </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035909"><a href="#local-6989586621680035909"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035910"><a href="#local-6989586621680035910"><span class="hs-identifier">syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#splitHsAppsTy"><span class="hs-identifier hs-var">splitHsAppsTy</span></a><span> </span><a href="#local-6989586621680035875"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span>             </span><span class="hs-comment">-- Step 2: rename the pieces</span><span>
</span><a name="line-615"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035911"><a href="#local-6989586621680035911"><span class="hs-identifier">syms1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035912"><a href="#local-6989586621680035912"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnHsTyOp"><span class="hs-identifier hs-var">rnHsTyOp</span></a><span> </span><a href="#local-6989586621680035873"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035874"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035910"><span class="hs-identifier hs-var">syms</span></a><span>
</span><a name="line-616"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035913"><a href="#local-6989586621680035913"><span class="hs-identifier">non_syms1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035914"><a href="#local-6989586621680035914"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035873"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035909"><span class="hs-identifier hs-var">non_syms</span></a><span>
</span><a name="line-617"></a><span>
</span><a name="line-618"></a><span>             </span><span class="hs-comment">-- Step 3: deal with *. See Note [Dealing with *]</span><span>
</span><a name="line-619"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035915"><a href="#local-6989586621680035915"><span class="hs-identifier">non_syms2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035916"><a href="#local-6989586621680035916"><span class="hs-identifier">syms2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035876"><span class="hs-identifier hs-var">deal_with_star</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621680035913"><span class="hs-identifier hs-var">non_syms1</span></a><span> </span><a href="#local-6989586621680035911"><span class="hs-identifier hs-var">syms1</span></a><span>
</span><a name="line-620"></a><span>
</span><a name="line-621"></a><span>             </span><span class="hs-comment">-- Step 4: collapse the non-symbol regions with HsAppTy</span><span>
</span><a name="line-622"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035917"><a href="#local-6989586621680035917"><span class="hs-identifier">non_syms3</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621680035877"><span class="hs-identifier hs-var">deal_with_non_syms</span></a><span> </span><a href="#local-6989586621680035915"><span class="hs-identifier hs-var">non_syms2</span></a><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span>             </span><span class="hs-comment">-- Step 5: assemble the pieces, using mkHsOpTyRn</span><span>
</span><a name="line-625"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680035918"><a href="#local-6989586621680035918"><span class="hs-identifier">res_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680035878"><span class="hs-identifier hs-var">build_res_ty</span></a><span> </span><a href="#local-6989586621680035917"><span class="hs-identifier hs-var">non_syms3</span></a><span> </span><a href="#local-6989586621680035916"><span class="hs-identifier hs-var">syms2</span></a><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span>        </span><span class="hs-comment">-- all done. Phew.</span><span>
</span><a name="line-628"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035918"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035912"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035914"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-629"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-630"></a><span>    </span><span class="hs-comment">-- See Note [Dealing with *]</span><span>
</span><a name="line-631"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-632"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-633"></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>    </span><a name="local-6989586621680035876"><a href="#local-6989586621680035876"><span class="hs-identifier">deal_with_star</span></a></a><span> </span><a name="local-6989586621680035879"><a href="#local-6989586621680035879"><span class="hs-identifier">acc1</span></a></a><span> </span><a name="local-6989586621680035880"><a href="#local-6989586621680035880"><span class="hs-identifier">acc2</span></a></a><span>
</span><a name="line-635"></a><span>                   </span><span class="hs-special">(</span><a name="local-6989586621680035881"><a href="#local-6989586621680035881"><span class="hs-identifier">non_syms1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035882"><a href="#local-6989586621680035882"><span class="hs-identifier">non_syms2</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035883"><a href="#local-6989586621680035883"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035884"><a href="#local-6989586621680035884"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680035885"><a href="#local-6989586621680035885"><span class="hs-identifier">star</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035886"><a href="#local-6989586621680035886"><span class="hs-identifier">ops</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-636"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680035885"><span class="hs-identifier hs-var">star</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#starKindTyConKey"><span class="hs-identifier hs-var">starKindTyConKey</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680035885"><span class="hs-identifier hs-var">star</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#unicodeStarKindTyConKey"><span class="hs-identifier hs-var">unicodeStarKindTyConKey</span></a><span>
</span><a name="line-637"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035876"><span class="hs-identifier hs-var">deal_with_star</span></a><span> </span><a href="#local-6989586621680035879"><span class="hs-identifier hs-var">acc1</span></a><span> </span><a href="#local-6989586621680035880"><span class="hs-identifier hs-var">acc2</span></a><span>
</span><a name="line-638"></a><span>                       </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621680035881"><span class="hs-identifier hs-var">non_syms1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035884"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><a href="HsTypes.html#NotPromoted"><span class="hs-identifier hs-var">NotPromoted</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035884"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035885"><span class="hs-identifier hs-var">star</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>                            </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680035882"><span class="hs-identifier hs-var">non_syms2</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680035883"><span class="hs-identifier hs-var">non_syms</span></a><span class="hs-special">)</span><span>
</span><a name="line-640"></a><span>                       </span><a href="#local-6989586621680035886"><span class="hs-identifier hs-var">ops</span></a><span>
</span><a name="line-641"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><a name="local-6989586621680035887"><a href="#local-6989586621680035887"><span class="hs-identifier">acc1</span></a></a><span> </span><a name="local-6989586621680035888"><a href="#local-6989586621680035888"><span class="hs-identifier">acc2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680035889"><a href="#local-6989586621680035889"><span class="hs-identifier">non_syms1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035890"><a href="#local-6989586621680035890"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035891"><a href="#local-6989586621680035891"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035892"><a href="#local-6989586621680035892"><span class="hs-identifier">ops</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-642"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680035876"><span class="hs-identifier hs-var">deal_with_star</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035889"><span class="hs-identifier hs-var">non_syms1</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680035887"><span class="hs-identifier hs-var">acc1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035891"><span class="hs-identifier hs-var">op1</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680035888"><span class="hs-identifier hs-var">acc2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035890"><span class="hs-identifier hs-var">non_syms</span></a><span> </span><a href="#local-6989586621680035892"><span class="hs-identifier hs-var">ops</span></a><span>
</span><a name="line-643"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><a name="local-6989586621680035893"><a href="#local-6989586621680035893"><span class="hs-identifier">acc1</span></a></a><span> </span><a name="local-6989586621680035894"><a href="#local-6989586621680035894"><span class="hs-identifier">acc2</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621680035895"><a href="#local-6989586621680035895"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-644"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035895"><span class="hs-identifier hs-var">non_syms</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680035893"><span class="hs-identifier hs-var">acc1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621680035894"><span class="hs-identifier hs-var">acc2</span></a><span class="hs-special">)</span><span>
</span><a name="line-645"></a><span>    </span><span class="hs-identifier">deal_with_star</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-646"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;deal_with_star&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035874"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span>    </span><span class="hs-comment">-- collapse [LHsType GhcRn] to LHsType GhcRn by making applications</span><span>
</span><a name="line-649"></a><span>    </span><span class="hs-comment">-- monadic only for failure</span><span>
</span><a name="line-650"></a><span>    </span><span class="hs-identifier">deal_with_non_syms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-651"></a><span>    </span><a name="local-6989586621680035877"><a href="#local-6989586621680035877"><span class="hs-identifier">deal_with_non_syms</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680035896"><a href="#local-6989586621680035896"><span class="hs-identifier">non_sym</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035897"><a href="#local-6989586621680035897"><span class="hs-identifier">non_syms</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="HsTypes.html#mkHsAppTys"><span class="hs-identifier hs-var">mkHsAppTys</span></a><span> </span><a href="#local-6989586621680035896"><span class="hs-identifier hs-var">non_sym</span></a><span> </span><a href="#local-6989586621680035897"><span class="hs-identifier hs-var">non_syms</span></a><span>
</span><a name="line-652"></a><span>    </span><span class="hs-identifier">deal_with_non_syms</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#failWith"><span class="hs-identifier hs-var">failWith</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#emptyNonSymsErr"><span class="hs-identifier hs-var">emptyNonSymsErr</span></a><span> </span><a href="#local-6989586621680035874"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span>    </span><span class="hs-comment">-- assemble a right-biased OpTy for use in mkHsOpTyRn</span><span>
</span><a name="line-655"></a><span>    </span><span class="hs-identifier">build_res_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-656"></a><span>    </span><a name="local-6989586621680035878"><a href="#local-6989586621680035878"><span class="hs-identifier">build_res_ty</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680035898"><a href="#local-6989586621680035898"><span class="hs-identifier">arg1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035899"><a href="#local-6989586621680035899"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035900"><a href="#local-6989586621680035900"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621680035901"><a href="#local-6989586621680035901"><span class="hs-identifier">ops</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-657"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035902"><a href="#local-6989586621680035902"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680035878"><span class="hs-identifier hs-var">build_res_ty</span></a><span> </span><a href="#local-6989586621680035899"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621680035901"><span class="hs-identifier hs-var">ops</span></a><span>
</span><a name="line-658"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035903"><a href="#local-6989586621680035903"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnFixity.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span> </span><a href="#local-6989586621680035900"><span class="hs-identifier hs-var">op1</span></a><span>
</span><a name="line-659"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035906"><a href="#local-6989586621680035906"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-660"></a><span>               </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680035904"><a href="#local-6989586621680035904"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621680035905"><a href="#local-6989586621680035905"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a href="#local-6989586621680035904"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621680035900"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621680035905"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680035900"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035903"><span class="hs-identifier hs-var">fix</span></a><span> </span><a href="#local-6989586621680035898"><span class="hs-identifier hs-var">arg1</span></a><span> </span><a href="#local-6989586621680035902"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-661"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035907"><a href="#local-6989586621680035907"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621680035898"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621680035902"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-662"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035907"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035906"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>           </span><span class="hs-special">}</span><span>
</span><a name="line-664"></a><span>    </span><span class="hs-identifier">build_res_ty</span><span> </span><span class="hs-special">[</span><a name="local-6989586621680035908"><a href="#local-6989586621680035908"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680035908"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-665"></a><span>    </span><span class="hs-identifier">build_res_ty</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;build_op_ty&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035874"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-666"></a><span>
</span><a name="line-667"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035919"><a href="#local-6989586621680035919"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a name="local-6989586621680035920"><a href="#local-6989586621680035920"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680035921"><a href="#local-6989586621680035921"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-668"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035922"><a href="#local-6989586621680035922"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035923"><a href="#local-6989586621680035923"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035919"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035920"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-669"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035924"><a href="#local-6989586621680035924"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035925"><a href="#local-6989586621680035925"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035919"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035921"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-670"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a href="#local-6989586621680035922"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621680035924"><span class="hs-identifier hs-var">ty2'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035923"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035925"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035926"><a href="#local-6989586621680035926"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035927"><a href="#local-6989586621680035927"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><a name="local-6989586621680035928"><a href="#local-6989586621680035928"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621680035929"><a href="#local-6989586621680035929"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-673"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#notInKinds"><span class="hs-identifier hs-var">notInKinds</span></a><span> </span><a href="#local-6989586621680035926"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035927"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-674"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035930"><a href="#local-6989586621680035930"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035931"><a href="#local-6989586621680035931"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035926"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035929"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-675"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><a href="#local-6989586621680035928"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621680035930"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035931"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-676"></a><span>
</span><a name="line-677"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035932"><a href="#local-6989586621680035932"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035933"><a href="#local-6989586621680035933"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a name="local-6989586621680035934"><a href="#local-6989586621680035934"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680035935"><a href="#local-6989586621680035935"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-678"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621680035932"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035933"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-679"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035936"><a href="#local-6989586621680035936"><span class="hs-identifier">ty1'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035937"><a href="#local-6989586621680035937"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035932"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035934"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-680"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035938"><a href="#local-6989586621680035938"><span class="hs-identifier">ty2'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035939"><a href="#local-6989586621680035939"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035932"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035935"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-681"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a href="#local-6989586621680035936"><span class="hs-identifier hs-var">ty1'</span></a><span> </span><a href="#local-6989586621680035938"><span class="hs-identifier hs-var">ty2'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035937"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680035939"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-682"></a><span>
</span><a name="line-683"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><a name="local-6989586621680035940"><a href="#local-6989586621680035940"><span class="hs-identifier">sp</span></a></a><span> </span><a name="local-6989586621680035941"><a href="#local-6989586621680035941"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-684"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnSplice.html#rnSpliceType"><span class="hs-identifier hs-var">rnSpliceType</span></a><span> </span><a href="#local-6989586621680035940"><span class="hs-identifier hs-var">sp</span></a><span> </span><a href="#local-6989586621680035941"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-685"></a><span>
</span><a name="line-686"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035942"><a href="#local-6989586621680035942"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a name="local-6989586621680035943"><a href="#local-6989586621680035943"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680035944"><a href="#local-6989586621680035944"><span class="hs-identifier">haddock_doc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-687"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035945"><a href="#local-6989586621680035945"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035946"><a href="#local-6989586621680035946"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035942"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035943"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-688"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035947"><a href="#local-6989586621680035947"><span class="hs-identifier">haddock_doc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnHsDoc.html#rnLHsDoc"><span class="hs-identifier hs-var">rnLHsDoc</span></a><span> </span><a href="#local-6989586621680035944"><span class="hs-identifier hs-var">haddock_doc</span></a><span>
</span><a name="line-689"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a href="#local-6989586621680035945"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621680035947"><span class="hs-identifier hs-var">haddock_doc'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035946"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-690"></a><span>
</span><a name="line-691"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><a name="local-6989586621680035948"><a href="#local-6989586621680035948"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><a href="#local-6989586621680035948"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span>
</span><a name="line-693"></a><span>    </span><span class="hs-comment">-- The emptyFVs probably isn't quite right</span><span>
</span><a name="line-694"></a><span>    </span><span class="hs-comment">-- but I don't think it matters</span><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035949"><a href="#local-6989586621680035949"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035950"><a href="#local-6989586621680035950"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><a name="local-6989586621680035951"><a href="#local-6989586621680035951"><span class="hs-identifier">ip</span></a></a><span> </span><a name="local-6989586621680035952"><a href="#local-6989586621680035952"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621680035953"><a href="#local-6989586621680035953"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-697"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621680035949"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035950"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-698"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035954"><a href="#local-6989586621680035954"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-699"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680035954"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621680035949"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035950"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035955"><a href="#local-6989586621680035955"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035956"><a href="#local-6989586621680035956"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035949"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035953"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-701"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><a href="#local-6989586621680035951"><span class="hs-identifier hs-var">ip</span></a><span> </span><a href="#local-6989586621680035952"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621680035955"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035956"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-702"></a><span>
</span><a name="line-703"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035957"><a href="#local-6989586621680035957"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035958"><a href="#local-6989586621680035958"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><a name="local-6989586621680035959"><a href="#local-6989586621680035959"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621680035960"><a href="#local-6989586621680035960"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-704"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier hs-var">checkTypeInType</span></a><span> </span><a href="#local-6989586621680035957"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035958"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-705"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035961"><a href="#local-6989586621680035961"><span class="hs-identifier">data_kinds</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#DataKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">DataKinds</span></a><span>
</span><a name="line-706"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680035961"><span class="hs-identifier hs-var">data_kinds</span></a><span> </span><span class="hs-special">(</span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier hs-var">dataKindsErr</span></a><span> </span><a href="#local-6989586621680035957"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035958"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-707"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680035962"><a href="#local-6989586621680035962"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680035963"><a href="#local-6989586621680035963"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680035957"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035960"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-708"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><a href="#local-6989586621680035959"><span class="hs-identifier hs-var">kis</span></a><span> </span><a href="#local-6989586621680035962"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035963"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-709"></a><span>
</span><a name="line-710"></a><span class="hs-identifier">rnHsTyKi</span><span> </span><a name="local-6989586621680035964"><a href="#local-6989586621680035964"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a name="local-6989586621680035965"><a href="#local-6989586621680035965"><span class="hs-identifier">wc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-711"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#checkAnonWildCard"><span class="hs-identifier hs-var">checkAnonWildCard</span></a><span> </span><a href="#local-6989586621680035964"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035965"><span class="hs-identifier hs-var">wc</span></a><span>
</span><a name="line-712"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035966"><a href="#local-6989586621680035966"><span class="hs-identifier">wc'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnAnonWildCard"><span class="hs-identifier hs-var">rnAnonWildCard</span></a><span> </span><a href="#local-6989586621680035965"><span class="hs-identifier hs-var">wc</span></a><span>
</span><a name="line-713"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><a href="#local-6989586621680035966"><span class="hs-identifier hs-var">wc'</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#emptyFVs"><span class="hs-identifier hs-var">emptyFVs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-714"></a><span>         </span><span class="hs-comment">-- emptyFVs: this occurrence does not refer to a</span><span>
</span><a name="line-715"></a><span>         </span><span class="hs-comment">--           user-written binding site, so don't treat</span><span>
</span><a name="line-716"></a><span>         </span><span class="hs-comment">--           it as a free variable</span><span>
</span><a name="line-717"></a><span>
</span><a name="line-718"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-719"></a><span class="hs-identifier">rnTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-720"></a><a name="rnTyVar"><a href="RnTypes.html#rnTyVar"><span class="hs-identifier">rnTyVar</span></a></a><span> </span><a name="local-6989586621680035967"><a href="#local-6989586621680035967"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035968"><a href="#local-6989586621680035968"><span class="hs-identifier">rdr_name</span></a></a><span>
</span><a name="line-721"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035969"><a href="#local-6989586621680035969"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span>   </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621680035967"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-722"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="RnEnv.html#lookupKindOccRn"><span class="hs-identifier hs-var">lookupKindOccRn</span></a><span> </span><a href="#local-6989586621680035968"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-723"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><a href="RnEnv.html#lookupTypeOccRn"><span class="hs-identifier hs-var">lookupTypeOccRn</span></a><span> </span><a href="#local-6989586621680035968"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-724"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkNamedWildCard"><span class="hs-identifier hs-var">checkNamedWildCard</span></a><span> </span><a href="#local-6989586621680035967"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035969"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-725"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680035969"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-identifier">rnLTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-728"></a><span class="hs-comment">-- Called externally; does not deal with wildards</span><span>
</span><a name="line-729"></a><a name="rnLTyVar"><a href="RnTypes.html#rnLTyVar"><span class="hs-identifier">rnLTyVar</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035970"><a href="#local-6989586621680035970"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680035971"><a href="#local-6989586621680035971"><span class="hs-identifier">rdr_name</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-730"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035972"><a href="#local-6989586621680035972"><span class="hs-identifier">tyvar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnEnv.html#lookupTypeOccRn"><span class="hs-identifier hs-var">lookupTypeOccRn</span></a><span> </span><a href="#local-6989586621680035971"><span class="hs-identifier hs-var">rdr_name</span></a><span>
</span><a name="line-731"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035970"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035972"><span class="hs-identifier hs-var">tyvar</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-732"></a><span>
</span><a name="line-733"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-734"></a><span class="hs-identifier">rnHsTyOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621680035627"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-735"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680035627"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-736"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-737"></a><a name="rnHsTyOp"><a href="RnTypes.html#rnHsTyOp"><span class="hs-identifier">rnHsTyOp</span></a></a><span> </span><a name="local-6989586621680035973"><a href="#local-6989586621680035973"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035974"><a href="#local-6989586621680035974"><span class="hs-identifier">overall_ty</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680035975"><a href="#local-6989586621680035975"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680035976"><a href="#local-6989586621680035976"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-738"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035977"><a href="#local-6989586621680035977"><span class="hs-identifier">ops_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#TypeOperators"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeOperators</span></a><span>
</span><a name="line-739"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035978"><a href="#local-6989586621680035978"><span class="hs-identifier">op'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnTyVar"><span class="hs-identifier hs-var">rnTyVar</span></a><span> </span><a href="#local-6989586621680035973"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035976"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-740"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035977"><span class="hs-identifier hs-var">ops_ok</span></a><span>
</span><a name="line-741"></a><span>                 </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680035978"><span class="hs-identifier hs-var">op'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysWiredIn.html#starKindTyConName"><span class="hs-identifier hs-var">starKindTyConName</span></a><span>
</span><a name="line-742"></a><span>                 </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680035978"><span class="hs-identifier hs-var">op'</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysWiredIn.html#unicodeStarKindTyConName"><span class="hs-identifier hs-var">unicodeStarKindTyConName</span></a><span>
</span><a name="line-743"></a><span>                 </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680035978"><span class="hs-identifier hs-var">op'</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqTyConKey"><span class="hs-identifier hs-var">eqTyConKey</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-744"></a><span>           </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#opTyErr"><span class="hs-identifier hs-var">opTyErr</span></a><span> </span><a href="#local-6989586621680035976"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621680035974"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-745"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035979"><a href="#local-6989586621680035979"><span class="hs-identifier">l_op'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035975"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035978"><span class="hs-identifier hs-var">op'</span></a><span>
</span><a name="line-746"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035979"><span class="hs-identifier hs-var">l_op'</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#unitFV"><span class="hs-identifier hs-var">unitFV</span></a><span> </span><a href="#local-6989586621680035978"><span class="hs-identifier hs-var">op'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-747"></a><span>
</span><a name="line-748"></a><span class="hs-comment">--------------</span><span>
</span><a name="line-749"></a><span class="hs-identifier">notAllowed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-750"></a><a name="notAllowed"><a href="RnTypes.html#notAllowed"><span class="hs-identifier">notAllowed</span></a></a><span> </span><a name="local-6989586621680035980"><a href="#local-6989586621680035980"><span class="hs-identifier">doc</span></a></a><span>
</span><a name="line-751"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Wildcard&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><a href="#local-6989586621680035980"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;not allowed&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-752"></a><span>
</span><a name="line-753"></a><span class="hs-identifier">checkWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-754"></a><a name="checkWildCard"><a href="RnTypes.html#checkWildCard"><span class="hs-identifier">checkWildCard</span></a></a><span> </span><a name="local-6989586621680035981"><a href="#local-6989586621680035981"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680035982"><a href="#local-6989586621680035982"><span class="hs-identifier">doc</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-755"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680035982"><span class="hs-identifier hs-var">doc</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="RnUtils.html#pprHsDocContext"><span class="hs-identifier hs-var">pprHsDocContext</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621680035981"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-756"></a><span class="hs-identifier">checkWildCard</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-757"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>
</span><a name="line-759"></a><span class="hs-identifier">checkAnonWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-760"></a><span class="hs-comment">-- Report an error if an anonymous wildcard is illegal here</span><span>
</span><a name="line-761"></a><a name="checkAnonWildCard"><a href="RnTypes.html#checkAnonWildCard"><span class="hs-identifier">checkAnonWildCard</span></a></a><span> </span><a name="local-6989586621680035983"><a href="#local-6989586621680035983"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035984"><a href="#local-6989586621680035984"><span class="hs-identifier">wc</span></a></a><span>
</span><a name="line-762"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#checkWildCard"><span class="hs-identifier hs-var">checkWildCard</span></a><span> </span><a href="#local-6989586621680035983"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035985"><span class="hs-identifier hs-var">mb_bad</span></a><span>
</span><a name="line-763"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-764"></a><span>    </span><span class="hs-identifier">mb_bad</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-765"></a><span>    </span><a name="local-6989586621680035985"><a href="#local-6989586621680035985"><span class="hs-identifier">mb_bad</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#wildCardsAllowed"><span class="hs-identifier hs-var">wildCardsAllowed</span></a><span> </span><a href="#local-6989586621680035983"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-766"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035984"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-767"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-768"></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><a href="#local-6989586621680035983"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-769"></a><span>               </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-770"></a><span>               </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621680035986"><span class="hs-identifier hs-var">constraint_msg</span></a><span>
</span><a name="line-771"></a><span>               </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621680035986"><span class="hs-identifier hs-var">constraint_msg</span></a><span>
</span><a name="line-772"></a><span>
</span><a name="line-773"></a><span>    </span><a name="local-6989586621680035986"><a href="#local-6989586621680035986"><span class="hs-identifier">constraint_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035984"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a constraint&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>                        </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621680035987"><span class="hs-identifier hs-var">hint_msg</span></a><span>
</span><a name="line-775"></a><span>    </span><a name="local-6989586621680035987"><a href="#local-6989586621680035987"><span class="hs-identifier">hint_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;except as the last top-level constraint of a type signature&quot;</span><span>
</span><a name="line-776"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;e.g  f :: (Eq a, _) =&gt; blah&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-777"></a><span>
</span><a name="line-778"></a><span class="hs-identifier">checkNamedWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-779"></a><span class="hs-comment">-- Report an error if a named wildcard is illegal here</span><span>
</span><a name="line-780"></a><a name="checkNamedWildCard"><a href="RnTypes.html#checkNamedWildCard"><span class="hs-identifier">checkNamedWildCard</span></a></a><span> </span><a name="local-6989586621680035988"><a href="#local-6989586621680035988"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035989"><a href="#local-6989586621680035989"><span class="hs-identifier">name</span></a></a><span>
</span><a name="line-781"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#checkWildCard"><span class="hs-identifier hs-var">checkWildCard</span></a><span> </span><a href="#local-6989586621680035988"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680035990"><span class="hs-identifier hs-var">mb_bad</span></a><span>
</span><a name="line-782"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-783"></a><span>    </span><a name="local-6989586621680035990"><a href="#local-6989586621680035990"><span class="hs-identifier">mb_bad</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035989"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">rtke_nwcs</span><span> </span><a href="#local-6989586621680035988"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-comment">-- Not a wildcard</span><span>
</span><a name="line-785"></a><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#wildCardsAllowed"><span class="hs-identifier hs-var">wildCardsAllowed</span></a><span> </span><a href="#local-6989586621680035988"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span>
</span><a name="line-786"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035989"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-787"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-788"></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_what</span><span> </span><a href="#local-6989586621680035988"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-789"></a><span>               </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-comment">-- Allowed</span><span>
</span><a name="line-790"></a><span>               </span><a href="RnTypes.html#RnTopConstraint"><span class="hs-identifier hs-var">RnTopConstraint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>   </span><span class="hs-comment">-- Allowed</span><span>
</span><a name="line-791"></a><span>               </span><a href="RnTypes.html#RnConstraint"><span class="hs-identifier hs-var">RnConstraint</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621680035991"><span class="hs-identifier hs-var">constraint_msg</span></a><span>
</span><a name="line-792"></a><span>    </span><a name="local-6989586621680035991"><a href="#local-6989586621680035991"><span class="hs-identifier">constraint_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#notAllowed"><span class="hs-identifier hs-var">notAllowed</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035989"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in a constraint&quot;</span><span>
</span><a name="line-793"></a><span>
</span><a name="line-794"></a><span class="hs-identifier">wildCardsAllowed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-795"></a><span class="hs-comment">-- ^ In what contexts are wildcards permitted</span><span>
</span><a name="line-796"></a><a name="wildCardsAllowed"><a href="RnTypes.html#wildCardsAllowed"><span class="hs-identifier">wildCardsAllowed</span></a></a><span> </span><a name="local-6989586621680035992"><a href="#local-6989586621680035992"><span class="hs-identifier">env</span></a></a><span>
</span><a name="line-797"></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">rtke_ctxt</span><span> </span><a href="#local-6989586621680035992"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-798"></a><span>       </span><a href="RnUtils.html#TypeSigCtx"><span class="hs-identifier hs-var">TypeSigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-799"></a><span>       </span><a href="RnUtils.html#TypBrCtx"><span class="hs-identifier hs-var">TypBrCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Template Haskell quoted type</span><span>
</span><a name="line-800"></a><span>       </span><a href="RnUtils.html#SpliceTypeCtx"><span class="hs-identifier hs-var">SpliceTypeCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Result of a Template Haskell splice</span><span>
</span><a name="line-801"></a><span>       </span><a href="RnUtils.html#ExprWithTySigCtx"><span class="hs-identifier hs-var">ExprWithTySigCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-802"></a><span>       </span><a href="RnUtils.html#PatCtx"><span class="hs-identifier hs-var">PatCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-803"></a><span>       </span><a href="RnUtils.html#RuleCtx"><span class="hs-identifier hs-var">RuleCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-804"></a><span>       </span><a href="RnUtils.html#FamPatCtx"><span class="hs-identifier hs-var">FamPatCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>   </span><span class="hs-comment">-- Not named wildcards though</span><span>
</span><a name="line-805"></a><span>       </span><a href="RnUtils.html#GHCiCtx"><span class="hs-identifier hs-var">GHCiCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-806"></a><span>       </span><a href="RnUtils.html#HsTypeCtx"><span class="hs-identifier hs-var">HsTypeCtx</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-807"></a><span>       </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-808"></a><span>
</span><a name="line-809"></a><span class="hs-identifier">rnAnonWildCard</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsWildCardInfo"><span class="hs-identifier hs-type">HsWildCardInfo</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-810"></a><a name="rnAnonWildCard"><a href="RnTypes.html#rnAnonWildCard"><span class="hs-identifier">rnAnonWildCard</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AnonWildCard"><span class="hs-identifier hs-var">AnonWildCard</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-811"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035993"><a href="#local-6989586621680035993"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getSrcSpanM"><span class="hs-identifier hs-var">getSrcSpanM</span></a><span>
</span><a name="line-812"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680035994"><a href="#local-6989586621680035994"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a><span>
</span><a name="line-813"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680035995"><a href="#local-6989586621680035995"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a><span> </span><a href="#local-6989586621680035994"><span class="hs-identifier hs-var">uniq</span></a><span> </span><span class="hs-special">(</span><a href="OccName.html#mkTyVarOcc"><span class="hs-identifier hs-var">mkTyVarOcc</span></a><span> </span><span class="hs-string">&quot;_&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621680035993"><span class="hs-identifier hs-var">loc</span></a><span>
</span><a name="line-814"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AnonWildCard"><span class="hs-identifier hs-var">AnonWildCard</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680035993"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680035995"><span class="hs-identifier hs-var">name</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-815"></a><span>
</span><a name="line-816"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-817"></a><span class="hs-comment">-- | Ensures either that we're in a type or that -XTypeInType is set</span><span>
</span><a name="line-818"></a><span class="hs-identifier">checkTypeInType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621680035626"><span class="hs-identifier hs-type">ty</span></a><span>
</span><a name="line-819"></a><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span>
</span><a name="line-820"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680035626"><span class="hs-identifier hs-type">ty</span></a><span>      </span><span class="hs-comment">-- ^ type</span><span>
</span><a name="line-821"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-822"></a><a name="checkTypeInType"><a href="RnTypes.html#checkTypeInType"><span class="hs-identifier">checkTypeInType</span></a></a><span> </span><a name="local-6989586621680035996"><a href="#local-6989586621680035996"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680035997"><a href="#local-6989586621680035997"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-823"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621680035996"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-824"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680035998"><a href="#local-6989586621680035998"><span class="hs-identifier">type_in_type</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#TypeInType"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeInType</span></a><span>
</span><a name="line-825"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680035998"><span class="hs-identifier hs-var">type_in_type</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-826"></a><span>         </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal kind:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035997"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span>
</span><a name="line-827"></a><span>                 </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Did you mean to enable TypeInType?&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-828"></a><span class="hs-identifier">checkTypeInType</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-829"></a><span>
</span><a name="line-830"></a><span class="hs-identifier">notInKinds</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621680035625"><span class="hs-identifier hs-type">ty</span></a><span>
</span><a name="line-831"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span>
</span><a name="line-832"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680035625"><span class="hs-identifier hs-type">ty</span></a><span>
</span><a name="line-833"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-834"></a><a name="notInKinds"><a href="RnTypes.html#notInKinds"><span class="hs-identifier">notInKinds</span></a></a><span> </span><a name="local-6989586621680035999"><a href="#local-6989586621680035999"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680036000"><a href="#local-6989586621680036000"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-835"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621680035999"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-836"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal kind (even with TypeInType enabled):&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036000"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-837"></a><span class="hs-identifier">notInKinds</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-838"></a><span>
</span><a name="line-839"></a><span class="hs-comment">{- *****************************************************
*                                                      *
          Binding type variables
*                                                      *
***************************************************** -}</span><span>
</span><a name="line-844"></a><span>
</span><a name="line-845"></a><span class="hs-identifier">bindSigTyVarsFV</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-846"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035624"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-847"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035624"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-848"></a><span class="hs-comment">-- Used just before renaming the defn of a function</span><span>
</span><a name="line-849"></a><span class="hs-comment">-- with a separate type signature, to bring its tyvars into scope</span><span>
</span><a name="line-850"></a><span class="hs-comment">-- With no -XScopedTypeVariables, this is a no-op</span><span>
</span><a name="line-851"></a><a name="bindSigTyVarsFV"><a href="RnTypes.html#bindSigTyVarsFV"><span class="hs-identifier">bindSigTyVarsFV</span></a></a><span> </span><a name="local-6989586621680036001"><a href="#local-6989586621680036001"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621680036002"><a href="#local-6989586621680036002"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-852"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036003"><a href="#local-6989586621680036003"><span class="hs-identifier">scoped_tyvars</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#ScopedTypeVariables"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ScopedTypeVariables</span></a><span>
</span><a name="line-853"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680036003"><span class="hs-identifier hs-var">scoped_tyvars</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-854"></a><span>                </span><a href="#local-6989586621680036002"><span class="hs-identifier hs-var">thing_inside</span></a><span>
</span><a name="line-855"></a><span>          </span><span class="hs-keyword">else</span><span>
</span><a name="line-856"></a><span>                </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621680036001"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621680036002"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span class="hs-comment">-- | Simply bring a bunch of RdrNames into scope. No checking for</span><span>
</span><a name="line-859"></a><span class="hs-comment">-- validity, at all. The binding location is taken from the location</span><span>
</span><a name="line-860"></a><span class="hs-comment">-- on each name.</span><span>
</span><a name="line-861"></a><span class="hs-identifier">bindLRdrNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-862"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035623"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-863"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035623"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-864"></a><a name="bindLRdrNames"><a href="RnTypes.html#bindLRdrNames"><span class="hs-identifier">bindLRdrNames</span></a></a><span> </span><a name="local-6989586621680036004"><a href="#local-6989586621680036004"><span class="hs-identifier">rdrs</span></a></a><span> </span><a name="local-6989586621680036005"><a href="#local-6989586621680036005"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-865"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036006"><a href="#local-6989586621680036006"><span class="hs-identifier">var_names</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036004"><span class="hs-identifier hs-var">rdrs</span></a><span>
</span><a name="line-866"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621680036006"><span class="hs-identifier hs-var">var_names</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-867"></a><span>         </span><a href="#local-6989586621680036005"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><a href="#local-6989586621680036006"><span class="hs-identifier hs-var">var_names</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-870"></a><span class="hs-identifier">bindHsQTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621680035621"><a href="#local-6989586621680035621"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621680035622"><a href="#local-6989586621680035622"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-871"></a><span>                 </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-872"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>         </span><span class="hs-comment">-- Just d =&gt; check for unused tvs</span><span>
</span><a name="line-873"></a><span>                                    </span><span class="hs-comment">--   d is a phrase like &quot;in the type ...&quot;</span><span>
</span><a name="line-874"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621680035621"><span class="hs-identifier hs-type">a</span></a><span>            </span><span class="hs-comment">-- Just _  =&gt; an associated type decl</span><span>
</span><a name="line-875"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Kind variables from scope, no dups</span><span>
</span><a name="line-876"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-877"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsQTyVars"><span class="hs-identifier hs-type">LHsQTyVars</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035622"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-878"></a><span>                  </span><span class="hs-comment">-- The Bool is True &lt;=&gt; all kind variables used in the</span><span>
</span><a name="line-879"></a><span>                  </span><span class="hs-comment">-- kind signature are bound on the left.  Reason:</span><span>
</span><a name="line-880"></a><span>                  </span><span class="hs-comment">-- the TypeInType clause of Note [Complete user-supplied</span><span>
</span><a name="line-881"></a><span>                  </span><span class="hs-comment">-- kind signatures] in HsDecls</span><span>
</span><a name="line-882"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035622"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-883"></a><span>
</span><a name="line-884"></a><span class="hs-comment">-- See Note [bindHsQTyVars examples]</span><span>
</span><a name="line-885"></a><span class="hs-comment">-- (a) Bring kind variables into scope</span><span>
</span><a name="line-886"></a><span class="hs-comment">--     both (i)  passed in body_kv_occs</span><span>
</span><a name="line-887"></a><span class="hs-comment">--     and  (ii) mentioned in the kinds of hsq_bndrs</span><span>
</span><a name="line-888"></a><span class="hs-comment">-- (b) Bring type variables into scope</span><span>
</span><a name="line-889"></a><span class="hs-comment">--</span><span>
</span><a name="line-890"></a><a name="bindHsQTyVars"><a href="RnTypes.html#bindHsQTyVars"><span class="hs-identifier">bindHsQTyVars</span></a></a><span> </span><a name="local-6989586621680036007"><a href="#local-6989586621680036007"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680036008"><a href="#local-6989586621680036008"><span class="hs-identifier">mb_in_doc</span></a></a><span> </span><a name="local-6989586621680036009"><a href="#local-6989586621680036009"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><a name="local-6989586621680036010"><a href="#local-6989586621680036010"><span class="hs-identifier">body_kv_occs</span></a></a><span> </span><a name="local-6989586621680036011"><a href="#local-6989586621680036011"><span class="hs-identifier">hsq_bndrs</span></a></a><span> </span><a name="local-6989586621680036012"><a href="#local-6989586621680036012"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-891"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680036020"><a href="#local-6989586621680036020"><span class="hs-identifier">hs_tv_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#hsQTvExplicit"><span class="hs-identifier hs-var">hsQTvExplicit</span></a><span> </span><a href="#local-6989586621680036011"><span class="hs-identifier hs-var">hsq_bndrs</span></a><span>
</span><a name="line-892"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680036021"><a href="#local-6989586621680036021"><span class="hs-identifier">bndr_kv_occs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extractHsTyVarBndrsKVs"><span class="hs-identifier hs-var">extractHsTyVarBndrsKVs</span></a><span> </span><a href="#local-6989586621680036020"><span class="hs-identifier hs-var">hs_tv_bndrs</span></a><span>
</span><a name="line-893"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680036022"><a href="#local-6989586621680036022"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-894"></a><span>
</span><a name="line-895"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- See Note [bindHsQTyVars examples] for what</span><span>
</span><a name="line-896"></a><span>             </span><span class="hs-comment">-- all these various things are doing</span><span>
</span><a name="line-897"></a><span>             </span><span class="hs-identifier">bndrs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">kv_occs</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">implicit_kvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-898"></a><span>             </span><a name="local-6989586621680036023"><a href="#local-6989586621680036023"><span class="hs-identifier">bndrs</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsTypes.html#hsLTyVarLocName"><span class="hs-identifier hs-var">hsLTyVarLocName</span></a><span> </span><a href="#local-6989586621680036020"><span class="hs-identifier hs-var">hs_tv_bndrs</span></a><span>
</span><a name="line-899"></a><span>             </span><a name="local-6989586621680036024"><a href="#local-6989586621680036024"><span class="hs-identifier">kv_occs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036010"><span class="hs-identifier hs-var">body_kv_occs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680036021"><span class="hs-identifier hs-var">bndr_kv_occs</span></a><span class="hs-special">)</span><span>
</span><a name="line-900"></a><span>             </span><a name="local-6989586621680036025"><a href="#local-6989586621680036025"><span class="hs-identifier">implicit_kvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036013"><span class="hs-identifier hs-var">filter_occs</span></a><span> </span><a href="#local-6989586621680036022"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-6989586621680036023"><span class="hs-identifier hs-var">bndrs</span></a><span> </span><a href="#local-6989586621680036024"><span class="hs-identifier hs-var">kv_occs</span></a><span>
</span><a name="line-901"></a><span>                                 </span><span class="hs-comment">-- Deleting bndrs: See Note [Kind-variable ordering]</span><span>
</span><a name="line-902"></a><span>             </span><span class="hs-comment">-- dep_bndrs is the subset of bndrs that are dependent</span><span>
</span><a name="line-903"></a><span>             </span><span class="hs-comment">--   i.e. appear in bndr/body_kv_occs</span><span>
</span><a name="line-904"></a><span>             </span><span class="hs-comment">-- Can't use implicit_kvs because we've deleted bndrs from that!</span><span>
</span><a name="line-905"></a><span>             </span><a name="local-6989586621680036026"><a href="#local-6989586621680036026"><span class="hs-identifier">dep_bndrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="RnTypes.html#elemRdr"><span class="hs-identifier hs-var">elemRdr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036024"><span class="hs-identifier hs-var">kv_occs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036023"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-906"></a><span>             </span><a name="local-6989586621680036027"><a href="#local-6989586621680036027"><span class="hs-identifier">del</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="ListSetOps.html#deleteBys"><span class="hs-identifier hs-var">deleteBys</span></a><span> </span><a href="SrcLoc.html#eqLocated"><span class="hs-identifier hs-var">eqLocated</span></a><span>
</span><a name="line-907"></a><span>             </span><a name="local-6989586621680036028"><a href="#local-6989586621680036028"><span class="hs-identifier">all_bound_on_lhs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621680036010"><span class="hs-identifier hs-var">body_kv_occs</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621680036027"><span class="hs-identifier hs-var">del</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036023"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621680036027"><span class="hs-identifier hs-var">del</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036021"><span class="hs-identifier hs-var">bndr_kv_occs</span></a><span class="hs-special">)</span><span>
</span><a name="line-908"></a><span>
</span><a name="line-909"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;checkMixedVars3&quot;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-910"></a><span>           </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kv_occs&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036024"><span class="hs-identifier hs-var">kv_occs</span></a><span>
</span><a name="line-911"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bndrs&quot;</span><span>   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036020"><span class="hs-identifier hs-var">hs_tv_bndrs</span></a><span>
</span><a name="line-912"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;bndr_kv_occs&quot;</span><span>   </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036021"><span class="hs-identifier hs-var">bndr_kv_occs</span></a><span>
</span><a name="line-913"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;wubble&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621680036024"><span class="hs-identifier hs-var">kv_occs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span> </span><a href="#local-6989586621680036023"><span class="hs-identifier hs-var">bndrs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span> </span><a href="#local-6989586621680036021"><span class="hs-identifier hs-var">bndr_kv_occs</span></a><span class="hs-special">)</span><span>
</span><a name="line-914"></a><span>                </span><span class="hs-special">]</span><span>
</span><a name="line-915"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkBadKindBndrs"><span class="hs-identifier hs-var">checkBadKindBndrs</span></a><span> </span><a href="#local-6989586621680036007"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621680036025"><span class="hs-identifier hs-var">implicit_kvs</span></a><span>
</span><a name="line-916"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkMixedVars"><span class="hs-identifier hs-var">checkMixedVars</span></a><span> </span><a href="#local-6989586621680036024"><span class="hs-identifier hs-var">kv_occs</span></a><span> </span><a href="#local-6989586621680036023"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-917"></a><span>
</span><a name="line-918"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680036029"><a href="#local-6989586621680036029"><span class="hs-identifier">implicit_kv_nms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="#local-6989586621680036009"><span class="hs-identifier hs-var">mb_assoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036025"><span class="hs-identifier hs-var">implicit_kvs</span></a><span>
</span><a name="line-919"></a><span>
</span><a name="line-920"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><a href="#local-6989586621680036029"><span class="hs-identifier hs-var">implicit_kv_nms</span></a><span>                     </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-921"></a><span>         </span><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier hs-var">bindLHsTyVarBndrs</span></a><span> </span><a href="#local-6989586621680036007"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621680036008"><span class="hs-identifier hs-var">mb_in_doc</span></a><span> </span><a href="#local-6989586621680036009"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621680036020"><span class="hs-identifier hs-var">hs_tv_bndrs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680036030"><a href="#local-6989586621680036030"><span class="hs-identifier">rn_bndrs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-922"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;bindHsQTyVars&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036011"><span class="hs-identifier hs-var">hsq_bndrs</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036029"><span class="hs-identifier hs-var">implicit_kv_nms</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036030"><span class="hs-identifier hs-var">rn_bndrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-923"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680036031"><a href="#local-6989586621680036031"><span class="hs-identifier">dep_bndr_nms</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><span class="hs-special">(</span><a href="RnEnv.html#lookupLocalOccRn"><span class="hs-identifier hs-var">lookupLocalOccRn</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036026"><span class="hs-identifier hs-var">dep_bndrs</span></a><span>
</span><a name="line-924"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621680036012"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsQTvs"><span class="hs-identifier hs-var">HsQTvs</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hsq_implicit</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036029"><span class="hs-identifier hs-var">implicit_kv_nms</span></a><span>
</span><a name="line-925"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_explicit</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036030"><span class="hs-identifier hs-var">rn_bndrs</span></a><span>
</span><a name="line-926"></a><span>                              </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hsq_dependent</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="NameSet.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a><span> </span><a href="#local-6989586621680036031"><span class="hs-identifier hs-var">dep_bndr_nms</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-927"></a><span>                      </span><a href="#local-6989586621680036028"><span class="hs-identifier hs-var">all_bound_on_lhs</span></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-928"></a><span>
</span><a name="line-929"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-930"></a><span>    </span><span class="hs-identifier">filter_occs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span>         </span><span class="hs-comment">-- In scope</span><span>
</span><a name="line-931"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Bound here</span><span>
</span><a name="line-932"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Potential implicit binders</span><span>
</span><a name="line-933"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- Final implicit binders</span><span>
</span><a name="line-934"></a><span>    </span><span class="hs-comment">-- Filter out any potential implicit binders that are either</span><span>
</span><a name="line-935"></a><span>    </span><span class="hs-comment">-- already in scope, or are explicitly bound here</span><span>
</span><a name="line-936"></a><span>    </span><a name="local-6989586621680036013"><a href="#local-6989586621680036013"><span class="hs-identifier">filter_occs</span></a></a><span> </span><a name="local-6989586621680036014"><a href="#local-6989586621680036014"><span class="hs-identifier">rdr_env</span></a></a><span> </span><a name="local-6989586621680036015"><a href="#local-6989586621680036015"><span class="hs-identifier">bndrs</span></a></a><span> </span><a name="local-6989586621680036016"><a href="#local-6989586621680036016"><span class="hs-identifier">occs</span></a></a><span>
</span><a name="line-937"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="#local-6989586621680036017"><span class="hs-identifier hs-var">is_in_scope</span></a><span> </span><a href="#local-6989586621680036016"><span class="hs-identifier hs-var">occs</span></a><span>
</span><a name="line-938"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-939"></a><span>        </span><a name="local-6989586621680036017"><a href="#local-6989586621680036017"><span class="hs-identifier">is_in_scope</span></a></a><span> </span><a name="local-6989586621680036018"><a href="#local-6989586621680036018"><span class="hs-identifier">locc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036019"><a href="#local-6989586621680036019"><span class="hs-identifier">occ</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><span class="hs-special">(</span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-6989586621680036014"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-6989586621680036019"><span class="hs-identifier hs-var">occ</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><span>                                  </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621680036018"><span class="hs-identifier hs-var">locc</span></a><span> </span><span class="hs-special">`</span><a href="RnTypes.html#elemRdr"><span class="hs-identifier hs-var">elemRdr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036015"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-941"></a><span>
</span><a name="line-942"></a><span class="hs-comment">{- Note [bindHsQTyVars examples]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Suppose we have
   data T k (a::k1) (b::k) :: k2 -&gt; k1 -&gt; *

Then:
  hs_tv_bndrs = [k, a::k1, b::k], the explicitly-bound variables
  bndrs       = [k,a,b]

  bndr_kv_occs = [k,k1], kind variables free in kind signatures
                         of hs_tv_bndrs

  body_kv_occs = [k2,k1], kind variables free in the
                          result kind signature

  implicit_kvs = [k1,k2], kind variables free in kind signatures
                          of hs_tv_bndrs, and not bound by bndrs

* We want to quantify add implicit bindings for implicit_kvs

* The &quot;dependent&quot; bndrs (hsq_dependent) are the subset of
  bndrs that are free in bndr_kv_occs or body_kv_occs

* If implicit_body_kvs is non-empty, then there is a kind variable
  mentioned in the kind signature that is not bound &quot;on the left&quot;.
  That's one of the rules for a CUSK, so we pass that info on
  as the second argument to thing_inside.

* Order is not important in these lists.  All we are doing is
  bring Names into scope.

Finally, you may wonder why filter_occs removes in-scope variables
from bndr/body_kv_occs.  How can anything be in scope?  Answer:
HsQTyVars is /also/ used (slightly oddly) for Haskell-98 syntax
ConDecls
   data T a = forall (b::k). MkT a b
The ConDecl has a LHsQTyVars in it; but 'a' scopes over the entire
ConDecl.  Hence the local RdrEnv may be non-empty and we must filter
out 'a' from the free vars.  (Mind you, in this situation all the
implicit kind variables are bound at the data type level, so there
are none to bind in the ConDecl, so there are no implicitly bound
variables at all.

Note [Kind variable scoping]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
If we have
  data T (a :: k) k = ...
we report &quot;k is out of scope&quot; for (a::k).  Reason: k is not brought
into scope until the explicit k-binding that follows.  It would be
terribly confusing to bring into scope an /implicit/ k for a's kind
and a distinct, shadowing explicit k that follows, something like
  data T {k1} (a :: k1) k = ...

So the rule is:

   the implicit binders never include any
   of the explicit binders in the group

Note that in the denerate case
  data T (a :: a) = blah
we get a complaint the second 'a' is not in scope.

That applies to foralls too: e.g.
   forall (a :: k) k . blah

But if the foralls are split, we treat the two groups separately:
   forall (a :: k). forall k. blah
Here we bring into scope an implicit k, which is later shadowed
by the explicit k.

In implementation terms

* In bindHsQTyVars 'k' is free in bndr_kv_occs; then we delete
  the binders {a,k}, and so end with no implicit binders.  Then we
  rename the binders left-to-right, and hence see that 'k' is out of
  scope in the kind of 'a'.

* Similarly in extract_hs_tv_bndrs
-}</span><span>
</span><a name="line-1021"></a><span>
</span><a name="line-1022"></a><span class="hs-identifier">bindLHsTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-1023"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>            </span><span class="hs-comment">-- Just d =&gt; check for unused tvs</span><span>
</span><a name="line-1024"></a><span>                                           </span><span class="hs-comment">--   d is a phrase like &quot;in the type ...&quot;</span><span>
</span><a name="line-1025"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621680035619"><span class="hs-identifier hs-type">a</span></a><span>               </span><span class="hs-comment">-- Just _  =&gt; an associated type decl</span><span>
</span><a name="line-1026"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- User-written tyvars</span><span>
</span><a name="line-1027"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035620"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1028"></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035620"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1029"></a><a name="bindLHsTyVarBndrs"><a href="RnTypes.html#bindLHsTyVarBndrs"><span class="hs-identifier">bindLHsTyVarBndrs</span></a></a><span> </span><a name="local-6989586621680036032"><a href="#local-6989586621680036032"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680036033"><a href="#local-6989586621680036033"><span class="hs-identifier">mb_in_doc</span></a></a><span> </span><a name="local-6989586621680036034"><a href="#local-6989586621680036034"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><a name="local-6989586621680036035"><a href="#local-6989586621680036035"><span class="hs-identifier">tv_bndrs</span></a></a><span> </span><a name="local-6989586621680036036"><a href="#local-6989586621680036036"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-1030"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a><span> </span><a href="#local-6989586621680036034"><span class="hs-identifier hs-var">mb_assoc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnUtils.html#checkShadowedRdrNames"><span class="hs-identifier hs-var">checkShadowedRdrNames</span></a><span> </span><a href="#local-6989586621680036037"><span class="hs-identifier hs-var">tv_names_w_loc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1031"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnUtils.html#checkDupRdrNames"><span class="hs-identifier hs-var">checkDupRdrNames</span></a><span> </span><a href="#local-6989586621680036037"><span class="hs-identifier hs-var">tv_names_w_loc</span></a><span>
</span><a name="line-1032"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621680036038"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036035"><span class="hs-identifier hs-var">tv_bndrs</span></a><span> </span><a href="#local-6989586621680036036"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1033"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1034"></a><span>    </span><a name="local-6989586621680036037"><a href="#local-6989586621680036037"><span class="hs-identifier">tv_names_w_loc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsTypes.html#hsLTyVarLocName"><span class="hs-identifier hs-var">hsLTyVarLocName</span></a><span> </span><a href="#local-6989586621680036035"><span class="hs-identifier hs-var">tv_bndrs</span></a><span>
</span><a name="line-1035"></a><span>
</span><a name="line-1036"></a><span>    </span><a name="local-6989586621680036038"><a href="#local-6989586621680036038"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-6989586621680036040"><a href="#local-6989586621680036040"><span class="hs-identifier">thing_inside</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036040"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1037"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680036041"><a href="#local-6989586621680036041"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621680036042"><a href="#local-6989586621680036042"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680036043"><a href="#local-6989586621680036043"><span class="hs-identifier">thing_inside</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#bindLHsTyVarBndr"><span class="hs-identifier hs-var">bindLHsTyVarBndr</span></a><span> </span><a href="#local-6989586621680036032"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621680036034"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621680036041"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680036044"><a href="#local-6989586621680036044"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1038"></a><span>                             </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680036046"><a href="#local-6989586621680036046"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036047"><a href="#local-6989586621680036047"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680036038"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036042"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621680036045"><a href="#local-6989586621680036045"><span class="hs-identifier">bs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1039"></a><span>                                                </span><a href="#local-6989586621680036043"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036044"><span class="hs-identifier hs-var">b'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680036045"><span class="hs-identifier hs-var">bs'</span></a><span class="hs-special">)</span><span>
</span><a name="line-1040"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="#local-6989586621680036039"><span class="hs-identifier hs-var">warn_unused</span></a><span> </span><a href="#local-6989586621680036044"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621680036047"><span class="hs-identifier hs-var">fvs</span></a><span>
</span><a name="line-1041"></a><span>                                </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036046"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036047"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1042"></a><span>
</span><a name="line-1043"></a><span>    </span><a name="local-6989586621680036039"><a href="#local-6989586621680036039"><span class="hs-identifier">warn_unused</span></a></a><span> </span><a name="local-6989586621680036048"><a href="#local-6989586621680036048"><span class="hs-identifier">tv_bndr</span></a></a><span> </span><a name="local-6989586621680036049"><a href="#local-6989586621680036049"><span class="hs-identifier">fvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680036033"><span class="hs-identifier hs-var">mb_in_doc</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1044"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680036050"><a href="#local-6989586621680036050"><span class="hs-identifier">in_doc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#warnUnusedForAll"><span class="hs-identifier hs-var">warnUnusedForAll</span></a><span> </span><a href="#local-6989586621680036050"><span class="hs-identifier hs-var">in_doc</span></a><span> </span><a href="#local-6989586621680036048"><span class="hs-identifier hs-var">tv_bndr</span></a><span> </span><a href="#local-6989586621680036049"><span class="hs-identifier hs-var">fvs</span></a><span>
</span><a name="line-1045"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1046"></a><span>
</span><a name="line-1047"></a><span class="hs-identifier">bindLHsTyVarBndr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span>
</span><a name="line-1048"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621680035617"><span class="hs-identifier hs-type">a</span></a><span>   </span><span class="hs-comment">-- associated class</span><span>
</span><a name="line-1049"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1050"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035618"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1051"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035618"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1052"></a><a name="bindLHsTyVarBndr"><a href="RnTypes.html#bindLHsTyVarBndr"><span class="hs-identifier">bindLHsTyVarBndr</span></a></a><span> </span><a name="local-6989586621680036051"><a href="#local-6989586621680036051"><span class="hs-identifier">_doc</span></a></a><span> </span><a name="local-6989586621680036052"><a href="#local-6989586621680036052"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036053"><a href="#local-6989586621680036053"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><a name="local-6989586621680036054"><a href="#local-6989586621680036054"><span class="hs-identifier">lrdr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036055"><a href="#local-6989586621680036055"><span class="hs-identifier">lv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036056"><a href="#local-6989586621680036056"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-1053"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036057"><a href="#local-6989586621680036057"><span class="hs-identifier">nm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="#local-6989586621680036052"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621680036054"><span class="hs-identifier hs-var">lrdr</span></a><span>
</span><a name="line-1054"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680036057"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1055"></a><span>         </span><a href="#local-6989586621680036056"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036053"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036055"><span class="hs-identifier hs-var">lv</span></a><span> </span><a href="#local-6989586621680036057"><span class="hs-identifier hs-var">nm</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1056"></a><span>
</span><a name="line-1057"></a><span class="hs-identifier">bindLHsTyVarBndr</span><span> </span><a name="local-6989586621680036058"><a href="#local-6989586621680036058"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680036059"><a href="#local-6989586621680036059"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036060"><a href="#local-6989586621680036060"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><a name="local-6989586621680036061"><a href="#local-6989586621680036061"><span class="hs-identifier">lrdr</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036062"><a href="#local-6989586621680036062"><span class="hs-identifier">lv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036063"><a href="#local-6989586621680036063"><span class="hs-identifier">kind</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036064"><a href="#local-6989586621680036064"><span class="hs-identifier">thing_inside</span></a></a><span>
</span><a name="line-1058"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036065"><a href="#local-6989586621680036065"><span class="hs-identifier">sig_ok</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#KindSignatures"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">KindSignatures</span></a><span>
</span><a name="line-1059"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680036065"><span class="hs-identifier hs-var">sig_ok</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#badKindSigErr"><span class="hs-identifier hs-var">badKindSigErr</span></a><span> </span><a href="#local-6989586621680036058"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621680036063"><span class="hs-identifier hs-var">kind</span></a><span class="hs-special">)</span><span>
</span><a name="line-1060"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680036066"><a href="#local-6989586621680036066"><span class="hs-identifier">kind'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036067"><a href="#local-6989586621680036067"><span class="hs-identifier">fvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsKind"><span class="hs-identifier hs-var">rnLHsKind</span></a><span> </span><a href="#local-6989586621680036058"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="#local-6989586621680036063"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-1061"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680036068"><a href="#local-6989586621680036068"><span class="hs-identifier">tv_nm</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier hs-var">newTyVarNameRn</span></a><span> </span><a href="#local-6989586621680036059"><span class="hs-identifier hs-var">mb_assoc</span></a><span> </span><a href="#local-6989586621680036061"><span class="hs-identifier hs-var">lrdr</span></a><span>
</span><a name="line-1062"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680036069"><a href="#local-6989586621680036069"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036070"><a href="#local-6989586621680036070"><span class="hs-identifier">fvs2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnUtils.html#bindLocalNamesFV"><span class="hs-identifier hs-var">bindLocalNamesFV</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621680036068"><span class="hs-identifier hs-var">tv_nm</span></a><span class="hs-special">]</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1063"></a><span>                          </span><a href="#local-6989586621680036064"><span class="hs-identifier hs-var">thing_inside</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036060"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036062"><span class="hs-identifier hs-var">lv</span></a><span> </span><a href="#local-6989586621680036068"><span class="hs-identifier hs-var">tv_nm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036066"><span class="hs-identifier hs-var">kind'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1064"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036069"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036067"><span class="hs-identifier hs-var">fvs1</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#plusFV"><span class="hs-identifier hs-var">plusFV</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036070"><span class="hs-identifier hs-var">fvs2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1065"></a><span>
</span><a name="line-1066"></a><span class="hs-identifier">newTyVarNameRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621680035616"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-1067"></a><a name="newTyVarNameRn"><a href="RnTypes.html#newTyVarNameRn"><span class="hs-identifier">newTyVarNameRn</span></a></a><span> </span><a name="local-6989586621680036071"><a href="#local-6989586621680036071"><span class="hs-identifier">mb_assoc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036072"><a href="#local-6989586621680036072"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680036073"><a href="#local-6989586621680036073"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1068"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036074"><a href="#local-6989586621680036074"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#getLocalRdrEnv"><span class="hs-identifier hs-var">getLocalRdrEnv</span></a><span>
</span><a name="line-1069"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036071"><span class="hs-identifier hs-var">mb_assoc</span></a><span class="hs-special">,</span><span> </span><a href="RdrName.html#lookupLocalRdrEnv"><span class="hs-identifier hs-var">lookupLocalRdrEnv</span></a><span> </span><a href="#local-6989586621680036074"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="#local-6989586621680036073"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1070"></a><span>           </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680036075"><a href="#local-6989586621680036075"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036075"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1071"></a><span>              </span><span class="hs-comment">-- Use the same Name as the parent class decl</span><span>
</span><a name="line-1072"></a><span>
</span><a name="line-1073"></a><span>           </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnUtils.html#newLocalBndrRn"><span class="hs-identifier hs-var">newLocalBndrRn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036072"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680036073"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1074"></a><span>
</span><a name="line-1075"></a><span class="hs-comment">---------------------</span><span>
</span><a name="line-1076"></a><span class="hs-identifier">collectAnonWildCards</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1077"></a><span class="hs-comment">-- | Extract all wild cards from a type.</span><span>
</span><a name="line-1078"></a><a name="collectAnonWildCards"><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier">collectAnonWildCards</span></a></a><span> </span><a name="local-6989586621680036076"><a href="#local-6989586621680036076"><span class="hs-identifier">lty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036076"><span class="hs-identifier hs-var">lty</span></a><span>
</span><a name="line-1079"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1080"></a><span>    </span><a name="local-6989586621680036077"><a href="#local-6989586621680036077"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036080"><a href="#local-6989586621680036080"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680036080"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1081"></a><span>      </span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AnonWildCard"><span class="hs-identifier hs-var">AnonWildCard</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036081"><a href="#local-6989586621680036081"><span class="hs-identifier">wc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680036081"><span class="hs-identifier hs-var">wc</span></a><span class="hs-special">]</span><span>
</span><a name="line-1082"></a><span>      </span><a href="HsTypes.html#HsAppsTy"><span class="hs-identifier hs-var">HsAppsTy</span></a><span> </span><a name="local-6989586621680036082"><a href="#local-6989586621680036082"><span class="hs-identifier">tys</span></a></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036078"><span class="hs-identifier hs-var">gos</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036079"><span class="hs-identifier hs-var">prefix_types_only</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036082"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1083"></a><span>      </span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a name="local-6989586621680036083"><a href="#local-6989586621680036083"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036084"><a href="#local-6989586621680036084"><span class="hs-identifier">ty2</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036083"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036084"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1084"></a><span>      </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621680036085"><a href="#local-6989586621680036085"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036086"><a href="#local-6989586621680036086"><span class="hs-identifier">ty2</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036085"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036086"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1085"></a><span>      </span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a name="local-6989586621680036087"><a href="#local-6989586621680036087"><span class="hs-identifier">ty</span></a></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036087"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1086"></a><span>      </span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a name="local-6989586621680036088"><a href="#local-6989586621680036088"><span class="hs-identifier">ty</span></a></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036088"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1087"></a><span>      </span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036089"><a href="#local-6989586621680036089"><span class="hs-identifier">tys</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036078"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621680036089"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1088"></a><span>      </span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a name="local-6989586621680036090"><a href="#local-6989586621680036090"><span class="hs-identifier">tys</span></a></a><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036078"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621680036090"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1089"></a><span>      </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621680036091"><a href="#local-6989586621680036091"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036092"><a href="#local-6989586621680036092"><span class="hs-identifier">ty2</span></a></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036091"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036092"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1090"></a><span>      </span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a name="local-6989586621680036093"><a href="#local-6989586621680036093"><span class="hs-identifier">ty</span></a></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036093"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1091"></a><span>      </span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036094"><a href="#local-6989586621680036094"><span class="hs-identifier">ty</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036094"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1092"></a><span>      </span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a name="local-6989586621680036095"><a href="#local-6989586621680036095"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036096"><a href="#local-6989586621680036096"><span class="hs-identifier">ty2</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036095"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036096"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1093"></a><span>      </span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a name="local-6989586621680036097"><a href="#local-6989586621680036097"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680036098"><a href="#local-6989586621680036098"><span class="hs-identifier">kind</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036097"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036098"><span class="hs-identifier hs-var">kind</span></a><span>
</span><a name="line-1094"></a><span>      </span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a name="local-6989586621680036099"><a href="#local-6989586621680036099"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036099"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1095"></a><span>      </span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036100"><a href="#local-6989586621680036100"><span class="hs-identifier">ty</span></a></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036100"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1096"></a><span>      </span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621680036101"><a href="#local-6989586621680036101"><span class="hs-identifier">flds</span></a></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036078"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">cd_fld_type</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036101"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1097"></a><span>      </span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036102"><a href="#local-6989586621680036102"><span class="hs-identifier">tys</span></a></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036078"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621680036102"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1098"></a><span>      </span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036103"><a href="#local-6989586621680036103"><span class="hs-identifier">tys</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036078"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621680036103"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1099"></a><span>      </span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036104"><a href="#local-6989586621680036104"><span class="hs-identifier">bndrs</span></a></a><span>
</span><a name="line-1100"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036105"><a href="#local-6989586621680036105"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#collectAnonWildCardsBndrs"><span class="hs-identifier hs-var">collectAnonWildCardsBndrs</span></a><span> </span><a href="#local-6989586621680036104"><span class="hs-identifier hs-var">bndrs</span></a><span>
</span><a name="line-1101"></a><span>                                      </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036105"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1102"></a><span>      </span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036106"><a href="#local-6989586621680036106"><span class="hs-identifier">ctxt</span></a></a><span>
</span><a name="line-1103"></a><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036107"><a href="#local-6989586621680036107"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036078"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621680036106"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621680036107"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1104"></a><span>      </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSpliced"><span class="hs-identifier hs-var">HsSpliced</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsSplicedTy"><span class="hs-identifier hs-var">HsSplicedTy</span></a><span> </span><a name="local-6989586621680036108"><a href="#local-6989586621680036108"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a><span> </span><a href="#local-6989586621680036108"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1105"></a><span>      </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1106"></a><span>      </span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1107"></a><span>      </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1108"></a><span>      </span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-1109"></a><span>
</span><a name="line-1110"></a><span>    </span><a name="local-6989586621680036078"><a href="#local-6989586621680036078"><span class="hs-identifier">gos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621680036077"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-1111"></a><span>
</span><a name="line-1112"></a><span>    </span><a name="local-6989586621680036079"><a href="#local-6989586621680036079"><span class="hs-identifier">prefix_types_only</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppPrefix"><span class="hs-identifier hs-var">HsAppPrefix</span></a><span> </span><a name="local-6989586621680036109"><a href="#local-6989586621680036109"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621680036109"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1113"></a><span>    </span><span class="hs-identifier">prefix_types_only</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppInfix"><span class="hs-identifier hs-var">HsAppInfix</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1114"></a><span>
</span><a name="line-1115"></a><span class="hs-identifier">collectAnonWildCardsBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span>
</span><a name="line-1116"></a><a name="collectAnonWildCardsBndrs"><a href="RnTypes.html#collectAnonWildCardsBndrs"><span class="hs-identifier">collectAnonWildCardsBndrs</span></a></a><span> </span><a name="local-6989586621680036110"><a href="#local-6989586621680036110"><span class="hs-identifier">ltvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036111"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036110"><span class="hs-identifier hs-var">ltvs</span></a><span>
</span><a name="line-1117"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1118"></a><span>    </span><a name="local-6989586621680036111"><a href="#local-6989586621680036111"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#UserTyVar"><span class="hs-identifier hs-var">UserTyVar</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1119"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036112"><a href="#local-6989586621680036112"><span class="hs-identifier">ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#collectAnonWildCards"><span class="hs-identifier hs-var">collectAnonWildCards</span></a><span> </span><a href="#local-6989586621680036112"><span class="hs-identifier hs-var">ki</span></a><span>
</span><a name="line-1120"></a><span>
</span><a name="line-1121"></a><span class="hs-comment">{-
*********************************************************
*                                                       *
        ConDeclField
*                                                       *
*********************************************************

When renaming a ConDeclField, we have to find the FieldLabel
associated with each field.  But we already have all the FieldLabels
available (since they were brought into scope by
RnNames.getLocalNonValBinders), so we just take the list as an
argument, build a map and look them up.
-}</span><span>
</span><a name="line-1134"></a><span>
</span><a name="line-1135"></a><span class="hs-identifier">rnConDeclFields</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1136"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1137"></a><span class="hs-comment">-- Also called from RnSource</span><span>
</span><a name="line-1138"></a><span class="hs-comment">-- No wildcards can appear in record fields</span><span>
</span><a name="line-1139"></a><a name="rnConDeclFields"><a href="RnTypes.html#rnConDeclFields"><span class="hs-identifier">rnConDeclFields</span></a></a><span> </span><a name="local-6989586621680036113"><a href="#local-6989586621680036113"><span class="hs-identifier">ctxt</span></a></a><span> </span><a name="local-6989586621680036114"><a href="#local-6989586621680036114"><span class="hs-identifier">fls</span></a></a><span> </span><a name="local-6989586621680036115"><a href="#local-6989586621680036115"><span class="hs-identifier">fields</span></a></a><span>
</span><a name="line-1140"></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="RnUtils.html#mapFvRn"><span class="hs-identifier hs-var">mapFvRn</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#rnField"><span class="hs-identifier hs-var">rnField</span></a><span> </span><a href="#local-6989586621680036117"><span class="hs-identifier hs-var">fl_env</span></a><span> </span><a href="#local-6989586621680036116"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036115"><span class="hs-identifier hs-var">fields</span></a><span>
</span><a name="line-1141"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1142"></a><span>    </span><a name="local-6989586621680036116"><a href="#local-6989586621680036116"><span class="hs-identifier">env</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#mkTyKiEnv"><span class="hs-identifier hs-var">mkTyKiEnv</span></a><span> </span><a href="#local-6989586621680036113"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="RnTypes.html#RnTypeBody"><span class="hs-identifier hs-var">RnTypeBody</span></a><span>
</span><a name="line-1143"></a><span>    </span><a name="local-6989586621680036117"><a href="#local-6989586621680036117"><span class="hs-identifier">fl_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="FastStringEnv.html#mkFsEnv"><span class="hs-identifier hs-var">mkFsEnv</span></a><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">flLabel</span><span> </span><a href="#local-6989586621680036118"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036118"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621680036118"><a href="#local-6989586621680036118"><span class="hs-identifier">fl</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680036114"><span class="hs-identifier hs-var">fls</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1144"></a><span>
</span><a name="line-1145"></a><span class="hs-identifier">rnField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastStringEnv.html#FastStringEnv"><span class="hs-identifier hs-type">FastStringEnv</span></a><span> </span><a href="FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1146"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LConDeclField"><span class="hs-identifier hs-type">LConDeclField</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">,</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1147"></a><a name="rnField"><a href="RnTypes.html#rnField"><span class="hs-identifier">rnField</span></a></a><span> </span><a name="local-6989586621680036119"><a href="#local-6989586621680036119"><span class="hs-identifier">fl_env</span></a></a><span> </span><a name="local-6989586621680036120"><a href="#local-6989586621680036120"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036121"><a href="#local-6989586621680036121"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#ConDeclField"><span class="hs-identifier hs-var">ConDeclField</span></a><span> </span><a name="local-6989586621680036122"><a href="#local-6989586621680036122"><span class="hs-identifier">names</span></a></a><span> </span><a name="local-6989586621680036123"><a href="#local-6989586621680036123"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680036124"><a href="#local-6989586621680036124"><span class="hs-identifier">haddock_doc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1148"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621680036130"><a href="#local-6989586621680036130"><span class="hs-identifier">new_names</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="#local-6989586621680036125"><span class="hs-identifier hs-var">lookupField</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036122"><span class="hs-identifier hs-var">names</span></a><span>
</span><a name="line-1149"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680036131"><a href="#local-6989586621680036131"><span class="hs-identifier">new_ty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036132"><a href="#local-6989586621680036132"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#rnLHsTyKi"><span class="hs-identifier hs-var">rnLHsTyKi</span></a><span> </span><a href="#local-6989586621680036120"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621680036123"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1150"></a><span>       </span><span class="hs-special">;</span><span> </span><a name="local-6989586621680036133"><a href="#local-6989586621680036133"><span class="hs-identifier">new_haddock_doc</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnHsDoc.html#rnMbLHsDoc"><span class="hs-identifier hs-var">rnMbLHsDoc</span></a><span> </span><a href="#local-6989586621680036124"><span class="hs-identifier hs-var">haddock_doc</span></a><span>
</span><a name="line-1151"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036121"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#ConDeclField"><span class="hs-identifier hs-var">ConDeclField</span></a><span> </span><a href="#local-6989586621680036130"><span class="hs-identifier hs-var">new_names</span></a><span> </span><a href="#local-6989586621680036131"><span class="hs-identifier hs-var">new_ty</span></a><span> </span><a href="#local-6989586621680036133"><span class="hs-identifier hs-var">new_haddock_doc</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036132"><span class="hs-identifier hs-var">fvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1152"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1153"></a><span>    </span><span class="hs-identifier">lookupField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-1154"></a><span>    </span><a name="local-6989586621680036125"><a href="#local-6989586621680036125"><span class="hs-identifier">lookupField</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036126"><a href="#local-6989586621680036126"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-6989586621680036127"><a href="#local-6989586621680036127"><span class="hs-identifier">rdr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="HsTypes.html#FieldOcc"><span class="hs-identifier hs-var">FieldOcc</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036126"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="#local-6989586621680036127"><span class="hs-identifier hs-var">rdr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">flSelector</span><span> </span><a href="#local-6989586621680036129"><span class="hs-identifier hs-var">fl</span></a><span class="hs-special">)</span><span>
</span><a name="line-1155"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1156"></a><span>        </span><a name="local-6989586621680036128"><a href="#local-6989586621680036128"><span class="hs-identifier">lbl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">occNameFS</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="RdrName.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a><span> </span><a href="#local-6989586621680036127"><span class="hs-identifier hs-var">rdr</span></a><span>
</span><a name="line-1157"></a><span>        </span><a name="local-6989586621680036129"><a href="#local-6989586621680036129"><span class="hs-identifier">fl</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Maybes.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a><span> </span><span class="hs-string">&quot;rnField&quot;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="FastStringEnv.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a><span> </span><a href="#local-6989586621680036119"><span class="hs-identifier hs-var">fl_env</span></a><span> </span><a href="#local-6989586621680036128"><span class="hs-identifier hs-var">lbl</span></a><span>
</span><a name="line-1158"></a><span>
</span><a name="line-1159"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Fixities and precedence parsing
*                                                                      *
************************************************************************

@mkOpAppRn@ deals with operator fixities.  The argument expressions
are assumed to be already correctly arranged.  It needs the fixities
recorded in the OpApp nodes, because fixity info applies to the things
the programmer actually wrote, so you can't find it out from the Name.

Furthermore, the second argument is guaranteed not to be another
operator application.  Why? Because the parser parses all
operator applications left-associatively, EXCEPT negation, which
we need to handle specially.
Infix types are read in a *right-associative* way, so that
        a `op` b `op` c
is always read in as
        a `op` (b `op` c)

mkHsOpTyRn rearranges where necessary.  The two arguments
have already been renamed and rearranged.  It's made rather tiresome
by the presence of -&gt;, which is a separate syntactic construct.
-}</span><span>
</span><a name="line-1184"></a><span>
</span><a name="line-1185"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-1186"></a><span class="hs-comment">-- Building (ty1 `op1` (ty21 `op2` ty22))</span><span>
</span><a name="line-1187"></a><span class="hs-identifier">mkHsOpTyRn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1188"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-1189"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1190"></a><span>
</span><a name="line-1191"></a><a name="mkHsOpTyRn"><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier">mkHsOpTyRn</span></a></a><span> </span><a name="local-6989586621680036134"><a href="#local-6989586621680036134"><span class="hs-identifier">mk1</span></a></a><span> </span><a name="local-6989586621680036135"><a href="#local-6989586621680036135"><span class="hs-identifier">pp_op1</span></a></a><span> </span><a name="local-6989586621680036136"><a href="#local-6989586621680036136"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621680036137"><a href="#local-6989586621680036137"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036138"><a href="#local-6989586621680036138"><span class="hs-identifier">loc2</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621680036139"><a href="#local-6989586621680036139"><span class="hs-identifier">ty21</span></a></a><span> </span><a name="local-6989586621680036140"><a href="#local-6989586621680036140"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621680036141"><a href="#local-6989586621680036141"><span class="hs-identifier">ty22</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1192"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036142"><a href="#local-6989586621680036142"><span class="hs-identifier">fix2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnFixity.html#lookupTyFixityRn"><span class="hs-identifier hs-var">lookupTyFixityRn</span></a><span> </span><a href="#local-6989586621680036140"><span class="hs-identifier hs-var">op2</span></a><span>
</span><a name="line-1193"></a><span>        </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#mk_hs_op_ty"><span class="hs-identifier hs-var">mk_hs_op_ty</span></a><span> </span><a href="#local-6989586621680036134"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621680036135"><span class="hs-identifier hs-var">pp_op1</span></a><span> </span><a href="#local-6989586621680036136"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036137"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1194"></a><span>                      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621680036143"><a href="#local-6989586621680036143"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621680036144"><a href="#local-6989586621680036144"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a href="#local-6989586621680036143"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621680036140"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036144"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1195"></a><span>                      </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036140"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036142"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621680036139"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621680036141"><span class="hs-identifier hs-var">ty22</span></a><span> </span><a href="#local-6989586621680036138"><span class="hs-identifier hs-var">loc2</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1196"></a><span>
</span><a name="line-1197"></a><span class="hs-identifier">mkHsOpTyRn</span><span> </span><a name="local-6989586621680036145"><a href="#local-6989586621680036145"><span class="hs-identifier">mk1</span></a></a><span> </span><a name="local-6989586621680036146"><a href="#local-6989586621680036146"><span class="hs-identifier">pp_op1</span></a></a><span> </span><a name="local-6989586621680036147"><a href="#local-6989586621680036147"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621680036148"><a href="#local-6989586621680036148"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036149"><a href="#local-6989586621680036149"><span class="hs-identifier">loc2</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621680036150"><a href="#local-6989586621680036150"><span class="hs-identifier">ty21</span></a></a><span> </span><a name="local-6989586621680036151"><a href="#local-6989586621680036151"><span class="hs-identifier">ty22</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1198"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#mk_hs_op_ty"><span class="hs-identifier hs-var">mk_hs_op_ty</span></a><span> </span><a href="#local-6989586621680036145"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621680036146"><span class="hs-identifier hs-var">pp_op1</span></a><span> </span><a href="#local-6989586621680036147"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036148"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1199"></a><span>                </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a href="TysPrim.html#funTyConName"><span class="hs-identifier hs-var">funTyConName</span></a><span> </span><a href="BasicTypes.html#funTyFixity"><span class="hs-identifier hs-var">funTyFixity</span></a><span> </span><a href="#local-6989586621680036150"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621680036151"><span class="hs-identifier hs-var">ty22</span></a><span> </span><a href="#local-6989586621680036149"><span class="hs-identifier hs-var">loc2</span></a><span>
</span><a name="line-1200"></a><span>
</span><a name="line-1201"></a><span class="hs-identifier">mkHsOpTyRn</span><span> </span><a name="local-6989586621680036152"><a href="#local-6989586621680036152"><span class="hs-identifier">mk1</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036153"><a href="#local-6989586621680036153"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036154"><a href="#local-6989586621680036154"><span class="hs-identifier">ty2</span></a></a><span>              </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1202"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036152"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621680036153"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621680036154"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1203"></a><span>
</span><a name="line-1204"></a><span class="hs-comment">---------------</span><span>
</span><a name="line-1205"></a><span class="hs-identifier">mk_hs_op_ty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1206"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-1207"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-1209"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1210"></a><a name="mk_hs_op_ty"><a href="RnTypes.html#mk_hs_op_ty"><span class="hs-identifier">mk_hs_op_ty</span></a></a><span> </span><a name="local-6989586621680036155"><a href="#local-6989586621680036155"><span class="hs-identifier">mk1</span></a></a><span> </span><a name="local-6989586621680036156"><a href="#local-6989586621680036156"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621680036157"><a href="#local-6989586621680036157"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621680036158"><a href="#local-6989586621680036158"><span class="hs-identifier">ty1</span></a></a><span>
</span><a name="line-1211"></a><span>            </span><a name="local-6989586621680036159"><a href="#local-6989586621680036159"><span class="hs-identifier">mk2</span></a></a><span> </span><a name="local-6989586621680036160"><a href="#local-6989586621680036160"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621680036161"><a href="#local-6989586621680036161"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621680036162"><a href="#local-6989586621680036162"><span class="hs-identifier">ty21</span></a></a><span> </span><a name="local-6989586621680036163"><a href="#local-6989586621680036163"><span class="hs-identifier">ty22</span></a></a><span> </span><a name="local-6989586621680036164"><a href="#local-6989586621680036164"><span class="hs-identifier">loc2</span></a></a><span>
</span><a name="line-1212"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036165"><span class="hs-identifier hs-var">nofix_error</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621680036156"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><a href="#local-6989586621680036157"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621680036160"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621680036161"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1213"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036155"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621680036158"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036164"><span class="hs-identifier hs-var">loc2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036159"><span class="hs-identifier hs-var">mk2</span></a><span> </span><a href="#local-6989586621680036162"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621680036163"><span class="hs-identifier hs-var">ty22</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1214"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036166"><span class="hs-identifier hs-var">associate_right</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036155"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621680036158"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036164"><span class="hs-identifier hs-var">loc2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036159"><span class="hs-identifier hs-var">mk2</span></a><span> </span><a href="#local-6989586621680036162"><span class="hs-identifier hs-var">ty21</span></a><span> </span><a href="#local-6989586621680036163"><span class="hs-identifier hs-var">ty22</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1215"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Rearrange to ((ty1 `op1` ty21) `op2` ty22)</span><span>
</span><a name="line-1216"></a><span>                           </span><a name="local-6989586621680036167"><a href="#local-6989586621680036167"><span class="hs-identifier">new_ty</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkHsOpTyRn"><span class="hs-identifier hs-var">mkHsOpTyRn</span></a><span> </span><a href="#local-6989586621680036155"><span class="hs-identifier hs-var">mk1</span></a><span> </span><a href="#local-6989586621680036156"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621680036157"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036158"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621680036162"><span class="hs-identifier hs-var">ty21</span></a><span>
</span><a name="line-1217"></a><span>                         </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036159"><span class="hs-identifier hs-var">mk2</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a><span> </span><a href="#local-6989586621680036167"><span class="hs-identifier hs-var">new_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036163"><span class="hs-identifier hs-var">ty22</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1218"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1219"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680036165"><a href="#local-6989586621680036165"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036166"><a href="#local-6989586621680036166"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621680036157"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036161"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1220"></a><span>
</span><a name="line-1221"></a><span>
</span><a name="line-1222"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1223"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>             </span><span class="hs-comment">-- Left operand; already rearranged</span><span>
</span><a name="line-1224"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>   </span><span class="hs-comment">-- Operator and fixity</span><span>
</span><a name="line-1225"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>             </span><span class="hs-comment">-- Right operand (not an OpApp, but might</span><span>
</span><a name="line-1226"></a><span>                                       </span><span class="hs-comment">-- be a NegApp)</span><span>
</span><a name="line-1227"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1228"></a><span>
</span><a name="line-1229"></a><span class="hs-comment">-- (e11 `op1` e12) `op2` e2</span><span>
</span><a name="line-1230"></a><a name="mkOpAppRn"><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier">mkOpAppRn</span></a></a><span> </span><a name="local-6989586621680036168"><a href="#local-6989586621680036168"><span class="hs-identifier">e1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a name="local-6989586621680036169"><a href="#local-6989586621680036169"><span class="hs-identifier">e11</span></a></a><span> </span><a name="local-6989586621680036170"><a href="#local-6989586621680036170"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621680036171"><a href="#local-6989586621680036171"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621680036172"><a href="#local-6989586621680036172"><span class="hs-identifier">e12</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036173"><a href="#local-6989586621680036173"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621680036174"><a href="#local-6989586621680036174"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621680036175"><a href="#local-6989586621680036175"><span class="hs-identifier">e2</span></a></a><span>
</span><a name="line-1231"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036177"><span class="hs-identifier hs-var">nofix_error</span></a><span>
</span><a name="line-1232"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036170"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><a href="#local-6989586621680036171"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036173"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621680036174"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1233"></a><span>       </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621680036168"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621680036173"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036174"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621680036175"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1234"></a><span>
</span><a name="line-1235"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036178"><span class="hs-identifier hs-var">associate_right</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1236"></a><span>    </span><a name="local-6989586621680036179"><a href="#local-6989586621680036179"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier hs-var">mkOpAppRn</span></a><span> </span><a href="#local-6989586621680036172"><span class="hs-identifier hs-var">e12</span></a><span> </span><a href="#local-6989586621680036173"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036174"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621680036175"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1237"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621680036169"><span class="hs-identifier hs-var">e11</span></a><span> </span><a href="#local-6989586621680036170"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621680036171"><span class="hs-identifier hs-var">fix1</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036176"><span class="hs-identifier hs-var">loc'</span></a><span> </span><a href="#local-6989586621680036179"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1238"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1239"></a><span>    </span><a name="local-6989586621680036176"><a href="#local-6989586621680036176"><span class="hs-identifier">loc'</span></a></a><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-6989586621680036172"><span class="hs-identifier hs-var">e12</span></a><span> </span><a href="#local-6989586621680036175"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1240"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680036177"><a href="#local-6989586621680036177"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036178"><a href="#local-6989586621680036178"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621680036171"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036174"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1241"></a><span>
</span><a name="line-1242"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1243"></a><span class="hs-comment">--      (- neg_arg) `op` e2</span><span>
</span><a name="line-1244"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><a name="local-6989586621680036180"><a href="#local-6989586621680036180"><span class="hs-identifier">e1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a name="local-6989586621680036181"><a href="#local-6989586621680036181"><span class="hs-identifier">neg_arg</span></a></a><span> </span><a name="local-6989586621680036182"><a href="#local-6989586621680036182"><span class="hs-identifier">neg_name</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036183"><a href="#local-6989586621680036183"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621680036184"><a href="#local-6989586621680036184"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621680036185"><a href="#local-6989586621680036185"><span class="hs-identifier">e2</span></a></a><span>
</span><a name="line-1245"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036187"><span class="hs-identifier hs-var">nofix_error</span></a><span>
</span><a name="line-1246"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span class="hs-special">,</span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036183"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621680036184"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1247"></a><span>       </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621680036180"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621680036183"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036184"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621680036185"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1248"></a><span>
</span><a name="line-1249"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036188"><span class="hs-identifier hs-var">associate_right</span></a><span>
</span><a name="line-1250"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680036189"><a href="#local-6989586621680036189"><span class="hs-identifier">new_e</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkOpAppRn"><span class="hs-identifier hs-var">mkOpAppRn</span></a><span> </span><a href="#local-6989586621680036181"><span class="hs-identifier hs-var">neg_arg</span></a><span> </span><a href="#local-6989586621680036183"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036184"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621680036185"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1251"></a><span>       </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036186"><span class="hs-identifier hs-var">loc'</span></a><span> </span><a href="#local-6989586621680036189"><span class="hs-identifier hs-var">new_e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036182"><span class="hs-identifier hs-var">neg_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1252"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1253"></a><span>    </span><a name="local-6989586621680036186"><a href="#local-6989586621680036186"><span class="hs-identifier">loc'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#combineLocs"><span class="hs-identifier hs-var">combineLocs</span></a><span> </span><a href="#local-6989586621680036181"><span class="hs-identifier hs-var">neg_arg</span></a><span> </span><a href="#local-6989586621680036185"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-1254"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680036187"><a href="#local-6989586621680036187"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036188"><a href="#local-6989586621680036188"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span> </span><a href="#local-6989586621680036184"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1255"></a><span>
</span><a name="line-1256"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1257"></a><span class="hs-comment">--      e1 `op` - neg_arg</span><span>
</span><a name="line-1258"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><a name="local-6989586621680036190"><a href="#local-6989586621680036190"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621680036191"><a href="#local-6989586621680036191"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621680036192"><a href="#local-6989586621680036192"><span class="hs-identifier">fix1</span></a></a><span> </span><a name="local-6989586621680036193"><a href="#local-6989586621680036193"><span class="hs-identifier">e2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- NegApp can occur on the right</span><span>
</span><a name="line-1259"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680036194"><span class="hs-identifier hs-var">associate_right</span></a><span>                 </span><span class="hs-comment">-- We *want* right association</span><span>
</span><a name="line-1260"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036191"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036192"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1261"></a><span>       </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621680036190"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621680036191"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621680036192"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036193"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1262"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1263"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621680036194"><a href="#local-6989586621680036194"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621680036192"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span>
</span><a name="line-1264"></a><span>
</span><a name="line-1265"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1266"></a><span class="hs-comment">--      Default case</span><span>
</span><a name="line-1267"></a><span class="hs-identifier">mkOpAppRn</span><span> </span><a name="local-6989586621680036195"><a href="#local-6989586621680036195"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621680036196"><a href="#local-6989586621680036196"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621680036197"><a href="#local-6989586621680036197"><span class="hs-identifier">fix</span></a></a><span> </span><a name="local-6989586621680036198"><a href="#local-6989586621680036198"><span class="hs-identifier">e2</span></a></a><span>                  </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1268"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">right_op_ok</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#right_op_ok"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><span class="hs-identifier">e2</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1269"></a><span>             </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">e1</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;---&quot;</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">op</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;---&quot;</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;---&quot;</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">e2</span><span>
</span><a name="line-1270"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-1271"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><a href="#local-6989586621680036195"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="#local-6989586621680036196"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621680036197"><span class="hs-identifier hs-var">fix</span></a><span> </span><a href="#local-6989586621680036198"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1272"></a><span>
</span><a name="line-1273"></a><span class="hs-comment">----------------------------</span><span>
</span><a name="line-1274"></a><span>
</span><a name="line-1275"></a><span class="hs-comment">-- | Name of an operator in an operator application or section</span><span>
</span><a name="line-1276"></a><span class="hs-keyword">data</span><span> </span><a name="OpName"><a href="RnTypes.html#OpName"><span class="hs-identifier">OpName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NormalOp"><a href="RnTypes.html#NormalOp"><span class="hs-identifier">NormalOp</span></a></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>         </span><span class="hs-comment">-- ^ A normal identifier</span><span>
</span><a name="line-1277"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="NegateOp"><a href="RnTypes.html#NegateOp"><span class="hs-identifier">NegateOp</span></a></a><span>              </span><span class="hs-comment">-- ^ Prefix negation</span><span>
</span><a name="line-1278"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="UnboundOp"><a href="RnTypes.html#UnboundOp"><span class="hs-identifier">UnboundOp</span></a></a><span> </span><a href="HsExpr.html#UnboundVar"><span class="hs-identifier hs-type">UnboundVar</span></a><span>  </span><span class="hs-comment">-- ^ An unbound indentifier</span><span>
</span><a name="line-1279"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="RecFldOp"><a href="RnTypes.html#RecFldOp"><span class="hs-identifier">RecFldOp</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#AmbiguousFieldOcc"><span class="hs-identifier hs-type">AmbiguousFieldOcc</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1280"></a><span>              </span><span class="hs-comment">-- ^ A (possibly ambiguous) record field occurrence</span><span>
</span><a name="line-1281"></a><span>
</span><a name="line-1282"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1283"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a name="local-6989586621680035603"><a href="#local-6989586621680035603"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035603"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1284"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="PrelNames.html#negateName"><span class="hs-identifier hs-var">negateName</span></a><span>
</span><a name="line-1285"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span> </span><a name="local-6989586621680035604"><a href="#local-6989586621680035604"><span class="hs-identifier">uv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035604"><span class="hs-identifier hs-var">uv</span></a><span>
</span><a name="line-1286"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RecFldOp"><span class="hs-identifier hs-var">RecFldOp</span></a><span> </span><a name="local-6989586621680035605"><a href="#local-6989586621680035605"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680035605"><span class="hs-identifier hs-var">fld</span></a><span>
</span><a name="line-1287"></a><span>
</span><a name="line-1288"></a><span class="hs-identifier">get_op</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span>
</span><a name="line-1289"></a><span class="hs-comment">-- An unbound name could be either HsVar or HsUnboundVar</span><span>
</span><a name="line-1290"></a><span class="hs-comment">-- See RnExpr.rnUnboundVar</span><span>
</span><a name="line-1291"></a><a name="get_op"><a href="RnTypes.html#get_op"><span class="hs-identifier">get_op</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsVar"><span class="hs-identifier hs-var">HsVar</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036199"><a href="#local-6989586621680036199"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621680036199"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1292"></a><span class="hs-identifier">get_op</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsUnboundVar"><span class="hs-identifier hs-var">HsUnboundVar</span></a><span> </span><a name="local-6989586621680036200"><a href="#local-6989586621680036200"><span class="hs-identifier">uv</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span> </span><a href="#local-6989586621680036200"><span class="hs-identifier hs-var">uv</span></a><span>
</span><a name="line-1293"></a><span class="hs-identifier">get_op</span><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsRecFld"><span class="hs-identifier hs-var">HsRecFld</span></a><span> </span><a name="local-6989586621680036201"><a href="#local-6989586621680036201"><span class="hs-identifier">fld</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#RecFldOp"><span class="hs-identifier hs-var">RecFldOp</span></a><span> </span><a href="#local-6989586621680036201"><span class="hs-identifier hs-var">fld</span></a><span>
</span><a name="line-1294"></a><span class="hs-identifier">get_op</span><span> </span><a name="local-6989586621680036202"><a href="#local-6989586621680036202"><span class="hs-identifier">other</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;get_op&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036202"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-1295"></a><span>
</span><a name="line-1296"></a><span class="hs-comment">-- Parser left-associates everything, but</span><span>
</span><a name="line-1297"></a><span class="hs-comment">-- derived instances may have correctly-associated things to</span><span>
</span><a name="line-1298"></a><span class="hs-comment">-- in the right operand.  So we just check that the right operand is OK</span><span>
</span><a name="line-1299"></a><span class="hs-identifier">right_op_ok</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1300"></a><a name="right_op_ok"><a href="RnTypes.html#right_op_ok"><span class="hs-identifier">right_op_ok</span></a></a><span> </span><a name="local-6989586621680036203"><a href="#local-6989586621680036203"><span class="hs-identifier">fix1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036204"><a href="#local-6989586621680036204"><span class="hs-identifier">fix2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1301"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680036205"><span class="hs-identifier hs-var">error_please</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680036206"><span class="hs-identifier hs-var">associate_right</span></a><span>
</span><a name="line-1302"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1303"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680036205"><a href="#local-6989586621680036205"><span class="hs-identifier">error_please</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036206"><a href="#local-6989586621680036206"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621680036203"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036204"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1304"></a><span class="hs-identifier">right_op_ok</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1305"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1306"></a><span>
</span><a name="line-1307"></a><span class="hs-comment">-- Parser initially makes negation bind more tightly than any other operator</span><span>
</span><a name="line-1308"></a><span class="hs-comment">-- And &quot;deriving&quot; code should respect this (use HsPar if not)</span><span>
</span><a name="line-1309"></a><span class="hs-identifier">mkNegAppRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="#local-6989586621680035615"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a><span> </span><a href="#local-6989586621680035615"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621680035615"><span class="hs-identifier hs-type">id</span></a><span class="hs-special">)</span><span>
</span><a name="line-1310"></a><a name="mkNegAppRn"><a href="RnTypes.html#mkNegAppRn"><span class="hs-identifier">mkNegAppRn</span></a></a><span> </span><a name="local-6989586621680036207"><a href="#local-6989586621680036207"><span class="hs-identifier">neg_arg</span></a></a><span> </span><a name="local-6989586621680036208"><a href="#local-6989586621680036208"><span class="hs-identifier">neg_name</span></a></a><span>
</span><a name="line-1311"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not_op_app</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">neg_arg</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1312"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><a href="#local-6989586621680036207"><span class="hs-identifier hs-var">neg_arg</span></a><span> </span><a href="#local-6989586621680036208"><span class="hs-identifier hs-var">neg_name</span></a><span class="hs-special">)</span><span>
</span><a name="line-1313"></a><span>
</span><a name="line-1314"></a><span class="hs-identifier">not_op_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="#local-6989586621680035614"><span class="hs-identifier hs-type">id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1315"></a><a name="not_op_app"><a href="RnTypes.html#not_op_app"><span class="hs-identifier">not_op_app</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1316"></a><span class="hs-identifier">not_op_app</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1317"></a><span>
</span><a name="line-1318"></a><span class="hs-comment">---------------------------</span><span>
</span><a name="line-1319"></a><span class="hs-identifier">mkOpFormRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>            </span><span class="hs-comment">-- Left operand; already rearranged</span><span>
</span><a name="line-1320"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>     </span><span class="hs-comment">-- Operator and fixity</span><span>
</span><a name="line-1321"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsCmdTop"><span class="hs-identifier hs-type">LHsCmdTop</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>             </span><span class="hs-comment">-- Right operand (not an infix)</span><span>
</span><a name="line-1322"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmd"><span class="hs-identifier hs-type">HsCmd</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1323"></a><span>
</span><a name="line-1324"></a><span class="hs-comment">-- (e11 `op1` e12) `op2` e2</span><span>
</span><a name="line-1325"></a><a name="mkOpFormRn"><a href="RnTypes.html#mkOpFormRn"><span class="hs-identifier">mkOpFormRn</span></a></a><span> </span><a name="local-6989586621680036209"><a href="#local-6989586621680036209"><span class="hs-identifier">a1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036210"><a href="#local-6989586621680036210"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a name="local-6989586621680036211"><a href="#local-6989586621680036211"><span class="hs-identifier">op1</span></a></a><span> </span><a name="local-6989586621680036212"><a href="#local-6989586621680036212"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680036213"><a href="#local-6989586621680036213"><span class="hs-identifier">fix1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1326"></a><span>                                     </span><span class="hs-special">[</span><a name="local-6989586621680036214"><a href="#local-6989586621680036214"><span class="hs-identifier">a11</span></a></a><span class="hs-special">,</span><a name="local-6989586621680036215"><a href="#local-6989586621680036215"><span class="hs-identifier">a12</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1327"></a><span>        </span><a name="local-6989586621680036216"><a href="#local-6989586621680036216"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621680036217"><a href="#local-6989586621680036217"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621680036218"><a href="#local-6989586621680036218"><span class="hs-identifier">a2</span></a></a><span>
</span><a name="line-1328"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036219"><span class="hs-identifier hs-var">nofix_error</span></a><span>
</span><a name="line-1329"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036211"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><a href="#local-6989586621680036213"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036216"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><a href="#local-6989586621680036217"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1330"></a><span>       </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-6989586621680036216"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036212"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621680036217"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680036209"><span class="hs-identifier hs-var">a1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036218"><span class="hs-identifier hs-var">a2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1331"></a><span>
</span><a name="line-1332"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036220"><span class="hs-identifier hs-var">associate_right</span></a><span>
</span><a name="line-1333"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621680036221"><a href="#local-6989586621680036221"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkOpFormRn"><span class="hs-identifier hs-var">mkOpFormRn</span></a><span> </span><a href="#local-6989586621680036215"><span class="hs-identifier hs-var">a12</span></a><span> </span><a href="#local-6989586621680036216"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036217"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621680036218"><span class="hs-identifier hs-var">a2</span></a><span>
</span><a name="line-1334"></a><span>       </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-6989586621680036211"><span class="hs-identifier hs-var">op1</span></a><span> </span><a href="#local-6989586621680036212"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621680036213"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1335"></a><span>               </span><span class="hs-special">[</span><a href="#local-6989586621680036214"><span class="hs-identifier hs-var">a11</span></a><span class="hs-special">,</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036210"><span class="hs-identifier hs-var">loc</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdTop"><span class="hs-identifier hs-var">HsCmdTop</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036210"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680036221"><span class="hs-identifier hs-var">new_c</span></a><span class="hs-special">)</span><span>
</span><a name="line-1336"></a><span>               </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span> </span><a href="PlaceHolder.html#placeHolderType"><span class="hs-identifier hs-var">placeHolderType</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1337"></a><span>        </span><span class="hs-comment">-- TODO: locs are wrong</span><span>
</span><a name="line-1338"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1339"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680036219"><a href="#local-6989586621680036219"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036220"><a href="#local-6989586621680036220"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621680036213"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036217"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1340"></a><span>
</span><a name="line-1341"></a><span class="hs-comment">--      Default case</span><span>
</span><a name="line-1342"></a><span class="hs-identifier">mkOpFormRn</span><span> </span><a name="local-6989586621680036222"><a href="#local-6989586621680036222"><span class="hs-identifier">arg1</span></a></a><span> </span><a name="local-6989586621680036223"><a href="#local-6989586621680036223"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621680036224"><a href="#local-6989586621680036224"><span class="hs-identifier">fix</span></a></a><span> </span><a name="local-6989586621680036225"><a href="#local-6989586621680036225"><span class="hs-identifier">arg2</span></a></a><span>                     </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1343"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#HsCmdArrForm"><span class="hs-identifier hs-var">HsCmdArrForm</span></a><span> </span><a href="#local-6989586621680036223"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="BasicTypes.html#Infix"><span class="hs-identifier hs-var">Infix</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621680036224"><span class="hs-identifier hs-var">fix</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621680036222"><span class="hs-identifier hs-var">arg1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036225"><span class="hs-identifier hs-var">arg2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span>
</span><a name="line-1346"></a><span class="hs-comment">--------------------------------------</span><span>
</span><a name="line-1347"></a><span class="hs-identifier">mkConOpPatRn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#LPat"><span class="hs-identifier hs-type">LPat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span>
</span><a name="line-1348"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span class="hs-special">)</span><span>
</span><a name="line-1349"></a><span>
</span><a name="line-1350"></a><a name="mkConOpPatRn"><a href="RnTypes.html#mkConOpPatRn"><span class="hs-identifier">mkConOpPatRn</span></a></a><span> </span><a name="local-6989586621680036226"><a href="#local-6989586621680036226"><span class="hs-identifier">op2</span></a></a><span> </span><a name="local-6989586621680036227"><a href="#local-6989586621680036227"><span class="hs-identifier">fix2</span></a></a><span> </span><a name="local-6989586621680036228"><a href="#local-6989586621680036228"><span class="hs-identifier">p1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036229"><a href="#local-6989586621680036229"><span class="hs-identifier">loc</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a name="local-6989586621680036230"><a href="#local-6989586621680036230"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a name="local-6989586621680036231"><a href="#local-6989586621680036231"><span class="hs-identifier">p11</span></a></a><span> </span><a name="local-6989586621680036232"><a href="#local-6989586621680036232"><span class="hs-identifier">p12</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036233"><a href="#local-6989586621680036233"><span class="hs-identifier">p2</span></a></a><span>
</span><a name="line-1351"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036234"><a href="#local-6989586621680036234"><span class="hs-identifier">fix1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnFixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036230"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1352"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680036235"><a href="#local-6989586621680036235"><span class="hs-identifier">nofix_error</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036236"><a href="#local-6989586621680036236"><span class="hs-identifier">associate_right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="BasicTypes.html#compareFixity"><span class="hs-identifier hs-var">compareFixity</span></a><span> </span><a href="#local-6989586621680036234"><span class="hs-identifier hs-var">fix1</span></a><span> </span><a href="#local-6989586621680036227"><span class="hs-identifier hs-var">fix2</span></a><span>
</span><a name="line-1353"></a><span>
</span><a name="line-1354"></a><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621680036235"><span class="hs-identifier hs-var">nofix_error</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1355"></a><span>                </span><span class="hs-special">{</span><span> </span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036230"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621680036234"><span class="hs-identifier hs-var">fix1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1356"></a><span>                               </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036226"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621680036227"><span class="hs-identifier hs-var">fix2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1357"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621680036226"><span class="hs-identifier hs-var">op2</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621680036228"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621680036233"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1358"></a><span>
</span><a name="line-1359"></a><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621680036236"><span class="hs-identifier hs-var">associate_right</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1360"></a><span>                </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036237"><a href="#local-6989586621680036237"><span class="hs-identifier">new_p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#mkConOpPatRn"><span class="hs-identifier hs-var">mkConOpPatRn</span></a><span> </span><a href="#local-6989586621680036226"><span class="hs-identifier hs-var">op2</span></a><span> </span><a href="#local-6989586621680036227"><span class="hs-identifier hs-var">fix2</span></a><span> </span><a href="#local-6989586621680036232"><span class="hs-identifier hs-var">p12</span></a><span> </span><a href="#local-6989586621680036233"><span class="hs-identifier hs-var">p2</span></a><span>
</span><a name="line-1361"></a><span>                </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621680036230"><span class="hs-identifier hs-var">op1</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621680036231"><span class="hs-identifier hs-var">p11</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a href="#local-6989586621680036229"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="#local-6989586621680036237"><span class="hs-identifier hs-var">new_p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- XXX loc right?</span><span>
</span><a name="line-1362"></a><span>          </span><span class="hs-keyword">else</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621680036226"><span class="hs-identifier hs-var">op2</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621680036228"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621680036233"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1363"></a><span>
</span><a name="line-1364"></a><span class="hs-identifier">mkConOpPatRn</span><span> </span><a name="local-6989586621680036238"><a href="#local-6989586621680036238"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036239"><a href="#local-6989586621680036239"><span class="hs-identifier">p1</span></a></a><span> </span><a name="local-6989586621680036240"><a href="#local-6989586621680036240"><span class="hs-identifier">p2</span></a></a><span>                         </span><span class="hs-comment">-- Default case, no rearrangment</span><span>
</span><a name="line-1365"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not_op_pat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><a href="RnTypes.html#not_op_pat"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1366"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a href="#local-6989586621680036238"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><a href="#local-6989586621680036239"><span class="hs-identifier hs-var">p1</span></a><span> </span><a href="#local-6989586621680036240"><span class="hs-identifier hs-var">p2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1367"></a><span>
</span><a name="line-1368"></a><span class="hs-identifier">not_op_pat</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1369"></a><a name="not_op_pat"><a href="RnTypes.html#not_op_pat"><span class="hs-identifier">not_op_pat</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1370"></a><span class="hs-identifier">not_op_pat</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1371"></a><span>
</span><a name="line-1372"></a><span class="hs-comment">--------------------------------------</span><span>
</span><a name="line-1373"></a><span class="hs-identifier">checkPrecMatch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#MatchGroup"><span class="hs-identifier hs-type">MatchGroup</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><a href="#local-6989586621680035613"><span class="hs-identifier hs-type">body</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1374"></a><span>  </span><span class="hs-comment">-- Check precedence of a function binding written infix</span><span>
</span><a name="line-1375"></a><span>  </span><span class="hs-comment">--   eg  a `op` b `C` c = ...</span><span>
</span><a name="line-1376"></a><span>  </span><span class="hs-comment">-- See comments with rnExpr (OpApp ...) about &quot;deriving&quot;</span><span>
</span><a name="line-1377"></a><span>
</span><a name="line-1378"></a><a name="checkPrecMatch"><a href="RnTypes.html#checkPrecMatch"><span class="hs-identifier">checkPrecMatch</span></a></a><span> </span><a name="local-6989586621680036241"><a href="#local-6989586621680036241"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#MG"><span class="hs-identifier hs-var">MG</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">mg_alts</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036242"><a href="#local-6989586621680036242"><span class="hs-identifier">ms</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1379"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-6989586621680036243"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621680036242"><span class="hs-identifier hs-var">ms</span></a><span>
</span><a name="line-1380"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1381"></a><span>    </span><a name="local-6989586621680036243"><a href="#local-6989586621680036243"><span class="hs-identifier">check</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsExpr.html#Match"><span class="hs-identifier hs-var">Match</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">m_pats</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036244"><a href="#local-6989586621680036244"><span class="hs-identifier">l1</span></a></a><span> </span><a name="local-6989586621680036245"><a href="#local-6989586621680036245"><span class="hs-identifier">p1</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036246"><a href="#local-6989586621680036246"><span class="hs-identifier">l2</span></a></a><span> </span><a name="local-6989586621680036247"><a href="#local-6989586621680036247"><span class="hs-identifier">p2</span></a></a><span> </span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1382"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#combineSrcSpans"><span class="hs-identifier hs-var">combineSrcSpans</span></a><span> </span><a href="#local-6989586621680036244"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621680036246"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1383"></a><span>        </span><span class="hs-keyword">do</span><span> </span><a href="RnTypes.html#checkPrec"><span class="hs-identifier hs-var">checkPrec</span></a><span> </span><a href="#local-6989586621680036241"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621680036245"><span class="hs-identifier hs-var">p1</span></a><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1384"></a><span>           </span><a href="RnTypes.html#checkPrec"><span class="hs-identifier hs-var">checkPrec</span></a><span> </span><a href="#local-6989586621680036241"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621680036247"><span class="hs-identifier hs-var">p2</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1385"></a><span>
</span><a name="line-1386"></a><span>    </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1387"></a><span>        </span><span class="hs-comment">-- This can happen.  Consider</span><span>
</span><a name="line-1388"></a><span>        </span><span class="hs-comment">--      a `op` True = ...</span><span>
</span><a name="line-1389"></a><span>        </span><span class="hs-comment">--      op          = ...</span><span>
</span><a name="line-1390"></a><span>        </span><span class="hs-comment">-- The infix flag comes from the first binding of the group</span><span>
</span><a name="line-1391"></a><span>        </span><span class="hs-comment">-- but the second eqn has no args (an error, but not discovered</span><span>
</span><a name="line-1392"></a><span>        </span><span class="hs-comment">-- until the type checker).  So we don't want to crash on the</span><span>
</span><a name="line-1393"></a><span>        </span><span class="hs-comment">-- second eqn.</span><span>
</span><a name="line-1394"></a><span>
</span><a name="line-1395"></a><span class="hs-identifier">checkPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsPat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="IOEnv.html#IOEnv"><span class="hs-identifier hs-type">IOEnv</span></a><span> </span><span class="hs-special">(</span><a href="TcRnTypes.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><a href="TcRnTypes.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a><span> </span><a href="TcRnTypes.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1396"></a><a name="checkPrec"><a href="RnTypes.html#checkPrec"><span class="hs-identifier">checkPrec</span></a></a><span> </span><a name="local-6989586621680036248"><a href="#local-6989586621680036248"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-special">(</span><a href="HsPat.html#ConPatIn"><span class="hs-identifier hs-var">ConPatIn</span></a><span> </span><a name="local-6989586621680036249"><a href="#local-6989586621680036249"><span class="hs-identifier">op1</span></a></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#InfixCon"><span class="hs-identifier hs-var">InfixCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036250"><a href="#local-6989586621680036250"><span class="hs-identifier">right</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1397"></a><span>    </span><a name="local-6989586621680036251"><a href="#local-6989586621680036251"><span class="hs-identifier">op_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036252"><a href="#local-6989586621680036252"><span class="hs-identifier">op_prec</span></a></a><span>  </span><a name="local-6989586621680036253"><a href="#local-6989586621680036253"><span class="hs-identifier">op_dir</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnFixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><a href="#local-6989586621680036248"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1398"></a><span>    </span><a name="local-6989586621680036254"><a href="#local-6989586621680036254"><span class="hs-identifier">op1_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036255"><a href="#local-6989586621680036255"><span class="hs-identifier">op1_prec</span></a></a><span> </span><a name="local-6989586621680036256"><a href="#local-6989586621680036256"><span class="hs-identifier">op1_dir</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnFixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036249"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span>
</span><a name="line-1399"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-1400"></a><span>        </span><a name="local-6989586621680036257"><a href="#local-6989586621680036257"><span class="hs-identifier">inf_ok</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036255"><span class="hs-identifier hs-var">op1_prec</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621680036252"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-1401"></a><span>                 </span><span class="hs-special">(</span><a href="#local-6989586621680036255"><span class="hs-identifier hs-var">op1_prec</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680036252"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-1402"></a><span>                  </span><span class="hs-special">(</span><a href="#local-6989586621680036256"><span class="hs-identifier hs-var">op1_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680036253"><span class="hs-identifier hs-var">op_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680036250"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-1403"></a><span>                   </span><a href="#local-6989586621680036256"><span class="hs-identifier hs-var">op1_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680036253"><span class="hs-identifier hs-var">op_dir</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="BasicTypes.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><a href="#local-6989586621680036250"><span class="hs-identifier hs-var">right</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1404"></a><span>
</span><a name="line-1405"></a><span>        </span><a name="local-6989586621680036258"><a href="#local-6989586621680036258"><span class="hs-identifier">info</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a href="#local-6989586621680036248"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span>          </span><a href="#local-6989586621680036251"><span class="hs-identifier hs-var">op_fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1406"></a><span>        </span><a name="local-6989586621680036259"><a href="#local-6989586621680036259"><span class="hs-identifier">info1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036249"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036254"><span class="hs-identifier hs-var">op1_fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1407"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621680036260"><a href="#local-6989586621680036260"><span class="hs-identifier">infol</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036261"><a href="#local-6989586621680036261"><span class="hs-identifier">infor</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621680036250"><span class="hs-identifier hs-var">right</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036258"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036259"><span class="hs-identifier hs-var">info1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036259"><span class="hs-identifier hs-var">info1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036258"><span class="hs-identifier hs-var">info</span></a><span class="hs-special">)</span><span>
</span><a name="line-1408"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680036257"><span class="hs-identifier hs-var">inf_ok</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#precParseErr"><span class="hs-identifier hs-var">precParseErr</span></a><span> </span><a href="#local-6989586621680036260"><span class="hs-identifier hs-var">infol</span></a><span> </span><a href="#local-6989586621680036261"><span class="hs-identifier hs-var">infor</span></a><span class="hs-special">)</span><span>
</span><a name="line-1409"></a><span>
</span><a name="line-1410"></a><span class="hs-identifier">checkPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-1411"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><span>
</span><a name="line-1413"></a><span class="hs-comment">-- Check precedence of (arg op) or (op arg) respectively</span><span>
</span><a name="line-1414"></a><span class="hs-comment">-- If arg is itself an operator application, then either</span><span>
</span><a name="line-1415"></a><span class="hs-comment">--   (a) its precedence must be higher than that of op</span><span>
</span><a name="line-1416"></a><span class="hs-comment">--   (b) its precedency &amp; associativity must be the same as that of op</span><span>
</span><a name="line-1417"></a><span class="hs-identifier">checkSectionPrec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#FixityDirection"><span class="hs-identifier hs-type">FixityDirection</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1418"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1419"></a><a name="checkSectionPrec"><a href="RnTypes.html#checkSectionPrec"><span class="hs-identifier">checkSectionPrec</span></a></a><span> </span><a name="local-6989586621680036262"><a href="#local-6989586621680036262"><span class="hs-identifier">direction</span></a></a><span> </span><a name="local-6989586621680036263"><a href="#local-6989586621680036263"><span class="hs-identifier">section</span></a></a><span> </span><a name="local-6989586621680036264"><a href="#local-6989586621680036264"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621680036265"><a href="#local-6989586621680036265"><span class="hs-identifier">arg</span></a></a><span>
</span><a name="line-1420"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036265"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1421"></a><span>        </span><a href="HsExpr.html#OpApp"><span class="hs-identifier hs-var">OpApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036274"><a href="#local-6989586621680036274"><span class="hs-identifier">op'</span></a></a><span> </span><a name="local-6989586621680036275"><a href="#local-6989586621680036275"><span class="hs-identifier">fix</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036267"><span class="hs-identifier hs-var">go_for_it</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036274"><span class="hs-identifier hs-var">op'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036275"><span class="hs-identifier hs-var">fix</span></a><span>
</span><a name="line-1422"></a><span>        </span><a href="HsExpr.html#NegApp"><span class="hs-identifier hs-var">NegApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680036267"><span class="hs-identifier hs-var">go_for_it</span></a><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span>     </span><a href="BasicTypes.html#negateFixity"><span class="hs-identifier hs-var">negateFixity</span></a><span>
</span><a name="line-1423"></a><span>        </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1424"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1425"></a><span>    </span><a name="local-6989586621680036266"><a href="#local-6989586621680036266"><span class="hs-identifier">op_name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036264"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-1426"></a><span>    </span><a name="local-6989586621680036267"><a href="#local-6989586621680036267"><span class="hs-identifier">go_for_it</span></a></a><span> </span><a name="local-6989586621680036268"><a href="#local-6989586621680036268"><span class="hs-identifier">arg_op</span></a></a><span> </span><a name="local-6989586621680036269"><a href="#local-6989586621680036269"><span class="hs-identifier">arg_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036270"><a href="#local-6989586621680036270"><span class="hs-identifier">arg_prec</span></a></a><span> </span><a name="local-6989586621680036271"><a href="#local-6989586621680036271"><span class="hs-identifier">assoc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1427"></a><span>          </span><a name="local-6989586621680036272"><a href="#local-6989586621680036272"><span class="hs-identifier">op_fix</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036273"><a href="#local-6989586621680036273"><span class="hs-identifier">op_prec</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#lookupFixityOp"><span class="hs-identifier hs-var">lookupFixityOp</span></a><span> </span><a href="#local-6989586621680036266"><span class="hs-identifier hs-var">op_name</span></a><span>
</span><a name="line-1428"></a><span>          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036273"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621680036270"><span class="hs-identifier hs-var">arg_prec</span></a><span>
</span><a name="line-1429"></a><span>                  </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036273"><span class="hs-identifier hs-var">op_prec</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680036270"><span class="hs-identifier hs-var">arg_prec</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621680036262"><span class="hs-identifier hs-var">direction</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621680036271"><span class="hs-identifier hs-var">assoc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1430"></a><span>                 </span><span class="hs-special">(</span><a href="RnTypes.html#sectionPrecErr"><span class="hs-identifier hs-var">sectionPrecErr</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#get_op"><span class="hs-identifier hs-var">get_op</span></a><span> </span><a href="#local-6989586621680036264"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036272"><span class="hs-identifier hs-var">op_fix</span></a><span class="hs-special">)</span><span>
</span><a name="line-1431"></a><span>                                 </span><span class="hs-special">(</span><a href="#local-6989586621680036268"><span class="hs-identifier hs-var">arg_op</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036269"><span class="hs-identifier hs-var">arg_fix</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036263"><span class="hs-identifier hs-var">section</span></a><span class="hs-special">)</span><span>
</span><a name="line-1432"></a><span>
</span><a name="line-1433"></a><span class="hs-comment">-- | Look up the fixity for an operator name.  Be careful to use</span><span>
</span><a name="line-1434"></a><span class="hs-comment">-- 'lookupFieldFixityRn' for (possibly ambiguous) record fields</span><span>
</span><a name="line-1435"></a><span class="hs-comment">-- (see Trac #13132).</span><span>
</span><a name="line-1436"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span>
</span><a name="line-1437"></a><a name="lookupFixityOp"><a href="RnTypes.html#lookupFixityOp"><span class="hs-identifier">lookupFixityOp</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a name="local-6989586621680036276"><a href="#local-6989586621680036276"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnFixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><a href="#local-6989586621680036276"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1438"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnFixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><a href="PrelNames.html#negateName"><span class="hs-identifier hs-var">negateName</span></a><span>
</span><a name="line-1439"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span> </span><a name="local-6989586621680036277"><a href="#local-6989586621680036277"><span class="hs-identifier">u</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnFixity.html#lookupFixityRn"><span class="hs-identifier hs-var">lookupFixityRn</span></a><span> </span><span class="hs-special">(</span><a href="PrelNames.html#mkUnboundName"><span class="hs-identifier hs-var">mkUnboundName</span></a><span> </span><span class="hs-special">(</span><a href="HsExpr.html#unboundVarOcc"><span class="hs-identifier hs-var">unboundVarOcc</span></a><span> </span><a href="#local-6989586621680036277"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1440"></a><span class="hs-identifier">lookupFixityOp</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#RecFldOp"><span class="hs-identifier hs-var">RecFldOp</span></a><span> </span><a name="local-6989586621680036278"><a href="#local-6989586621680036278"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnFixity.html#lookupFieldFixityRn"><span class="hs-identifier hs-var">lookupFieldFixityRn</span></a><span> </span><a href="#local-6989586621680036278"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-1441"></a><span>
</span><a name="line-1442"></a><span>
</span><a name="line-1443"></a><span class="hs-comment">-- Precedence-related error messages</span><span>
</span><a name="line-1444"></a><span>
</span><a name="line-1445"></a><span class="hs-identifier">precParseErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1446"></a><a name="precParseErr"><a href="RnTypes.html#precParseErr"><span class="hs-identifier">precParseErr</span></a></a><span> </span><a name="local-6989586621680036279"><a href="#local-6989586621680036279"><span class="hs-identifier">op1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621680036280"><a href="#local-6989586621680036280"><span class="hs-identifier">n1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036281"><a href="#local-6989586621680036281"><span class="hs-identifier">op2</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621680036282"><a href="#local-6989586621680036282"><span class="hs-identifier">n2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><a name="line-1447"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621680036280"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621680036282"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-1448"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Avoid error cascade</span><span>
</span><a name="line-1449"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1450"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Precedence parsing error&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><span>      </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;cannot mix&quot;</span><span class="hs-special">,</span><span> </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621680036279"><span class="hs-identifier hs-var">op1</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;and&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1452"></a><span>               </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621680036281"><span class="hs-identifier hs-var">op2</span></a><span class="hs-special">,</span><span>
</span><a name="line-1453"></a><span>               </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in the same infix expression&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1454"></a><span>
</span><a name="line-1455"></a><span class="hs-identifier">sectionPrecErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsExpr.html#HsExpr"><span class="hs-identifier hs-type">HsExpr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1456"></a><a name="sectionPrecErr"><a href="RnTypes.html#sectionPrecErr"><span class="hs-identifier">sectionPrecErr</span></a></a><span> </span><a name="local-6989586621680036283"><a href="#local-6989586621680036283"><span class="hs-identifier">op</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621680036284"><a href="#local-6989586621680036284"><span class="hs-identifier">n1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036285"><a href="#local-6989586621680036285"><span class="hs-identifier">arg_op</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621680036286"><a href="#local-6989586621680036286"><span class="hs-identifier">n2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036287"><a href="#local-6989586621680036287"><span class="hs-identifier">section</span></a></a><span>
</span><a name="line-1457"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621680036284"><span class="hs-identifier hs-var">n1</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="RnTypes.html#is_unbound"><span class="hs-identifier hs-var">is_unbound</span></a><span> </span><a href="#local-6989586621680036286"><span class="hs-identifier hs-var">n2</span></a><span>
</span><a name="line-1458"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Avoid error cascade</span><span>
</span><a name="line-1459"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1460"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;The operator&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621680036283"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;of a section&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1461"></a><span>         </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;must have lower precedence than that of the operand,&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-1462"></a><span>                      </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;namely&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier hs-var">ppr_opfix</span></a><span> </span><a href="#local-6989586621680036285"><span class="hs-identifier hs-var">arg_op</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-1463"></a><span>         </span><a href="Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a><span> </span><span class="hs-number">4</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;in the section:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036287"><span class="hs-identifier hs-var">section</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-1464"></a><span>
</span><a name="line-1465"></a><span class="hs-identifier">is_unbound</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1466"></a><a name="is_unbound"><a href="RnTypes.html#is_unbound"><span class="hs-identifier">is_unbound</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#NormalOp"><span class="hs-identifier hs-var">NormalOp</span></a><span> </span><a name="local-6989586621680036288"><a href="#local-6989586621680036288"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="PrelNames.html#isUnboundName"><span class="hs-identifier hs-var">isUnboundName</span></a><span> </span><a href="#local-6989586621680036288"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1467"></a><span class="hs-identifier">is_unbound</span><span> </span><a href="RnTypes.html#UnboundOp"><span class="hs-identifier hs-var">UnboundOp</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1468"></a><span class="hs-identifier">is_unbound</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1469"></a><span>
</span><a name="line-1470"></a><span class="hs-identifier">ppr_opfix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#OpName"><span class="hs-identifier hs-type">OpName</span></a><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1471"></a><a name="ppr_opfix"><a href="RnTypes.html#ppr_opfix"><span class="hs-identifier">ppr_opfix</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680036289"><a href="#local-6989586621680036289"><span class="hs-identifier">op</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680036290"><a href="#local-6989586621680036290"><span class="hs-identifier">fixity</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036291"><span class="hs-identifier hs-var">pp_op</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036290"><span class="hs-identifier hs-var">fixity</span></a><span class="hs-special">)</span><span>
</span><a name="line-1472"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1473"></a><span>     </span><a name="local-6989586621680036291"><a href="#local-6989586621680036291"><span class="hs-identifier">pp_op</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#NegateOp"><span class="hs-identifier hs-var">NegateOp</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680036289"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;prefix `-'&quot;</span><span>
</span><a name="line-1474"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036289"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span>
</span><a name="line-1475"></a><span>
</span><a name="line-1476"></a><span>
</span><a name="line-1477"></a><span class="hs-comment">{- *****************************************************
*                                                      *
                 Errors
*                                                      *
***************************************************** -}</span><span>
</span><a name="line-1482"></a><span>
</span><a name="line-1483"></a><span class="hs-identifier">unexpectedTypeSigErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsSigWcType"><span class="hs-identifier hs-type">LHsSigWcType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1484"></a><a name="unexpectedTypeSigErr"><a href="RnTypes.html#unexpectedTypeSigErr"><span class="hs-identifier">unexpectedTypeSigErr</span></a></a><span> </span><a name="local-6989586621680036292"><a href="#local-6989586621680036292"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1485"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal type signature:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036292"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1486"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Type signatures are only allowed in patterns with ScopedTypeVariables&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1487"></a><span>
</span><a name="line-1488"></a><span class="hs-identifier">checkBadKindBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1489"></a><a name="checkBadKindBndrs"><a href="RnTypes.html#checkBadKindBndrs"><span class="hs-identifier">checkBadKindBndrs</span></a></a><span> </span><a name="local-6989586621680036293"><a href="#local-6989586621680036293"><span class="hs-identifier">doc</span></a></a><span> </span><a name="local-6989586621680036294"><a href="#local-6989586621680036294"><span class="hs-identifier">kvs</span></a></a><span>
</span><a name="line-1490"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680036294"><span class="hs-identifier hs-var">kvs</span></a><span class="hs-special">)</span><span>             </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1491"></a><span>    </span><a href="TcRnMonad.html#unlessXOptM"><span class="hs-identifier hs-var">unlessXOptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#PolyKinds"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">PolyKinds</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1492"></a><span>    </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><span class="hs-special">(</span><a href="RnUtils.html#withHsDocContext"><span class="hs-identifier hs-var">withHsDocContext</span></a><span> </span><a href="#local-6989586621680036293"><span class="hs-identifier hs-var">doc</span></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1493"></a><span>            </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unexpected kind variable&quot;</span><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#plural"><span class="hs-identifier hs-var">plural</span></a><span> </span><a href="#local-6989586621680036294"><span class="hs-identifier hs-var">kvs</span></a><span>
</span><a name="line-1494"></a><span>                  </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#pprQuotedList"><span class="hs-identifier hs-var">pprQuotedList</span></a><span> </span><a href="#local-6989586621680036294"><span class="hs-identifier hs-var">kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1495"></a><span>               </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use PolyKinds&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1496"></a><span>
</span><a name="line-1497"></a><span class="hs-identifier">badKindSigErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnUtils.html#HsDocContext"><span class="hs-identifier hs-type">HsDocContext</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1498"></a><a name="badKindSigErr"><a href="RnTypes.html#badKindSigErr"><span class="hs-identifier">badKindSigErr</span></a></a><span> </span><a name="local-6989586621680036295"><a href="#local-6989586621680036295"><span class="hs-identifier">doc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036296"><a href="#local-6989586621680036296"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680036297"><a href="#local-6989586621680036297"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1499"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a><span> </span><a href="#local-6989586621680036296"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TcRnMonad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1500"></a><span>    </span><a href="RnUtils.html#withHsDocContext"><span class="hs-identifier hs-var">withHsDocContext</span></a><span> </span><a href="#local-6989586621680036295"><span class="hs-identifier hs-var">doc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1501"></a><span>    </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal kind signature:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036297"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1502"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use KindSignatures&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1503"></a><span>
</span><a name="line-1504"></a><span class="hs-identifier">dataKindsErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#RnTyKiEnv"><span class="hs-identifier hs-type">RnTyKiEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1505"></a><a name="dataKindsErr"><a href="RnTypes.html#dataKindsErr"><span class="hs-identifier">dataKindsErr</span></a></a><span> </span><a name="local-6989586621680036298"><a href="#local-6989586621680036298"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621680036299"><a href="#local-6989586621680036299"><span class="hs-identifier">thing</span></a></a><span>
</span><a name="line-1506"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="#local-6989586621680036300"><span class="hs-identifier hs-var">pp_what</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036299"><span class="hs-identifier hs-var">thing</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1507"></a><span>       </span><span class="hs-number">2</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Perhaps you intended to use DataKinds&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1508"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1509"></a><span>    </span><a name="local-6989586621680036300"><a href="#local-6989586621680036300"><span class="hs-identifier">pp_what</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="RnTypes.html#isRnKindLevel"><span class="hs-identifier hs-var">isRnKindLevel</span></a><span> </span><a href="#local-6989586621680036298"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;kind&quot;</span><span>
</span><a name="line-1510"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;type&quot;</span><span>
</span><a name="line-1511"></a><span>
</span><a name="line-1512"></a><span class="hs-identifier">inTypeDoc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1513"></a><a name="inTypeDoc"><a href="RnTypes.html#inTypeDoc"><span class="hs-identifier">inTypeDoc</span></a></a><span> </span><a name="local-6989586621680036301"><a href="#local-6989586621680036301"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;In the type&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036301"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1514"></a><span>
</span><a name="line-1515"></a><span class="hs-identifier">warnUnusedForAll</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="NameSet.html#FreeVars"><span class="hs-identifier hs-type">FreeVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#TcM"><span class="hs-identifier hs-type">TcM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1516"></a><a name="warnUnusedForAll"><a href="RnTypes.html#warnUnusedForAll"><span class="hs-identifier">warnUnusedForAll</span></a></a><span> </span><a name="local-6989586621680036302"><a href="#local-6989586621680036302"><span class="hs-identifier">in_doc</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-6989586621680036303"><a href="#local-6989586621680036303"><span class="hs-identifier">loc</span></a></a><span> </span><a name="local-6989586621680036304"><a href="#local-6989586621680036304"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680036305"><a href="#local-6989586621680036305"><span class="hs-identifier">used_names</span></a></a><span>
</span><a name="line-1517"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TcRnMonad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedForalls"><span class="hs-identifier hs-var">Opt_WarnUnusedForalls</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1518"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#hsTyVarName"><span class="hs-identifier hs-var">hsTyVarName</span></a><span> </span><a href="#local-6989586621680036304"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><a href="NameSet.html#elemNameSet"><span class="hs-identifier hs-var">elemNameSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036305"><span class="hs-identifier hs-var">used_names</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1519"></a><span>    </span><a href="TcRnMonad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a><span> </span><span class="hs-special">(</span><a href="DynFlags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a><span> </span><a href="DynFlags.html#Opt_WarnUnusedForalls"><span class="hs-identifier hs-var">Opt_WarnUnusedForalls</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036303"><span class="hs-identifier hs-var">loc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1520"></a><span>    </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Unused quantified type variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036304"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1521"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680036302"><span class="hs-identifier hs-var">in_doc</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1522"></a><span>
</span><a name="line-1523"></a><span class="hs-identifier">opTyErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="#local-6989586621680035612"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680035612"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1524"></a><a name="opTyErr"><a href="RnTypes.html#opTyErr"><span class="hs-identifier">opTyErr</span></a></a><span> </span><a name="local-6989586621680036306"><a href="#local-6989586621680036306"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621680036307"><a href="#local-6989586621680036307"><span class="hs-identifier">overall_ty</span></a></a><span>
</span><a name="line-1525"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Illegal operator&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036306"><span class="hs-identifier hs-var">op</span></a><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a><span> </span><span class="hs-string">&quot;in type&quot;</span><span class="hs-special">)</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036307"><span class="hs-identifier hs-var">overall_ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1526"></a><span>         </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621680036308"><span class="hs-identifier hs-var">extra</span></a><span>
</span><a name="line-1527"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1528"></a><span>    </span><a name="local-6989586621680036308"><a href="#local-6989586621680036308"><span class="hs-identifier">extra</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621680036306"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#dot_tv_RDR"><span class="hs-identifier hs-var">dot_tv_RDR</span></a><span>
</span><a name="line-1529"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="RnUnbound.html#perhapsForallMsg"><span class="hs-identifier hs-var">perhapsForallMsg</span></a><span>
</span><a name="line-1530"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1531"></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Use TypeOperators to allow operators in types&quot;</span><span>
</span><a name="line-1532"></a><span>
</span><a name="line-1533"></a><span class="hs-identifier">emptyNonSymsErr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#HsType"><span class="hs-identifier hs-type">HsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1534"></a><a name="emptyNonSymsErr"><a href="RnTypes.html#emptyNonSymsErr"><span class="hs-identifier">emptyNonSymsErr</span></a></a><span> </span><a name="local-6989586621680036309"><a href="#local-6989586621680036309"><span class="hs-identifier">overall_ty</span></a></a><span>
</span><a name="line-1535"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Operator applied to too few arguments:&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036309"><span class="hs-identifier hs-var">overall_ty</span></a><span>
</span><a name="line-1536"></a><span>
</span><a name="line-1537"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
      Finding the free type variables of a (HsType RdrName)
*                                                                      *
************************************************************************


Note [Kind and type-variable binders]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In a type signature we may implicitly bind type variable and, more
recently, kind variables.  For example:
  *   f :: a -&gt; a
      f = ...
    Here we need to find the free type variables of (a -&gt; a),
    so that we know what to quantify

  *   class C (a :: k) where ...
    This binds 'k' in ..., as well as 'a'

  *   f (x :: a -&gt; [a]) = ....
    Here we bind 'a' in ....

  *   f (x :: T a -&gt; T (b :: k)) = ...
    Here we bind both 'a' and the kind variable 'k'

  *   type instance F (T (a :: Maybe k)) = ...a...k...
    Here we want to constrain the kind of 'a', and bind 'k'.

In general we want to walk over a type, and find
  * Its free type variables
  * The free kind variables of any kind signatures in the type

Hence we return a pair (kind-vars, type vars)
See also Note [HsBSig binder lists] in HsTypes

Most clients of this code just want to know the kind/type vars, without
duplicates. The function rmDupsInRdrTyVars removes duplicates. That function
also makes sure that no variable is reported as both a kind var and
a type var, preferring kind vars. Why kind vars? Consider this:

 foo :: forall (a :: k). Proxy k -&gt; Proxy a -&gt; ...

Should that be accepted?

Normally, if a type signature has an explicit forall, it must list *all*
tyvars mentioned in the type. But there's an exception for tyvars mentioned in
a kind, as k is above. Note that k is also used &quot;as a type variable&quot;, as the
argument to the first Proxy. So, do we consider k to be type-variable-like and
require it in the forall? Or do we consider k to be kind-variable-like and not
require it?

It's not just in type signatures: kind variables are implicitly brought into
scope in a variety of places. Should vars used at both the type level and kind
level be treated this way?

GHC indeed allows kind variables to be brought into scope implicitly even when
the kind variable is also used as a type variable. Thus, we must prefer to keep
a variable listed as a kind var in rmDupsInRdrTyVars. If we kept it as a type
var, then this would prevent it from being implicitly quantified (see
rnImplicitBndrs). In the `foo` example above, that would have the consequence
of the k in Proxy k being reported as out of scope.

-}</span><span>
</span><a name="line-1601"></a><span>
</span><a name="line-1602"></a><span class="hs-comment">-- See Note [Kind and type-variable binders]</span><span>
</span><a name="line-1603"></a><span class="hs-keyword">data</span><span> </span><a name="FreeKiTyVars"><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier">FreeKiTyVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="FKTV"><a href="RnTypes.html#FKTV"><span class="hs-identifier">FKTV</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="fktv_kis"><a href="RnTypes.html#fktv_kis"><span class="hs-identifier">fktv_kis</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1604"></a><span>                         </span><span class="hs-special">,</span><span> </span><a name="fktv_tys"><a href="RnTypes.html#fktv_tys"><span class="hs-identifier">fktv_tys</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1605"></a><span>
</span><a name="line-1606"></a><span class="hs-comment">-- | A 'FreeKiTyVars' list that is allowed to have duplicate variables.</span><span>
</span><a name="line-1607"></a><span class="hs-keyword">type</span><span> </span><a name="FreeKiTyVarsWithDups"><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier">FreeKiTyVarsWithDups</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1608"></a><span>
</span><a name="line-1609"></a><span class="hs-comment">-- | A 'FreeKiTyVars' list that contains no duplicate variables.</span><span>
</span><a name="line-1610"></a><span class="hs-keyword">type</span><span> </span><a name="FreeKiTyVarsNoDups"><a href="RnTypes.html#FreeKiTyVarsNoDups"><span class="hs-identifier">FreeKiTyVarsNoDups</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1611"></a><span>
</span><a name="line-1612"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1613"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680035601"><a href="#local-6989586621680035601"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621680035602"><a href="#local-6989586621680035602"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035601"><span class="hs-identifier hs-var">kis</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680035602"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1614"></a><span>
</span><a name="line-1615"></a><span class="hs-identifier">emptyFKTV</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVarsNoDups"><span class="hs-identifier hs-type">FreeKiTyVarsNoDups</span></a><span>
</span><a name="line-1616"></a><a name="emptyFKTV"><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier">emptyFKTV</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1617"></a><span>
</span><a name="line-1618"></a><span class="hs-identifier">freeKiTyVarsAllVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1619"></a><a name="freeKiTyVarsAllVars"><a href="RnTypes.html#freeKiTyVarsAllVars"><span class="hs-identifier">freeKiTyVarsAllVars</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680036310"><a href="#local-6989586621680036310"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621680036311"><a href="#local-6989586621680036311"><span class="hs-identifier">kvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036310"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680036311"><span class="hs-identifier hs-var">kvs</span></a><span>
</span><a name="line-1620"></a><span>
</span><a name="line-1621"></a><span class="hs-identifier">freeKiTyVarsKindVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1622"></a><a name="freeKiTyVarsKindVars"><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier">freeKiTyVarsKindVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fktv_kis</span><span>
</span><a name="line-1623"></a><span>
</span><a name="line-1624"></a><span class="hs-identifier">freeKiTyVarsTypeVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1625"></a><a name="freeKiTyVarsTypeVars"><a href="RnTypes.html#freeKiTyVarsTypeVars"><span class="hs-identifier">freeKiTyVarsTypeVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fktv_tys</span><span>
</span><a name="line-1626"></a><span>
</span><a name="line-1627"></a><span class="hs-identifier">filterInScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1628"></a><a name="filterInScope"><a href="RnTypes.html#filterInScope"><span class="hs-identifier">filterInScope</span></a></a><span> </span><a name="local-6989586621680036312"><a href="#local-6989586621680036312"><span class="hs-identifier">rdr_env</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680036313"><a href="#local-6989586621680036313"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621680036314"><a href="#local-6989586621680036314"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1629"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="#local-6989586621680036315"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621680036313"><span class="hs-identifier hs-var">kis</span></a><span class="hs-special">)</span><span>
</span><a name="line-1630"></a><span>         </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><a href="#local-6989586621680036315"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621680036314"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1631"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1632"></a><span>    </span><a name="local-6989586621680036315"><a href="#local-6989586621680036315"><span class="hs-identifier">in_scope</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#inScope"><span class="hs-identifier hs-var">inScope</span></a><span> </span><a href="#local-6989586621680036312"><span class="hs-identifier hs-var">rdr_env</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span>
</span><a name="line-1633"></a><span>
</span><a name="line-1634"></a><span class="hs-identifier">inScope</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RdrName.html#LocalRdrEnv"><span class="hs-identifier hs-type">LocalRdrEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1635"></a><a name="inScope"><a href="RnTypes.html#inScope"><span class="hs-identifier">inScope</span></a></a><span> </span><a name="local-6989586621680036316"><a href="#local-6989586621680036316"><span class="hs-identifier">rdr_env</span></a></a><span> </span><a name="local-6989586621680036317"><a href="#local-6989586621680036317"><span class="hs-identifier">rdr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036317"><span class="hs-identifier hs-var">rdr</span></a><span> </span><span class="hs-special">`</span><a href="RdrName.html#elemLocalRdrEnv"><span class="hs-identifier hs-var">elemLocalRdrEnv</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036316"><span class="hs-identifier hs-var">rdr_env</span></a><span>
</span><a name="line-1636"></a><span>
</span><a name="line-1637"></a><span class="hs-comment">-- | 'extractHsTyRdrTyVars' finds the</span><span>
</span><a name="line-1638"></a><span class="hs-comment">--        free (kind, type) variables of an 'HsType'</span><span>
</span><a name="line-1639"></a><span class="hs-comment">-- or the free (sort, kind) variables of an 'HsKind'.</span><span>
</span><a name="line-1640"></a><span class="hs-comment">-- It's used when making the @forall@s explicit.</span><span>
</span><a name="line-1641"></a><span class="hs-comment">-- Does not return any wildcards.</span><span>
</span><a name="line-1642"></a><span class="hs-comment">-- When the same name occurs multiple times in the types, only the first</span><span>
</span><a name="line-1643"></a><span class="hs-comment">-- occurrence is returned.</span><span>
</span><a name="line-1644"></a><span class="hs-comment">-- See Note [Kind and type-variable binders]</span><span>
</span><a name="line-1645"></a><span class="hs-identifier">extractHsTyRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsNoDups"><span class="hs-identifier hs-type">FreeKiTyVarsNoDups</span></a><span>
</span><a name="line-1646"></a><a name="extractHsTyRdrTyVars"><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier">extractHsTyRdrTyVars</span></a></a><span> </span><a name="local-6989586621680036318"><a href="#local-6989586621680036318"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1647"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier hs-var">rmDupsInRdrTyVars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVarsDups"><span class="hs-identifier hs-var">extractHsTyRdrTyVarsDups</span></a><span> </span><a href="#local-6989586621680036318"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1648"></a><span>
</span><a name="line-1649"></a><span class="hs-comment">-- | 'extractHsTyRdrTyVarsDups' find the</span><span>
</span><a name="line-1650"></a><span class="hs-comment">--        free (kind, type) variables of an 'HsType'</span><span>
</span><a name="line-1651"></a><span class="hs-comment">-- or the free (sort, kind) variables of an 'HsKind'.</span><span>
</span><a name="line-1652"></a><span class="hs-comment">-- It's used when making the @forall@s explicit.</span><span>
</span><a name="line-1653"></a><span class="hs-comment">-- Does not return any wildcards.</span><span>
</span><a name="line-1654"></a><span class="hs-comment">-- When the same name occurs multiple times in the types, all occurrences</span><span>
</span><a name="line-1655"></a><span class="hs-comment">-- are returned.</span><span>
</span><a name="line-1656"></a><span class="hs-identifier">extractHsTyRdrTyVarsDups</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1657"></a><a name="extractHsTyRdrTyVarsDups"><a href="RnTypes.html#extractHsTyRdrTyVarsDups"><span class="hs-identifier">extractHsTyRdrTyVarsDups</span></a></a><span> </span><a name="local-6989586621680036319"><a href="#local-6989586621680036319"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1658"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621680036319"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1659"></a><span>
</span><a name="line-1660"></a><span class="hs-comment">-- | Extracts the free kind variables (but not the type variables) of an</span><span>
</span><a name="line-1661"></a><span class="hs-comment">-- 'HsType'. Does not return any wildcards.</span><span>
</span><a name="line-1662"></a><span class="hs-comment">-- When the same name occurs multiple times in the type, only the first</span><span>
</span><a name="line-1663"></a><span class="hs-comment">-- occurrence is returned.</span><span>
</span><a name="line-1664"></a><span class="hs-comment">-- See Note [Kind and type-variable binders]</span><span>
</span><a name="line-1665"></a><span class="hs-identifier">extractHsTyRdrTyVarsKindVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1666"></a><a name="extractHsTyRdrTyVarsKindVars"><a href="RnTypes.html#extractHsTyRdrTyVarsKindVars"><span class="hs-identifier">extractHsTyRdrTyVarsKindVars</span></a></a><span> </span><a name="local-6989586621680036320"><a href="#local-6989586621680036320"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1667"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier hs-var">freeKiTyVarsKindVars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span> </span><a href="#local-6989586621680036320"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1668"></a><span>
</span><a name="line-1669"></a><span class="hs-comment">-- | Extracts free type and kind variables from types in a list.</span><span>
</span><a name="line-1670"></a><span class="hs-comment">-- When the same name occurs multiple times in the types, only the first</span><span>
</span><a name="line-1671"></a><span class="hs-comment">-- occurrence is returned and the rest is filtered out.</span><span>
</span><a name="line-1672"></a><span class="hs-comment">-- See Note [Kind and type-variable binders]</span><span>
</span><a name="line-1673"></a><span class="hs-identifier">extractHsTysRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsNoDups"><span class="hs-identifier hs-type">FreeKiTyVarsNoDups</span></a><span>
</span><a name="line-1674"></a><a name="extractHsTysRdrTyVars"><a href="RnTypes.html#extractHsTysRdrTyVars"><span class="hs-identifier">extractHsTysRdrTyVars</span></a></a><span> </span><a name="local-6989586621680036321"><a href="#local-6989586621680036321"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1675"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier hs-var">rmDupsInRdrTyVars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTysRdrTyVarsDups"><span class="hs-identifier hs-var">extractHsTysRdrTyVarsDups</span></a><span> </span><a href="#local-6989586621680036321"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1676"></a><span>
</span><a name="line-1677"></a><span class="hs-comment">-- | Extracts free type and kind variables from types in a list.</span><span>
</span><a name="line-1678"></a><span class="hs-comment">-- When the same name occurs multiple times in the types, all occurrences</span><span>
</span><a name="line-1679"></a><span class="hs-comment">-- are returned.</span><span>
</span><a name="line-1680"></a><span class="hs-identifier">extractHsTysRdrTyVarsDups</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1681"></a><a name="extractHsTysRdrTyVarsDups"><a href="RnTypes.html#extractHsTysRdrTyVarsDups"><span class="hs-identifier">extractHsTysRdrTyVarsDups</span></a></a><span> </span><a name="local-6989586621680036322"><a href="#local-6989586621680036322"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1682"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621680036322"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1683"></a><span>
</span><a name="line-1684"></a><span class="hs-identifier">extractHsTyVarBndrsKVs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1685"></a><span class="hs-comment">-- Returns the free kind variables of any explictly-kinded binders</span><span>
</span><a name="line-1686"></a><span class="hs-comment">-- NB: Does /not/ delete the binders themselves.</span><span>
</span><a name="line-1687"></a><span class="hs-comment">--     However duplicates are removed</span><span>
</span><a name="line-1688"></a><span class="hs-comment">--     E.g. given  [k1, a:k1, b:k2]</span><span>
</span><a name="line-1689"></a><span class="hs-comment">--          the function returns [k1,k2], even though k1 is bound here</span><span>
</span><a name="line-1690"></a><a name="extractHsTyVarBndrsKVs"><a href="RnTypes.html#extractHsTyVarBndrsKVs"><span class="hs-identifier">extractHsTyVarBndrsKVs</span></a></a><span> </span><a name="local-6989586621680036323"><a href="#local-6989586621680036323"><span class="hs-identifier">tv_bndrs</span></a></a><span>
</span><a name="line-1691"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036324"><a href="#local-6989586621680036324"><span class="hs-identifier">kvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extract_hs_tv_bndrs_kvs"><span class="hs-identifier hs-var">extract_hs_tv_bndrs_kvs</span></a><span> </span><a href="#local-6989586621680036323"><span class="hs-identifier hs-var">tv_bndrs</span></a><span>
</span><a name="line-1692"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621680036324"><span class="hs-identifier hs-var">kvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1693"></a><span>
</span><a name="line-1694"></a><span class="hs-comment">-- | Removes multiple occurrences of the same name from FreeKiTyVars. If a</span><span>
</span><a name="line-1695"></a><span class="hs-comment">-- variable occurs as both a kind and a type variable, only keep the occurrence</span><span>
</span><a name="line-1696"></a><span class="hs-comment">-- as a kind variable.</span><span>
</span><a name="line-1697"></a><span class="hs-comment">-- See also Note [Kind and type-variable binders]</span><span>
</span><a name="line-1698"></a><span class="hs-identifier">rmDupsInRdrTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsNoDups"><span class="hs-identifier hs-type">FreeKiTyVarsNoDups</span></a><span>
</span><a name="line-1699"></a><a name="rmDupsInRdrTyVars"><a href="RnTypes.html#rmDupsInRdrTyVars"><span class="hs-identifier">rmDupsInRdrTyVars</span></a></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680036325"><a href="#local-6989586621680036325"><span class="hs-identifier">kis</span></a></a><span> </span><a name="local-6989586621680036326"><a href="#local-6989586621680036326"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1700"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a href="#local-6989586621680036327"><span class="hs-identifier hs-var">kis'</span></a><span> </span><a href="#local-6989586621680036328"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-1701"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1702"></a><span>    </span><a name="local-6989586621680036327"><a href="#local-6989586621680036327"><span class="hs-identifier">kis'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="#local-6989586621680036325"><span class="hs-identifier hs-var">kis</span></a><span>
</span><a name="line-1703"></a><span>    </span><a name="local-6989586621680036328"><a href="#local-6989586621680036328"><span class="hs-identifier">tys'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="RnTypes.html#elemRdr"><span class="hs-identifier hs-var">elemRdr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036327"><span class="hs-identifier hs-var">kis'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036326"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1704"></a><span>
</span><a name="line-1705"></a><span class="hs-identifier">extractRdrKindSigVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#LFamilyResultSig"><span class="hs-identifier hs-type">LFamilyResultSig</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1706"></a><a name="extractRdrKindSigVars"><a href="RnTypes.html#extractRdrKindSigVars"><span class="hs-identifier">extractRdrKindSigVars</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036329"><a href="#local-6989586621680036329"><span class="hs-identifier">resultSig</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1707"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="HsDecls.html#KindSig"><span class="hs-identifier hs-var">KindSig</span></a><span> </span><a name="local-6989586621680036332"><a href="#local-6989586621680036332"><span class="hs-identifier">k</span></a></a><span>                        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680036329"><span class="hs-identifier hs-var">resultSig</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036330"><span class="hs-identifier hs-var">kindRdrNameFromSig</span></a><span> </span><a href="#local-6989586621680036332"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1708"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="HsDecls.html#TyVarSig"><span class="hs-identifier hs-var">TyVarSig</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036333"><a href="#local-6989586621680036333"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680036329"><span class="hs-identifier hs-var">resultSig</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036330"><span class="hs-identifier hs-var">kindRdrNameFromSig</span></a><span> </span><a href="#local-6989586621680036333"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1709"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1710"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621680036330"><a href="#local-6989586621680036330"><span class="hs-identifier">kindRdrNameFromSig</span></a></a><span> </span><a name="local-6989586621680036331"><a href="#local-6989586621680036331"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#freeKiTyVarsAllVars"><span class="hs-identifier hs-var">freeKiTyVarsAllVars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="RnTypes.html#extractHsTyRdrTyVars"><span class="hs-identifier hs-var">extractHsTyRdrTyVars</span></a><span> </span><a href="#local-6989586621680036331"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1711"></a><span>
</span><a name="line-1712"></a><span class="hs-identifier">extractDataDefnKindVars</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1713"></a><span class="hs-comment">-- Get the scoped kind variables mentioned free in the constructor decls</span><span>
</span><a name="line-1714"></a><span class="hs-comment">-- Eg: data T a = T1 (S (a :: k) | forall (b::k). T2 (S b)</span><span>
</span><a name="line-1715"></a><span class="hs-comment">--     Here k should scope over the whole definition</span><span>
</span><a name="line-1716"></a><span class="hs-comment">--</span><span>
</span><a name="line-1717"></a><span class="hs-comment">-- However, do NOT collect free kind vars from the deriving clauses:</span><span>
</span><a name="line-1718"></a><span class="hs-comment">-- Eg: (Trac #14331)    class C p q</span><span>
</span><a name="line-1719"></a><span class="hs-comment">--                      data D = D deriving ( C (a :: k) )</span><span>
</span><a name="line-1720"></a><span class="hs-comment">--     Here k should /not/ scope over the whole definition.  We intend</span><span>
</span><a name="line-1721"></a><span class="hs-comment">--     this to elaborate to:</span><span>
</span><a name="line-1722"></a><span class="hs-comment">--         class C @k1 @k2 (p::k1) (q::k2)</span><span>
</span><a name="line-1723"></a><span class="hs-comment">--         data D = D</span><span>
</span><a name="line-1724"></a><span class="hs-comment">--         instance forall k (a::k). C @k @* a D where ...</span><span>
</span><a name="line-1725"></a><span class="hs-comment">--</span><span>
</span><a name="line-1726"></a><a name="extractDataDefnKindVars"><a href="RnTypes.html#extractDataDefnKindVars"><span class="hs-identifier">extractDataDefnKindVars</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#HsDataDefn"><span class="hs-identifier hs-var">HsDataDefn</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">dd_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036334"><a href="#local-6989586621680036334"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_kindSig</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036335"><a href="#local-6989586621680036335"><span class="hs-identifier">ksig</span></a></a><span>
</span><a name="line-1727"></a><span>                                    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">dd_cons</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036336"><a href="#local-6989586621680036336"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-1728"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="RnTypes.html#nubL"><span class="hs-identifier hs-var">nubL</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier hs-var">freeKiTyVarsKindVars</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span>
</span><a name="line-1729"></a><span>    </span><span class="hs-special">(</span><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier hs-var">extract_lctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621680036334"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1730"></a><span>     </span><a href="RnTypes.html#extract_mb"><span class="hs-identifier hs-var">extract_mb</span></a><span> </span><a href="RnTypes.html#extract_lkind"><span class="hs-identifier hs-var">extract_lkind</span></a><span> </span><a href="#local-6989586621680036335"><span class="hs-identifier hs-var">ksig</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1731"></a><span>     </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036337"><span class="hs-identifier hs-var">extract_con</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span> </span><a href="#local-6989586621680036336"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">)</span><span>
</span><a name="line-1732"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1733"></a><span>    </span><a name="local-6989586621680036337"><a href="#local-6989586621680036337"><span class="hs-identifier">extract_con</span></a></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclGADT"><span class="hs-identifier hs-var">ConDeclGADT</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036338"><a href="#local-6989586621680036338"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036338"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1734"></a><span>    </span><span class="hs-identifier">extract_con</span><span> </span><span class="hs-special">(</span><a href="HsDecls.html#ConDeclH98"><span class="hs-identifier hs-var">ConDeclH98</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">con_ex_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036339"><a href="#local-6989586621680036339"><span class="hs-identifier">ex_tvs</span></a></a><span>
</span><a name="line-1735"></a><span>                            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_mb_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036340"><a href="#local-6989586621680036340"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">con_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036341"><a href="#local-6989586621680036341"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036342"><a href="#local-6989586621680036342"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-1736"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_hs_tv_bndrs"><span class="hs-identifier hs-var">extract_hs_tv_bndrs</span></a><span> </span><a href="#local-6989586621680036339"><span class="hs-identifier hs-var">ex_tvs</span></a><span> </span><a href="#local-6989586621680036342"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1737"></a><span>        </span><a href="RnTypes.html#extract_mlctxt"><span class="hs-identifier hs-var">extract_mlctxt</span></a><span> </span><a href="#local-6989586621680036340"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1738"></a><span>        </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><span class="hs-special">(</span><a href="HsDecls.html#hsConDeclArgTys"><span class="hs-identifier hs-var">hsConDeclArgTys</span></a><span> </span><a href="#local-6989586621680036341"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1739"></a><span>
</span><a name="line-1740"></a><span class="hs-identifier">extract_mlctxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1741"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1742"></a><a name="extract_mlctxt"><a href="RnTypes.html#extract_mlctxt"><span class="hs-identifier">extract_mlctxt</span></a></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>     </span><a name="local-6989586621680036343"><a href="#local-6989586621680036343"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036343"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1743"></a><span class="hs-identifier">extract_mlctxt</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680036344"><a href="#local-6989586621680036344"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680036345"><a href="#local-6989586621680036345"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier hs-var">extract_lctxt</span></a><span> </span><a href="TcRnTypes.html#TypeLevel"><span class="hs-identifier hs-var">TypeLevel</span></a><span> </span><a href="#local-6989586621680036344"><span class="hs-identifier hs-var">ctxt</span></a><span> </span><a href="#local-6989586621680036345"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1744"></a><span>
</span><a name="line-1745"></a><span class="hs-identifier">extract_lctxt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>
</span><a name="line-1746"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsContext"><span class="hs-identifier hs-type">LHsContext</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1747"></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1748"></a><a name="extract_lctxt"><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier">extract_lctxt</span></a></a><span> </span><a name="local-6989586621680036346"><a href="#local-6989586621680036346"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621680036347"><a href="#local-6989586621680036347"><span class="hs-identifier">ctxt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621680036346"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span> </span><a href="#local-6989586621680036347"><span class="hs-identifier hs-var">ctxt</span></a><span class="hs-special">)</span><span>
</span><a name="line-1749"></a><span>
</span><a name="line-1750"></a><span class="hs-identifier">extract_ltys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>
</span><a name="line-1751"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1752"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1753"></a><a name="extract_ltys"><a href="RnTypes.html#extract_ltys"><span class="hs-identifier">extract_ltys</span></a></a><span> </span><a name="local-6989586621680036348"><a href="#local-6989586621680036348"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621680036349"><a href="#local-6989586621680036349"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621680036350"><a href="#local-6989586621680036350"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036348"><span class="hs-identifier hs-var">t_or_k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036350"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621680036349"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1754"></a><span>
</span><a name="line-1755"></a><span class="hs-identifier">extract_mb</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680035611"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span class="hs-special">)</span><span>
</span><a name="line-1756"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621680035611"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1757"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1758"></a><a name="extract_mb"><a href="RnTypes.html#extract_mb"><span class="hs-identifier">extract_mb</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><a name="local-6989586621680036351"><a href="#local-6989586621680036351"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036351"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1759"></a><span class="hs-identifier">extract_mb</span><span> </span><a name="local-6989586621680036352"><a href="#local-6989586621680036352"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621680036353"><a href="#local-6989586621680036353"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680036354"><a href="#local-6989586621680036354"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621680036352"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680036353"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621680036354"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1760"></a><span>
</span><a name="line-1761"></a><span class="hs-identifier">extract_lkind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1762"></a><a name="extract_lkind"><a href="RnTypes.html#extract_lkind"><span class="hs-identifier">extract_lkind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="TcRnTypes.html#KindLevel"><span class="hs-identifier hs-var">KindLevel</span></a><span>
</span><a name="line-1763"></a><span>
</span><a name="line-1764"></a><span class="hs-identifier">extract_lty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsType"><span class="hs-identifier hs-type">LHsType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1765"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1766"></a><a name="extract_lty"><a href="RnTypes.html#extract_lty"><span class="hs-identifier">extract_lty</span></a></a><span> </span><a name="local-6989586621680036355"><a href="#local-6989586621680036355"><span class="hs-identifier">t_or_k</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036356"><a href="#local-6989586621680036356"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680036357"><a href="#local-6989586621680036357"><span class="hs-identifier">acc</span></a></a><span>
</span><a name="line-1767"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621680036356"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1768"></a><span>      </span><a href="HsTypes.html#HsTyVar"><span class="hs-identifier hs-var">HsTyVar</span></a><span> </span><span class="hs-identifier">_</span><span>  </span><a name="local-6989586621680036358"><a href="#local-6989586621680036358"><span class="hs-identifier">ltv</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_tv"><span class="hs-identifier hs-var">extract_tv</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036358"><span class="hs-identifier hs-var">ltv</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1769"></a><span>      </span><a href="HsTypes.html#HsBangTy"><span class="hs-identifier hs-var">HsBangTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036359"><a href="#local-6989586621680036359"><span class="hs-identifier">ty</span></a></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036359"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1770"></a><span>      </span><a href="HsTypes.html#HsRecTy"><span class="hs-identifier hs-var">HsRecTy</span></a><span> </span><a name="local-6989586621680036360"><a href="#local-6989586621680036360"><span class="hs-identifier">flds</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span>
</span><a name="line-1771"></a><span>                                           </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">cd_fld_type</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1772"></a><span>                                         </span><a href="#local-6989586621680036360"><span class="hs-identifier hs-var">flds</span></a><span>
</span><a name="line-1773"></a><span>      </span><a href="HsTypes.html#HsAppsTy"><span class="hs-identifier hs-var">HsAppsTy</span></a><span> </span><a name="local-6989586621680036361"><a href="#local-6989586621680036361"><span class="hs-identifier">tys</span></a></a><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_apps"><span class="hs-identifier hs-var">extract_apps</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036361"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1774"></a><span>      </span><a href="HsTypes.html#HsAppTy"><span class="hs-identifier hs-var">HsAppTy</span></a><span> </span><a name="local-6989586621680036362"><a href="#local-6989586621680036362"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036363"><a href="#local-6989586621680036363"><span class="hs-identifier">ty2</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036362"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1775"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036363"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1776"></a><span>      </span><a href="HsTypes.html#HsListTy"><span class="hs-identifier hs-var">HsListTy</span></a><span> </span><a name="local-6989586621680036364"><a href="#local-6989586621680036364"><span class="hs-identifier">ty</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036364"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1777"></a><span>      </span><a href="HsTypes.html#HsPArrTy"><span class="hs-identifier hs-var">HsPArrTy</span></a><span> </span><a name="local-6989586621680036365"><a href="#local-6989586621680036365"><span class="hs-identifier">ty</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036365"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1778"></a><span>      </span><a href="HsTypes.html#HsTupleTy"><span class="hs-identifier hs-var">HsTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036366"><a href="#local-6989586621680036366"><span class="hs-identifier">tys</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036366"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1779"></a><span>      </span><a href="HsTypes.html#HsSumTy"><span class="hs-identifier hs-var">HsSumTy</span></a><span> </span><a name="local-6989586621680036367"><a href="#local-6989586621680036367"><span class="hs-identifier">tys</span></a></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036367"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1780"></a><span>      </span><a href="HsTypes.html#HsFunTy"><span class="hs-identifier hs-var">HsFunTy</span></a><span> </span><a name="local-6989586621680036368"><a href="#local-6989586621680036368"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036369"><a href="#local-6989586621680036369"><span class="hs-identifier">ty2</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036368"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1781"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036369"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1782"></a><span>      </span><a href="HsTypes.html#HsIParamTy"><span class="hs-identifier hs-var">HsIParamTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036370"><a href="#local-6989586621680036370"><span class="hs-identifier">ty</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036370"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1783"></a><span>      </span><a href="HsTypes.html#HsEqTy"><span class="hs-identifier hs-var">HsEqTy</span></a><span> </span><a name="local-6989586621680036371"><a href="#local-6989586621680036371"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036372"><a href="#local-6989586621680036372"><span class="hs-identifier">ty2</span></a></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036371"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1784"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036372"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1785"></a><span>      </span><a href="HsTypes.html#HsOpTy"><span class="hs-identifier hs-var">HsOpTy</span></a><span> </span><a name="local-6989586621680036373"><a href="#local-6989586621680036373"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621680036374"><a href="#local-6989586621680036374"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621680036375"><a href="#local-6989586621680036375"><span class="hs-identifier">ty2</span></a></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_tv"><span class="hs-identifier hs-var">extract_tv</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036374"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1786"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036373"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1787"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036375"><span class="hs-identifier hs-var">ty2</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1788"></a><span>      </span><a href="HsTypes.html#HsParTy"><span class="hs-identifier hs-var">HsParTy</span></a><span> </span><a name="local-6989586621680036376"><a href="#local-6989586621680036376"><span class="hs-identifier">ty</span></a></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036376"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1789"></a><span>      </span><a href="HsTypes.html#HsCoreTy"><span class="hs-identifier hs-var">HsCoreTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>  </span><span class="hs-comment">-- The type is closed</span><span>
</span><a name="line-1790"></a><span>      </span><a href="HsTypes.html#HsSpliceTy"><span class="hs-identifier hs-var">HsSpliceTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>  </span><span class="hs-comment">-- Type splices mention no tvs</span><span>
</span><a name="line-1791"></a><span>      </span><a href="HsTypes.html#HsDocTy"><span class="hs-identifier hs-var">HsDocTy</span></a><span> </span><a name="local-6989586621680036377"><a href="#local-6989586621680036377"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036377"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1792"></a><span>      </span><a href="HsTypes.html#HsExplicitListTy"><span class="hs-identifier hs-var">HsExplicitListTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036378"><a href="#local-6989586621680036378"><span class="hs-identifier">tys</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036378"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1793"></a><span>      </span><a href="HsTypes.html#HsExplicitTupleTy"><span class="hs-identifier hs-var">HsExplicitTupleTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036379"><a href="#local-6989586621680036379"><span class="hs-identifier">tys</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_ltys"><span class="hs-identifier hs-var">extract_ltys</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036379"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1794"></a><span>      </span><a href="HsTypes.html#HsTyLit"><span class="hs-identifier hs-var">HsTyLit</span></a><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1795"></a><span>      </span><a href="HsTypes.html#HsKindSig"><span class="hs-identifier hs-var">HsKindSig</span></a><span> </span><a name="local-6989586621680036380"><a href="#local-6989586621680036380"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621680036381"><a href="#local-6989586621680036381"><span class="hs-identifier">ki</span></a></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036380"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1796"></a><span>                                   </span><a href="RnTypes.html#extract_lkind"><span class="hs-identifier hs-var">extract_lkind</span></a><span> </span><a href="#local-6989586621680036381"><span class="hs-identifier hs-var">ki</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1797"></a><span>      </span><a href="HsTypes.html#HsForAllTy"><span class="hs-identifier hs-var">HsForAllTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_bndrs</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036382"><a href="#local-6989586621680036382"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036383"><a href="#local-6989586621680036383"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1798"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_hs_tv_bndrs"><span class="hs-identifier hs-var">extract_hs_tv_bndrs</span></a><span> </span><a href="#local-6989586621680036382"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1799"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036383"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1800"></a><span>      </span><a href="HsTypes.html#HsQualTy"><span class="hs-identifier hs-var">HsQualTy</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">hst_ctxt</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036384"><a href="#local-6989586621680036384"><span class="hs-identifier">ctxt</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">hst_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621680036385"><a href="#local-6989586621680036385"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1801"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#extract_lctxt"><span class="hs-identifier hs-var">extract_lctxt</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036384"><span class="hs-identifier hs-var">ctxt</span></a><span>   </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3D%3C%3C"><span class="hs-operator hs-var">=&lt;&lt;</span></a><span>
</span><a name="line-1802"></a><span>                                   </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036355"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036385"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1803"></a><span>      </span><span class="hs-comment">-- We deal with these separately in rnLHsTypeWithWildCards</span><span>
</span><a name="line-1804"></a><span>      </span><a href="HsTypes.html#HsWildCardTy"><span class="hs-identifier hs-var">HsWildCardTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036357"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1805"></a><span>
</span><a name="line-1806"></a><span class="hs-identifier">extract_apps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span>
</span><a name="line-1807"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsAppType"><span class="hs-identifier hs-type">LHsAppType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVars"><span class="hs-identifier hs-type">FreeKiTyVars</span></a><span>
</span><a name="line-1808"></a><a name="extract_apps"><a href="RnTypes.html#extract_apps"><span class="hs-identifier">extract_apps</span></a></a><span> </span><a name="local-6989586621680036386"><a href="#local-6989586621680036386"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621680036387"><a href="#local-6989586621680036387"><span class="hs-identifier">tys</span></a></a><span> </span><a name="local-6989586621680036388"><a href="#local-6989586621680036388"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#extract_app"><span class="hs-identifier hs-var">extract_app</span></a><span> </span><a href="#local-6989586621680036386"><span class="hs-identifier hs-var">t_or_k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036388"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621680036387"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1809"></a><span>
</span><a name="line-1810"></a><span class="hs-identifier">extract_app</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="HsTypes.html#LHsAppType"><span class="hs-identifier hs-type">LHsAppType</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span>
</span><a name="line-1811"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1812"></a><a name="extract_app"><a href="RnTypes.html#extract_app"><span class="hs-identifier">extract_app</span></a></a><span> </span><a name="local-6989586621680036389"><a href="#local-6989586621680036389"><span class="hs-identifier">t_or_k</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppInfix"><span class="hs-identifier hs-var">HsAppInfix</span></a><span> </span><a name="local-6989586621680036390"><a href="#local-6989586621680036390"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><a name="local-6989586621680036391"><a href="#local-6989586621680036391"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_tv"><span class="hs-identifier hs-var">extract_tv</span></a><span> </span><a href="#local-6989586621680036389"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036390"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621680036391"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1813"></a><span class="hs-identifier">extract_app</span><span> </span><a name="local-6989586621680036392"><a href="#local-6989586621680036392"><span class="hs-identifier">t_or_k</span></a></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#HsAppPrefix"><span class="hs-identifier hs-var">HsAppPrefix</span></a><span> </span><a name="local-6989586621680036393"><a href="#local-6989586621680036393"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a name="local-6989586621680036394"><a href="#local-6989586621680036394"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_lty"><span class="hs-identifier hs-var">extract_lty</span></a><span> </span><a href="#local-6989586621680036392"><span class="hs-identifier hs-var">t_or_k</span></a><span> </span><a href="#local-6989586621680036393"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621680036394"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1814"></a><span>
</span><a name="line-1815"></a><span class="hs-identifier">extractHsTvBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1816"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>           </span><span class="hs-comment">-- Free in body</span><span>
</span><a name="line-1817"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>       </span><span class="hs-comment">-- Free in result</span><span>
</span><a name="line-1818"></a><a name="extractHsTvBndrs"><a href="RnTypes.html#extractHsTvBndrs"><span class="hs-identifier">extractHsTvBndrs</span></a></a><span> </span><a name="local-6989586621680036395"><a href="#local-6989586621680036395"><span class="hs-identifier">tv_bndrs</span></a></a><span> </span><a name="local-6989586621680036396"><a href="#local-6989586621680036396"><span class="hs-identifier">body_fvs</span></a></a><span>
</span><a name="line-1819"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="RnTypes.html#extract_hs_tv_bndrs"><span class="hs-identifier hs-var">extract_hs_tv_bndrs</span></a><span> </span><a href="#local-6989586621680036395"><span class="hs-identifier hs-var">tv_bndrs</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span> </span><a href="#local-6989586621680036396"><span class="hs-identifier hs-var">body_fvs</span></a><span>
</span><a name="line-1820"></a><span>
</span><a name="line-1821"></a><span class="hs-identifier">extract_hs_tv_bndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1822"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>  </span><span class="hs-comment">-- Accumulator</span><span>
</span><a name="line-1823"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>  </span><span class="hs-comment">-- Free in body</span><span>
</span><a name="line-1824"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1825"></a><span class="hs-comment">-- In (forall (a :: Maybe e). a -&gt; b) we have</span><span>
</span><a name="line-1826"></a><span class="hs-comment">--     'a' is bound by the forall</span><span>
</span><a name="line-1827"></a><span class="hs-comment">--     'b' is a free type variable</span><span>
</span><a name="line-1828"></a><span class="hs-comment">--     'e' is a free kind variable</span><span>
</span><a name="line-1829"></a><a name="extract_hs_tv_bndrs"><a href="RnTypes.html#extract_hs_tv_bndrs"><span class="hs-identifier">extract_hs_tv_bndrs</span></a></a><span> </span><a name="local-6989586621680036397"><a href="#local-6989586621680036397"><span class="hs-identifier">tv_bndrs</span></a></a><span>
</span><a name="line-1830"></a><span>                    </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680036398"><a href="#local-6989586621680036398"><span class="hs-identifier">acc_kvs</span></a></a><span>  </span><a name="local-6989586621680036399"><a href="#local-6989586621680036399"><span class="hs-identifier">acc_tvs</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Accumulator</span><span>
</span><a name="line-1831"></a><span>                    </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680036400"><a href="#local-6989586621680036400"><span class="hs-identifier">body_kvs</span></a></a><span> </span><a name="local-6989586621680036401"><a href="#local-6989586621680036401"><span class="hs-identifier">body_tvs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Free in the body</span><span>
</span><a name="line-1832"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621680036397"><span class="hs-identifier hs-var">tv_bndrs</span></a><span>
</span><a name="line-1833"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1834"></a><span>    </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036400"><span class="hs-identifier hs-var">body_kvs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680036398"><span class="hs-identifier hs-var">acc_kvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036401"><span class="hs-identifier hs-var">body_tvs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680036399"><span class="hs-identifier hs-var">acc_tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1835"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1836"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036402"><a href="#local-6989586621680036402"><span class="hs-identifier">bndr_kvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RnTypes.html#extract_hs_tv_bndrs_kvs"><span class="hs-identifier hs-var">extract_hs_tv_bndrs_kvs</span></a><span> </span><a href="#local-6989586621680036397"><span class="hs-identifier hs-var">tv_bndrs</span></a><span>
</span><a name="line-1837"></a><span>
</span><a name="line-1838"></a><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">tv_bndr_rdrs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1839"></a><span>             </span><a name="local-6989586621680036403"><a href="#local-6989586621680036403"><span class="hs-identifier">tv_bndr_rdrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="HsTypes.html#hsLTyVarLocName"><span class="hs-identifier hs-var">hsLTyVarLocName</span></a><span> </span><a href="#local-6989586621680036397"><span class="hs-identifier hs-var">tv_bndrs</span></a><span>
</span><a name="line-1840"></a><span>
</span><a name="line-1841"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="TcRnMonad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a><span> </span><span class="hs-string">&quot;checkMixedVars1&quot;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1842"></a><span>           </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;body_kvs&quot;</span><span>     </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036400"><span class="hs-identifier hs-var">body_kvs</span></a><span>
</span><a name="line-1843"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;tv_bndr_rdrs&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036403"><span class="hs-identifier hs-var">tv_bndr_rdrs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1844"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="RnTypes.html#checkMixedVars"><span class="hs-identifier hs-var">checkMixedVars</span></a><span> </span><a href="#local-6989586621680036400"><span class="hs-identifier hs-var">body_kvs</span></a><span> </span><a href="#local-6989586621680036403"><span class="hs-identifier hs-var">tv_bndr_rdrs</span></a><span>
</span><a name="line-1845"></a><span>
</span><a name="line-1846"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1847"></a><span>         </span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="RnTypes.html#elemRdr"><span class="hs-identifier hs-var">elemRdr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036403"><span class="hs-identifier hs-var">tv_bndr_rdrs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036402"><span class="hs-identifier hs-var">bndr_kvs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680036400"><span class="hs-identifier hs-var">body_kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1848"></a><span>                    </span><span class="hs-comment">-- NB: delete all tv_bndr_rdrs from bndr_kvs as well</span><span>
</span><a name="line-1849"></a><span>                    </span><span class="hs-comment">-- as body_kvs; see Note [Kind variable scoping]</span><span>
</span><a name="line-1850"></a><span>                </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680036398"><span class="hs-identifier hs-var">acc_kvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1851"></a><span>              </span><span class="hs-special">(</span><a href="Util.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="RnTypes.html#elemRdr"><span class="hs-identifier hs-var">elemRdr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036403"><span class="hs-identifier hs-var">tv_bndr_rdrs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036401"><span class="hs-identifier hs-var">body_tvs</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621680036399"><span class="hs-identifier hs-var">acc_tvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1852"></a><span>
</span><a name="line-1853"></a><span class="hs-identifier">extract_hs_tv_bndrs_kvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="HsTypes.html#LHsTyVarBndr"><span class="hs-identifier hs-type">LHsTyVarBndr</span></a><span> </span><a href="HsExtension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span>
</span><a name="line-1854"></a><span class="hs-comment">-- Returns the free kind variables of any explictly-kinded binders</span><span>
</span><a name="line-1855"></a><span class="hs-comment">-- NB: Does /not/ delete the binders themselves.</span><span>
</span><a name="line-1856"></a><span class="hs-comment">--     Duplicates are /not/ removed</span><span>
</span><a name="line-1857"></a><span class="hs-comment">--     E.g. given  [k1, a:k1, b:k2]</span><span>
</span><a name="line-1858"></a><span class="hs-comment">--          the function returns [k1,k2], even though k1 is bound here</span><span>
</span><a name="line-1859"></a><a name="extract_hs_tv_bndrs_kvs"><a href="RnTypes.html#extract_hs_tv_bndrs_kvs"><span class="hs-identifier">extract_hs_tv_bndrs_kvs</span></a></a><span> </span><a name="local-6989586621680036404"><a href="#local-6989586621680036404"><span class="hs-identifier">tv_bndrs</span></a></a><span>
</span><a name="line-1860"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036406"><a href="#local-6989586621680036406"><span class="hs-identifier">fktvs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="MonadUtils.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a><span> </span><a href="RnTypes.html#extract_lkind"><span class="hs-identifier hs-var">extract_lkind</span></a><span> </span><a href="RnTypes.html#emptyFKTV"><span class="hs-identifier hs-var">emptyFKTV</span></a><span>
</span><a name="line-1861"></a><span>                  </span><span class="hs-special">[</span><a href="#local-6989586621680036405"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="HsTypes.html#KindedTyVar"><span class="hs-identifier hs-var">KindedTyVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036405"><a href="#local-6989586621680036405"><span class="hs-identifier">k</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621680036404"><span class="hs-identifier hs-var">tv_bndrs</span></a><span class="hs-special">]</span><span>
</span><a name="line-1862"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#freeKiTyVarsKindVars"><span class="hs-identifier hs-var">freeKiTyVarsKindVars</span></a><span> </span><a href="#local-6989586621680036406"><span class="hs-identifier hs-var">fktvs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1863"></a><span>         </span><span class="hs-comment">-- There will /be/ no free tyvars!</span><span>
</span><a name="line-1864"></a><span>
</span><a name="line-1865"></a><span class="hs-identifier">extract_tv</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TcRnTypes.html#TypeOrKind"><span class="hs-identifier hs-type">TypeOrKind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span>
</span><a name="line-1866"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><a href="RnTypes.html#FreeKiTyVarsWithDups"><span class="hs-identifier hs-type">FreeKiTyVarsWithDups</span></a><span>
</span><a name="line-1867"></a><a name="extract_tv"><a href="RnTypes.html#extract_tv"><span class="hs-identifier">extract_tv</span></a></a><span> </span><a name="local-6989586621680036407"><a href="#local-6989586621680036407"><span class="hs-identifier">t_or_k</span></a></a><span> </span><a name="local-6989586621680036408"><a href="#local-6989586621680036408"><span class="hs-identifier">ltv</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621680036409"><a href="#local-6989586621680036409"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680036410"><a href="#local-6989586621680036410"><span class="hs-identifier">acc</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a name="local-6989586621680036411"><a href="#local-6989586621680036411"><span class="hs-identifier">kvs</span></a></a><span> </span><a name="local-6989586621680036412"><a href="#local-6989586621680036412"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1868"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="RdrName.html#isRdrTyVar"><span class="hs-identifier hs-var">isRdrTyVar</span></a><span> </span><a href="#local-6989586621680036409"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621680036410"><span class="hs-identifier hs-var">acc</span></a><span>
</span><a name="line-1869"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TcRnTypes.html#isTypeLevel"><span class="hs-identifier hs-var">isTypeLevel</span></a><span> </span><a href="#local-6989586621680036407"><span class="hs-identifier hs-var">t_or_k</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><a href="#local-6989586621680036411"><span class="hs-identifier hs-var">kvs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036408"><span class="hs-identifier hs-var">ltv</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680036412"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1870"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="RnTypes.html#FKTV"><span class="hs-identifier hs-var">FKTV</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036408"><span class="hs-identifier hs-var">ltv</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680036411"><span class="hs-identifier hs-var">kvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680036412"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1871"></a><span>
</span><a name="line-1872"></a><span class="hs-comment">-- just used in this module; seemed convenient here</span><span>
</span><a name="line-1873"></a><span class="hs-identifier">nubL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621680035610"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621680035610"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="#local-6989586621680035610"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1874"></a><a name="nubL"><a href="RnTypes.html#nubL"><span class="hs-identifier">nubL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.OldList.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span> </span><a href="SrcLoc.html#eqLocated"><span class="hs-identifier hs-var">eqLocated</span></a><span>
</span><a name="line-1875"></a><span>
</span><a name="line-1876"></a><span class="hs-identifier">elemRdr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1877"></a><a name="elemRdr"><a href="RnTypes.html#elemRdr"><span class="hs-identifier">elemRdr</span></a></a><span> </span><a name="local-6989586621680036413"><a href="#local-6989586621680036413"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#eqLocated"><span class="hs-identifier hs-var">eqLocated</span></a><span> </span><a href="#local-6989586621680036413"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1878"></a><span>
</span><a name="line-1879"></a><span class="hs-identifier">checkMixedVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a><span> </span><a href="RdrName.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TcRnTypes.html#RnM"><span class="hs-identifier hs-type">RnM</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-1880"></a><span class="hs-comment">-- In (checkMixedVars kvs tvs) we are about to bind the type</span><span>
</span><a name="line-1881"></a><span class="hs-comment">-- variables tvs, and kvs is the set of free variables of the kinds</span><span>
</span><a name="line-1882"></a><span class="hs-comment">-- in the scope of the binding.  E.g.</span><span>
</span><a name="line-1883"></a><span class="hs-comment">--    forall a b. a -&gt; (b::k) -&gt; (c::a)</span><span>
</span><a name="line-1884"></a><span class="hs-comment">-- Here tv will be {a,b}, and kvs {k,a}.</span><span>
</span><a name="line-1885"></a><span class="hs-comment">-- Without -XTypeInType we want to complain that 'a' is used both</span><span>
</span><a name="line-1886"></a><span class="hs-comment">-- as a type and a kind.</span><span>
</span><a name="line-1887"></a><span class="hs-comment">--</span><span>
</span><a name="line-1888"></a><span class="hs-comment">-- Specifically, check that there is no overlap between kvs and tvs</span><span>
</span><a name="line-1889"></a><span class="hs-comment">-- See typecheck/should_fail/T11963 for examples</span><span>
</span><a name="line-1890"></a><span class="hs-comment">--</span><span>
</span><a name="line-1891"></a><span class="hs-comment">-- NB: we do this only at the binding site of 'tvs'.</span><span>
</span><a name="line-1892"></a><a name="checkMixedVars"><a href="RnTypes.html#checkMixedVars"><span class="hs-identifier">checkMixedVars</span></a></a><span> </span><a name="local-6989586621680036414"><a href="#local-6989586621680036414"><span class="hs-identifier">kvs</span></a></a><span> </span><a name="local-6989586621680036415"><a href="#local-6989586621680036415"><span class="hs-identifier">tvs</span></a></a><span>
</span><a name="line-1893"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621680036418"><a href="#local-6989586621680036418"><span class="hs-identifier">type_in_type</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TcRnMonad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a><span> </span><a href="../ghc-boot-th-8.5/src/%{MODULE/./-}.html#%{NAME}/GHC.LanguageExtensions.Type.html#TypeInType"><span class="hs-identifier hs-var">LangExt</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">TypeInType</span></a><span>
</span><a name="line-1894"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a><span> </span><a href="#local-6989586621680036418"><span class="hs-identifier hs-var">type_in_type</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1895"></a><span>         </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span> </span><a href="#local-6989586621680036416"><span class="hs-identifier hs-var">check</span></a><span> </span><a href="#local-6989586621680036414"><span class="hs-identifier hs-var">kvs</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1896"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1897"></a><span>    </span><a name="local-6989586621680036416"><a href="#local-6989586621680036416"><span class="hs-identifier">check</span></a></a><span> </span><a name="local-6989586621680036417"><a href="#local-6989586621680036417"><span class="hs-identifier">kv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680036417"><span class="hs-identifier hs-var">kv</span></a><span> </span><span class="hs-special">`</span><a href="RnTypes.html#elemRdr"><span class="hs-identifier hs-var">elemRdr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680036415"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1898"></a><span>               </span><a href="TcRnMonad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a><span> </span><span class="hs-special">(</span><a href="SrcLoc.html#getLoc"><span class="hs-identifier hs-var">getLoc</span></a><span> </span><a href="#local-6989586621680036417"><span class="hs-identifier hs-var">kv</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1899"></a><span>               </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Variable&quot;</span><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621680036417"><span class="hs-identifier hs-var">kv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1900"></a><span>                      </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;used as both a kind and a type&quot;</span><span>
</span><a name="line-1901"></a><span>                    </span><span class="hs-special">,</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;Did you intend to use TypeInType?&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1902"></a></pre></body></html>