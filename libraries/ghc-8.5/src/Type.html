<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- (c) The University of Glasgow 2006</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- (c) The GRASP/AQUA Project, Glasgow University, 1998</span><span>
</span><a name="line-3"></a><span class="hs-comment">--</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Type - public interface</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE CPP, FlexibleContexts #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">-- | Main functions for manipulating types and type-related things</span><span>
</span><a name="line-10"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Type</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-11"></a><span>        </span><span class="hs-comment">-- Note some of this is just re-exports from TyCon..</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span>        </span><span class="hs-comment">-- * Main data types representing Types</span><span>
</span><a name="line-14"></a><span>        </span><span class="hs-comment">-- $type_classification</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span>        </span><span class="hs-comment">-- $representation_types</span><span>
</span><a name="line-17"></a><span>        </span><a href="TyCoRep.html#TyThing"><span class="hs-identifier hs-type">TyThing</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>        </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>        </span><span class="hs-comment">-- ** Constructing and deconstructing types</span><span>
</span><a name="line-21"></a><span>        </span><a href="TyCoRep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getTyVar"><span class="hs-identifier hs-var">getTyVar</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>        </span><a href="Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var">getCastedTyVar_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>        </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitAppTy"><span class="hs-identifier hs-var">splitAppTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitAppTys"><span class="hs-identifier hs-var">splitAppTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repSplitAppTys"><span class="hs-identifier hs-var">repSplitAppTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>        </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier hs-var">tcRepSplitAppTy_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>        </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkFunTys"><span class="hs-identifier hs-var">mkFunTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitFunTy"><span class="hs-identifier hs-var">splitFunTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>        </span><a href="Type.html#splitFunTys"><span class="hs-identifier hs-var">splitFunTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#funResultTy"><span class="hs-identifier hs-var">funResultTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#funArgTy"><span class="hs-identifier hs-var">funArgTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>        </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkTyConTy"><span class="hs-identifier hs-var">mkTyConTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>        </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier hs-var">tyConAppTyConPicky_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>        </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppArgs"><span class="hs-identifier hs-var">tyConAppArgs</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>        </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitTyConApp"><span class="hs-identifier hs-var">splitTyConApp</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyConAppArgN"><span class="hs-identifier hs-var">tyConAppArgN</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#nextRole"><span class="hs-identifier hs-var">nextRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>        </span><a href="Type.html#tcRepSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcRepSplitTyConApp_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>        </span><a href="Type.html#splitListTyConApp_maybe"><span class="hs-identifier hs-var">splitListTyConApp_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>        </span><a href="Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span>        </span><a href="TyCoRep.html#mkForAllTy"><span class="hs-identifier hs-var">mkForAllTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkInvForAllTys"><span class="hs-identifier hs-var">mkInvForAllTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier hs-var">mkSpecForAllTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>        </span><a href="Type.html#mkVisForAllTys"><span class="hs-identifier hs-var">mkVisForAllTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkInvForAllTy"><span class="hs-identifier hs-var">mkInvForAllTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>        </span><a href="Type.html#splitForAllTys"><span class="hs-identifier hs-var">splitForAllTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitForAllTyVarBndrs"><span class="hs-identifier hs-var">splitForAllTyVarBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>        </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitForAllTy"><span class="hs-identifier hs-var">splitForAllTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><a href="Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitPiTy"><span class="hs-identifier hs-var">splitPiTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><a href="TyCoRep.html#mkPiTy"><span class="hs-identifier hs-var">mkPiTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkPiTys"><span class="hs-identifier hs-var">mkPiTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier hs-var">mkTyConBindersPreferAnon</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>        </span><a href="Type.html#mkLamType"><span class="hs-identifier hs-var">mkLamType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkLamTypes"><span class="hs-identifier hs-var">mkLamTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>        </span><a href="Type.html#piResultTy"><span class="hs-identifier hs-var">piResultTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>        </span><a href="Type.html#applyTysX"><span class="hs-identifier hs-var">applyTysX</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#dropForAlls"><span class="hs-identifier hs-var">dropForAlls</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>        </span><a href="Type.html#mkNumLitTy"><span class="hs-identifier hs-var">mkNumLitTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isNumLitTy"><span class="hs-identifier hs-var">isNumLitTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>        </span><a href="Type.html#mkStrLitTy"><span class="hs-identifier hs-var">mkStrLitTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>        </span><a href="Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getRuntimeRepFromKind_maybe"><span class="hs-identifier hs-var">getRuntimeRepFromKind_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>        </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkCoercionTy"><span class="hs-identifier hs-var">mkCoercionTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitCastTy_maybe"><span class="hs-identifier hs-var">splitCastTy_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span>        </span><a href="Type.html#userTypeError_maybe"><span class="hs-identifier hs-var">userTypeError_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>        </span><a href="Type.html#coAxNthLHS"><span class="hs-identifier hs-var">coAxNthLHS</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>        </span><a href="Type.html#stripCoercionTy"><span class="hs-identifier hs-var">stripCoercionTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitCoercionType_maybe"><span class="hs-identifier hs-var">splitCoercionType_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>        </span><a href="Type.html#splitPiTysInvisible"><span class="hs-identifier hs-var">splitPiTysInvisible</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier hs-var">filterOutInvisibleTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>        </span><a href="Type.html#partitionInvisibles"><span class="hs-identifier hs-var">partitionInvisibles</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>        </span><a href="Type.html#synTyConResKind"><span class="hs-identifier hs-var">synTyConResKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span>        </span><a href="Type.html#modifyJoinResTy"><span class="hs-identifier hs-var">modifyJoinResTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#setJoinResTy"><span class="hs-identifier hs-var">setJoinResTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>        </span><span class="hs-comment">-- Analyzing types</span><span>
</span><a name="line-67"></a><span>        </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>        </span><span class="hs-comment">-- (Newtypes)</span><span>
</span><a name="line-70"></a><span>        </span><a href="Type.html#newTyConInstRhs"><span class="hs-identifier hs-var">newTyConInstRhs</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>        </span><span class="hs-comment">-- Pred types</span><span>
</span><a name="line-73"></a><span>        </span><a href="Type.html#mkFamilyTyConApp"><span class="hs-identifier hs-var">mkFamilyTyConApp</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>        </span><a href="Type.html#isDictLikeTy"><span class="hs-identifier hs-var">isDictLikeTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>        </span><a href="Type.html#mkPrimEqPred"><span class="hs-identifier hs-var">mkPrimEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkReprPrimEqPred"><span class="hs-identifier hs-var">mkReprPrimEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkPrimEqPredRole"><span class="hs-identifier hs-var">mkPrimEqPredRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>        </span><a href="Type.html#equalityTyCon"><span class="hs-identifier hs-var">equalityTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>        </span><a href="Type.html#mkHeteroPrimEqPred"><span class="hs-identifier hs-var">mkHeteroPrimEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkHeteroReprPrimEqPred"><span class="hs-identifier hs-var">mkHeteroReprPrimEqPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>        </span><a href="Type.html#mkClassPred"><span class="hs-identifier hs-var">mkClassPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>        </span><a href="Type.html#isClassPred"><span class="hs-identifier hs-var">isClassPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isEqPred"><span class="hs-identifier hs-var">isEqPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isNomEqPred"><span class="hs-identifier hs-var">isNomEqPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>        </span><a href="Type.html#isIPPred"><span class="hs-identifier hs-var">isIPPred</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isIPPred_maybe"><span class="hs-identifier hs-var">isIPPred_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isIPTyCon"><span class="hs-identifier hs-var">isIPTyCon</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isIPClass"><span class="hs-identifier hs-var">isIPClass</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>        </span><a href="Type.html#isCTupleClass"><span class="hs-identifier hs-var">isCTupleClass</span></a><span class="hs-special">,</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>        </span><span class="hs-comment">-- Deconstructing predicate types</span><span>
</span><a name="line-84"></a><span>        </span><a href="Type.html#PredTree"><span class="hs-identifier hs-type">PredTree</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Type.html#eqRelRole"><span class="hs-identifier hs-var">eqRelRole</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#classifyPredType"><span class="hs-identifier hs-var">classifyPredType</span></a><span class="hs-special">,</span><span>
</span><a name="line-85"></a><span>        </span><a href="Type.html#getClassPredTys"><span class="hs-identifier hs-var">getClassPredTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier hs-var">getClassPredTys_maybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>        </span><a href="Type.html#getEqPredTys"><span class="hs-identifier hs-var">getEqPredTys</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier hs-var">getEqPredTys_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getEqPredRole"><span class="hs-identifier hs-var">getEqPredRole</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>        </span><a href="Type.html#predTypeEqRel"><span class="hs-identifier hs-var">predTypeEqRel</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>        </span><span class="hs-comment">-- ** Binders</span><span>
</span><a name="line-90"></a><span>        </span><a href="Var.html#sameVis"><span class="hs-identifier hs-var">sameVis</span></a><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>        </span><a href="Var.html#mkTyVarBinder"><span class="hs-identifier hs-var">mkTyVarBinder</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#mkTyVarBinders"><span class="hs-identifier hs-var">mkTyVarBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>        </span><a href="Type.html#mkAnonBinder"><span class="hs-identifier hs-var">mkAnonBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-93"></a><span>        </span><a href="Type.html#isAnonTyBinder"><span class="hs-identifier hs-var">isAnonTyBinder</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isNamedTyBinder"><span class="hs-identifier hs-var">isNamedTyBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-94"></a><span>        </span><a href="Var.html#binderVar"><span class="hs-identifier hs-var">binderVar</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#binderVars"><span class="hs-identifier hs-var">binderVars</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#binderKind"><span class="hs-identifier hs-var">binderKind</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#binderArgFlag"><span class="hs-identifier hs-var">binderArgFlag</span></a><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>        </span><a href="Type.html#tyBinderType"><span class="hs-identifier hs-var">tyBinderType</span></a><span class="hs-special">,</span><span>
</span><a name="line-96"></a><span>        </span><a href="Type.html#binderRelevantType_maybe"><span class="hs-identifier hs-var">binderRelevantType_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#caseBinder"><span class="hs-identifier hs-var">caseBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-97"></a><span>        </span><a href="Var.html#isVisibleArgFlag"><span class="hs-identifier hs-var">isVisibleArgFlag</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#isInvisibleArgFlag"><span class="hs-identifier hs-var">isInvisibleArgFlag</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isVisibleBinder"><span class="hs-identifier hs-var">isVisibleBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isInvisibleBinder"><span class="hs-identifier hs-var">isInvisibleBinder</span></a><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>        </span><a href="Type.html#tyConBindersTyBinders"><span class="hs-identifier hs-var">tyConBindersTyBinders</span></a><span class="hs-special">,</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>        </span><span class="hs-comment">-- ** Common type constructors</span><span>
</span><a name="line-101"></a><span>        </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>        </span><span class="hs-comment">-- ** Predicates on types</span><span>
</span><a name="line-104"></a><span>        </span><a href="Type.html#isTyVarTy"><span class="hs-identifier hs-var">isTyVarTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isDictTy"><span class="hs-identifier hs-var">isDictTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-105"></a><span>        </span><a href="Type.html#isCoercionTy_maybe"><span class="hs-identifier hs-var">isCoercionTy_maybe</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isCoercionType"><span class="hs-identifier hs-var">isCoercionType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isForAllTy"><span class="hs-identifier hs-var">isForAllTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-106"></a><span>        </span><a href="Type.html#isPiTy"><span class="hs-identifier hs-var">isPiTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>        </span><a href="Type.html#isValidJoinPointType"><span class="hs-identifier hs-var">isValidJoinPointType</span></a><span class="hs-special">,</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>        </span><span class="hs-comment">-- (Lifting and boxity)</span><span>
</span><a name="line-111"></a><span>        </span><a href="Type.html#isLiftedType_maybe"><span class="hs-identifier hs-var">isLiftedType_maybe</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isUnboxedTupleType"><span class="hs-identifier hs-var">isUnboxedTupleType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isUnboxedSumType"><span class="hs-identifier hs-var">isUnboxedSumType</span></a><span class="hs-special">,</span><span>
</span><a name="line-112"></a><span>        </span><a href="Type.html#isAlgType"><span class="hs-identifier hs-var">isAlgType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isDataFamilyAppType"><span class="hs-identifier hs-var">isDataFamilyAppType</span></a><span class="hs-special">,</span><span>
</span><a name="line-113"></a><span>        </span><a href="Type.html#isPrimitiveType"><span class="hs-identifier hs-var">isPrimitiveType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isStrictType"><span class="hs-identifier hs-var">isStrictType</span></a><span class="hs-special">,</span><span>
</span><a name="line-114"></a><span>        </span><a href="TyCoRep.html#isRuntimeRepTy"><span class="hs-identifier hs-var">isRuntimeRepTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#isRuntimeRepVar"><span class="hs-identifier hs-var">isRuntimeRepVar</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-var">isRuntimeRepKindedTy</span></a><span class="hs-special">,</span><span>
</span><a name="line-115"></a><span>        </span><a href="Type.html#dropRuntimeRepArgs"><span class="hs-identifier hs-var">dropRuntimeRepArgs</span></a><span class="hs-special">,</span><span>
</span><a name="line-116"></a><span>        </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#getRuntimeRepFromKind"><span class="hs-identifier hs-var">getRuntimeRepFromKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span>        </span><span class="hs-comment">-- * Main data types representing Kinds</span><span>
</span><a name="line-119"></a><span>        </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span class="hs-special">,</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>        </span><span class="hs-comment">-- ** Finding the kind of a type</span><span>
</span><a name="line-122"></a><span>        </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#isTypeLevPoly"><span class="hs-identifier hs-var">isTypeLevPoly</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#resultIsLevPoly"><span class="hs-identifier hs-var">resultIsLevPoly</span></a><span class="hs-special">,</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>        </span><span class="hs-comment">-- ** Common Kind</span><span>
</span><a name="line-125"></a><span>        </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span>        </span><span class="hs-comment">-- * Type free variables</span><span>
</span><a name="line-128"></a><span>        </span><a href="TyCoRep.html#tyCoFVsOfType"><span class="hs-identifier hs-var">tyCoFVsOfType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tyCoFVsBndr"><span class="hs-identifier hs-var">tyCoFVsBndr</span></a><span class="hs-special">,</span><span>
</span><a name="line-129"></a><span>        </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-130"></a><span>        </span><a href="TyCoRep.html#tyCoVarsOfTypeDSet"><span class="hs-identifier hs-var">tyCoVarsOfTypeDSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-131"></a><span>        </span><a href="TyCoRep.html#coVarsOfType"><span class="hs-identifier hs-var">coVarsOfType</span></a><span class="hs-special">,</span><span>
</span><a name="line-132"></a><span>        </span><a href="TyCoRep.html#coVarsOfTypes"><span class="hs-identifier hs-var">coVarsOfTypes</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#closeOverKinds"><span class="hs-identifier hs-var">closeOverKinds</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#closeOverKindsList"><span class="hs-identifier hs-var">closeOverKindsList</span></a><span class="hs-special">,</span><span>
</span><a name="line-133"></a><span>        </span><a href="TyCoRep.html#noFreeVarsOfType"><span class="hs-identifier hs-var">noFreeVarsOfType</span></a><span class="hs-special">,</span><span>
</span><a name="line-134"></a><span>        </span><a href="Type.html#splitVisVarsOfType"><span class="hs-identifier hs-var">splitVisVarsOfType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#splitVisVarsOfTypes"><span class="hs-identifier hs-var">splitVisVarsOfTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-135"></a><span>        </span><a href="Type.html#expandTypeSynonyms"><span class="hs-identifier hs-var">expandTypeSynonyms</span></a><span class="hs-special">,</span><span>
</span><a name="line-136"></a><span>        </span><a href="TyCoRep.html#typeSize"><span class="hs-identifier hs-var">typeSize</span></a><span class="hs-special">,</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>        </span><span class="hs-comment">-- * Well-scoped lists of variables</span><span>
</span><a name="line-139"></a><span>        </span><a href="Type.html#dVarSetElemsWellScoped"><span class="hs-identifier hs-var">dVarSetElemsWellScoped</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier hs-var">tyCoVarsOfTypeWellScoped</span></a><span class="hs-special">,</span><span>
</span><a name="line-140"></a><span>        </span><a href="Type.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier hs-var">tyCoVarsOfTypesWellScoped</span></a><span class="hs-special">,</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span>        </span><span class="hs-comment">-- * Type comparison</span><span>
</span><a name="line-143"></a><span>        </span><a href="Type.html#eqType"><span class="hs-identifier hs-var">eqType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#eqTypeX"><span class="hs-identifier hs-var">eqTypeX</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#eqTypes"><span class="hs-identifier hs-var">eqTypes</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#nonDetCmpType"><span class="hs-identifier hs-var">nonDetCmpType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#nonDetCmpTypes"><span class="hs-identifier hs-var">nonDetCmpTypes</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var">nonDetCmpTypeX</span></a><span class="hs-special">,</span><span>
</span><a name="line-144"></a><span>        </span><a href="Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#nonDetCmpTc"><span class="hs-identifier hs-var">nonDetCmpTc</span></a><span class="hs-special">,</span><span>
</span><a name="line-145"></a><span>        </span><a href="Type.html#eqVarBndrs"><span class="hs-identifier hs-var">eqVarBndrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span>        </span><span class="hs-comment">-- * Forcing evaluation of types</span><span>
</span><a name="line-148"></a><span>        </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span>        </span><span class="hs-comment">-- * Other views onto Types</span><span>
</span><a name="line-151"></a><span>        </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a><span class="hs-special">,</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>        </span><a href="Type.html#tyConsOfType"><span class="hs-identifier hs-var">tyConsOfType</span></a><span class="hs-special">,</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span>        </span><span class="hs-comment">-- * Main type substitution data types</span><span>
</span><a name="line-156"></a><span>        </span><a href="TyCoRep.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- Representation widely visible</span><span>
</span><a name="line-157"></a><span>        </span><a href="TyCoRep.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- Representation visible to a few friends</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>        </span><span class="hs-comment">-- ** Manipulating type substitutions</span><span>
</span><a name="line-160"></a><span>        </span><a href="TyCoRep.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#emptyTCvSubst"><span class="hs-identifier hs-var">emptyTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span>        </span><a href="TyCoRep.html#mkTCvSubst"><span class="hs-identifier hs-var">mkTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a><span class="hs-special">,</span><span>
</span><a name="line-163"></a><span>        </span><a href="TyCoRep.html#notElemTCvSubst"><span class="hs-identifier hs-var">notElemTCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-164"></a><span>        </span><a href="TyCoRep.html#getTvSubstEnv"><span class="hs-identifier hs-var">getTvSubstEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#setTvSubstEnv"><span class="hs-identifier hs-var">setTvSubstEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-165"></a><span>        </span><a href="TyCoRep.html#zapTCvSubst"><span class="hs-identifier hs-var">zapTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#getTCvInScope"><span class="hs-identifier hs-var">getTCvInScope</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#getTCvSubstRangeFVs"><span class="hs-identifier hs-var">getTCvSubstRangeFVs</span></a><span class="hs-special">,</span><span>
</span><a name="line-166"></a><span>        </span><a href="TyCoRep.html#extendTCvInScope"><span class="hs-identifier hs-var">extendTCvInScope</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTCvInScopeList"><span class="hs-identifier hs-var">extendTCvInScopeList</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTCvInScopeSet"><span class="hs-identifier hs-var">extendTCvInScopeSet</span></a><span class="hs-special">,</span><span>
</span><a name="line-167"></a><span>        </span><a href="TyCoRep.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendCvSubst"><span class="hs-identifier hs-var">extendCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-168"></a><span>        </span><a href="TyCoRep.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTvSubstBinderAndInScope"><span class="hs-identifier hs-var">extendTvSubstBinderAndInScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-169"></a><span>        </span><a href="TyCoRep.html#extendTvSubstList"><span class="hs-identifier hs-var">extendTvSubstList</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#extendTvSubstAndInScope"><span class="hs-identifier hs-var">extendTvSubstAndInScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-170"></a><span>        </span><a href="TyCoRep.html#extendTvSubstWithClone"><span class="hs-identifier hs-var">extendTvSubstWithClone</span></a><span class="hs-special">,</span><span>
</span><a name="line-171"></a><span>        </span><a href="TyCoRep.html#isInScope"><span class="hs-identifier hs-var">isInScope</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#composeTCvSubstEnv"><span class="hs-identifier hs-var">composeTCvSubstEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#composeTCvSubst"><span class="hs-identifier hs-var">composeTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#zipTyEnv"><span class="hs-identifier hs-var">zipTyEnv</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#zipCoEnv"><span class="hs-identifier hs-var">zipCoEnv</span></a><span class="hs-special">,</span><span>
</span><a name="line-172"></a><span>        </span><a href="TyCoRep.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#unionTCvSubst"><span class="hs-identifier hs-var">unionTCvSubst</span></a><span class="hs-special">,</span><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span>        </span><span class="hs-comment">-- ** Performing substitution on types and kinds</span><span>
</span><a name="line-175"></a><span>        </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTysWith"><span class="hs-identifier hs-var">substTysWith</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTheta"><span class="hs-identifier hs-var">substTheta</span></a><span class="hs-special">,</span><span>
</span><a name="line-176"></a><span>        </span><a href="TyCoRep.html#substTyAddInScope"><span class="hs-identifier hs-var">substTyAddInScope</span></a><span class="hs-special">,</span><span>
</span><a name="line-177"></a><span>        </span><a href="TyCoRep.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTysUnchecked"><span class="hs-identifier hs-var">substTysUnchecked</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substThetaUnchecked"><span class="hs-identifier hs-var">substThetaUnchecked</span></a><span class="hs-special">,</span><span>
</span><a name="line-178"></a><span>        </span><a href="TyCoRep.html#substTyWithUnchecked"><span class="hs-identifier hs-var">substTyWithUnchecked</span></a><span class="hs-special">,</span><span>
</span><a name="line-179"></a><span>        </span><a href="TyCoRep.html#substCoUnchecked"><span class="hs-identifier hs-var">substCoUnchecked</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substCoWithUnchecked"><span class="hs-identifier hs-var">substCoWithUnchecked</span></a><span class="hs-special">,</span><span>
</span><a name="line-180"></a><span>        </span><a href="TyCoRep.html#substTyVarBndr"><span class="hs-identifier hs-var">substTyVarBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#substTyVars"><span class="hs-identifier hs-var">substTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-181"></a><span>        </span><a href="TyCoRep.html#cloneTyVarBndr"><span class="hs-identifier hs-var">cloneTyVarBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#cloneTyVarBndrs"><span class="hs-identifier hs-var">cloneTyVarBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#lookupTyVar"><span class="hs-identifier hs-var">lookupTyVar</span></a><span class="hs-special">,</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span>        </span><span class="hs-comment">-- * Pretty-printing</span><span>
</span><a name="line-184"></a><span>        </span><a href="TyCoRep.html#pprType"><span class="hs-identifier hs-var">pprType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprParendType"><span class="hs-identifier hs-var">pprParendType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprPrecType"><span class="hs-identifier hs-var">pprPrecType</span></a><span class="hs-special">,</span><span>
</span><a name="line-185"></a><span>        </span><a href="TyCoRep.html#pprTypeApp"><span class="hs-identifier hs-var">pprTypeApp</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTyThingCategory"><span class="hs-identifier hs-var">pprTyThingCategory</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprShortTyThing"><span class="hs-identifier hs-var">pprShortTyThing</span></a><span class="hs-special">,</span><span>
</span><a name="line-186"></a><span>        </span><a href="TyCoRep.html#pprTvBndr"><span class="hs-identifier hs-var">pprTvBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTvBndrs"><span class="hs-identifier hs-var">pprTvBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprForAll"><span class="hs-identifier hs-var">pprForAll</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprUserForAll"><span class="hs-identifier hs-var">pprUserForAll</span></a><span class="hs-special">,</span><span>
</span><a name="line-187"></a><span>        </span><a href="TyCoRep.html#pprSigmaType"><span class="hs-identifier hs-var">pprSigmaType</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ppSuggestExplicitKinds"><span class="hs-identifier hs-var">ppSuggestExplicitKinds</span></a><span class="hs-special">,</span><span>
</span><a name="line-188"></a><span>        </span><a href="TyCoRep.html#pprTheta"><span class="hs-identifier hs-var">pprTheta</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprThetaArrowTy"><span class="hs-identifier hs-var">pprThetaArrowTy</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprClassPred"><span class="hs-identifier hs-var">pprClassPred</span></a><span class="hs-special">,</span><span>
</span><a name="line-189"></a><span>        </span><a href="TyCoRep.html#pprKind"><span class="hs-identifier hs-var">pprKind</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprParendKind"><span class="hs-identifier hs-var">pprParendKind</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#pprSourceTyCon"><span class="hs-identifier hs-var">pprSourceTyCon</span></a><span class="hs-special">,</span><span>
</span><a name="line-190"></a><span>        </span><a href="BasicTypes.html#TyPrec"><span class="hs-identifier hs-type">TyPrec</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="BasicTypes.html#maybeParen"><span class="hs-identifier hs-var">maybeParen</span></a><span class="hs-special">,</span><span>
</span><a name="line-191"></a><span>        </span><a href="TyCoRep.html#pprTyVar"><span class="hs-identifier hs-var">pprTyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#pprTyVars"><span class="hs-identifier hs-var">pprTyVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span>        </span><span class="hs-comment">-- * Tidying type related things up for printing</span><span>
</span><a name="line-194"></a><span>        </span><a href="TyCoRep.html#tidyType"><span class="hs-identifier hs-var">tidyType</span></a><span class="hs-special">,</span><span>      </span><a href="TyCoRep.html#tidyTypes"><span class="hs-identifier hs-var">tidyTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-195"></a><span>        </span><a href="TyCoRep.html#tidyOpenType"><span class="hs-identifier hs-var">tidyOpenType</span></a><span class="hs-special">,</span><span>  </span><a href="TyCoRep.html#tidyOpenTypes"><span class="hs-identifier hs-var">tidyOpenTypes</span></a><span class="hs-special">,</span><span>
</span><a name="line-196"></a><span>        </span><a href="TyCoRep.html#tidyOpenKind"><span class="hs-identifier hs-var">tidyOpenKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-197"></a><span>        </span><a href="TyCoRep.html#tidyTyCoVarBndr"><span class="hs-identifier hs-var">tidyTyCoVarBndr</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tidyTyCoVarBndrs"><span class="hs-identifier hs-var">tidyTyCoVarBndrs</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tidyFreeTyCoVars"><span class="hs-identifier hs-var">tidyFreeTyCoVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-198"></a><span>        </span><a href="TyCoRep.html#tidyOpenTyCoVar"><span class="hs-identifier hs-var">tidyOpenTyCoVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tidyOpenTyCoVars"><span class="hs-identifier hs-var">tidyOpenTyCoVars</span></a><span class="hs-special">,</span><span>
</span><a name="line-199"></a><span>        </span><a href="TyCoRep.html#tidyTyVarOcc"><span class="hs-identifier hs-var">tidyTyVarOcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-200"></a><span>        </span><a href="TyCoRep.html#tidyTopType"><span class="hs-identifier hs-var">tidyTopType</span></a><span class="hs-special">,</span><span>
</span><a name="line-201"></a><span>        </span><a href="TyCoRep.html#tidyKind"><span class="hs-identifier hs-var">tidyKind</span></a><span class="hs-special">,</span><span>
</span><a name="line-202"></a><span>        </span><a href="TyCoRep.html#tidyTyVarBinder"><span class="hs-identifier hs-var">tidyTyVarBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tidyTyVarBinders"><span class="hs-identifier hs-var">tidyTyVarBinders</span></a><span>
</span><a name="line-203"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-cpp">#include &quot;HsVersions.h&quot;</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-keyword">import</span><span> </span><a href="BasicTypes.html"><span class="hs-identifier">BasicTypes</span></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">-- We import the representation and primitive functions from TyCoRep.</span><span>
</span><a name="line-212"></a><span class="hs-comment">-- Many things are reexported, but not the representation!</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-keyword">import</span><span> </span><a href="Kind.html"><span class="hs-identifier">Kind</span></a><span>
</span><a name="line-215"></a><span class="hs-keyword">import</span><span> </span><a href="TyCoRep.html"><span class="hs-identifier">TyCoRep</span></a><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- friends:</span><span>
</span><a name="line-218"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-219"></a><span class="hs-keyword">import</span><span> </span><a href="VarEnv.html"><span class="hs-identifier">VarEnv</span></a><span>
</span><a name="line-220"></a><span class="hs-keyword">import</span><span> </span><a href="VarSet.html"><span class="hs-identifier">VarSet</span></a><span>
</span><a name="line-221"></a><span class="hs-keyword">import</span><span> </span><a href="UniqSet.html"><span class="hs-identifier">UniqSet</span></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-keyword">import</span><span> </span><a href="Class.html"><span class="hs-identifier">Class</span></a><span>
</span><a name="line-224"></a><span class="hs-keyword">import</span><span> </span><a href="TyCon.html"><span class="hs-identifier">TyCon</span></a><span>
</span><a name="line-225"></a><span class="hs-keyword">import</span><span> </span><a href="TysPrim.html"><span class="hs-identifier">TysPrim</span></a><span>
</span><a name="line-226"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="TysWiredIn.html"><span class="hs-identifier">TysWiredIn</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="TysWiredIn.html#listTyCon"><span class="hs-identifier hs-var">listTyCon</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#typeNatKind"><span class="hs-identifier hs-var">typeNatKind</span></a><span>
</span><a name="line-227"></a><span>                                 </span><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a><span class="hs-special">,</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span class="hs-keyword">import</span><span> </span><a href="PrelNames.html"><span class="hs-identifier">PrelNames</span></a><span>
</span><a name="line-229"></a><span class="hs-keyword">import</span><span> </span><a href="CoAxiom.html"><span class="hs-identifier">CoAxiom</span></a><span>
</span><a name="line-230"></a><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE #-}</span><span> </span><a href="Coercion.html"><span class="hs-identifier">Coercion</span></a><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span class="hs-comment">-- others</span><span>
</span><a name="line-233"></a><span class="hs-keyword">import</span><span> </span><a href="Util.html"><span class="hs-identifier">Util</span></a><span>
</span><a name="line-234"></a><span class="hs-keyword">import</span><span> </span><a href="Outputable.html"><span class="hs-identifier">Outputable</span></a><span>
</span><a name="line-235"></a><span class="hs-keyword">import</span><span> </span><a href="FastString.html"><span class="hs-identifier">FastString</span></a><span>
</span><a name="line-236"></a><span class="hs-keyword">import</span><span> </span><a href="Pair.html"><span class="hs-identifier">Pair</span></a><span>
</span><a name="line-237"></a><span class="hs-keyword">import</span><span> </span><a href="ListSetOps.html"><span class="hs-identifier">ListSetOps</span></a><span>
</span><a name="line-238"></a><span class="hs-keyword">import</span><span> </span><a href="Digraph.html"><span class="hs-identifier">Digraph</span></a><span>
</span><a name="line-239"></a><span class="hs-keyword">import</span><span> </span><a href="Unique.html"><span class="hs-identifier">Unique</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-keyword">import</span><span> </span><a href="Maybes.html"><span class="hs-identifier">Maybes</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span></a><span>    </span><span class="hs-special">(</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-comment">-- $type_classification</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- #type_classification#</span><span>
</span><a name="line-248"></a><span class="hs-comment">--</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- Types are one of:</span><span>
</span><a name="line-250"></a><span class="hs-comment">--</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- [Unboxed]            Iff its representation is other than a pointer</span><span>
</span><a name="line-252"></a><span class="hs-comment">--                      Unboxed types are also unlifted.</span><span>
</span><a name="line-253"></a><span class="hs-comment">--</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- [Lifted]             Iff it has bottom as an element.</span><span>
</span><a name="line-255"></a><span class="hs-comment">--                      Closures always have lifted types: i.e. any</span><span>
</span><a name="line-256"></a><span class="hs-comment">--                      let-bound identifier in Core must have a lifted</span><span>
</span><a name="line-257"></a><span class="hs-comment">--                      type. Operationally, a lifted object is one that</span><span>
</span><a name="line-258"></a><span class="hs-comment">--                      can be entered.</span><span>
</span><a name="line-259"></a><span class="hs-comment">--                      Only lifted types may be unified with a type variable.</span><span>
</span><a name="line-260"></a><span class="hs-comment">--</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- [Algebraic]          Iff it is a type with one or more constructors, whether</span><span>
</span><a name="line-262"></a><span class="hs-comment">--                      declared with @data@ or @newtype@.</span><span>
</span><a name="line-263"></a><span class="hs-comment">--                      An algebraic type is one that can be deconstructed</span><span>
</span><a name="line-264"></a><span class="hs-comment">--                      with a case expression. This is /not/ the same as</span><span>
</span><a name="line-265"></a><span class="hs-comment">--                      lifted types, because we also include unboxed</span><span>
</span><a name="line-266"></a><span class="hs-comment">--                      tuples in this classification.</span><span>
</span><a name="line-267"></a><span class="hs-comment">--</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- [Data]               Iff it is a type declared with @data@, or a boxed tuple.</span><span>
</span><a name="line-269"></a><span class="hs-comment">--</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- [Primitive]          Iff it is a built-in type that can't be expressed in Haskell.</span><span>
</span><a name="line-271"></a><span class="hs-comment">--</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- Currently, all primitive types are unlifted, but that's not necessarily</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- the case: for example, @Int@ could be primitive.</span><span>
</span><a name="line-274"></a><span class="hs-comment">--</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- Some primitive types are unboxed, such as @Int#@, whereas some are boxed</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- but unlifted (such as @ByteArray#@).  The only primitive types that we</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- classify as algebraic are the unboxed tuples.</span><span>
</span><a name="line-278"></a><span class="hs-comment">--</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- Some examples of type classifications that may make this a bit clearer are:</span><span>
</span><a name="line-280"></a><span class="hs-comment">--</span><span>
</span><a name="line-281"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-282"></a><span class="hs-comment">-- Type          primitive       boxed           lifted          algebraic</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-284"></a><span class="hs-comment">-- Int#          Yes             No              No              No</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- ByteArray#    Yes             Yes             No              No</span><span>
</span><a name="line-286"></a><span class="hs-comment">-- (\# a, b \#)  Yes             No              No              Yes</span><span>
</span><a name="line-287"></a><span class="hs-comment">-- (\# a | b \#) Yes             No              No              Yes</span><span>
</span><a name="line-288"></a><span class="hs-comment">-- (  a, b  )    No              Yes             Yes             Yes</span><span>
</span><a name="line-289"></a><span class="hs-comment">-- [a]           No              Yes             Yes             Yes</span><span>
</span><a name="line-290"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-comment">-- $representation_types</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- A /source type/ is a type that is a separate type as far as the type checker is</span><span>
</span><a name="line-294"></a><span class="hs-comment">-- concerned, but which has a more low-level representation as far as Core-to-Core</span><span>
</span><a name="line-295"></a><span class="hs-comment">-- passes and the rest of the back end is concerned.</span><span>
</span><a name="line-296"></a><span class="hs-comment">--</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- You don't normally have to worry about this, as the utility functions in</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- this module will automatically convert a source into a representation type</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- if they are spotted, to the best of it's abilities. If you don't want this</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- to happen, use the equivalent functions from the &quot;TcType&quot; module.</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Type representation
*                                                                      *
************************************************************************

Note [coreView vs tcView]
~~~~~~~~~~~~~~~~~~~~~~~~~
So far as the typechecker is concerned, 'Constraint' and 'TYPE LiftedRep' are distinct kinds.

But in Core these two are treated as identical.

We implement this by making 'coreView' convert 'Constraint' to 'TYPE LiftedRep' on the fly.
The function tcView (used in the type checker) does not do this.

See also Trac #11715, which tracks removing this inconsistency.

-}</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-pragma">{-# INLINE coreView #-}</span><span>
</span><a name="line-323"></a><span class="hs-identifier">coreView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-324"></a><span class="hs-comment">-- ^ This function Strips off the /top layer only/ of a type synonym</span><span>
</span><a name="line-325"></a><span class="hs-comment">-- application (if any) its underlying representation type.</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- Returns Nothing if there is nothing to look through.</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- This function considers 'Constraint' to be a synonym of @TYPE LiftedRep@.</span><span>
</span><a name="line-328"></a><span class="hs-comment">--</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- By being non-recursive and inlined, this case analysis gets efficiently</span><span>
</span><a name="line-330"></a><span class="hs-comment">-- joined onto the case analysis that the caller is already doing</span><span>
</span><a name="line-331"></a><a name="coreView"><a href="Type.html#coreView"><span class="hs-identifier">coreView</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399380"><a href="#local-6989586621679399380"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399381"><a href="#local-6989586621679399381"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399382"><a href="#local-6989586621679399382"><span class="hs-identifier">tenv</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399383"><a href="#local-6989586621679399383"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399384"><a href="#local-6989586621679399384"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399380"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399381"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-332"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a><span> </span><a href="#local-6989586621679399382"><span class="hs-identifier hs-var">tenv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399383"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399384"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>               </span><span class="hs-comment">-- The free vars of 'rhs' should all be bound by 'tenv', so it's</span><span>
</span><a name="line-334"></a><span>               </span><span class="hs-comment">-- ok to use 'substTy' here.</span><span>
</span><a name="line-335"></a><span>               </span><span class="hs-comment">-- See also Note [The substitution invariant] in TyCoRep.</span><span>
</span><a name="line-336"></a><span>               </span><span class="hs-comment">-- Its important to use mkAppTys, rather than (foldl AppTy),</span><span>
</span><a name="line-337"></a><span>               </span><span class="hs-comment">-- because the function part might well return a</span><span>
</span><a name="line-338"></a><span>               </span><span class="hs-comment">-- partially-applied type constructor; indeed, usually will!</span><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-identifier">coreView</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399385"><a href="#local-6989586621679399385"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- At the Core level, Constraint = Type</span><span>
</span><a name="line-341"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">isStarKindSynonymTyCon</span></a><span> </span><a href="#local-6989586621679399385"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-342"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-identifier">coreView</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">-- | Gives the typechecker view of a type. This unwraps synonyms but</span><span>
</span><a name="line-347"></a><span class="hs-comment">-- leaves 'Constraint' alone. c.f. coreView, which turns Constraint into</span><span>
</span><a name="line-348"></a><span class="hs-comment">-- TYPE LiftedRep. Returns Nothing if no unwrapping happens.</span><span>
</span><a name="line-349"></a><span class="hs-comment">-- See also Note [coreView vs tcView] in Type.</span><span>
</span><a name="line-350"></a><span class="hs-pragma">{-# INLINE tcView #-}</span><span>
</span><a name="line-351"></a><span class="hs-identifier">tcView</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-352"></a><a name="tcView"><a href="Type.html#tcView"><span class="hs-identifier">tcView</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399386"><a href="#local-6989586621679399386"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399387"><a href="#local-6989586621679399387"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399388"><a href="#local-6989586621679399388"><span class="hs-identifier">tenv</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399389"><a href="#local-6989586621679399389"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399390"><a href="#local-6989586621679399390"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399386"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399387"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-353"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a><span> </span><a href="#local-6989586621679399388"><span class="hs-identifier hs-var">tenv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399389"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399390"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>               </span><span class="hs-comment">-- The free vars of 'rhs' should all be bound by 'tenv', so it's</span><span>
</span><a name="line-355"></a><span>               </span><span class="hs-comment">-- ok to use 'substTy' here.</span><span>
</span><a name="line-356"></a><span>               </span><span class="hs-comment">-- See also Note [The substitution invariant] in TyCoRep.</span><span>
</span><a name="line-357"></a><span>               </span><span class="hs-comment">-- Its important to use mkAppTys, rather than (foldl AppTy),</span><span>
</span><a name="line-358"></a><span>               </span><span class="hs-comment">-- because the function part might well return a</span><span>
</span><a name="line-359"></a><span>               </span><span class="hs-comment">-- partially-applied type constructor; indeed, usually will!</span><span>
</span><a name="line-360"></a><span class="hs-identifier">tcView</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-comment">-----------------------------------------------</span><span>
</span><a name="line-363"></a><span class="hs-identifier">expandTypeSynonyms</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-364"></a><span class="hs-comment">-- ^ Expand out all type synonyms.  Actually, it'd suffice to expand out</span><span>
</span><a name="line-365"></a><span class="hs-comment">-- just the ones that discard type variables (e.g.  type Funny a = Int)</span><span>
</span><a name="line-366"></a><span class="hs-comment">-- But we don't know which those are currently, so we just expand all.</span><span>
</span><a name="line-367"></a><span class="hs-comment">--</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- 'expandTypeSynonyms' only expands out type synonyms mentioned in the type,</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- not in the kinds of any TyCon or TyVar mentioned in the type.</span><span>
</span><a name="line-370"></a><span class="hs-comment">--</span><span>
</span><a name="line-371"></a><span class="hs-comment">-- Keep this synchronized with 'synonymTyConsOfType'</span><span>
</span><a name="line-372"></a><a name="expandTypeSynonyms"><a href="Type.html#expandTypeSynonyms"><span class="hs-identifier">expandTypeSynonyms</span></a></a><span> </span><a name="local-6989586621679399391"><a href="#local-6989586621679399391"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-373"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a><span> </span><a href="#local-6989586621679399392"><span class="hs-identifier hs-var">in_scope</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399391"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-374"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-375"></a><span>    </span><a name="local-6989586621679399392"><a href="#local-6989586621679399392"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-6989586621679399391"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span>    </span><a name="local-6989586621679399393"><a href="#local-6989586621679399393"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679399397"><a href="#local-6989586621679399397"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399398"><a href="#local-6989586621679399398"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399399"><a href="#local-6989586621679399399"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-378"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399401"><a href="#local-6989586621679399401"><span class="hs-identifier">tenv</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399402"><a href="#local-6989586621679399402"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399403"><a href="#local-6989586621679399403"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#expandSynTyCon_maybe"><span class="hs-identifier hs-var">expandSynTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399398"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399400"><span class="hs-identifier hs-var">expanded_tys</span></a><span>
</span><a name="line-379"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679399404"><a href="#local-6989586621679399404"><span class="hs-identifier">subst'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a><span> </span><a href="#local-6989586621679399392"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a><span> </span><a href="#local-6989586621679399401"><span class="hs-identifier hs-var">tenv</span></a><span class="hs-special">)</span><span>
</span><a name="line-380"></a><span>            </span><span class="hs-comment">-- Make a fresh substitution; rhs has nothing to</span><span>
</span><a name="line-381"></a><span>            </span><span class="hs-comment">-- do with anything that has happened so far</span><span>
</span><a name="line-382"></a><span>            </span><span class="hs-comment">-- NB: if you make changes here, be sure to build an</span><span>
</span><a name="line-383"></a><span>            </span><span class="hs-comment">--     /idempotent/ substitution, even in the nested case</span><span>
</span><a name="line-384"></a><span>            </span><span class="hs-comment">--        type T a b = a -&gt; b</span><span>
</span><a name="line-385"></a><span>            </span><span class="hs-comment">--        type S x y = T y x</span><span>
</span><a name="line-386"></a><span>            </span><span class="hs-comment">-- (Trac #11665)</span><span>
</span><a name="line-387"></a><span>        </span><span class="hs-keyword">in</span><span>  </span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399404"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-6989586621679399402"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399403"><span class="hs-identifier hs-var">tys'</span></a><span>
</span><a name="line-388"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-389"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621679399398"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399400"><span class="hs-identifier hs-var">expanded_tys</span></a><span>
</span><a name="line-390"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-391"></a><span>        </span><a name="local-6989586621679399400"><a href="#local-6989586621679399400"><span class="hs-identifier">expanded_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399397"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399399"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679399405"><a href="#local-6989586621679399405"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a href="#local-6989586621679399405"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-394"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399406"><a href="#local-6989586621679399406"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399407"><a href="#local-6989586621679399407"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a><span> </span><a href="#local-6989586621679399406"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399407"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-395"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399408"><a href="#local-6989586621679399408"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399409"><a href="#local-6989586621679399409"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679399410"><a href="#local-6989586621679399410"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399408"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399409"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399408"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399410"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399411"><a href="#local-6989586621679399411"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399412"><a href="#local-6989586621679399412"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399413"><a href="#local-6989586621679399413"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-397"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkFunTy"><span class="hs-identifier hs-var">mkFunTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399411"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399412"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399411"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399413"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399414"><a href="#local-6989586621679399414"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399415"><a href="#local-6989586621679399415"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679399416"><a href="#local-6989586621679399416"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399417"><a href="#local-6989586621679399417"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679399418"><a href="#local-6989586621679399418"><span class="hs-identifier">subst'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399419"><a href="#local-6989586621679399419"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTyVarBndrCallback"><span class="hs-identifier hs-var">substTyVarBndrCallback</span></a><span> </span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399414"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399415"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-400"></a><span>        </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399419"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-6989586621679399416"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399418"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-6989586621679399417"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399420"><a href="#local-6989586621679399420"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679399421"><a href="#local-6989586621679399421"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399422"><a href="#local-6989586621679399422"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399420"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399421"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399420"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399422"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399423"><a href="#local-6989586621679399423"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679399424"><a href="#local-6989586621679399424"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkCoercionTy"><span class="hs-identifier hs-var">mkCoercionTy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399423"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399424"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span>    </span><a name="local-6989586621679399394"><a href="#local-6989586621679399394"><span class="hs-identifier">go_co</span></a></a><span> </span><a name="local-6989586621679399425"><a href="#local-6989586621679399425"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><a name="local-6989586621679399426"><a href="#local-6989586621679399426"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399427"><a href="#local-6989586621679399427"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-405"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a><span> </span><a href="#local-6989586621679399426"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399425"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399427"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-406"></a><span>       </span><span class="hs-comment">-- NB: coercions are always expanded upon creation</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399428"><a href="#local-6989586621679399428"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><a name="local-6989586621679399429"><a href="#local-6989586621679399429"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399430"><a href="#local-6989586621679399430"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399431"><a href="#local-6989586621679399431"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-408"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a><span> </span><a href="#local-6989586621679399429"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679399430"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399428"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399431"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399432"><a href="#local-6989586621679399432"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span> </span><a name="local-6989586621679399433"><a href="#local-6989586621679399433"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679399434"><a href="#local-6989586621679399434"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399432"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399433"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399432"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399434"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399435"><a href="#local-6989586621679399435"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><a name="local-6989586621679399436"><a href="#local-6989586621679399436"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679399437"><a href="#local-6989586621679399437"><span class="hs-identifier">kind_co</span></a></a><span> </span><a name="local-6989586621679399438"><a href="#local-6989586621679399438"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-412"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679399439"><a href="#local-6989586621679399439"><span class="hs-identifier">subst'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399440"><a href="#local-6989586621679399440"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399441"><a href="#local-6989586621679399441"><span class="hs-identifier">kind_co'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399396"><span class="hs-identifier hs-var">go_cobndr</span></a><span> </span><a href="#local-6989586621679399435"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399436"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679399437"><span class="hs-identifier hs-var">kind_co</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-413"></a><span>        </span><a href="Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a><span> </span><a href="#local-6989586621679399440"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-6989586621679399441"><span class="hs-identifier hs-var">kind_co'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399439"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-6989586621679399438"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399442"><a href="#local-6989586621679399442"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunCo"><span class="hs-identifier hs-var">FunCo</span></a><span> </span><a name="local-6989586621679399443"><a href="#local-6989586621679399443"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399444"><a href="#local-6989586621679399444"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-6989586621679399445"><a href="#local-6989586621679399445"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a><span> </span><a href="#local-6989586621679399443"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399442"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399444"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399442"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399445"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399446"><a href="#local-6989586621679399446"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a><span> </span><a name="local-6989586621679399447"><a href="#local-6989586621679399447"><span class="hs-identifier">cv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substCoVar"><span class="hs-identifier hs-var">substCoVar</span></a><span> </span><a href="#local-6989586621679399446"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399447"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-418"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399448"><a href="#local-6989586621679399448"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span> </span><a name="local-6989586621679399449"><a href="#local-6989586621679399449"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-6989586621679399450"><a href="#local-6989586621679399450"><span class="hs-identifier">ind</span></a></a><span> </span><a name="local-6989586621679399451"><a href="#local-6989586621679399451"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a><span> </span><a href="#local-6989586621679399449"><span class="hs-identifier hs-var">ax</span></a><span> </span><a href="#local-6989586621679399450"><span class="hs-identifier hs-var">ind</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399448"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399451"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399452"><a href="#local-6989586621679399452"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><a name="local-6989586621679399453"><a href="#local-6989586621679399453"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679399454"><a href="#local-6989586621679399454"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399455"><a href="#local-6989586621679399455"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679399456"><a href="#local-6989586621679399456"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-421"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399395"><span class="hs-identifier hs-var">go_prov</span></a><span> </span><a href="#local-6989586621679399452"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399453"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399454"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399452"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399455"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399393"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399452"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399456"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-422"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399457"><a href="#local-6989586621679399457"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span> </span><a name="local-6989586621679399458"><a href="#local-6989586621679399458"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-423"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399457"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399458"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-424"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399459"><a href="#local-6989586621679399459"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span> </span><a name="local-6989586621679399460"><a href="#local-6989586621679399460"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-6989586621679399461"><a href="#local-6989586621679399461"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-425"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399459"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399460"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399459"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399461"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399462"><a href="#local-6989586621679399462"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span> </span><a name="local-6989586621679399463"><a href="#local-6989586621679399463"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679399464"><a href="#local-6989586621679399464"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a><span> </span><a href="#local-6989586621679399463"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399462"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399464"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-428"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399465"><a href="#local-6989586621679399465"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span> </span><a name="local-6989586621679399466"><a href="#local-6989586621679399466"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-6989586621679399467"><a href="#local-6989586621679399467"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a><span> </span><a href="#local-6989586621679399466"><span class="hs-identifier hs-var">lr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399465"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399467"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-430"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399468"><a href="#local-6989586621679399468"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span> </span><a name="local-6989586621679399469"><a href="#local-6989586621679399469"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679399470"><a href="#local-6989586621679399470"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-431"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399468"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399469"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399468"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399470"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-432"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399471"><a href="#local-6989586621679399471"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span> </span><a name="local-6989586621679399472"><a href="#local-6989586621679399472"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-6989586621679399473"><a href="#local-6989586621679399473"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkCoherenceCo"><span class="hs-identifier hs-var">mkCoherenceCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399471"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399472"><span class="hs-identifier hs-var">co1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399471"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399473"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399474"><a href="#local-6989586621679399474"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span> </span><a name="local-6989586621679399475"><a href="#local-6989586621679399475"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399474"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399475"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399476"><a href="#local-6989586621679399476"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span> </span><a name="local-6989586621679399477"><a href="#local-6989586621679399477"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-437"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399476"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399477"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-438"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><a name="local-6989586621679399478"><a href="#local-6989586621679399478"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a name="local-6989586621679399479"><a href="#local-6989586621679399479"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-6989586621679399480"><a href="#local-6989586621679399480"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-439"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a href="#local-6989586621679399479"><span class="hs-identifier hs-var">ax</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399478"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399480"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-440"></a><span>    </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#HoleCo"><span class="hs-identifier hs-var">HoleCo</span></a><span> </span><a name="local-6989586621679399481"><a href="#local-6989586621679399481"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-441"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;expandTypeSynonyms hit a hole&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399481"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span>    </span><a name="local-6989586621679399395"><a href="#local-6989586621679399395"><span class="hs-identifier">go_prov</span></a></a><span> </span><span class="hs-identifier">_</span><span>     </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>
</span><a name="line-444"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><a name="local-6989586621679399482"><a href="#local-6989586621679399482"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a name="local-6989586621679399483"><a href="#local-6989586621679399483"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399482"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399483"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-445"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><a name="local-6989586621679399484"><a href="#local-6989586621679399484"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a name="local-6989586621679399485"><a href="#local-6989586621679399485"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399484"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399485"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-446"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-identifier">_</span><span>     </span><a name="local-6989586621679399486"><a href="#local-6989586621679399486"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#PluginProv"><span class="hs-identifier hs-var">PluginProv</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399486"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-447"></a><span>
</span><a name="line-448"></a><span>      </span><span class="hs-comment">-- the &quot;False&quot; and &quot;const&quot; are to accommodate the type of</span><span>
</span><a name="line-449"></a><span>      </span><span class="hs-comment">-- substForAllCoBndrCallback, which is general enough to</span><span>
</span><a name="line-450"></a><span>      </span><span class="hs-comment">-- handle coercion optimization (which sometimes swaps the</span><span>
</span><a name="line-451"></a><span>      </span><span class="hs-comment">-- order of a coercion)</span><span>
</span><a name="line-452"></a><span>    </span><a name="local-6989586621679399396"><a href="#local-6989586621679399396"><span class="hs-identifier">go_cobndr</span></a></a><span> </span><a name="local-6989586621679399487"><a href="#local-6989586621679399487"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substForAllCoBndrCallback"><span class="hs-identifier hs-var">substForAllCoBndrCallback</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399394"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679399487"><span class="hs-identifier hs-var">subst</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399487"><span class="hs-identifier hs-var">subst</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
   Analyzing types
*                                                                      *
************************************************************************

These functions do a map-like operation over types, performing some operation
on all variables and binding sites. Primarily used for zonking.

Note [Efficiency for mapCoercion ForAllCo case]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As noted in Note [Forall coercions] in TyCoRep, a ForAllCo is a bit redundant.
It stores a TyVar and a Coercion, where the kind of the TyVar always matches
the left-hand kind of the coercion. This is convenient lots of the time, but
not when mapping a function over a coercion.

The problem is that tcm_tybinder will affect the TyVar's kind and
mapCoercion will affect the Coercion, and we hope that the results will be
the same. Even if they are the same (which should generally happen with
correct algorithms), then there is an efficiency issue. In particular,
this problem seems to make what should be a linear algorithm into a potentially
exponential one. But it's only going to be bad in the case where there's
lots of foralls in the kinds of other foralls. Like this:

  forall a : (forall b : (forall c : ...). ...). ...

This construction seems unlikely. So we'll do the inefficient, easy way
for now.

Note [Specialising mappers]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
These INLINABLE pragmas are indispensable. mapType/mapCoercion are used
to implement zonking, and it's vital that they get specialised to the TcM
monad. This specialisation happens automatically (that is, without a
SPECIALISE pragma) as long as the definitions are INLINABLE. For example,
this one change made a 20% allocation difference in perf/compiler/T5030.

-}</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-comment">-- | This describes how a &quot;map&quot; operation over a type/coercion should behave</span><span>
</span><a name="line-495"></a><span class="hs-keyword">data</span><span> </span><a name="TyCoMapper"><a href="Type.html#TyCoMapper"><span class="hs-identifier">TyCoMapper</span></a></a><span> </span><a name="local-6989586621679399371"><a href="#local-6989586621679399371"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679399372"><a href="#local-6989586621679399372"><span class="hs-identifier">m</span></a></a><span>
</span><a name="line-496"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="TyCoMapper"><a href="Type.html#TyCoMapper"><span class="hs-identifier">TyCoMapper</span></a></a><span>
</span><a name="line-497"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="tcm_smart"><a href="Type.html#tcm_smart"><span class="hs-identifier">tcm_smart</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-comment">-- ^ Should the new type be created with smart</span><span>
</span><a name="line-498"></a><span>                         </span><span class="hs-comment">-- constructors?</span><span>
</span><a name="line-499"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="tcm_tyvar"><a href="Type.html#tcm_tyvar"><span class="hs-identifier">tcm_tyvar</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679399371"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399372"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-500"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="tcm_covar"><a href="Type.html#tcm_covar"><span class="hs-identifier">tcm_covar</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679399371"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399372"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-501"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="tcm_hole"><a href="Type.html#tcm_hole"><span class="hs-identifier">tcm_hole</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679399371"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399372"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-502"></a><span>          </span><span class="hs-comment">-- ^ What to do with coercion holes.</span><span>
</span><a name="line-503"></a><span>          </span><span class="hs-comment">-- See Note [Coercion holes] in TyCoRep.</span><span>
</span><a name="line-504"></a><span>
</span><a name="line-505"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="tcm_tybinder"><a href="Type.html#tcm_tybinder"><span class="hs-identifier">tcm_tybinder</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679399371"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#ArgFlag"><span class="hs-identifier hs-type">ArgFlag</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399372"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399371"><span class="hs-identifier hs-type">env</span></a><span class="hs-special">,</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span>          </span><span class="hs-comment">-- ^ The returned env is used in the extended scope</span><span>
</span><a name="line-507"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-pragma">{-# INLINABLE mapType #-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><a name="line-510"></a><span class="hs-identifier">mapType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679399378"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span> </span><a href="#local-6989586621679399379"><span class="hs-identifier hs-type">env</span></a><span> </span><a href="#local-6989586621679399378"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399379"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399378"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-511"></a><a name="mapType"><a href="Type.html#mapType"><span class="hs-identifier">mapType</span></a></a><span> </span><a name="local-6989586621679399488"><a href="#local-6989586621679399488"><span class="hs-identifier">mapper</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcm_smart</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679399489"><a href="#local-6989586621679399489"><span class="hs-identifier">smart</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tyvar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679399490"><a href="#local-6989586621679399490"><span class="hs-identifier">tyvar</span></a></a><span>
</span><a name="line-512"></a><span>                           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tybinder</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679399491"><a href="#local-6989586621679399491"><span class="hs-identifier">tybinder</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-513"></a><span>        </span><a name="local-6989586621679399492"><a href="#local-6989586621679399492"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679399493"><a href="#local-6989586621679399493"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-514"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399493"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-515"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-516"></a><span>    </span><a name="local-6989586621679399494"><a href="#local-6989586621679399494"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399498"><a href="#local-6989586621679399498"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399490"><span class="hs-identifier hs-var">tyvar</span></a><span> </span><a href="#local-6989586621679399492"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399498"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-517"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399499"><a href="#local-6989586621679399499"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679399500"><a href="#local-6989586621679399500"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399496"><span class="hs-identifier hs-var">mkappty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399499"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399500"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-518"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399501"><a href="#local-6989586621679399501"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679399501"><span class="hs-identifier hs-var">t</span></a><span>  </span><span class="hs-comment">-- avoid allocation in this exceedingly</span><span>
</span><a name="line-519"></a><span>                                     </span><span class="hs-comment">-- common case (mostly, for *)</span><span>
</span><a name="line-520"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399502"><a href="#local-6989586621679399502"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399503"><a href="#local-6989586621679399503"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399495"><span class="hs-identifier hs-var">mktyconapp</span></a><span> </span><a href="#local-6989586621679399502"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399503"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-521"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399504"><a href="#local-6989586621679399504"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399505"><a href="#local-6989586621679399505"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399504"><span class="hs-identifier hs-var">arg</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399505"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-522"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399506"><a href="#local-6989586621679399506"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679399507"><a href="#local-6989586621679399507"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399508"><a href="#local-6989586621679399508"><span class="hs-identifier">inner</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-523"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679399509"><a href="#local-6989586621679399509"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399510"><a href="#local-6989586621679399510"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399491"><span class="hs-identifier hs-var">tybinder</span></a><span> </span><a href="#local-6989586621679399492"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399506"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679399507"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-524"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679399511"><a href="#local-6989586621679399511"><span class="hs-identifier">inner'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-6989586621679399488"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-6989586621679399509"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679399508"><span class="hs-identifier hs-var">inner</span></a><span>
</span><a name="line-525"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399510"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-6989586621679399507"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399511"><span class="hs-identifier hs-var">inner'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-526"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399512"><a href="#local-6989586621679399512"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679399512"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-527"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679399513"><a href="#local-6989586621679399513"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399514"><a href="#local-6989586621679399514"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399497"><span class="hs-identifier hs-var">mkcastty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399513"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="#local-6989586621679399488"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-6989586621679399492"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399514"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-528"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679399515"><a href="#local-6989586621679399515"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="#local-6989586621679399488"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-6989586621679399492"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399515"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679399495"><a href="#local-6989586621679399495"><span class="hs-identifier">mktyconapp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399496"><a href="#local-6989586621679399496"><span class="hs-identifier">mkappty</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399497"><a href="#local-6989586621679399497"><span class="hs-identifier">mkcastty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-531"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679399489"><span class="hs-identifier hs-var">smart</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a><span class="hs-special">,</span><span> </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-532"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span class="hs-special">,</span><span>   </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span class="hs-special">,</span><span>   </span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span class="hs-special">)</span><span>
</span><a name="line-533"></a><span>
</span><a name="line-534"></a><span class="hs-pragma">{-# INLINABLE mapCoercion #-}</span><span>  </span><span class="hs-comment">-- See Note [Specialising mappers]</span><span>
</span><a name="line-535"></a><span class="hs-identifier">mapCoercion</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679399376"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-536"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-type">TyCoMapper</span></a><span> </span><a href="#local-6989586621679399377"><span class="hs-identifier hs-type">env</span></a><span> </span><a href="#local-6989586621679399376"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399377"><span class="hs-identifier hs-type">env</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399376"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-537"></a><a name="mapCoercion"><a href="Type.html#mapCoercion"><span class="hs-identifier">mapCoercion</span></a></a><span> </span><a name="local-6989586621679399516"><a href="#local-6989586621679399516"><span class="hs-identifier">mapper</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Type.html#TyCoMapper"><span class="hs-identifier hs-var">TyCoMapper</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">tcm_smart</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679399517"><a href="#local-6989586621679399517"><span class="hs-identifier">smart</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_covar</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679399518"><a href="#local-6989586621679399518"><span class="hs-identifier">covar</span></a></a><span>
</span><a name="line-538"></a><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_hole</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679399519"><a href="#local-6989586621679399519"><span class="hs-identifier">cohole</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">tcm_tybinder</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679399520"><a href="#local-6989586621679399520"><span class="hs-identifier">tybinder</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-539"></a><span>            </span><a name="local-6989586621679399521"><a href="#local-6989586621679399521"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679399522"><a href="#local-6989586621679399522"><span class="hs-identifier">co</span></a></a><span>
</span><a name="line-540"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399522"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-541"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-542"></a><span>    </span><a name="local-6989586621679399523"><a href="#local-6989586621679399523"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><a name="local-6989586621679399538"><a href="#local-6989586621679399538"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399539"><a href="#local-6989586621679399539"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><a href="#local-6989586621679399538"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-6989586621679399516"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-6989586621679399521"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399539"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-543"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><a name="local-6989586621679399540"><a href="#local-6989586621679399540"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399541"><a href="#local-6989586621679399541"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399542"><a href="#local-6989586621679399542"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399525"><span class="hs-identifier hs-var">mktyconappco</span></a><span> </span><a href="#local-6989586621679399540"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679399541"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399542"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-545"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span> </span><a name="local-6989586621679399543"><a href="#local-6989586621679399543"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679399544"><a href="#local-6989586621679399544"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399526"><span class="hs-identifier hs-var">mkappco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399543"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399544"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-546"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><a name="local-6989586621679399545"><a href="#local-6989586621679399545"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679399546"><a href="#local-6989586621679399546"><span class="hs-identifier">kind_co</span></a></a><span> </span><a name="local-6989586621679399547"><a href="#local-6989586621679399547"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-547"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679399548"><a href="#local-6989586621679399548"><span class="hs-identifier">kind_co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399546"><span class="hs-identifier hs-var">kind_co</span></a><span>
</span><a name="line-548"></a><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679399549"><a href="#local-6989586621679399549"><span class="hs-identifier">env'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399550"><a href="#local-6989586621679399550"><span class="hs-identifier">tv'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399520"><span class="hs-identifier hs-var">tybinder</span></a><span> </span><a href="#local-6989586621679399521"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399545"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span>
</span><a name="line-549"></a><span>           </span><span class="hs-special">;</span><span> </span><a name="local-6989586621679399551"><a href="#local-6989586621679399551"><span class="hs-identifier">co'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#mapCoercion"><span class="hs-identifier hs-var">mapCoercion</span></a><span> </span><a href="#local-6989586621679399516"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-6989586621679399549"><span class="hs-identifier hs-var">env'</span></a><span> </span><a href="#local-6989586621679399547"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-550"></a><span>           </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679399537"><span class="hs-identifier hs-var">mkforallco</span></a><span> </span><a href="#local-6989586621679399550"><span class="hs-identifier hs-var">tv'</span></a><span> </span><a href="#local-6989586621679399548"><span class="hs-identifier hs-var">kind_co'</span></a><span> </span><a href="#local-6989586621679399551"><span class="hs-identifier hs-var">co'</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-551"></a><span>        </span><span class="hs-comment">-- See Note [Efficiency for mapCoercion ForAllCo case]</span><span>
</span><a name="line-552"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunCo"><span class="hs-identifier hs-var">FunCo</span></a><span> </span><a name="local-6989586621679399552"><a href="#local-6989586621679399552"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399553"><a href="#local-6989586621679399553"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679399554"><a href="#local-6989586621679399554"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a><span> </span><a href="#local-6989586621679399552"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399553"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399554"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-553"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a><span> </span><a name="local-6989586621679399555"><a href="#local-6989586621679399555"><span class="hs-identifier">cv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399518"><span class="hs-identifier hs-var">covar</span></a><span> </span><a href="#local-6989586621679399521"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399555"><span class="hs-identifier hs-var">cv</span></a><span>
</span><a name="line-554"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span> </span><a name="local-6989586621679399556"><a href="#local-6989586621679399556"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-6989586621679399557"><a href="#local-6989586621679399557"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679399558"><a href="#local-6989586621679399558"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-555"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399527"><span class="hs-identifier hs-var">mkaxiominstco</span></a><span> </span><a href="#local-6989586621679399556"><span class="hs-identifier hs-var">ax</span></a><span> </span><a href="#local-6989586621679399557"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399558"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-556"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#HoleCo"><span class="hs-identifier hs-var">HoleCo</span></a><span> </span><a name="local-6989586621679399559"><a href="#local-6989586621679399559"><span class="hs-identifier">hole</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399519"><span class="hs-identifier hs-var">cohole</span></a><span> </span><a href="#local-6989586621679399521"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399559"><span class="hs-identifier hs-var">hole</span></a><span>
</span><a name="line-557"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><a name="local-6989586621679399560"><a href="#local-6989586621679399560"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679399561"><a href="#local-6989586621679399561"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399562"><a href="#local-6989586621679399562"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679399563"><a href="#local-6989586621679399563"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-558"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399528"><span class="hs-identifier hs-var">mkunivco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399524"><span class="hs-identifier hs-var">go_prov</span></a><span> </span><a href="#local-6989586621679399560"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a><span> </span><a href="#local-6989586621679399561"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-559"></a><span>                 </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-6989586621679399516"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-6989586621679399521"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399562"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="Type.html#mapType"><span class="hs-identifier hs-var">mapType</span></a><span> </span><a href="#local-6989586621679399516"><span class="hs-identifier hs-var">mapper</span></a><span> </span><a href="#local-6989586621679399521"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679399563"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-560"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span> </span><a name="local-6989586621679399564"><a href="#local-6989586621679399564"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399529"><span class="hs-identifier hs-var">mksymco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399564"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-561"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span> </span><a name="local-6989586621679399565"><a href="#local-6989586621679399565"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679399566"><a href="#local-6989586621679399566"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399530"><span class="hs-identifier hs-var">mktransco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399565"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399566"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-562"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a name="local-6989586621679399567"><a href="#local-6989586621679399567"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679399568"><a href="#local-6989586621679399568"><span class="hs-identifier">cos</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><a href="#local-6989586621679399567"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399568"><span class="hs-identifier hs-var">cos</span></a><span>
</span><a name="line-563"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span> </span><a name="local-6989586621679399569"><a href="#local-6989586621679399569"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679399570"><a href="#local-6989586621679399570"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399531"><span class="hs-identifier hs-var">mknthco</span></a><span> </span><a href="#local-6989586621679399569"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399570"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-564"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span> </span><a name="local-6989586621679399571"><a href="#local-6989586621679399571"><span class="hs-identifier">lr</span></a></a><span> </span><a name="local-6989586621679399572"><a href="#local-6989586621679399572"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399532"><span class="hs-identifier hs-var">mklrco</span></a><span> </span><a href="#local-6989586621679399571"><span class="hs-identifier hs-var">lr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399572"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-565"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span> </span><a name="local-6989586621679399573"><a href="#local-6989586621679399573"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679399574"><a href="#local-6989586621679399574"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399533"><span class="hs-identifier hs-var">mkinstco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399573"><span class="hs-identifier hs-var">co</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399574"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-566"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span> </span><a name="local-6989586621679399575"><a href="#local-6989586621679399575"><span class="hs-identifier">c1</span></a></a><span> </span><a name="local-6989586621679399576"><a href="#local-6989586621679399576"><span class="hs-identifier">c2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399534"><span class="hs-identifier hs-var">mkcoherenceco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399575"><span class="hs-identifier hs-var">c1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399576"><span class="hs-identifier hs-var">c2</span></a><span>
</span><a name="line-567"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span> </span><a name="local-6989586621679399577"><a href="#local-6989586621679399577"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399535"><span class="hs-identifier hs-var">mkkindco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399577"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-568"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span> </span><a name="local-6989586621679399578"><a href="#local-6989586621679399578"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399536"><span class="hs-identifier hs-var">mksubco</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399578"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span>    </span><a name="local-6989586621679399524"><a href="#local-6989586621679399524"><span class="hs-identifier">go_prov</span></a></a><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>
</span><a name="line-571"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a name="local-6989586621679399579"><a href="#local-6989586621679399579"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399579"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-572"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a name="local-6989586621679399580"><a href="#local-6989586621679399580"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679399523"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399580"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-573"></a><span>    </span><span class="hs-identifier">go_prov</span><span> </span><a name="local-6989586621679399581"><a href="#local-6989586621679399581"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#PluginProv"><span class="hs-identifier hs-var">PluginProv</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679399581"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-574"></a><span>
</span><a name="line-575"></a><span>    </span><span class="hs-special">(</span><span> </span><a name="local-6989586621679399525"><a href="#local-6989586621679399525"><span class="hs-identifier">mktyconappco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399526"><a href="#local-6989586621679399526"><span class="hs-identifier">mkappco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399527"><a href="#local-6989586621679399527"><span class="hs-identifier">mkaxiominstco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399528"><a href="#local-6989586621679399528"><span class="hs-identifier">mkunivco</span></a></a><span>
</span><a name="line-576"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="local-6989586621679399529"><a href="#local-6989586621679399529"><span class="hs-identifier">mksymco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399530"><a href="#local-6989586621679399530"><span class="hs-identifier">mktransco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399531"><a href="#local-6989586621679399531"><span class="hs-identifier">mknthco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399532"><a href="#local-6989586621679399532"><span class="hs-identifier">mklrco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399533"><a href="#local-6989586621679399533"><span class="hs-identifier">mkinstco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399534"><a href="#local-6989586621679399534"><span class="hs-identifier">mkcoherenceco</span></a></a><span>
</span><a name="line-577"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="local-6989586621679399535"><a href="#local-6989586621679399535"><span class="hs-identifier">mkkindco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399536"><a href="#local-6989586621679399536"><span class="hs-identifier">mksubco</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399537"><a href="#local-6989586621679399537"><span class="hs-identifier">mkforallco</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-578"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679399517"><span class="hs-identifier hs-var">smart</span></a><span>
</span><a name="line-579"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a><span>
</span><a name="line-580"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkCoherenceCo"><span class="hs-identifier hs-var">mkCoherenceCo</span></a><span>
</span><a name="line-581"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-582"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-583"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span>
</span><a name="line-584"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span>
</span><a name="line-585"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-586"></a><span>
</span><a name="line-587"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Constructor-specific functions}
*                                                                      *
************************************************************************


---------------------------------------------------------------------
                                TyVarTy
                                ~~~~~~~
-}</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', and panics with the</span><span>
</span><a name="line-601"></a><span class="hs-comment">-- given message if this is not a type variable type. See also 'getTyVar_maybe'</span><span>
</span><a name="line-602"></a><span class="hs-identifier">getTyVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-603"></a><a name="getTyVar"><a href="Type.html#getTyVar"><span class="hs-identifier">getTyVar</span></a></a><span> </span><a name="local-6989586621679399582"><a href="#local-6989586621679399582"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621679399583"><a href="#local-6989586621679399583"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-6989586621679399583"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-604"></a><span>                    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399584"><a href="#local-6989586621679399584"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399584"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-605"></a><span>                    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;getTyVar: &quot;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679399582"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-606"></a><span>
</span><a name="line-607"></a><span class="hs-identifier">isTyVarTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-608"></a><a name="isTyVarTy"><a href="Type.html#isTyVarTy"><span class="hs-identifier">isTyVarTy</span></a></a><span> </span><a name="local-6989586621679399585"><a href="#local-6989586621679399585"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-6989586621679399585"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type'</span><span>
</span><a name="line-611"></a><span class="hs-identifier">getTyVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-612"></a><a name="getTyVar_maybe"><a href="Type.html#getTyVar_maybe"><span class="hs-identifier">getTyVar_maybe</span></a></a><span> </span><a name="local-6989586621679399586"><a href="#local-6989586621679399586"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399587"><a href="#local-6989586621679399587"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399586"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getTyVar_maybe"><span class="hs-identifier hs-var">getTyVar_maybe</span></a><span> </span><a href="#local-6989586621679399587"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-613"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#repGetTyVar_maybe"><span class="hs-identifier hs-var">repGetTyVar_maybe</span></a><span> </span><a href="#local-6989586621679399586"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-614"></a><span>
</span><a name="line-615"></a><span class="hs-comment">-- | If the type is a tyvar, possibly under a cast, returns it, along</span><span>
</span><a name="line-616"></a><span class="hs-comment">-- with the coercion. Thus, the co is :: kind tv ~N kind type</span><span>
</span><a name="line-617"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#CoercionN"><span class="hs-identifier hs-type">CoercionN</span></a><span class="hs-special">)</span><span>
</span><a name="line-618"></a><a name="getCastedTyVar_maybe"><a href="Type.html#getCastedTyVar_maybe"><span class="hs-identifier">getCastedTyVar_maybe</span></a></a><span> </span><a name="local-6989586621679399588"><a href="#local-6989586621679399588"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399589"><a href="#local-6989586621679399589"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399588"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getCastedTyVar_maybe"><span class="hs-identifier hs-var">getCastedTyVar_maybe</span></a><span> </span><a href="#local-6989586621679399589"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-619"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399590"><a href="#local-6989586621679399590"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399591"><a href="#local-6989586621679399591"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399590"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399591"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399592"><a href="#local-6989586621679399592"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399592"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="Coercion.html#mkReflCo"><span class="hs-identifier hs-var">mkReflCo</span></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679399592"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-622"></a><span class="hs-identifier">getCastedTyVar_maybe</span><span> </span><span class="hs-identifier">_</span><span>                            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span class="hs-comment">-- | Attempts to obtain the type variable underlying a 'Type', without</span><span>
</span><a name="line-625"></a><span class="hs-comment">-- any expansion</span><span>
</span><a name="line-626"></a><span class="hs-identifier">repGetTyVar_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span>
</span><a name="line-627"></a><a name="repGetTyVar_maybe"><a href="Type.html#repGetTyVar_maybe"><span class="hs-identifier">repGetTyVar_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399593"><a href="#local-6989586621679399593"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399593"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-628"></a><span class="hs-identifier">repGetTyVar_maybe</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-629"></a><span>
</span><a name="line-630"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                AppTy
                                ~~~~~
We need to be pretty careful with AppTy to make sure we obey the
invariant that a TyConApp is always visibly so.  mkAppTy maintains the
invariant: use it.

Note [Decomposing fat arrow c=&gt;t]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Can we unify (a b) with (Eq a =&gt; ty)?   If we do so, we end up with
a partial application like ((=&gt;) Eq a) which doesn't make sense in
source Haskell.  In contrast, we *can* unify (a b) with (t1 -&gt; t2).
Here's an example (Trac #9858) of how you might do it:
   i :: (Typeable a, Typeable b) =&gt; Proxy (a b) -&gt; TypeRep
   i p = typeRep p

   j = i (Proxy :: Proxy (Eq Int =&gt; Int))
The type (Proxy (Eq Int =&gt; Int)) is only accepted with -XImpredicativeTypes,
but suppose we want that.  But then in the call to 'i', we end
up decomposing (Eq Int =&gt; Int), and we definitely don't want that.

This really only applies to the type checker; in Core, '=&gt;' and '-&gt;'
are the same, as are 'Constraint' and '*'.  But for now I've put
the test in repSplitAppTy_maybe, which applies throughout, because
the other calls to splitAppTy are in Unify, which is also used by
the type checker (e.g. when matching type-function equations).

-}</span><span>
</span><a name="line-659"></a><span>
</span><a name="line-660"></a><span class="hs-comment">-- | Applies a type to another, as in e.g. @k a@</span><span>
</span><a name="line-661"></a><span class="hs-identifier">mkAppTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-662"></a><a name="mkAppTy"><a href="Type.html#mkAppTy"><span class="hs-identifier">mkAppTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399594"><a href="#local-6989586621679399594"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399595"><a href="#local-6989586621679399595"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399596"><a href="#local-6989586621679399596"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-6989586621679399594"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399595"><span class="hs-identifier hs-var">tys</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399596"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span class="hs-identifier">mkAppTy</span><span> </span><a name="local-6989586621679399597"><a href="#local-6989586621679399597"><span class="hs-identifier">ty1</span></a></a><span>               </span><a name="local-6989586621679399598"><a href="#local-6989586621679399598"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a href="#local-6989586621679399597"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679399598"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-664"></a><span>        </span><span class="hs-comment">-- Note that the TyConApp could be an</span><span>
</span><a name="line-665"></a><span>        </span><span class="hs-comment">-- under-saturated type synonym.  GHC allows that; e.g.</span><span>
</span><a name="line-666"></a><span>        </span><span class="hs-comment">--      type Foo k = k a -&gt; k a</span><span>
</span><a name="line-667"></a><span>        </span><span class="hs-comment">--      type Id x = x</span><span>
</span><a name="line-668"></a><span>        </span><span class="hs-comment">--      foo :: Foo Id -&gt; Foo Id</span><span>
</span><a name="line-669"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-670"></a><span>        </span><span class="hs-comment">-- Here Id is partially applied in the type sig for Foo,</span><span>
</span><a name="line-671"></a><span>        </span><span class="hs-comment">-- but once the type synonyms are expanded all is well</span><span>
</span><a name="line-672"></a><span>
</span><a name="line-673"></a><span class="hs-identifier">mkAppTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-674"></a><a name="mkAppTys"><a href="Type.html#mkAppTys"><span class="hs-identifier">mkAppTys</span></a></a><span> </span><a name="local-6989586621679399599"><a href="#local-6989586621679399599"><span class="hs-identifier">ty1</span></a></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399599"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-675"></a><span class="hs-identifier">mkAppTys</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399600"><a href="#local-6989586621679399600"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399601"><a href="#local-6989586621679399601"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399602"><a href="#local-6989586621679399602"><span class="hs-identifier">tys2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-6989586621679399600"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399601"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679399602"><span class="hs-identifier hs-var">tys2</span></a><span class="hs-special">)</span><span>
</span><a name="line-676"></a><span class="hs-identifier">mkAppTys</span><span> </span><a name="local-6989586621679399603"><a href="#local-6989586621679399603"><span class="hs-identifier">ty1</span></a></a><span>                </span><a name="local-6989586621679399604"><a href="#local-6989586621679399604"><span class="hs-identifier">tys2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a href="#local-6989586621679399603"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679399604"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-677"></a><span>
</span><a name="line-678"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-679"></a><span class="hs-identifier">splitAppTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-680"></a><span class="hs-comment">-- ^ Attempt to take a type application apart, whether it is a</span><span>
</span><a name="line-681"></a><span class="hs-comment">-- function, type constructor, or plain type application. Note</span><span>
</span><a name="line-682"></a><span class="hs-comment">-- that type family applications are NEVER unsaturated by this!</span><span>
</span><a name="line-683"></a><a name="splitAppTy_maybe"><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier">splitAppTy_maybe</span></a></a><span> </span><a name="local-6989586621679399605"><a href="#local-6989586621679399605"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399606"><a href="#local-6989586621679399606"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399605"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-684"></a><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span> </span><a href="#local-6989586621679399606"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-685"></a><span class="hs-identifier">splitAppTy_maybe</span><span> </span><a name="local-6989586621679399607"><a href="#local-6989586621679399607"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-6989586621679399607"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-686"></a><span>
</span><a name="line-687"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-688"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-689"></a><span class="hs-comment">-- ^ Does the AppTy split as in 'splitAppTy_maybe', but assumes that</span><span>
</span><a name="line-690"></a><span class="hs-comment">-- any Core view stuff is already done</span><span>
</span><a name="line-691"></a><a name="repSplitAppTy_maybe"><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier">repSplitAppTy_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399608"><a href="#local-6989586621679399608"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679399609"><a href="#local-6989586621679399609"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-692"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399610"><span class="hs-identifier hs-var">rep1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399611"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399608"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399609"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-693"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-694"></a><span>    </span><a name="local-6989586621679399610"><a href="#local-6989586621679399610"><span class="hs-identifier">rep1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399608"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-695"></a><span>    </span><a name="local-6989586621679399611"><a href="#local-6989586621679399611"><span class="hs-identifier">rep2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399609"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399612"><a href="#local-6989586621679399612"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679399613"><a href="#local-6989586621679399613"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-698"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399612"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399613"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-699"></a><span>
</span><a name="line-700"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399614"><a href="#local-6989586621679399614"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399615"><a href="#local-6989586621679399615"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-6989586621679399614"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679399615"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621679399614"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-702"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399616"><a href="#local-6989586621679399616"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399617"><a href="#local-6989586621679399617"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#snocView"><span class="hs-identifier hs-var">snocView</span></a><span> </span><a href="#local-6989586621679399615"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-703"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621679399614"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399616"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399617"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Never create unsaturated type family apps!</span><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span class="hs-identifier">repSplitAppTy_maybe</span><span> </span><a name="local-6989586621679399618"><a href="#local-6989586621679399618"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-706"></a><span>
</span><a name="line-707"></a><span class="hs-comment">-- this one doesn't braek apart (c =&gt; t).</span><span>
</span><a name="line-708"></a><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><a name="line-709"></a><span class="hs-comment">-- Defined here to avoid module loops between Unify and TcType.</span><span>
</span><a name="line-710"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-711"></a><span class="hs-comment">-- ^ Does the AppTy split as in 'tcSplitAppTy_maybe', but assumes that</span><span>
</span><a name="line-712"></a><span class="hs-comment">-- any coreView stuff is already done. Refuses to look through (c =&gt; t)</span><span>
</span><a name="line-713"></a><a name="tcRepSplitAppTy_maybe"><a href="Type.html#tcRepSplitAppTy_maybe"><span class="hs-identifier">tcRepSplitAppTy_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399619"><a href="#local-6989586621679399619"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679399620"><a href="#local-6989586621679399620"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-714"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Kind.html#isConstraintKind"><span class="hs-identifier hs-var">isConstraintKind</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679399619"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-comment">-- See Note [Decomposing fat arrow c=&gt;t]</span><span>
</span><a name="line-716"></a><span>
</span><a name="line-717"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-718"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399621"><span class="hs-identifier hs-var">rep1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399622"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399619"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399620"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-720"></a><span>    </span><a name="local-6989586621679399621"><a href="#local-6989586621679399621"><span class="hs-identifier">rep1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399619"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-721"></a><span>    </span><a name="local-6989586621679399622"><a href="#local-6989586621679399622"><span class="hs-identifier">rep2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399620"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-722"></a><span>
</span><a name="line-723"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399623"><a href="#local-6989586621679399623"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679399624"><a href="#local-6989586621679399624"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399623"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399624"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-724"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399625"><a href="#local-6989586621679399625"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399626"><a href="#local-6989586621679399626"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-725"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-6989586621679399625"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679399626"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">lengthExceeds</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621679399625"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-726"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399627"><a href="#local-6989586621679399627"><span class="hs-identifier">tys'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399628"><a href="#local-6989586621679399628"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Util.html#snocView"><span class="hs-identifier hs-var">snocView</span></a><span> </span><a href="#local-6989586621679399626"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-727"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621679399625"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399627"><span class="hs-identifier hs-var">tys'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399628"><span class="hs-identifier hs-var">ty'</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Never create unsaturated type family apps!</span><span>
</span><a name="line-728"></a><span class="hs-identifier">tcRepSplitAppTy_maybe</span><span> </span><a name="local-6989586621679399629"><a href="#local-6989586621679399629"><span class="hs-identifier">_other</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-729"></a><span>
</span><a name="line-730"></a><span class="hs-comment">-- | Split a type constructor application into its type constructor and</span><span>
</span><a name="line-731"></a><span class="hs-comment">-- applied types. Note that this may fail in the case of a 'FunTy' with an</span><span>
</span><a name="line-732"></a><span class="hs-comment">-- argument of unknown kind 'FunTy' (e.g. @FunTy (a :: k) Int@. since the kind</span><span>
</span><a name="line-733"></a><span class="hs-comment">-- of @a@ isn't of the form @TYPE rep@). Consequently, you may need to zonk your</span><span>
</span><a name="line-734"></a><span class="hs-comment">-- type before using this function.</span><span>
</span><a name="line-735"></a><span class="hs-comment">--</span><span>
</span><a name="line-736"></a><span class="hs-comment">-- If you only need the 'TyCon', consider using 'tcTyConAppTyCon_maybe'.</span><span>
</span><a name="line-737"></a><span class="hs-identifier">tcSplitTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-738"></a><span class="hs-comment">-- Defined here to avoid module loops between Unify and TcType.</span><span>
</span><a name="line-739"></a><a name="tcSplitTyConApp_maybe"><a href="Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier">tcSplitTyConApp_maybe</span></a></a><span> </span><a name="local-6989586621679399630"><a href="#local-6989586621679399630"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399631"><a href="#local-6989586621679399631"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#tcView"><span class="hs-identifier hs-var">tcView</span></a><span> </span><a href="#local-6989586621679399630"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tcSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcSplitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399631"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-740"></a><span class="hs-identifier">tcSplitTyConApp_maybe</span><span> </span><a name="local-6989586621679399632"><a href="#local-6989586621679399632"><span class="hs-identifier">ty</span></a></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tcRepSplitTyConApp_maybe"><span class="hs-identifier hs-var">tcRepSplitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399632"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-741"></a><span>
</span><a name="line-742"></a><span class="hs-comment">-- | Like 'tcSplitTyConApp_maybe' but doesn't look through type synonyms.</span><span>
</span><a name="line-743"></a><span class="hs-identifier">tcRepSplitTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-744"></a><span class="hs-comment">-- Defined here to avoid module loops between Unify and TcType.</span><span>
</span><a name="line-745"></a><a name="tcRepSplitTyConApp_maybe"><a href="Type.html#tcRepSplitTyConApp_maybe"><span class="hs-identifier">tcRepSplitTyConApp_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399633"><a href="#local-6989586621679399633"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399634"><a href="#local-6989586621679399634"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-746"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399633"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399634"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-747"></a><span>
</span><a name="line-748"></a><span class="hs-identifier">tcRepSplitTyConApp_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399635"><a href="#local-6989586621679399635"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399636"><a href="#local-6989586621679399636"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-749"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399637"><span class="hs-identifier hs-var">arg_rep</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399638"><span class="hs-identifier hs-var">res_rep</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399635"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399636"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-750"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-751"></a><span>    </span><a name="local-6989586621679399637"><a href="#local-6989586621679399637"><span class="hs-identifier">arg_rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399635"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-752"></a><span>    </span><a name="local-6989586621679399638"><a href="#local-6989586621679399638"><span class="hs-identifier">res_rep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399636"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-753"></a><span>
</span><a name="line-754"></a><span class="hs-identifier">tcRepSplitTyConApp_maybe</span><span> </span><span class="hs-identifier">_</span><span>
</span><a name="line-755"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-756"></a><span>
</span><a name="line-757"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-758"></a><span class="hs-identifier">splitAppTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-759"></a><span class="hs-comment">-- ^ Attempts to take a type application apart, as in 'splitAppTy_maybe',</span><span>
</span><a name="line-760"></a><span class="hs-comment">-- and panics if this is not possible</span><span>
</span><a name="line-761"></a><a name="splitAppTy"><a href="Type.html#splitAppTy"><span class="hs-identifier">splitAppTy</span></a></a><span> </span><a name="local-6989586621679399639"><a href="#local-6989586621679399639"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitAppTy_maybe"><span class="hs-identifier hs-var">splitAppTy_maybe</span></a><span> </span><a href="#local-6989586621679399639"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-762"></a><span>                </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399640"><a href="#local-6989586621679399640"><span class="hs-identifier">pr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399640"><span class="hs-identifier hs-var">pr</span></a><span>
</span><a name="line-763"></a><span>                </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;splitAppTy&quot;</span><span>
</span><a name="line-764"></a><span>
</span><a name="line-765"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-766"></a><span class="hs-identifier">splitAppTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-767"></a><span class="hs-comment">-- ^ Recursively splits a type as far as is possible, leaving a residual</span><span>
</span><a name="line-768"></a><span class="hs-comment">-- type being applied to and the type arguments applied to it. Never fails,</span><span>
</span><a name="line-769"></a><span class="hs-comment">-- even if that means returning an empty list of type applications.</span><span>
</span><a name="line-770"></a><a name="splitAppTys"><a href="Type.html#splitAppTys"><span class="hs-identifier">splitAppTys</span></a></a><span> </span><a name="local-6989586621679399641"><a href="#local-6989586621679399641"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399642"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399641"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399641"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-771"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-772"></a><span>    </span><a name="local-6989586621679399642"><a href="#local-6989586621679399642"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679399643"><a href="#local-6989586621679399643"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-6989586621679399644"><a href="#local-6989586621679399644"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399645"><a href="#local-6989586621679399645"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399646"><a href="#local-6989586621679399646"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399644"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399642"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399643"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-6989586621679399646"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399645"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-773"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399647"><a href="#local-6989586621679399647"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399648"><a href="#local-6989586621679399648"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>        </span><a name="local-6989586621679399649"><a href="#local-6989586621679399649"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399642"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399647"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399647"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399648"><span class="hs-identifier hs-var">arg</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679399649"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399650"><a href="#local-6989586621679399650"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399651"><a href="#local-6989586621679399651"><span class="hs-identifier">tc_args</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399652"><a href="#local-6989586621679399652"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-775"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- keep type families saturated</span><span>
</span><a name="line-776"></a><span>            </span><a name="local-6989586621679399653"><a href="#local-6989586621679399653"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-6989586621679399650"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-777"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621679399650"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-778"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679399654"><a href="#local-6989586621679399654"><span class="hs-identifier">tc_args1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399655"><a href="#local-6989586621679399655"><span class="hs-identifier">tc_args2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span> </span><a href="#local-6989586621679399653"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679399651"><span class="hs-identifier hs-var">tc_args</span></a><span>
</span><a name="line-779"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-780"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621679399650"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399654"><span class="hs-identifier hs-var">tc_args1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399655"><span class="hs-identifier hs-var">tc_args2</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679399652"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-781"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399656"><a href="#local-6989586621679399656"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679399657"><a href="#local-6989586621679399657"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399658"><a href="#local-6989586621679399658"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-782"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-783"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399659"><span class="hs-identifier hs-var">rep1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399660"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399656"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399657"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-784"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-785"></a><span>        </span><a name="local-6989586621679399659"><a href="#local-6989586621679399659"><span class="hs-identifier">rep1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399656"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-786"></a><span>        </span><a name="local-6989586621679399660"><a href="#local-6989586621679399660"><span class="hs-identifier">rep2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399657"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-787"></a><span>
</span><a name="line-788"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399661"><a href="#local-6989586621679399661"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                     </span><a name="local-6989586621679399662"><a href="#local-6989586621679399662"><span class="hs-identifier">args</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399661"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399662"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-789"></a><span>
</span><a name="line-790"></a><span class="hs-comment">-- | Like 'splitAppTys', but doesn't look through type synonyms</span><span>
</span><a name="line-791"></a><span class="hs-identifier">repSplitAppTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-792"></a><a name="repSplitAppTys"><a href="Type.html#repSplitAppTys"><span class="hs-identifier">repSplitAppTys</span></a></a><span> </span><a name="local-6989586621679399663"><a href="#local-6989586621679399663"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399664"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399663"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-793"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-794"></a><span>    </span><a name="local-6989586621679399664"><a href="#local-6989586621679399664"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399665"><a href="#local-6989586621679399665"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399666"><a href="#local-6989586621679399666"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399667"><a href="#local-6989586621679399667"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399664"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399665"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399666"><span class="hs-identifier hs-var">arg</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679399667"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-795"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399668"><a href="#local-6989586621679399668"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399669"><a href="#local-6989586621679399669"><span class="hs-identifier">tc_args</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399670"><a href="#local-6989586621679399670"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-796"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679399671"><a href="#local-6989586621679399671"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#mightBeUnsaturatedTyCon"><span class="hs-identifier hs-var">mightBeUnsaturatedTyCon</span></a><span> </span><a href="#local-6989586621679399668"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-797"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621679399668"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-798"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679399672"><a href="#local-6989586621679399672"><span class="hs-identifier">tc_args1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399673"><a href="#local-6989586621679399673"><span class="hs-identifier">tc_args2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span> </span><a href="#local-6989586621679399671"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679399669"><span class="hs-identifier hs-var">tc_args</span></a><span>
</span><a name="line-799"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-800"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621679399668"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399672"><span class="hs-identifier hs-var">tc_args1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399673"><span class="hs-identifier hs-var">tc_args2</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679399670"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-801"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399674"><a href="#local-6989586621679399674"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679399675"><a href="#local-6989586621679399675"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399676"><a href="#local-6989586621679399676"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-802"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-803"></a><span>        </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399677"><span class="hs-identifier hs-var">rep1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399678"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399674"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399675"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-805"></a><span>        </span><a name="local-6989586621679399677"><a href="#local-6989586621679399677"><span class="hs-identifier">rep1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399674"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-806"></a><span>        </span><a name="local-6989586621679399678"><a href="#local-6989586621679399678"><span class="hs-identifier">rep2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679399675"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-807"></a><span>
</span><a name="line-808"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399679"><a href="#local-6989586621679399679"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399680"><a href="#local-6989586621679399680"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399679"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399680"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-809"></a><span>
</span><a name="line-810"></a><span class="hs-comment">{-
                      LitTy
                      ~~~~~
-}</span><span>
</span><a name="line-814"></a><span>
</span><a name="line-815"></a><span class="hs-identifier">mkNumLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-816"></a><a name="mkNumLitTy"><a href="Type.html#mkNumLitTy"><span class="hs-identifier">mkNumLitTy</span></a></a><span> </span><a name="local-6989586621679399681"><a href="#local-6989586621679399681"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a href="#local-6989586621679399681"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span class="hs-comment">-- | Is this a numeric literal. We also look through type synonyms.</span><span>
</span><a name="line-819"></a><span class="hs-identifier">isNumLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-820"></a><a name="isNumLitTy"><a href="Type.html#isNumLitTy"><span class="hs-identifier">isNumLitTy</span></a></a><span> </span><a name="local-6989586621679399682"><a href="#local-6989586621679399682"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399683"><a href="#local-6989586621679399683"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399682"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isNumLitTy"><span class="hs-identifier hs-var">isNumLitTy</span></a><span> </span><a href="#local-6989586621679399683"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-821"></a><span class="hs-identifier">isNumLitTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><a name="local-6989586621679399684"><a href="#local-6989586621679399684"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399684"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-822"></a><span class="hs-identifier">isNumLitTy</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-823"></a><span>
</span><a name="line-824"></a><span class="hs-identifier">mkStrLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-825"></a><a name="mkStrLitTy"><a href="Type.html#mkStrLitTy"><span class="hs-identifier">mkStrLitTy</span></a></a><span> </span><a name="local-6989586621679399685"><a href="#local-6989586621679399685"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a href="#local-6989586621679399685"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-826"></a><span>
</span><a name="line-827"></a><span class="hs-comment">-- | Is this a symbol literal. We also look through type synonyms.</span><span>
</span><a name="line-828"></a><span class="hs-identifier">isStrLitTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span>
</span><a name="line-829"></a><a name="isStrLitTy"><a href="Type.html#isStrLitTy"><span class="hs-identifier">isStrLitTy</span></a></a><span> </span><a name="local-6989586621679399686"><a href="#local-6989586621679399686"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399687"><a href="#local-6989586621679399687"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399686"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span> </span><a href="#local-6989586621679399687"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-830"></a><span class="hs-identifier">isStrLitTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><a name="local-6989586621679399688"><a href="#local-6989586621679399688"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399688"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-831"></a><span class="hs-identifier">isStrLitTy</span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-832"></a><span>
</span><a name="line-833"></a><span>
</span><a name="line-834"></a><span class="hs-comment">-- | Is this type a custom user error?</span><span>
</span><a name="line-835"></a><span class="hs-comment">-- If so, give us the kind and the error message.</span><span>
</span><a name="line-836"></a><span class="hs-identifier">userTypeError_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-837"></a><a name="userTypeError_maybe"><a href="Type.html#userTypeError_maybe"><span class="hs-identifier">userTypeError_maybe</span></a></a><span> </span><a name="local-6989586621679399689"><a href="#local-6989586621679399689"><span class="hs-identifier">t</span></a></a><span>
</span><a name="line-838"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679399690"><a href="#local-6989586621679399690"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399691"><a href="#local-6989586621679399691"><span class="hs-identifier">_kind</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679399692"><a href="#local-6989586621679399692"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399689"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-839"></a><span>          </span><span class="hs-comment">-- There may be more than 2 arguments, if the type error is</span><span>
</span><a name="line-840"></a><span>          </span><span class="hs-comment">-- used as a type constructor (e.g. at kind `Type -&gt; Type`).</span><span>
</span><a name="line-841"></a><span>
</span><a name="line-842"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621679399690"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#errorMessageTypeErrorFamName"><span class="hs-identifier hs-var">errorMessageTypeErrorFamName</span></a><span class="hs-special">)</span><span>
</span><a name="line-843"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679399692"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-844"></a><span>
</span><a name="line-845"></a><span class="hs-comment">-- | Render a type corresponding to a user type error into a SDoc.</span><span>
</span><a name="line-846"></a><span class="hs-identifier">pprUserTypeErrorTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-847"></a><a name="pprUserTypeErrorTy"><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier">pprUserTypeErrorTy</span></a></a><span> </span><a name="local-6989586621679399693"><a href="#local-6989586621679399693"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-848"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399693"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-849"></a><span>
</span><a name="line-850"></a><span>    </span><span class="hs-comment">-- Text &quot;Something&quot;</span><span>
</span><a name="line-851"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399694"><a href="#local-6989586621679399694"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-6989586621679399695"><a href="#local-6989586621679399695"><span class="hs-identifier">txt</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-852"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621679399694"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorTextDataConName"><span class="hs-identifier hs-var">typeErrorTextDataConName</span></a><span>
</span><a name="line-853"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399696"><a href="#local-6989586621679399696"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span> </span><a href="#local-6989586621679399695"><span class="hs-identifier hs-var">txt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ftext"><span class="hs-identifier hs-var">ftext</span></a><span> </span><a href="#local-6989586621679399696"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span>    </span><span class="hs-comment">-- ShowType t</span><span>
</span><a name="line-856"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399697"><a href="#local-6989586621679399697"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-6989586621679399698"><a href="#local-6989586621679399698"><span class="hs-identifier">_k</span></a></a><span class="hs-special">,</span><a name="local-6989586621679399699"><a href="#local-6989586621679399699"><span class="hs-identifier">t</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-857"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621679399697"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorShowTypeDataConName"><span class="hs-identifier hs-var">typeErrorShowTypeDataConName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399699"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-858"></a><span>
</span><a name="line-859"></a><span>    </span><span class="hs-comment">-- t1 :&lt;&gt;: t2</span><span>
</span><a name="line-860"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399700"><a href="#local-6989586621679399700"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-6989586621679399701"><a href="#local-6989586621679399701"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679399702"><a href="#local-6989586621679399702"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-861"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621679399700"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorAppendDataConName"><span class="hs-identifier hs-var">typeErrorAppendDataConName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-862"></a><span>        </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-6989586621679399701"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-6989586621679399702"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-863"></a><span>
</span><a name="line-864"></a><span>    </span><span class="hs-comment">-- t1 :$$: t2</span><span>
</span><a name="line-865"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399703"><a href="#local-6989586621679399703"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-6989586621679399704"><a href="#local-6989586621679399704"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679399705"><a href="#local-6989586621679399705"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-866"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">tyConName</span><span> </span><a href="#local-6989586621679399703"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="PrelNames.html#typeErrorVAppendDataConName"><span class="hs-identifier hs-var">typeErrorVAppendDataConName</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-867"></a><span>        </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-6989586621679399704"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Type.html#pprUserTypeErrorTy"><span class="hs-identifier hs-var">pprUserTypeErrorTy</span></a><span> </span><a href="#local-6989586621679399705"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span>    </span><span class="hs-comment">-- An unevaluated type function</span><span>
</span><a name="line-870"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399693"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-871"></a><span>
</span><a name="line-872"></a><span>
</span><a name="line-873"></a><span>
</span><a name="line-874"></a><span>
</span><a name="line-875"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                FunTy
                                ~~~~~

Note [Representation of function types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Functions (e.g. Int -&gt; Char) are can be thought of as being applications
of funTyCon (known in Haskell surface syntax as (-&gt;)),

    (-&gt;) :: forall (r1 :: RuntimeRep) (r2 :: RuntimeRep)
                   (a :: TYPE r1) (b :: TYPE r2).
            a -&gt; b -&gt; Type

However, for efficiency's sake we represent saturated applications of (-&gt;)
with FunTy. For instance, the type,

    (-&gt;) r1 r2 a b

is equivalent to,

    FunTy (Anon a) b

Note how the RuntimeReps are implied in the FunTy representation. For this
reason we must be careful when recontructing the TyConApp representation (see,
for instance, splitTyConApp_maybe).

In the compiler we maintain the invariant that all saturated applications of
(-&gt;) are represented with FunTy.

See #11714.
-}</span><span>
</span><a name="line-908"></a><span>
</span><a name="line-909"></a><span class="hs-identifier">isFunTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-910"></a><a name="isFunTy"><a href="Type.html#isFunTy"><span class="hs-identifier">isFunTy</span></a></a><span> </span><a name="local-6989586621679399706"><a href="#local-6989586621679399706"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span> </span><a href="#local-6989586621679399706"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-911"></a><span>
</span><a name="line-912"></a><span class="hs-identifier">splitFunTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-913"></a><span class="hs-comment">-- ^ Attempts to extract the argument and result types from a type, and</span><span>
</span><a name="line-914"></a><span class="hs-comment">-- panics if that is not possible. See also 'splitFunTy_maybe'</span><span>
</span><a name="line-915"></a><a name="splitFunTy"><a href="Type.html#splitFunTy"><span class="hs-identifier">splitFunTy</span></a></a><span> </span><a name="local-6989586621679399707"><a href="#local-6989586621679399707"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399708"><a href="#local-6989586621679399708"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399707"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitFunTy"><span class="hs-identifier hs-var">splitFunTy</span></a><span> </span><a href="#local-6989586621679399708"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-916"></a><span class="hs-identifier">splitFunTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399709"><a href="#local-6989586621679399709"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399710"><a href="#local-6989586621679399710"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399709"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399710"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-917"></a><span class="hs-identifier">splitFunTy</span><span> </span><a name="local-6989586621679399711"><a href="#local-6989586621679399711"><span class="hs-identifier">other</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitFunTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399711"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span class="hs-identifier">splitFunTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-920"></a><span class="hs-comment">-- ^ Attempts to extract the argument and result types from a type</span><span>
</span><a name="line-921"></a><a name="splitFunTy_maybe"><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier">splitFunTy_maybe</span></a></a><span> </span><a name="local-6989586621679399712"><a href="#local-6989586621679399712"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399713"><a href="#local-6989586621679399713"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399712"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span> </span><a href="#local-6989586621679399713"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-922"></a><span class="hs-identifier">splitFunTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399714"><a href="#local-6989586621679399714"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399715"><a href="#local-6989586621679399715"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399714"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399715"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-923"></a><span class="hs-identifier">splitFunTy_maybe</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-924"></a><span>
</span><a name="line-925"></a><span class="hs-identifier">splitFunTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-926"></a><a name="splitFunTys"><a href="Type.html#splitFunTys"><span class="hs-identifier">splitFunTys</span></a></a><span> </span><a name="local-6989586621679399716"><a href="#local-6989586621679399716"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399717"><span class="hs-identifier hs-var">split</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679399716"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399716"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-927"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-928"></a><span>    </span><a name="local-6989586621679399717"><a href="#local-6989586621679399717"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679399718"><a href="#local-6989586621679399718"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679399719"><a href="#local-6989586621679399719"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-6989586621679399720"><a href="#local-6989586621679399720"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399721"><a href="#local-6989586621679399721"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399720"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399717"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399718"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679399719"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-6989586621679399721"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-929"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399722"><a href="#local-6989586621679399722"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399723"><a href="#local-6989586621679399723"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399724"><a href="#local-6989586621679399724"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399717"><span class="hs-identifier hs-var">split</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399723"><span class="hs-identifier hs-var">arg</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679399722"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399724"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399724"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-930"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399725"><a href="#local-6989586621679399725"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679399726"><a href="#local-6989586621679399726"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679399725"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399726"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span class="hs-identifier">funResultTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-933"></a><span class="hs-comment">-- ^ Extract the function result type and panic if that is not possible</span><span>
</span><a name="line-934"></a><a name="funResultTy"><a href="Type.html#funResultTy"><span class="hs-identifier">funResultTy</span></a></a><span> </span><a name="local-6989586621679399727"><a href="#local-6989586621679399727"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399728"><a href="#local-6989586621679399728"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399727"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#funResultTy"><span class="hs-identifier hs-var">funResultTy</span></a><span> </span><a href="#local-6989586621679399728"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-935"></a><span class="hs-identifier">funResultTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399729"><a href="#local-6989586621679399729"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399729"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-936"></a><span class="hs-identifier">funResultTy</span><span> </span><a name="local-6989586621679399730"><a href="#local-6989586621679399730"><span class="hs-identifier">ty</span></a></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;funResultTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399730"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-937"></a><span>
</span><a name="line-938"></a><span class="hs-identifier">funArgTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-939"></a><span class="hs-comment">-- ^ Extract the function argument type and panic if that is not possible</span><span>
</span><a name="line-940"></a><a name="funArgTy"><a href="Type.html#funArgTy"><span class="hs-identifier">funArgTy</span></a></a><span> </span><a name="local-6989586621679399731"><a href="#local-6989586621679399731"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399732"><a href="#local-6989586621679399732"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399731"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#funArgTy"><span class="hs-identifier hs-var">funArgTy</span></a><span> </span><a href="#local-6989586621679399732"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-941"></a><span class="hs-identifier">funArgTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399733"><a href="#local-6989586621679399733"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399734"><a href="#local-6989586621679399734"><span class="hs-identifier">_res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399733"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-942"></a><span class="hs-identifier">funArgTy</span><span> </span><a name="local-6989586621679399735"><a href="#local-6989586621679399735"><span class="hs-identifier">ty</span></a></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;funArgTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399735"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-943"></a><span>
</span><a name="line-944"></a><span class="hs-identifier">piResultTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-945"></a><a name="piResultTy"><a href="Type.html#piResultTy"><span class="hs-identifier">piResultTy</span></a></a><span> </span><a name="local-6989586621679399736"><a href="#local-6989586621679399736"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399737"><a href="#local-6989586621679399737"><span class="hs-identifier">arg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#piResultTy_maybe"><span class="hs-identifier hs-var">piResultTy_maybe</span></a><span> </span><a href="#local-6989586621679399736"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399737"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-946"></a><span>                      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399738"><a href="#local-6989586621679399738"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399738"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-947"></a><span>                      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;piResultTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399736"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399737"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span>
</span><a name="line-948"></a><span>
</span><a name="line-949"></a><span class="hs-identifier">piResultTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-950"></a><span>
</span><a name="line-951"></a><span class="hs-comment">-- ^ Just like 'piResultTys' but for a single argument</span><span>
</span><a name="line-952"></a><span class="hs-comment">-- Try not to iterate 'piResultTy', because it's inefficient to substitute</span><span>
</span><a name="line-953"></a><span class="hs-comment">-- one variable at a time; instead use 'piResultTys&quot;</span><span>
</span><a name="line-954"></a><a name="piResultTy_maybe"><a href="Type.html#piResultTy_maybe"><span class="hs-identifier">piResultTy_maybe</span></a></a><span> </span><a name="local-6989586621679399739"><a href="#local-6989586621679399739"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399740"><a href="#local-6989586621679399740"><span class="hs-identifier">arg</span></a></a><span>
</span><a name="line-955"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399741"><a href="#local-6989586621679399741"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399739"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTy_maybe"><span class="hs-identifier hs-var">piResultTy_maybe</span></a><span> </span><a href="#local-6989586621679399741"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399740"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399742"><a href="#local-6989586621679399742"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399739"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-958"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399742"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-959"></a><span>
</span><a name="line-960"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399743"><a href="#local-6989586621679399743"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679399744"><a href="#local-6989586621679399744"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399739"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-961"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679399745"><a href="#local-6989586621679399745"><span class="hs-identifier">empty_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-962"></a><span>                      </span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399740"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><a href="#local-6989586621679399744"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-963"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a><span> </span><a href="#local-6989586621679399745"><span class="hs-identifier hs-var">empty_subst</span></a><span> </span><a href="#local-6989586621679399743"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679399740"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399744"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-964"></a><span>
</span><a name="line-965"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-966"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-967"></a><span>
</span><a name="line-968"></a><span class="hs-comment">-- | (piResultTys f_ty [ty1, .., tyn]) gives the type of (f ty1 .. tyn)</span><span>
</span><a name="line-969"></a><span class="hs-comment">--   where f :: f_ty</span><span>
</span><a name="line-970"></a><span class="hs-comment">-- 'piResultTys' is interesting because:</span><span>
</span><a name="line-971"></a><span class="hs-comment">--      1. 'f_ty' may have more for-alls than there are args</span><span>
</span><a name="line-972"></a><span class="hs-comment">--      2. Less obviously, it may have fewer for-alls</span><span>
</span><a name="line-973"></a><span class="hs-comment">-- For case 2. think of:</span><span>
</span><a name="line-974"></a><span class="hs-comment">--   piResultTys (forall a.a) [forall b.b, Int]</span><span>
</span><a name="line-975"></a><span class="hs-comment">-- This really can happen, but only (I think) in situations involving</span><span>
</span><a name="line-976"></a><span class="hs-comment">-- undefined.  For example:</span><span>
</span><a name="line-977"></a><span class="hs-comment">--       undefined :: forall a. a</span><span>
</span><a name="line-978"></a><span class="hs-comment">-- Term: undefined @(forall b. b-&gt;b) @Int</span><span>
</span><a name="line-979"></a><span class="hs-comment">-- This term should have type (Int -&gt; Int), but notice that</span><span>
</span><a name="line-980"></a><span class="hs-comment">-- there are more type args than foralls in 'undefined's type.</span><span>
</span><a name="line-981"></a><span>
</span><a name="line-982"></a><span class="hs-comment">-- If you edit this function, you may need to update the GHC formalism</span><span>
</span><a name="line-983"></a><span class="hs-comment">-- See Note [GHC Formalism] in coreSyn/CoreLint.hs</span><span>
</span><a name="line-984"></a><span>
</span><a name="line-985"></a><span class="hs-comment">-- This is a heavily used function (e.g. from typeKind),</span><span>
</span><a name="line-986"></a><span class="hs-comment">-- so we pay attention to efficiency, especially in the special case</span><span>
</span><a name="line-987"></a><span class="hs-comment">-- where there are no for-alls so we are just dropping arrows from</span><span>
</span><a name="line-988"></a><span class="hs-comment">-- a function type/kind.</span><span>
</span><a name="line-989"></a><span class="hs-identifier">piResultTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-990"></a><a name="piResultTys"><a href="Type.html#piResultTys"><span class="hs-identifier">piResultTys</span></a></a><span> </span><a name="local-6989586621679399746"><a href="#local-6989586621679399746"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399746"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-991"></a><span class="hs-identifier">piResultTys</span><span> </span><a name="local-6989586621679399747"><a href="#local-6989586621679399747"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399748"><a href="#local-6989586621679399748"><span class="hs-identifier">orig_args</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679399749"><a href="#local-6989586621679399749"><span class="hs-identifier">arg</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679399750"><a href="#local-6989586621679399750"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-992"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399766"><a href="#local-6989586621679399766"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399747"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-993"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><a href="#local-6989586621679399766"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399748"><span class="hs-identifier hs-var">orig_args</span></a><span>
</span><a name="line-994"></a><span>
</span><a name="line-995"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399767"><a href="#local-6989586621679399767"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399747"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-996"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><a href="#local-6989586621679399767"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399750"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-997"></a><span>
</span><a name="line-998"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399768"><a href="#local-6989586621679399768"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679399769"><a href="#local-6989586621679399769"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399747"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-999"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399752"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="TyCoRep.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a><span> </span><a href="#local-6989586621679399768"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679399749"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399769"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399750"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1000"></a><span>
</span><a name="line-1001"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1002"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;piResultTys1&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399747"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399748"><span class="hs-identifier hs-var">orig_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1003"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1004"></a><span>    </span><a name="local-6989586621679399751"><a href="#local-6989586621679399751"><span class="hs-identifier">in_scope</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399747"><span class="hs-identifier hs-var">ty</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679399748"><span class="hs-identifier hs-var">orig_args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1005"></a><span>
</span><a name="line-1006"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1007"></a><span>    </span><a name="local-6989586621679399752"><a href="#local-6989586621679399752"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679399753"><a href="#local-6989586621679399753"><span class="hs-identifier">tv_env</span></a></a><span> </span><a name="local-6989586621679399754"><a href="#local-6989586621679399754"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#substTy"><span class="hs-identifier hs-var">substTy</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a><span> </span><a href="#local-6989586621679399751"><span class="hs-identifier hs-var">in_scope</span></a><span> </span><a href="#local-6989586621679399753"><span class="hs-identifier hs-var">tv_env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399754"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1008"></a><span>
</span><a name="line-1009"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399755"><a href="#local-6989586621679399755"><span class="hs-identifier">tv_env</span></a></a><span> </span><a name="local-6989586621679399756"><a href="#local-6989586621679399756"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399757"><a href="#local-6989586621679399757"><span class="hs-identifier">all_args</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679399758"><a href="#local-6989586621679399758"><span class="hs-identifier">arg</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679399759"><a href="#local-6989586621679399759"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1010"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399760"><a href="#local-6989586621679399760"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399756"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1011"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399752"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399755"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-6989586621679399760"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399757"><span class="hs-identifier hs-var">all_args</span></a><span>
</span><a name="line-1012"></a><span>
</span><a name="line-1013"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399761"><a href="#local-6989586621679399761"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399756"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1014"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399752"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399755"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-6989586621679399761"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399759"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1015"></a><span>
</span><a name="line-1016"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399762"><a href="#local-6989586621679399762"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679399763"><a href="#local-6989586621679399763"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399756"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1017"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399752"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a><span> </span><a href="#local-6989586621679399755"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-6989586621679399762"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679399758"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399763"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399759"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1018"></a><span>
</span><a name="line-1019"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399764"><a href="#local-6989586621679399764"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399756"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1020"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399765"><a href="#local-6989586621679399765"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-6989586621679399755"><span class="hs-identifier hs-var">tv_env</span></a><span> </span><a href="#local-6989586621679399764"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1021"></a><span>        </span><span class="hs-comment">-- Deals with piResultTys (forall a. a) [forall b.b, Int]</span><span>
</span><a name="line-1022"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><a href="#local-6989586621679399765"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399757"><span class="hs-identifier hs-var">all_args</span></a><span>
</span><a name="line-1023"></a><span>
</span><a name="line-1024"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1025"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;piResultTys2&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399756"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399748"><span class="hs-identifier hs-var">orig_args</span></a><span> </span><a href="Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399757"><span class="hs-identifier hs-var">all_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1026"></a><span>
</span><a name="line-1027"></a><span class="hs-identifier">applyTysX</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1028"></a><span class="hs-comment">-- applyTyxX beta-reduces (/\tvs. body_ty) arg_tys</span><span>
</span><a name="line-1029"></a><span class="hs-comment">-- Assumes that (/\tvs. body_ty) is closed</span><span>
</span><a name="line-1030"></a><a name="applyTysX"><a href="Type.html#applyTysX"><span class="hs-identifier">applyTysX</span></a></a><span> </span><a name="local-6989586621679399770"><a href="#local-6989586621679399770"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679399771"><a href="#local-6989586621679399771"><span class="hs-identifier">body_ty</span></a></a><span> </span><a name="local-6989586621679399772"><a href="#local-6989586621679399772"><span class="hs-identifier">arg_tys</span></a></a><span>
</span><a name="line-1031"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">arg_tys</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthAtLeast</span><span class="hs-special">`</span><span> </span><a href="Util.html#lengthAtLeast"><span class="hs-identifier hs-var">n_tvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pp_stuff</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1032"></a><span>    </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tyCoVarsOfType</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">body_ty</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">subVarSet</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">mkVarSet</span><span> </span><a href="VarSet.html#subVarSet"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">pp_stuff</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1033"></a><span>    </span><a href="Type.html#mkAppTys"><span class="hs-identifier hs-var">mkAppTys</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTyWith"><span class="hs-identifier hs-var">substTyWith</span></a><span> </span><a href="#local-6989586621679399770"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-6989586621679399774"><span class="hs-identifier hs-var">n_tvs</span></a><span> </span><a href="#local-6989586621679399772"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399771"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1034"></a><span>             </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a><span> </span><a href="#local-6989586621679399774"><span class="hs-identifier hs-var">n_tvs</span></a><span> </span><a href="#local-6989586621679399772"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1035"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1036"></a><span>    </span><a name="local-6989586621679399773"><a href="#local-6989586621679399773"><span class="hs-identifier">pp_stuff</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a><span> </span><span class="hs-special">[</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399770"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399771"><span class="hs-identifier hs-var">body_ty</span></a><span class="hs-special">,</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399772"><span class="hs-identifier hs-var">arg_tys</span></a><span class="hs-special">]</span><span>
</span><a name="line-1037"></a><span>    </span><a name="local-6989586621679399774"><a href="#local-6989586621679399774"><span class="hs-identifier">n_tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679399770"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1038"></a><span>
</span><a name="line-1039"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                TyConApp
                                ~~~~~~~~
-}</span><span>
</span><a name="line-1044"></a><span>
</span><a name="line-1045"></a><span class="hs-comment">-- | A key function: builds a 'TyConApp' or 'FunTy' as appropriate to</span><span>
</span><a name="line-1046"></a><span class="hs-comment">-- its arguments.  Applies its arguments to the constructor from left to right.</span><span>
</span><a name="line-1047"></a><span class="hs-identifier">mkTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1048"></a><a name="mkTyConApp"><a href="Type.html#mkTyConApp"><span class="hs-identifier">mkTyConApp</span></a></a><span> </span><a name="local-6989586621679399775"><a href="#local-6989586621679399775"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-6989586621679399776"><a href="#local-6989586621679399776"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1049"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isFunTyCon"><span class="hs-identifier hs-var">isFunTyCon</span></a><span> </span><a href="#local-6989586621679399775"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1050"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679399777"><a href="#local-6989586621679399777"><span class="hs-identifier">_rep1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679399778"><a href="#local-6989586621679399778"><span class="hs-identifier">_rep2</span></a></a><span class="hs-special">,</span><a name="local-6989586621679399779"><a href="#local-6989586621679399779"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679399780"><a href="#local-6989586621679399780"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399776"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1051"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a href="#local-6989586621679399779"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679399780"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1052"></a><span>
</span><a name="line-1053"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1054"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="#local-6989586621679399775"><span class="hs-identifier hs-var">tycon</span></a><span> </span><a href="#local-6989586621679399776"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1055"></a><span>
</span><a name="line-1056"></a><span class="hs-comment">-- splitTyConApp &quot;looks through&quot; synonyms, because they don't</span><span>
</span><a name="line-1057"></a><span class="hs-comment">-- mean a distinct type, but all other type-constructor applications</span><span>
</span><a name="line-1058"></a><span class="hs-comment">-- including functions are returned as Just ..</span><span>
</span><a name="line-1059"></a><span>
</span><a name="line-1060"></a><span class="hs-comment">-- | Retrieve the tycon heading this type, if there is one. Does /not/</span><span>
</span><a name="line-1061"></a><span class="hs-comment">-- look through synonyms.</span><span>
</span><a name="line-1062"></a><span class="hs-identifier">tyConAppTyConPicky_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1063"></a><a name="tyConAppTyConPicky_maybe"><a href="Type.html#tyConAppTyConPicky_maybe"><span class="hs-identifier">tyConAppTyConPicky_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399781"><a href="#local-6989586621679399781"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399781"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1064"></a><span class="hs-identifier">tyConAppTyConPicky_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span>
</span><a name="line-1065"></a><span class="hs-identifier">tyConAppTyConPicky_maybe</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1066"></a><span>
</span><a name="line-1067"></a><span>
</span><a name="line-1068"></a><span class="hs-comment">-- | The same as @fst . splitTyConApp@</span><span>
</span><a name="line-1069"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1070"></a><a name="tyConAppTyCon_maybe"><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier">tyConAppTyCon_maybe</span></a></a><span> </span><a name="local-6989586621679399782"><a href="#local-6989586621679399782"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399783"><a href="#local-6989586621679399783"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399782"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399783"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1071"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399784"><a href="#local-6989586621679399784"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399784"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1072"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span>
</span><a name="line-1073"></a><span class="hs-identifier">tyConAppTyCon_maybe</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1074"></a><span>
</span><a name="line-1075"></a><span class="hs-identifier">tyConAppTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1076"></a><a name="tyConAppTyCon"><a href="Type.html#tyConAppTyCon"><span class="hs-identifier">tyConAppTyCon</span></a></a><span> </span><a name="local-6989586621679399785"><a href="#local-6989586621679399785"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399785"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConAppTyCon&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399785"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1077"></a><span>
</span><a name="line-1078"></a><span class="hs-comment">-- | The same as @snd . splitTyConApp@</span><span>
</span><a name="line-1079"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1080"></a><a name="tyConAppArgs_maybe"><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier">tyConAppArgs_maybe</span></a></a><span> </span><a name="local-6989586621679399786"><a href="#local-6989586621679399786"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399787"><a href="#local-6989586621679399787"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399786"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span> </span><a href="#local-6989586621679399787"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1081"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399788"><a href="#local-6989586621679399788"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399788"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1082"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399789"><a href="#local-6989586621679399789"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399790"><a href="#local-6989586621679399790"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1083"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399791"><a href="#local-6989586621679399791"><span class="hs-identifier">rep1</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a><span> </span><a href="#local-6989586621679399789"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1084"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399792"><a href="#local-6989586621679399792"><span class="hs-identifier">rep2</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a><span> </span><a href="#local-6989586621679399790"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1085"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399791"><span class="hs-identifier hs-var">rep1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399792"><span class="hs-identifier hs-var">rep2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399789"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399790"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span>
</span><a name="line-1086"></a><span class="hs-identifier">tyConAppArgs_maybe</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1087"></a><span>
</span><a name="line-1088"></a><span class="hs-identifier">tyConAppArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1089"></a><a name="tyConAppArgs"><a href="Type.html#tyConAppArgs"><span class="hs-identifier">tyConAppArgs</span></a></a><span> </span><a name="local-6989586621679399793"><a href="#local-6989586621679399793"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span> </span><a href="#local-6989586621679399793"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConAppArgs&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399793"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1090"></a><span>
</span><a name="line-1091"></a><span class="hs-identifier">tyConAppArgN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1092"></a><span class="hs-comment">-- Executing Nth</span><span>
</span><a name="line-1093"></a><a name="tyConAppArgN"><a href="Type.html#tyConAppArgN"><span class="hs-identifier">tyConAppArgN</span></a></a><span> </span><a name="local-6989586621679399794"><a href="#local-6989586621679399794"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679399795"><a href="#local-6989586621679399795"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1094"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppArgs_maybe"><span class="hs-identifier hs-var">tyConAppArgs_maybe</span></a><span> </span><a href="#local-6989586621679399795"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1095"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399796"><a href="#local-6989586621679399796"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthExceeds</span><span class="hs-special">`</span><span> </span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="Util.html#lengthExceeds"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Util.html#lengthExceeds"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-special">`</span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">getNth</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">n</span><span>
</span><a name="line-1096"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;tyConAppArgN&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399794"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399795"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1097"></a><span>
</span><a name="line-1098"></a><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><a name="line-1099"></a><span class="hs-comment">-- of a number of arguments to that constructor. Panics if that is not possible.</span><span>
</span><a name="line-1100"></a><span class="hs-comment">-- See also 'splitTyConApp_maybe'</span><span>
</span><a name="line-1101"></a><span class="hs-identifier">splitTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1102"></a><a name="splitTyConApp"><a href="Type.html#splitTyConApp"><span class="hs-identifier">splitTyConApp</span></a></a><span> </span><a name="local-6989586621679399797"><a href="#local-6989586621679399797"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399797"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1103"></a><span>                   </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399798"><a href="#local-6989586621679399798"><span class="hs-identifier">stuff</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399798"><span class="hs-identifier hs-var">stuff</span></a><span>
</span><a name="line-1104"></a><span>                   </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitTyConApp&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399797"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1105"></a><span>
</span><a name="line-1106"></a><span class="hs-comment">-- | Attempts to tease a type apart into a type constructor and the application</span><span>
</span><a name="line-1107"></a><span class="hs-comment">-- of a number of arguments to that constructor</span><span>
</span><a name="line-1108"></a><span class="hs-identifier">splitTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1109"></a><a name="splitTyConApp_maybe"><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier">splitTyConApp_maybe</span></a></a><span> </span><a name="local-6989586621679399799"><a href="#local-6989586621679399799"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399800"><a href="#local-6989586621679399800"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399799"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399800"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1110"></a><span class="hs-identifier">splitTyConApp_maybe</span><span> </span><a name="local-6989586621679399801"><a href="#local-6989586621679399801"><span class="hs-identifier">ty</span></a></a><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#repSplitTyConApp_maybe"><span class="hs-identifier hs-var">repSplitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399801"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1111"></a><span>
</span><a name="line-1112"></a><span class="hs-comment">-- | Like 'splitTyConApp_maybe', but doesn't look through synonyms. This</span><span>
</span><a name="line-1113"></a><span class="hs-comment">-- assumes the synonyms have already been dealt with.</span><span>
</span><a name="line-1114"></a><span class="hs-identifier">repSplitTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><a name="repSplitTyConApp_maybe"><a href="Type.html#repSplitTyConApp_maybe"><span class="hs-identifier">repSplitTyConApp_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399802"><a href="#local-6989586621679399802"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399803"><a href="#local-6989586621679399803"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399802"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399803"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1116"></a><span class="hs-identifier">repSplitTyConApp_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399804"><a href="#local-6989586621679399804"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399805"><a href="#local-6989586621679399805"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1117"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399806"><a href="#local-6989586621679399806"><span class="hs-identifier">arg_rep</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a><span> </span><a href="#local-6989586621679399804"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1118"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399807"><a href="#local-6989586621679399807"><span class="hs-identifier">res_rep</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a><span> </span><a href="#local-6989586621679399805"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1119"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399806"><span class="hs-identifier hs-var">arg_rep</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399807"><span class="hs-identifier hs-var">res_rep</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399804"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399805"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1120"></a><span class="hs-identifier">repSplitTyConApp_maybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1121"></a><span>
</span><a name="line-1122"></a><span class="hs-comment">-- | Attempts to tease a list type apart and gives the type of the elements if</span><span>
</span><a name="line-1123"></a><span class="hs-comment">-- successful (looks through type synonyms)</span><span>
</span><a name="line-1124"></a><span class="hs-identifier">splitListTyConApp_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1125"></a><a name="splitListTyConApp_maybe"><a href="Type.html#splitListTyConApp_maybe"><span class="hs-identifier">splitListTyConApp_maybe</span></a></a><span> </span><a name="local-6989586621679399808"><a href="#local-6989586621679399808"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399808"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1126"></a><span>  </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399809"><a href="#local-6989586621679399809"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-6989586621679399810"><a href="#local-6989586621679399810"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679399809"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TysWiredIn.html#listTyCon"><span class="hs-identifier hs-var">listTyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399810"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-1127"></a><span>  </span><a name="local-6989586621679399811"><a href="#local-6989586621679399811"><span class="hs-identifier">_other</span></a></a><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1128"></a><span>
</span><a name="line-1129"></a><span class="hs-comment">-- | What is the role assigned to the next parameter of this type? Usually,</span><span>
</span><a name="line-1130"></a><span class="hs-comment">-- this will be 'Nominal', but if the type is a 'TyConApp', we may be able to</span><span>
</span><a name="line-1131"></a><span class="hs-comment">-- do better. The type does *not* have to be well-kinded when applied for this</span><span>
</span><a name="line-1132"></a><span class="hs-comment">-- to work!</span><span>
</span><a name="line-1133"></a><span class="hs-identifier">nextRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-1134"></a><a name="nextRole"><a href="Type.html#nextRole"><span class="hs-identifier">nextRole</span></a></a><span> </span><a name="local-6989586621679399812"><a href="#local-6989586621679399812"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1135"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399813"><a href="#local-6989586621679399813"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399814"><a href="#local-6989586621679399814"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679399812"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1136"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679399815"><a href="#local-6989586621679399815"><span class="hs-identifier">num_tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a><span> </span><a href="#local-6989586621679399814"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1137"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399815"><span class="hs-identifier hs-var">num_tys</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="#local-6989586621679399813"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1138"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#tyConRoles"><span class="hs-identifier hs-var">tyConRoles</span></a><span> </span><a href="#local-6989586621679399813"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="ListSetOps.html#getNth"><span class="hs-identifier hs-var">getNth</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679399815"><span class="hs-identifier hs-var">num_tys</span></a><span>
</span><a name="line-1139"></a><span>
</span><a name="line-1140"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1141"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-1142"></a><span>
</span><a name="line-1143"></a><span class="hs-identifier">newTyConInstRhs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1144"></a><span class="hs-comment">-- ^ Unwrap one 'layer' of newtype on a type constructor and its</span><span>
</span><a name="line-1145"></a><span class="hs-comment">-- arguments, using an eta-reduced version of the @newtype@ if possible.</span><span>
</span><a name="line-1146"></a><span class="hs-comment">-- This requires tys to have at least @newTyConInstArity tycon@ elements.</span><span>
</span><a name="line-1147"></a><a name="newTyConInstRhs"><a href="Type.html#newTyConInstRhs"><span class="hs-identifier">newTyConInstRhs</span></a></a><span> </span><a name="local-6989586621679399816"><a href="#local-6989586621679399816"><span class="hs-identifier">tycon</span></a></a><span> </span><a name="local-6989586621679399817"><a href="#local-6989586621679399817"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1148"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">leLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">,</span><span> </span><a href="Util.html#leLength"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-identifier">tycon</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="Outputable.html#assertPprPanic"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1149"></a><span>      </span><a href="Type.html#applyTysX"><span class="hs-identifier hs-var">applyTysX</span></a><span> </span><a href="#local-6989586621679399818"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621679399819"><span class="hs-identifier hs-var">rhs</span></a><span> </span><a href="#local-6989586621679399817"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1150"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1151"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679399818"><a href="#local-6989586621679399818"><span class="hs-identifier">tvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399819"><a href="#local-6989586621679399819"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#newTyConEtadRhs"><span class="hs-identifier hs-var">newTyConEtadRhs</span></a><span> </span><a href="#local-6989586621679399816"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1152"></a><span>
</span><a name="line-1153"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                           CastTy
                           ~~~~~~
A casted type has its *kind* casted into something new.

Note [No reflexive casts in types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As far as possible, we would like to maintain the following property:

  (*) If (t1 `eqType` t2), then t1 and t2 are treated identically within GHC.

The (*) property is very useful, because we have a tendency to compare two
types to see if they're equal, and then arbitrarily choose one. We don't
want this arbitrary choice to then matter later on. Maintaining (*) means
that every function that looks at a structure of a type must think about
casts. In places where we directly pattern-match, this consideration is
forced by consideration of the CastTy constructor.

But, when we call a splitXXX function, it's easy to ignore the possibility
of casts. In particular, splitTyConApp is used extensively, and we don't
want it to fail on (T a b c |&gt; co). Happily, if we have
  (T a b c |&gt; co) `eqType` (T d e f)
then co must be reflexive. Why? eqType checks that the kinds are equal, as
well as checking that (a `eqType` d), (b `eqType` e), and (c `eqType` f).
By the kind check, we know that (T a b c |&gt; co) and (T d e f) have the same
kind. So the only way that co could be non-reflexive is for (T a b c) to have
a different kind than (T d e f). But because T's kind is closed (all tycon kinds
are closed), the only way for this to happen is that one of the arguments has
to differ, leading to a contradiction. Thus, co is reflexive.

Accordingly, by eliminating reflexive casts, splitTyConApp need not worry
about outermost casts to uphold (*).

Unfortunately, that's not the end of the story. Consider comparing
  (T a b c)      =?       (T a b |&gt; (co -&gt; &lt;Type&gt;)) (c |&gt; sym co)
These two types have the same kind (Type), but the left type is a TyConApp
while the right type is not. To handle this case, we will have to implement
some variant of the dreaded KPush algorithm (c.f. CoreOpt.pushCoDataCon).
This stone is left unturned for now, meaning that we don't yet uphold (*).

The other place where (*) will be hard to guarantee is in splitAppTy, because
I (Richard E) can't think of a way to push coercions into AppTys. The good
news here is that splitAppTy is not used all that much, and so all clients of
that function can simply be told to use splitCastTy as well, in order to
uphold (*). This, too, is left undone, for now.

-}</span><span>
</span><a name="line-1201"></a><span>
</span><a name="line-1202"></a><span class="hs-identifier">splitCastTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span class="hs-special">)</span><span>
</span><a name="line-1203"></a><a name="splitCastTy_maybe"><a href="Type.html#splitCastTy_maybe"><span class="hs-identifier">splitCastTy_maybe</span></a></a><span> </span><a name="local-6989586621679399820"><a href="#local-6989586621679399820"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399821"><a href="#local-6989586621679399821"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399820"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#splitCastTy_maybe"><span class="hs-identifier hs-var">splitCastTy_maybe</span></a><span> </span><a href="#local-6989586621679399821"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1204"></a><span class="hs-identifier">splitCastTy_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679399822"><a href="#local-6989586621679399822"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399823"><a href="#local-6989586621679399823"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399822"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399823"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-1205"></a><span class="hs-identifier">splitCastTy_maybe</span><span> </span><span class="hs-identifier">_</span><span>                            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1206"></a><span>
</span><a name="line-1207"></a><span class="hs-comment">-- | Make a 'CastTy'. The Coercion must be nominal. Checks the</span><span>
</span><a name="line-1208"></a><span class="hs-comment">-- Coercion for reflexivity, dropping it if it's reflexive.</span><span>
</span><a name="line-1209"></a><span class="hs-comment">-- See Note [No reflexive casts in types]</span><span>
</span><a name="line-1210"></a><span class="hs-identifier">mkCastTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1211"></a><a name="mkCastTy"><a href="Type.html#mkCastTy"><span class="hs-identifier">mkCastTy</span></a></a><span> </span><a name="local-6989586621679399824"><a href="#local-6989586621679399824"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399825"><a href="#local-6989586621679399825"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Coercion.html#isReflexiveCo"><span class="hs-identifier hs-var">isReflexiveCo</span></a><span> </span><a href="#local-6989586621679399825"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399824"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1212"></a><span class="hs-comment">-- NB: Do the slow check here. This is important to keep the splitXXX</span><span>
</span><a name="line-1213"></a><span class="hs-comment">-- functions working properly. Otherwise, we may end up with something</span><span>
</span><a name="line-1214"></a><span class="hs-comment">-- like (((-&gt;) |&gt; something_reflexive_but_not_obviously_so) biz baz)</span><span>
</span><a name="line-1215"></a><span class="hs-comment">-- fails under splitFunTy_maybe. This happened with the cheaper check</span><span>
</span><a name="line-1216"></a><span class="hs-comment">-- in test dependent/should_compile/dynamic-paper.</span><span>
</span><a name="line-1217"></a><span>
</span><a name="line-1218"></a><span class="hs-identifier">mkCastTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679399826"><a href="#local-6989586621679399826"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399827"><a href="#local-6989586621679399827"><span class="hs-identifier">co1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399828"><a href="#local-6989586621679399828"><span class="hs-identifier">co2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a><span> </span><a href="#local-6989586621679399826"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399827"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679399828"><span class="hs-identifier hs-var">co2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1219"></a><span class="hs-identifier">mkCastTy</span><span> </span><a name="local-6989586621679399829"><a href="#local-6989586621679399829"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399830"><a href="#local-6989586621679399830"><span class="hs-identifier">co</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a href="#local-6989586621679399829"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399830"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1220"></a><span>
</span><a name="line-1221"></a><span class="hs-identifier">tyConBindersTyBinders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1222"></a><span class="hs-comment">-- Return the tyConBinders in TyBinder form</span><span>
</span><a name="line-1223"></a><a name="tyConBindersTyBinders"><a href="Type.html#tyConBindersTyBinders"><span class="hs-identifier">tyConBindersTyBinders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679399831"><span class="hs-identifier hs-var">to_tyb</span></a><span>
</span><a name="line-1224"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1225"></a><span>    </span><a name="local-6989586621679399831"><a href="#local-6989586621679399831"><span class="hs-identifier">to_tyb</span></a></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399832"><a href="#local-6989586621679399832"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a name="local-6989586621679399833"><a href="#local-6989586621679399833"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399832"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="#local-6989586621679399833"><span class="hs-identifier hs-var">vis</span></a><span class="hs-special">)</span><span>
</span><a name="line-1226"></a><span>    </span><span class="hs-identifier">to_tyb</span><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399834"><a href="#local-6989586621679399834"><span class="hs-identifier">tv</span></a></a><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679399834"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1227"></a><span>
</span><a name="line-1228"></a><span class="hs-comment">{-
--------------------------------------------------------------------
                            CoercionTy
                            ~~~~~~~~~~
CoercionTy allows us to inject coercions into types. A CoercionTy
should appear only in the right-hand side of an application.
-}</span><span>
</span><a name="line-1235"></a><span>
</span><a name="line-1236"></a><span class="hs-identifier">mkCoercionTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1237"></a><a name="mkCoercionTy"><a href="Type.html#mkCoercionTy"><span class="hs-identifier">mkCoercionTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span>
</span><a name="line-1238"></a><span>
</span><a name="line-1239"></a><span class="hs-identifier">isCoercionTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1240"></a><a name="isCoercionTy"><a href="Type.html#isCoercionTy"><span class="hs-identifier">isCoercionTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1241"></a><span class="hs-identifier">isCoercionTy</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1242"></a><span>
</span><a name="line-1243"></a><span class="hs-identifier">isCoercionTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1244"></a><a name="isCoercionTy_maybe"><a href="Type.html#isCoercionTy_maybe"><span class="hs-identifier">isCoercionTy_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679399835"><a href="#local-6989586621679399835"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399835"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1245"></a><span class="hs-identifier">isCoercionTy_maybe</span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1246"></a><span>
</span><a name="line-1247"></a><span class="hs-identifier">stripCoercionTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a><span>
</span><a name="line-1248"></a><a name="stripCoercionTy"><a href="Type.html#stripCoercionTy"><span class="hs-identifier">stripCoercionTy</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679399836"><a href="#local-6989586621679399836"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399836"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-1249"></a><span class="hs-identifier">stripCoercionTy</span><span> </span><a name="local-6989586621679399837"><a href="#local-6989586621679399837"><span class="hs-identifier">ty</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;stripCoercionTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399837"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1250"></a><span>
</span><a name="line-1251"></a><span class="hs-comment">{-
---------------------------------------------------------------------
                                SynTy
                                ~~~~~

Notes on type synonyms
~~~~~~~~~~~~~~~~~~~~~~
The various &quot;split&quot; functions (splitFunTy, splitRhoTy, splitForAllTy) try
to return type synonyms wherever possible. Thus

        type Foo a = a -&gt; a

we want
        splitFunTys (a -&gt; Foo a) = ([a], Foo a)
not                                ([a], a -&gt; a)

The reason is that we then get better (shorter) type signatures in
interfaces.  Notably this plays a role in tcTySigs in TcBinds.hs.


---------------------------------------------------------------------
                                ForAllTy
                                ~~~~~~~~
-}</span><span>
</span><a name="line-1275"></a><span>
</span><a name="line-1276"></a><span class="hs-comment">-- | Make a dependent forall over an Inferred (as opposed to Specified)</span><span>
</span><a name="line-1277"></a><span class="hs-comment">-- variable</span><span>
</span><a name="line-1278"></a><span class="hs-identifier">mkInvForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1279"></a><a name="mkInvForAllTy"><a href="Type.html#mkInvForAllTy"><span class="hs-identifier">mkInvForAllTy</span></a></a><span> </span><a name="local-6989586621679399838"><a href="#local-6989586621679399838"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679399839"><a href="#local-6989586621679399839"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier hs-var">tv</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1280"></a><span>                      </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399838"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399839"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1281"></a><span>
</span><a name="line-1282"></a><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and Inferred,</span><span>
</span><a name="line-1283"></a><span class="hs-comment">-- a common case</span><span>
</span><a name="line-1284"></a><span class="hs-identifier">mkInvForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1285"></a><a name="mkInvForAllTys"><a href="Type.html#mkInvForAllTys"><span class="hs-identifier">mkInvForAllTys</span></a></a><span> </span><a name="local-6989586621679399840"><a href="#local-6989586621679399840"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679399841"><a href="#local-6989586621679399841"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1286"></a><span>                        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="Type.html#mkInvForAllTy"><span class="hs-identifier hs-var">mkInvForAllTy</span></a><span> </span><a href="#local-6989586621679399841"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399840"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1287"></a><span>
</span><a name="line-1288"></a><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and specified,</span><span>
</span><a name="line-1289"></a><span class="hs-comment">-- a common case</span><span>
</span><a name="line-1290"></a><span class="hs-identifier">mkSpecForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1291"></a><a name="mkSpecForAllTys"><a href="Type.html#mkSpecForAllTys"><span class="hs-identifier">mkSpecForAllTys</span></a></a><span> </span><a name="local-6989586621679399842"><a href="#local-6989586621679399842"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1292"></a><span>                     </span><a href="TyCoRep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399843"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Var.html#Specified"><span class="hs-identifier hs-var">Specified</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679399843"><a href="#local-6989586621679399843"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399842"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1293"></a><span>
</span><a name="line-1294"></a><span class="hs-comment">-- | Like mkForAllTys, but assumes all variables are dependent and visible</span><span>
</span><a name="line-1295"></a><span class="hs-identifier">mkVisForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1296"></a><a name="mkVisForAllTys"><a href="Type.html#mkVisForAllTys"><span class="hs-identifier">mkVisForAllTys</span></a></a><span> </span><a name="local-6989586621679399844"><a href="#local-6989586621679399844"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1297"></a><span>                     </span><a href="TyCoRep.html#mkForAllTys"><span class="hs-identifier hs-var">mkForAllTys</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399845"><span class="hs-identifier hs-var">tv</span></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679399845"><a href="#local-6989586621679399845"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679399844"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1298"></a><span>
</span><a name="line-1299"></a><span class="hs-identifier">mkLamType</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1300"></a><span class="hs-comment">-- ^ Makes a @(-&gt;)@ type or an implicit forall type, depending</span><span>
</span><a name="line-1301"></a><span class="hs-comment">-- on whether it is given a type variable or a term variable.</span><span>
</span><a name="line-1302"></a><span class="hs-comment">-- This is used, for example, when producing the type of a lambda.</span><span>
</span><a name="line-1303"></a><span class="hs-comment">-- Always uses Inferred binders.</span><span>
</span><a name="line-1304"></a><span class="hs-identifier">mkLamTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1305"></a><span class="hs-comment">-- ^ 'mkLamType' for multiple type or value arguments</span><span>
</span><a name="line-1306"></a><span>
</span><a name="line-1307"></a><a name="mkLamType"><a href="Type.html#mkLamType"><span class="hs-identifier">mkLamType</span></a></a><span> </span><a name="local-6989586621679399846"><a href="#local-6989586621679399846"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679399847"><a href="#local-6989586621679399847"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1308"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a><span> </span><a href="#local-6989586621679399846"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399846"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="Var.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399847"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1309"></a><span>   </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">varType</span><span> </span><a href="#local-6989586621679399846"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>          </span><a href="#local-6989586621679399847"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1310"></a><span>
</span><a name="line-1311"></a><a name="mkLamTypes"><a href="Type.html#mkLamTypes"><span class="hs-identifier">mkLamTypes</span></a></a><span> </span><a name="local-6989586621679399848"><a href="#local-6989586621679399848"><span class="hs-identifier">vs</span></a></a><span> </span><a name="local-6989586621679399849"><a href="#local-6989586621679399849"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="Type.html#mkLamType"><span class="hs-identifier hs-var">mkLamType</span></a><span> </span><a href="#local-6989586621679399849"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399848"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-1312"></a><span>
</span><a name="line-1313"></a><span class="hs-comment">-- | Given a list of type-level vars and a result kind,</span><span>
</span><a name="line-1314"></a><span class="hs-comment">-- makes TyBinders, preferring anonymous binders</span><span>
</span><a name="line-1315"></a><span class="hs-comment">-- if the variable is, in fact, not dependent.</span><span>
</span><a name="line-1316"></a><span class="hs-comment">-- e.g.    mkTyConBindersPreferAnon [(k:*),(b:k),(c:k)] (k-&gt;k)</span><span>
</span><a name="line-1317"></a><span class="hs-comment">-- We want (k:*) Named, (a;k) Anon, (c:k) Anon</span><span>
</span><a name="line-1318"></a><span class="hs-comment">--</span><span>
</span><a name="line-1319"></a><span class="hs-comment">-- All binders are /visible/.</span><span>
</span><a name="line-1320"></a><span class="hs-identifier">mkTyConBindersPreferAnon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span>
</span><a name="line-1321"></a><a name="mkTyConBindersPreferAnon"><a href="Type.html#mkTyConBindersPreferAnon"><span class="hs-identifier">mkTyConBindersPreferAnon</span></a></a><span> </span><a name="local-6989586621679399850"><a href="#local-6989586621679399850"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679399851"><a href="#local-6989586621679399851"><span class="hs-identifier">inner_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399852"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399850"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span>
</span><a name="line-1322"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1323"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCon.html#TyConBinder"><span class="hs-identifier hs-type">TyConBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- also returns the free vars</span><span>
</span><a name="line-1324"></a><span>    </span><a name="local-6989586621679399852"><a href="#local-6989586621679399852"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-6989586621679399851"><span class="hs-identifier hs-var">inner_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1325"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679399853"><a href="#local-6989586621679399853"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679399854"><a href="#local-6989586621679399854"><span class="hs-identifier">vs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span>  </span><a href="#local-6989586621679399853"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#elemVarSet"><span class="hs-identifier hs-var">elemVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679399856"><span class="hs-identifier hs-var">fvs</span></a><span>
</span><a name="line-1326"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399853"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="TyCon.html#NamedTCB"><span class="hs-identifier hs-var">NamedTCB</span></a><span> </span><a href="Var.html#Required"><span class="hs-identifier hs-var">Required</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679399855"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1327"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399856"><span class="hs-identifier hs-var">fvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#delVarSet"><span class="hs-identifier hs-var">delVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679399853"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679399857"><span class="hs-identifier hs-var">kind_vars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1328"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1329"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a href="#local-6989586621679399853"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="TyCon.html#AnonTCB"><span class="hs-identifier hs-var">AnonTCB</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679399855"><span class="hs-identifier hs-var">binders</span></a><span>
</span><a name="line-1330"></a><span>                </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399856"><span class="hs-identifier hs-var">fvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679399857"><span class="hs-identifier hs-var">kind_vars</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1331"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1332"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679399855"><a href="#local-6989586621679399855"><span class="hs-identifier">binders</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679399856"><a href="#local-6989586621679399856"><span class="hs-identifier">fvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399852"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399854"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-1333"></a><span>        </span><a name="local-6989586621679399857"><a href="#local-6989586621679399857"><span class="hs-identifier">kind_vars</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679399853"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1334"></a><span>
</span><a name="line-1335"></a><span class="hs-comment">-- | Take a ForAllTy apart, returning the list of tyvars and the result type.</span><span>
</span><a name="line-1336"></a><span class="hs-comment">-- This always succeeds, even if it returns only an empty list. Note that the</span><span>
</span><a name="line-1337"></a><span class="hs-comment">-- result type returned may have free variables that were bound by a forall.</span><span>
</span><a name="line-1338"></a><span class="hs-identifier">splitForAllTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1339"></a><a name="splitForAllTys"><a href="Type.html#splitForAllTys"><span class="hs-identifier">splitForAllTys</span></a></a><span> </span><a name="local-6989586621679399858"><a href="#local-6989586621679399858"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399859"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399858"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399858"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1340"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1341"></a><span>    </span><a name="local-6989586621679399859"><a href="#local-6989586621679399859"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679399860"><a href="#local-6989586621679399860"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-6989586621679399861"><a href="#local-6989586621679399861"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399862"><a href="#local-6989586621679399862"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399863"><a href="#local-6989586621679399863"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399861"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399859"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399860"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-6989586621679399863"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399862"><span class="hs-identifier hs-var">tvs</span></a><span>
</span><a name="line-1342"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399864"><a href="#local-6989586621679399864"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679399865"><a href="#local-6989586621679399865"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399866"><a href="#local-6989586621679399866"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399859"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399865"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399865"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399864"><span class="hs-identifier hs-var">tv</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679399866"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1343"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399867"><a href="#local-6989586621679399867"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                           </span><a name="local-6989586621679399868"><a href="#local-6989586621679399868"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679399868"><span class="hs-identifier hs-var">tvs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399867"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1344"></a><span>
</span><a name="line-1345"></a><span class="hs-comment">-- | Like 'splitPiTys' but split off only /named/ binders.</span><span>
</span><a name="line-1346"></a><span class="hs-identifier">splitForAllTyVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1347"></a><a name="splitForAllTyVarBndrs"><a href="Type.html#splitForAllTyVarBndrs"><span class="hs-identifier">splitForAllTyVarBndrs</span></a></a><span> </span><a name="local-6989586621679399869"><a href="#local-6989586621679399869"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399870"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399869"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399869"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1348"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1349"></a><span>    </span><a name="local-6989586621679399870"><a href="#local-6989586621679399870"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679399871"><a href="#local-6989586621679399871"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-6989586621679399872"><a href="#local-6989586621679399872"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399873"><a href="#local-6989586621679399873"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399874"><a href="#local-6989586621679399874"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399872"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399870"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399871"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-6989586621679399874"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399873"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1350"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-6989586621679399875"><a href="#local-6989586621679399875"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679399876"><a href="#local-6989586621679399876"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399877"><a href="#local-6989586621679399877"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399870"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399876"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399876"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399875"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679399877"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1351"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399878"><a href="#local-6989586621679399878"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                </span><a name="local-6989586621679399879"><a href="#local-6989586621679399879"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679399879"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399878"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1352"></a><span>
</span><a name="line-1353"></a><span class="hs-comment">-- | Checks whether this is a proper forall (with a named binder)</span><span>
</span><a name="line-1354"></a><span class="hs-identifier">isForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1355"></a><a name="isForAllTy"><a href="Type.html#isForAllTy"><span class="hs-identifier">isForAllTy</span></a></a><span> </span><a name="local-6989586621679399880"><a href="#local-6989586621679399880"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399881"><a href="#local-6989586621679399881"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399880"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isForAllTy"><span class="hs-identifier hs-var">isForAllTy</span></a><span> </span><a href="#local-6989586621679399881"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1356"></a><span class="hs-identifier">isForAllTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1357"></a><span class="hs-identifier">isForAllTy</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1358"></a><span>
</span><a name="line-1359"></a><span class="hs-comment">-- | Is this a function or forall?</span><span>
</span><a name="line-1360"></a><span class="hs-identifier">isPiTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1361"></a><a name="isPiTy"><a href="Type.html#isPiTy"><span class="hs-identifier">isPiTy</span></a></a><span> </span><a name="local-6989586621679399882"><a href="#local-6989586621679399882"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399883"><a href="#local-6989586621679399883"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399882"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isForAllTy"><span class="hs-identifier hs-var">isForAllTy</span></a><span> </span><a href="#local-6989586621679399883"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1362"></a><span class="hs-identifier">isPiTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1363"></a><span class="hs-identifier">isPiTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1364"></a><span class="hs-identifier">isPiTy</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1365"></a><span>
</span><a name="line-1366"></a><span class="hs-comment">-- | Take a forall type apart, or panics if that is not possible.</span><span>
</span><a name="line-1367"></a><span class="hs-identifier">splitForAllTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1368"></a><a name="splitForAllTy"><a href="Type.html#splitForAllTy"><span class="hs-identifier">splitForAllTy</span></a></a><span> </span><a name="local-6989586621679399884"><a href="#local-6989586621679399884"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1369"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399885"><a href="#local-6989586621679399885"><span class="hs-identifier">answer</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-6989586621679399884"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399885"><span class="hs-identifier hs-var">answer</span></a><span>
</span><a name="line-1370"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                             </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitForAllTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399884"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1371"></a><span>
</span><a name="line-1372"></a><span class="hs-comment">-- | Drops all ForAllTys</span><span>
</span><a name="line-1373"></a><span class="hs-identifier">dropForAlls</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1374"></a><a name="dropForAlls"><a href="Type.html#dropForAlls"><span class="hs-identifier">dropForAlls</span></a></a><span> </span><a name="local-6989586621679399886"><a href="#local-6989586621679399886"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399887"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399886"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1375"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1376"></a><span>    </span><a name="local-6989586621679399887"><a href="#local-6989586621679399887"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679399888"><a href="#local-6989586621679399888"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399889"><a href="#local-6989586621679399889"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399888"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399887"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399889"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1377"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399890"><a href="#local-6989586621679399890"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399887"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399890"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1378"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399891"><a href="#local-6989586621679399891"><span class="hs-identifier">res</span></a></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399891"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-1379"></a><span>
</span><a name="line-1380"></a><span class="hs-comment">-- | Attempts to take a forall type apart, but only if it's a proper forall,</span><span>
</span><a name="line-1381"></a><span class="hs-comment">-- with a named binder</span><span>
</span><a name="line-1382"></a><span class="hs-identifier">splitForAllTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1383"></a><a name="splitForAllTy_maybe"><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier">splitForAllTy_maybe</span></a></a><span> </span><a name="local-6989586621679399892"><a href="#local-6989586621679399892"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399893"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399892"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1384"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1385"></a><span>    </span><a name="local-6989586621679399893"><a href="#local-6989586621679399893"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679399894"><a href="#local-6989586621679399894"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399895"><a href="#local-6989586621679399895"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399894"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399893"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399895"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1386"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399896"><a href="#local-6989586621679399896"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679399897"><a href="#local-6989586621679399897"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399896"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399897"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1387"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1388"></a><span>
</span><a name="line-1389"></a><span class="hs-comment">-- | Attempts to take a forall type apart; works with proper foralls and</span><span>
</span><a name="line-1390"></a><span class="hs-comment">-- functions</span><span>
</span><a name="line-1391"></a><span class="hs-identifier">splitPiTy_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1392"></a><a name="splitPiTy_maybe"><a href="Type.html#splitPiTy_maybe"><span class="hs-identifier">splitPiTy_maybe</span></a></a><span> </span><a name="local-6989586621679399898"><a href="#local-6989586621679399898"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399899"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399898"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1393"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1394"></a><span>    </span><a name="local-6989586621679399899"><a href="#local-6989586621679399899"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679399900"><a href="#local-6989586621679399900"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399901"><a href="#local-6989586621679399901"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399900"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399899"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399901"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1395"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-6989586621679399902"><a href="#local-6989586621679399902"><span class="hs-identifier">bndr</span></a></a><span> </span><a name="local-6989586621679399903"><a href="#local-6989586621679399903"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-6989586621679399902"><span class="hs-identifier hs-var">bndr</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399903"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1396"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399904"><a href="#local-6989586621679399904"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399905"><a href="#local-6989586621679399905"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a href="#local-6989586621679399904"><span class="hs-identifier hs-var">arg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399905"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">)</span><span>
</span><a name="line-1397"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1398"></a><span>
</span><a name="line-1399"></a><span class="hs-comment">-- | Takes a forall type apart, or panics</span><span>
</span><a name="line-1400"></a><span class="hs-identifier">splitPiTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1401"></a><a name="splitPiTy"><a href="Type.html#splitPiTy"><span class="hs-identifier">splitPiTy</span></a></a><span> </span><a name="local-6989586621679399906"><a href="#local-6989586621679399906"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1402"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399907"><a href="#local-6989586621679399907"><span class="hs-identifier">answer</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a><span> </span><a href="#local-6989586621679399906"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399907"><span class="hs-identifier hs-var">answer</span></a><span>
</span><a name="line-1403"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                         </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;splitPiTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679399906"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1404"></a><span>
</span><a name="line-1405"></a><span class="hs-comment">-- | Split off all TyBinders to a type, splitting both proper foralls</span><span>
</span><a name="line-1406"></a><span class="hs-comment">-- and functions</span><span>
</span><a name="line-1407"></a><span class="hs-identifier">splitPiTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1408"></a><a name="splitPiTys"><a href="Type.html#splitPiTys"><span class="hs-identifier">splitPiTys</span></a></a><span> </span><a name="local-6989586621679399908"><a href="#local-6989586621679399908"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399909"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399908"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399908"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1409"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1410"></a><span>    </span><a name="local-6989586621679399909"><a href="#local-6989586621679399909"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679399910"><a href="#local-6989586621679399910"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-6989586621679399911"><a href="#local-6989586621679399911"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399912"><a href="#local-6989586621679399912"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399913"><a href="#local-6989586621679399913"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399911"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399909"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399910"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-6989586621679399913"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399912"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1411"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-6989586621679399914"><a href="#local-6989586621679399914"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679399915"><a href="#local-6989586621679399915"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399916"><a href="#local-6989586621679399916"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399909"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399915"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399915"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-6989586621679399914"><span class="hs-identifier hs-var">b</span></a><span>  </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679399916"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1412"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399917"><a href="#local-6989586621679399917"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399918"><a href="#local-6989586621679399918"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679399919"><a href="#local-6989586621679399919"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399909"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399918"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399918"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a href="#local-6989586621679399917"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679399919"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1413"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399920"><a href="#local-6989586621679399920"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                </span><a name="local-6989586621679399921"><a href="#local-6989586621679399921"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679399921"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399920"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1414"></a><span>
</span><a name="line-1415"></a><span class="hs-comment">-- Like splitPiTys, but returns only *invisible* binders, including constraints</span><span>
</span><a name="line-1416"></a><span class="hs-comment">-- Stops at the first visible binder</span><span>
</span><a name="line-1417"></a><span class="hs-identifier">splitPiTysInvisible</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1418"></a><a name="splitPiTysInvisible"><a href="Type.html#splitPiTysInvisible"><span class="hs-identifier">splitPiTysInvisible</span></a></a><span> </span><a name="local-6989586621679399922"><a href="#local-6989586621679399922"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399923"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399922"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="#local-6989586621679399922"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1419"></a><span>   </span><span class="hs-keyword">where</span><span>
</span><a name="line-1420"></a><span>    </span><a name="local-6989586621679399923"><a href="#local-6989586621679399923"><span class="hs-identifier">split</span></a></a><span> </span><a name="local-6989586621679399924"><a href="#local-6989586621679399924"><span class="hs-identifier">orig_ty</span></a></a><span> </span><a name="local-6989586621679399925"><a href="#local-6989586621679399925"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679399926"><a href="#local-6989586621679399926"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399927"><a href="#local-6989586621679399927"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399925"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399923"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399924"><span class="hs-identifier hs-var">orig_ty</span></a><span> </span><a href="#local-6989586621679399927"><span class="hs-identifier hs-var">ty'</span></a><span> </span><a href="#local-6989586621679399926"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-1421"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><a name="local-6989586621679399928"><a href="#local-6989586621679399928"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399929"><a href="#local-6989586621679399929"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399930"><a href="#local-6989586621679399930"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399931"><a href="#local-6989586621679399931"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-1422"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isInvisibleArgFlag"><span class="hs-identifier hs-var">isInvisibleArgFlag</span></a><span> </span><a href="#local-6989586621679399929"><span class="hs-identifier hs-var">vis</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399923"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399930"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399930"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a href="#local-6989586621679399928"><span class="hs-identifier hs-var">b</span></a><span>  </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679399931"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1423"></a><span>    </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399932"><a href="#local-6989586621679399932"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399933"><a href="#local-6989586621679399933"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span>  </span><a name="local-6989586621679399934"><a href="#local-6989586621679399934"><span class="hs-identifier">bs</span></a></a><span>
</span><a name="line-1424"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-6989586621679399932"><span class="hs-identifier hs-var">arg</span></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399923"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679399933"><span class="hs-identifier hs-var">res</span></a><span> </span><a href="#local-6989586621679399933"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a href="#local-6989586621679399932"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679399934"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1425"></a><span>    </span><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679399935"><a href="#local-6989586621679399935"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-identifier">_</span><span>                </span><a name="local-6989586621679399936"><a href="#local-6989586621679399936"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679399936"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399935"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1426"></a><span>
</span><a name="line-1427"></a><span class="hs-comment">-- | Given a tycon and its arguments, filters out any invisible arguments</span><span>
</span><a name="line-1428"></a><span class="hs-identifier">filterOutInvisibleTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1429"></a><a name="filterOutInvisibleTypes"><a href="Type.html#filterOutInvisibleTypes"><span class="hs-identifier">filterOutInvisibleTypes</span></a></a><span> </span><a name="local-6989586621679399937"><a href="#local-6989586621679399937"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399938"><a href="#local-6989586621679399938"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#partitionInvisibles"><span class="hs-identifier hs-var">partitionInvisibles</span></a><span> </span><a href="#local-6989586621679399937"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679399938"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1430"></a><span>
</span><a name="line-1431"></a><span class="hs-comment">-- | Given a tycon and a list of things (which correspond to arguments),</span><span>
</span><a name="line-1432"></a><span class="hs-comment">-- partitions the things into</span><span>
</span><a name="line-1433"></a><span class="hs-comment">--      Inferred or Specified ones and</span><span>
</span><a name="line-1434"></a><span class="hs-comment">--      Required ones</span><span>
</span><a name="line-1435"></a><span class="hs-comment">-- The callback function is necessary for this scenario:</span><span>
</span><a name="line-1436"></a><span class="hs-comment">--</span><span>
</span><a name="line-1437"></a><span class="hs-comment">-- &gt; T :: forall k. k -&gt; k</span><span>
</span><a name="line-1438"></a><span class="hs-comment">-- &gt; partitionInvisibles T [forall m. m -&gt; m -&gt; m, S, R, Q]</span><span>
</span><a name="line-1439"></a><span class="hs-comment">--</span><span>
</span><a name="line-1440"></a><span class="hs-comment">-- After substituting, we get</span><span>
</span><a name="line-1441"></a><span class="hs-comment">--</span><span>
</span><a name="line-1442"></a><span class="hs-comment">-- &gt; T (forall m. m -&gt; m -&gt; m) :: (forall m. m -&gt; m -&gt; m) -&gt; forall n. n -&gt; n -&gt; n</span><span>
</span><a name="line-1443"></a><span class="hs-comment">--</span><span>
</span><a name="line-1444"></a><span class="hs-comment">-- Thus, the first argument is invisible, @S@ is visible, @R@ is invisible again,</span><span>
</span><a name="line-1445"></a><span class="hs-comment">-- and @Q@ is visible.</span><span>
</span><a name="line-1446"></a><span class="hs-comment">--</span><span>
</span><a name="line-1447"></a><span class="hs-comment">-- If you're absolutely sure that your tycon's kind doesn't end in a variable,</span><span>
</span><a name="line-1448"></a><span class="hs-comment">-- it's OK if the callback function panics, as that's the only time it's</span><span>
</span><a name="line-1449"></a><span class="hs-comment">-- consulted.</span><span>
</span><a name="line-1450"></a><span class="hs-identifier">partitionInvisibles</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399375"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399375"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679399375"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679399375"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1451"></a><a name="partitionInvisibles"><a href="Type.html#partitionInvisibles"><span class="hs-identifier">partitionInvisibles</span></a></a><span> </span><a name="local-6989586621679399939"><a href="#local-6989586621679399939"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399940"><a href="#local-6989586621679399940"><span class="hs-identifier">get_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399941"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="TyCoRep.html#emptyTCvSubst"><span class="hs-identifier hs-var">emptyTCvSubst</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-6989586621679399939"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1452"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1453"></a><span>    </span><a name="local-6989586621679399941"><a href="#local-6989586621679399941"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1454"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399942"><a href="#local-6989586621679399942"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679399943"><a href="#local-6989586621679399943"><span class="hs-identifier">tv</span></a></a><span> </span><a name="local-6989586621679399944"><a href="#local-6989586621679399944"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399945"><a href="#local-6989586621679399945"><span class="hs-identifier">res_ki</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679399946"><a href="#local-6989586621679399946"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679399947"><a href="#local-6989586621679399947"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1455"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Var.html#isVisibleArgFlag"><span class="hs-identifier hs-var">isVisibleArgFlag</span></a><span> </span><a href="#local-6989586621679399944"><span class="hs-identifier hs-var">vis</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399946"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399941"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399948"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-6989586621679399945"><span class="hs-identifier hs-var">res_ki</span></a><span> </span><a href="#local-6989586621679399947"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1456"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Arrow.html#first"><span class="hs-identifier hs-var">first</span></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679399946"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399941"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399948"><span class="hs-identifier hs-var">subst'</span></a><span> </span><a href="#local-6989586621679399945"><span class="hs-identifier hs-var">res_ki</span></a><span> </span><a href="#local-6989586621679399947"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1457"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-1458"></a><span>        </span><a name="local-6989586621679399948"><a href="#local-6989586621679399948"><span class="hs-identifier">subst'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a><span> </span><a href="#local-6989586621679399942"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399943"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399940"><span class="hs-identifier hs-var">get_ty</span></a><span> </span><a href="#local-6989586621679399946"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1459"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679399949"><a href="#local-6989586621679399949"><span class="hs-identifier">subst</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399950"><a href="#local-6989586621679399950"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399951"><a href="#local-6989586621679399951"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-1460"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399952"><a href="#local-6989586621679399952"><span class="hs-identifier">ki</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCoRep.html#lookupTyVar"><span class="hs-identifier hs-var">lookupTyVar</span></a><span> </span><a href="#local-6989586621679399949"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399950"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399941"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399949"><span class="hs-identifier hs-var">subst</span></a><span> </span><a href="#local-6989586621679399952"><span class="hs-identifier hs-var">ki</span></a><span> </span><a href="#local-6989586621679399951"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1461"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399953"><a href="#local-6989586621679399953"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679399953"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- something is ill-kinded. But this can happen</span><span>
</span><a name="line-1462"></a><span>                          </span><span class="hs-comment">-- when printing errors. Assume everything is visible.</span><span>
</span><a name="line-1463"></a><span>
</span><a name="line-1464"></a><span class="hs-comment">-- @isTauTy@ tests if a type has no foralls</span><span>
</span><a name="line-1465"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1466"></a><a name="isTauTy"><a href="Type.html#isTauTy"><span class="hs-identifier">isTauTy</span></a></a><span> </span><a name="local-6989586621679399954"><a href="#local-6989586621679399954"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399955"><a href="#local-6989586621679399955"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679399954"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span> </span><a href="#local-6989586621679399955"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1467"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1468"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1469"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399956"><a href="#local-6989586621679399956"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399957"><a href="#local-6989586621679399957"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span> </span><a href="#local-6989586621679399957"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TyCon.html#isTauTyCon"><span class="hs-identifier hs-var">isTauTyCon</span></a><span> </span><a href="#local-6989586621679399956"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1470"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399958"><a href="#local-6989586621679399958"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679399959"><a href="#local-6989586621679399959"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span> </span><a href="#local-6989586621679399958"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span> </span><a href="#local-6989586621679399959"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1471"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399960"><a href="#local-6989586621679399960"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679399961"><a href="#local-6989586621679399961"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span> </span><a href="#local-6989586621679399960"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span> </span><a href="#local-6989586621679399961"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1472"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1473"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679399962"><a href="#local-6989586621679399962"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isTauTy"><span class="hs-identifier hs-var">isTauTy</span></a><span> </span><a href="#local-6989586621679399962"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1474"></a><span class="hs-identifier">isTauTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-comment">-- Not sure about this</span><span>
</span><a name="line-1475"></a><span>
</span><a name="line-1476"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
   TyBinders
%*                                                                      *
%************************************************************************
-}</span><span>
</span><a name="line-1483"></a><span>
</span><a name="line-1484"></a><span class="hs-comment">-- | Make an anonymous binder</span><span>
</span><a name="line-1485"></a><span class="hs-identifier">mkAnonBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span>
</span><a name="line-1486"></a><a name="mkAnonBinder"><a href="Type.html#mkAnonBinder"><span class="hs-identifier">mkAnonBinder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span>
</span><a name="line-1487"></a><span>
</span><a name="line-1488"></a><span class="hs-comment">-- | Does this binder bind a variable that is /not/ erased? Returns</span><span>
</span><a name="line-1489"></a><span class="hs-comment">-- 'True' for anonymous binders.</span><span>
</span><a name="line-1490"></a><span class="hs-identifier">isAnonTyBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1491"></a><a name="isAnonTyBinder"><a href="Type.html#isAnonTyBinder"><span class="hs-identifier">isAnonTyBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1492"></a><span class="hs-identifier">isAnonTyBinder</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1493"></a><span>
</span><a name="line-1494"></a><span class="hs-identifier">isNamedTyBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1495"></a><a name="isNamedTyBinder"><a href="Type.html#isNamedTyBinder"><span class="hs-identifier">isNamedTyBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1496"></a><span class="hs-identifier">isNamedTyBinder</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1497"></a><span>
</span><a name="line-1498"></a><span class="hs-identifier">tyBinderType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1499"></a><span class="hs-comment">-- Barely used</span><span>
</span><a name="line-1500"></a><a name="tyBinderType"><a href="Type.html#tyBinderType"><span class="hs-identifier">tyBinderType</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-6989586621679399963"><a href="#local-6989586621679399963"><span class="hs-identifier">tvb</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#binderKind"><span class="hs-identifier hs-var">binderKind</span></a><span> </span><a href="#local-6989586621679399963"><span class="hs-identifier hs-var">tvb</span></a><span>
</span><a name="line-1501"></a><span class="hs-identifier">tyBinderType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-6989586621679399964"><a href="#local-6989586621679399964"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399964"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1502"></a><span>
</span><a name="line-1503"></a><span class="hs-comment">-- | Extract a relevant type, if there is one.</span><span>
</span><a name="line-1504"></a><span class="hs-identifier">binderRelevantType_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1505"></a><a name="binderRelevantType_maybe"><a href="Type.html#binderRelevantType_maybe"><span class="hs-identifier">binderRelevantType_maybe</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1506"></a><span class="hs-identifier">binderRelevantType_maybe</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-6989586621679399965"><a href="#local-6989586621679399965"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679399965"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1507"></a><span>
</span><a name="line-1508"></a><span class="hs-comment">-- | Like 'maybe', but for binders.</span><span>
</span><a name="line-1509"></a><span class="hs-identifier">caseBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyBinder"><span class="hs-identifier hs-type">TyBinder</span></a><span>           </span><span class="hs-comment">-- ^ binder to scrutinize</span><span>
</span><a name="line-1510"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Var.html#TyVarBinder"><span class="hs-identifier hs-type">TyVarBinder</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399374"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ named case</span><span>
</span><a name="line-1511"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399374"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- ^ anonymous case</span><span>
</span><a name="line-1512"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399374"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1513"></a><a name="caseBinder"><a href="Type.html#caseBinder"><span class="hs-identifier">caseBinder</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Named"><span class="hs-identifier hs-var">Named</span></a><span> </span><a name="local-6989586621679399966"><a href="#local-6989586621679399966"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399967"><a href="#local-6989586621679399967"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399967"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679399966"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-1514"></a><span class="hs-identifier">caseBinder</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a><span> </span><a name="local-6989586621679399968"><a href="#local-6989586621679399968"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399969"><a href="#local-6989586621679399969"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399969"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679399968"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1515"></a><span>
</span><a name="line-1516"></a><span>
</span><a name="line-1517"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                         Pred
*                                                                      *
************************************************************************

Predicates on PredType

Note [isPredTy complications]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You would think that we could define
  isPredTy ty = isConstraintKind (typeKind ty)
But there are a number of complications:

* isPredTy is used when printing types, which can happen in debug
  printing during type checking of not-fully-zonked types.  So it's
  not cool to say isConstraintKind (typeKind ty) because, absent
  zonking, the type might be ill-kinded, and typeKind crashes. Hence the
  rather tiresome story here

* isPredTy must return &quot;True&quot; to *unlifted* coercions, such as (t1 ~# t2)
  and (t1 ~R# t2), which are not of kind Constraint!  Currently they are
  of kind #.

* If we do form the type '(C a =&gt; C [a]) =&gt; blah', then we'd like to
  print it as such. But that means that isPredTy must return True for
  (C a =&gt; C [a]).  Admittedly that type is illegal in Haskell, but we
  want to print it nicely in error messages.
-}</span><span>
</span><a name="line-1547"></a><span>
</span><a name="line-1548"></a><span class="hs-comment">-- | Is the type suitable to classify a given/wanted in the typechecker?</span><span>
</span><a name="line-1549"></a><span class="hs-identifier">isPredTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1550"></a><span class="hs-comment">-- See Note [isPredTy complications]</span><span>
</span><a name="line-1551"></a><a name="isPredTy"><a href="Type.html#isPredTy"><span class="hs-identifier">isPredTy</span></a></a><span> </span><a name="local-6989586621679399970"><a href="#local-6989586621679399970"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399971"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399970"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1552"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1553"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1554"></a><span>    </span><a name="local-6989586621679399971"><a href="#local-6989586621679399971"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679399974"><a href="#local-6989586621679399974"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679399975"><a href="#local-6989586621679399975"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">)</span><span>   </span><a name="local-6989586621679399976"><a href="#local-6989586621679399976"><span class="hs-identifier">args</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399971"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399974"><span class="hs-identifier hs-var">ty1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679399975"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679399976"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span>
</span><a name="line-1555"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679399977"><a href="#local-6989586621679399977"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>      </span><a name="local-6989586621679399978"><a href="#local-6989586621679399978"><span class="hs-identifier">args</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399973"><span class="hs-identifier hs-var">go_k</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679399977"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399978"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1556"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679399979"><a href="#local-6989586621679399979"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399980"><a href="#local-6989586621679399980"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399981"><a href="#local-6989586621679399981"><span class="hs-identifier">args</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-identifier">args</span><span> </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- TyConApp invariant</span><span>
</span><a name="line-1557"></a><span>                                      </span><a href="#local-6989586621679399972"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-6989586621679399979"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679399980"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1558"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679399982"><a href="#local-6989586621679399982"><span class="hs-identifier">arg</span></a></a><span> </span><a name="local-6989586621679399983"><a href="#local-6989586621679399983"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1559"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-6989586621679399982"><span class="hs-identifier hs-var">arg</span></a><span>                </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isPredTy"><span class="hs-identifier hs-var">isPredTy</span></a><span> </span><a href="#local-6989586621679399983"><span class="hs-identifier hs-var">res</span></a><span>   </span><span class="hs-comment">-- (Eq a =&gt; C a)</span><span>
</span><a name="line-1560"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>          </span><span class="hs-comment">-- (Int -&gt; Bool)</span><span>
</span><a name="line-1561"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399984"><a href="#local-6989586621679399984"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399971"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679399984"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1562"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679399985"><a href="#local-6989586621679399985"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679399986"><a href="#local-6989586621679399986"><span class="hs-identifier">args</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399973"><span class="hs-identifier hs-var">go_k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">pSnd</span><span> </span><span class="hs-special">(</span><a href="Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a><span> </span><a href="#local-6989586621679399985"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399986"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1563"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1564"></a><span>
</span><a name="line-1565"></a><span>    </span><span class="hs-identifier">go_tc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1566"></a><span>    </span><a name="local-6989586621679399972"><a href="#local-6989586621679399972"><span class="hs-identifier">go_tc</span></a></a><span> </span><a name="local-6989586621679399987"><a href="#local-6989586621679399987"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679399988"><a href="#local-6989586621679399988"><span class="hs-identifier">args</span></a></a><span>
</span><a name="line-1567"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679399987"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679399987"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1568"></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399988"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-special">`</span><a href="Util.html#lengthIs"><span class="hs-identifier hs-var">lengthIs</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">4</span><span>  </span><span class="hs-comment">-- ~# and ~R# sadly have result kind #</span><span>
</span><a name="line-1569"></a><span>                                       </span><span class="hs-comment">-- not Constraint; but we still want</span><span>
</span><a name="line-1570"></a><span>                                       </span><span class="hs-comment">-- isPredTy to reply True.</span><span>
</span><a name="line-1571"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679399973"><span class="hs-identifier hs-var">go_k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-6989586621679399987"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679399988"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1572"></a><span>
</span><a name="line-1573"></a><span>    </span><span class="hs-identifier">go_k</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#KindOrType"><span class="hs-identifier hs-type">KindOrType</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1574"></a><span>    </span><span class="hs-comment">-- True &lt;=&gt; ('k' applied to 'kts') = Constraint</span><span>
</span><a name="line-1575"></a><span>    </span><a name="local-6989586621679399973"><a href="#local-6989586621679399973"><span class="hs-identifier">go_k</span></a></a><span> </span><a name="local-6989586621679399989"><a href="#local-6989586621679399989"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Kind.html#isConstraintKind"><span class="hs-identifier hs-var">isConstraintKind</span></a><span> </span><a href="#local-6989586621679399989"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1576"></a><span>    </span><span class="hs-identifier">go_k</span><span> </span><a name="local-6989586621679399990"><a href="#local-6989586621679399990"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679399991"><a href="#local-6989586621679399991"><span class="hs-identifier">arg</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679399992"><a href="#local-6989586621679399992"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#piResultTy_maybe"><span class="hs-identifier hs-var">piResultTy_maybe</span></a><span> </span><a href="#local-6989586621679399990"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679399991"><span class="hs-identifier hs-var">arg</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1577"></a><span>                          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399993"><a href="#local-6989586621679399993"><span class="hs-identifier">k'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399973"><span class="hs-identifier hs-var">go_k</span></a><span> </span><a href="#local-6989586621679399993"><span class="hs-identifier hs-var">k'</span></a><span> </span><a href="#local-6989586621679399992"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-1578"></a><span>                          </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><a href="Outputable.html#warnPprTrace"><span class="hs-identifier hs-var">True</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;isPredTy&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1579"></a><span>                                     </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1580"></a><span>       </span><span class="hs-comment">-- This last case shouldn't happen under most circumstances. It can</span><span>
</span><a name="line-1581"></a><span>       </span><span class="hs-comment">-- occur if we call isPredTy during kind checking, especially if one</span><span>
</span><a name="line-1582"></a><span>       </span><span class="hs-comment">-- of the following happens:</span><span>
</span><a name="line-1583"></a><span>       </span><span class="hs-comment">--</span><span>
</span><a name="line-1584"></a><span>       </span><span class="hs-comment">-- 1. There is actually a kind error.  Example in which this showed up:</span><span>
</span><a name="line-1585"></a><span>       </span><span class="hs-comment">--    polykinds/T11399</span><span>
</span><a name="line-1586"></a><span>       </span><span class="hs-comment">--</span><span>
</span><a name="line-1587"></a><span>       </span><span class="hs-comment">-- 2. A type constructor application appears to be oversaturated. An</span><span>
</span><a name="line-1588"></a><span>       </span><span class="hs-comment">--    example of this occurred in GHC Trac #13187:</span><span>
</span><a name="line-1589"></a><span>       </span><span class="hs-comment">--</span><span>
</span><a name="line-1590"></a><span>       </span><span class="hs-comment">--      {-# LANGUAGE PolyKinds #-}</span><span>
</span><a name="line-1591"></a><span>       </span><span class="hs-comment">--      type Const a b = b</span><span>
</span><a name="line-1592"></a><span>       </span><span class="hs-comment">--      f :: Const Int (,) Bool Char -&gt; Char</span><span>
</span><a name="line-1593"></a><span>       </span><span class="hs-comment">--</span><span>
</span><a name="line-1594"></a><span>       </span><span class="hs-comment">--    We call isPredTy (Const k1 k2 Int (,) Bool Char</span><span>
</span><a name="line-1595"></a><span>       </span><span class="hs-comment">--    where k1,k2 are unification variables that have been</span><span>
</span><a name="line-1596"></a><span>       </span><span class="hs-comment">--    unified to *, and (*-&gt;*-&gt;*) resp, /but not zonked/.</span><span>
</span><a name="line-1597"></a><span>       </span><span class="hs-comment">--    This shows that isPredTy can report a false negative</span><span>
</span><a name="line-1598"></a><span>       </span><span class="hs-comment">--    if a constraint is similarly oversaturated, but</span><span>
</span><a name="line-1599"></a><span>       </span><span class="hs-comment">--    it's hard to do better than isPredTy currently does without</span><span>
</span><a name="line-1600"></a><span>       </span><span class="hs-comment">--    zonking, so we punt on such cases for now.  This only happens</span><span>
</span><a name="line-1601"></a><span>       </span><span class="hs-comment">--    during debug-printing, so it doesn't matter.</span><span>
</span><a name="line-1602"></a><span>
</span><a name="line-1603"></a><span class="hs-identifier">isClassPred</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isEqPred</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isNomEqPred</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isIPPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1604"></a><a name="isClassPred"><a href="Type.html#isClassPred"><span class="hs-identifier">isClassPred</span></a></a><span> </span><a name="local-6989586621679399994"><a href="#local-6989586621679399994"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399994"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1605"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399995"><a href="#local-6989586621679399995"><span class="hs-identifier">tyCon</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isClassTyCon"><span class="hs-identifier hs-var">isClassTyCon</span></a><span> </span><a href="#local-6989586621679399995"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1606"></a><span>    </span><span class="hs-identifier">_</span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1607"></a><a name="isEqPred"><a href="Type.html#isEqPred"><span class="hs-identifier">isEqPred</span></a></a><span> </span><a name="local-6989586621679399996"><a href="#local-6989586621679399996"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399996"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1608"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399997"><a href="#local-6989586621679399997"><span class="hs-identifier">tyCon</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399997"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>
</span><a name="line-1609"></a><span>               </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679399997"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1610"></a><span>    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1611"></a><span>
</span><a name="line-1612"></a><a name="isNomEqPred"><a href="Type.html#isNomEqPred"><span class="hs-identifier">isNomEqPred</span></a></a><span> </span><a name="local-6989586621679399998"><a href="#local-6989586621679399998"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-6989586621679399998"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1613"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679399999"><a href="#local-6989586621679399999"><span class="hs-identifier">tyCon</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679399999"><span class="hs-identifier hs-var">tyCon</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>
</span><a name="line-1614"></a><span>    </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1615"></a><span>
</span><a name="line-1616"></a><a name="isIPPred"><a href="Type.html#isIPPred"><span class="hs-identifier">isIPPred</span></a></a><span> </span><a name="local-6989586621679400000"><a href="#local-6989586621679400000"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-6989586621679400000"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1617"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400001"><a href="#local-6989586621679400001"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#isIPTyCon"><span class="hs-identifier hs-var">isIPTyCon</span></a><span> </span><a href="#local-6989586621679400001"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1618"></a><span>    </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1619"></a><span>
</span><a name="line-1620"></a><span class="hs-identifier">isIPTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1621"></a><a name="isIPTyCon"><a href="Type.html#isIPTyCon"><span class="hs-identifier">isIPTyCon</span></a></a><span> </span><a name="local-6989586621679400002"><a href="#local-6989586621679400002"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400002"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ipClassKey"><span class="hs-identifier hs-var">ipClassKey</span></a><span>
</span><a name="line-1622"></a><span>  </span><span class="hs-comment">-- Class and its corresponding TyCon have the same Unique</span><span>
</span><a name="line-1623"></a><span>
</span><a name="line-1624"></a><span class="hs-identifier">isIPClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1625"></a><a name="isIPClass"><a href="Type.html#isIPClass"><span class="hs-identifier">isIPClass</span></a></a><span> </span><a name="local-6989586621679400003"><a href="#local-6989586621679400003"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400003"><span class="hs-identifier hs-var">cls</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#ipClassKey"><span class="hs-identifier hs-var">ipClassKey</span></a><span>
</span><a name="line-1626"></a><span>
</span><a name="line-1627"></a><span class="hs-identifier">isCTupleClass</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1628"></a><a name="isCTupleClass"><a href="Type.html#isCTupleClass"><span class="hs-identifier">isCTupleClass</span></a></a><span> </span><a name="local-6989586621679400004"><a href="#local-6989586621679400004"><span class="hs-identifier">cls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">classTyCon</span><span> </span><a href="#local-6989586621679400004"><span class="hs-identifier hs-var">cls</span></a><span class="hs-special">)</span><span>
</span><a name="line-1629"></a><span>
</span><a name="line-1630"></a><span class="hs-identifier">isIPPred_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1631"></a><a name="isIPPred_maybe"><a href="Type.html#isIPPred_maybe"><span class="hs-identifier">isIPPred_maybe</span></a></a><span> </span><a name="local-6989586621679400005"><a href="#local-6989586621679400005"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1632"></a><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679400006"><a href="#local-6989586621679400006"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><a name="local-6989586621679400007"><a href="#local-6989586621679400007"><span class="hs-identifier">t1</span></a></a><span class="hs-special">,</span><a name="local-6989586621679400008"><a href="#local-6989586621679400008"><span class="hs-identifier">t2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400005"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1633"></a><span>     </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#isIPTyCon"><span class="hs-identifier hs-var">isIPTyCon</span></a><span> </span><a href="#local-6989586621679400006"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span>
</span><a name="line-1634"></a><span>     </span><a name="local-6989586621679400009"><a href="#local-6989586621679400009"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#isStrLitTy"><span class="hs-identifier hs-var">isStrLitTy</span></a><span> </span><a href="#local-6989586621679400007"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-1635"></a><span>     </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400009"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679400008"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1636"></a><span>
</span><a name="line-1637"></a><span class="hs-comment">{-
Make PredTypes

--------------------- Equality types ---------------------------------
-}</span><span>
</span><a name="line-1642"></a><span>
</span><a name="line-1643"></a><span class="hs-comment">-- | Makes a lifted equality predicate at the given role</span><span>
</span><a name="line-1644"></a><span class="hs-identifier">mkPrimEqPredRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span>
</span><a name="line-1645"></a><a name="mkPrimEqPredRole"><a href="Type.html#mkPrimEqPredRole"><span class="hs-identifier">mkPrimEqPredRole</span></a></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkPrimEqPred"><span class="hs-identifier hs-var">mkPrimEqPred</span></a><span>
</span><a name="line-1646"></a><span class="hs-identifier">mkPrimEqPredRole</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkReprPrimEqPred"><span class="hs-identifier hs-var">mkReprPrimEqPred</span></a><span>
</span><a name="line-1647"></a><span class="hs-identifier">mkPrimEqPredRole</span><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Panic.html#panic"><span class="hs-identifier hs-var">panic</span></a><span> </span><span class="hs-string">&quot;mkPrimEqPredRole phantom&quot;</span><span>
</span><a name="line-1648"></a><span>
</span><a name="line-1649"></a><span class="hs-comment">-- | Creates a primitive type equality predicate.</span><span>
</span><a name="line-1650"></a><span class="hs-comment">-- Invariant: the types are not Coercions</span><span>
</span><a name="line-1651"></a><span class="hs-identifier">mkPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1652"></a><a name="mkPrimEqPred"><a href="Type.html#mkPrimEqPred"><span class="hs-identifier">mkPrimEqPred</span></a></a><span> </span><a name="local-6989586621679400010"><a href="#local-6989586621679400010"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679400011"><a href="#local-6989586621679400011"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1653"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqPrimTyCon"><span class="hs-identifier hs-var">eqPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679400012"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400013"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400010"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400011"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1654"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1655"></a><span>    </span><a name="local-6989586621679400012"><a href="#local-6989586621679400012"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400010"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1656"></a><span>    </span><a name="local-6989586621679400013"><a href="#local-6989586621679400013"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400011"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1657"></a><span>
</span><a name="line-1658"></a><span class="hs-comment">-- | Creates a primite type equality predicate with explicit kinds</span><span>
</span><a name="line-1659"></a><span class="hs-identifier">mkHeteroPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1660"></a><a name="mkHeteroPrimEqPred"><a href="Type.html#mkHeteroPrimEqPred"><span class="hs-identifier">mkHeteroPrimEqPred</span></a></a><span> </span><a name="local-6989586621679400014"><a href="#local-6989586621679400014"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-6989586621679400015"><a href="#local-6989586621679400015"><span class="hs-identifier">k2</span></a></a><span> </span><a name="local-6989586621679400016"><a href="#local-6989586621679400016"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679400017"><a href="#local-6989586621679400017"><span class="hs-identifier">ty2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqPrimTyCon"><span class="hs-identifier hs-var">eqPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679400014"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400015"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400016"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400017"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1661"></a><span>
</span><a name="line-1662"></a><span class="hs-comment">-- | Creates a primitive representational type equality predicate</span><span>
</span><a name="line-1663"></a><span class="hs-comment">-- with explicit kinds</span><span>
</span><a name="line-1664"></a><span class="hs-identifier">mkHeteroReprPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1665"></a><a name="mkHeteroReprPrimEqPred"><a href="Type.html#mkHeteroReprPrimEqPred"><span class="hs-identifier">mkHeteroReprPrimEqPred</span></a></a><span> </span><a name="local-6989586621679400018"><a href="#local-6989586621679400018"><span class="hs-identifier">k1</span></a></a><span> </span><a name="local-6989586621679400019"><a href="#local-6989586621679400019"><span class="hs-identifier">k2</span></a></a><span> </span><a name="local-6989586621679400020"><a href="#local-6989586621679400020"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679400021"><a href="#local-6989586621679400021"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1666"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqReprPrimTyCon"><span class="hs-identifier hs-var">eqReprPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679400018"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400019"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400020"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400021"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1667"></a><span>
</span><a name="line-1668"></a><span class="hs-comment">-- | Try to split up a coercion type into the types that it coerces</span><span>
</span><a name="line-1669"></a><span class="hs-identifier">splitCoercionType_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1670"></a><a name="splitCoercionType_maybe"><a href="Type.html#splitCoercionType_maybe"><span class="hs-identifier">splitCoercionType_maybe</span></a></a><span> </span><a name="local-6989586621679400022"><a href="#local-6989586621679400022"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1671"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679400023"><a href="#local-6989586621679400023"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679400024"><a href="#local-6989586621679400024"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400025"><a href="#local-6989586621679400025"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400022"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1672"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679400023"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679400023"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1673"></a><span>       </span><span class="hs-special">;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400024"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400025"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1674"></a><span>
</span><a name="line-1675"></a><span class="hs-identifier">mkReprPrimEqPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1676"></a><a name="mkReprPrimEqPred"><a href="Type.html#mkReprPrimEqPred"><span class="hs-identifier">mkReprPrimEqPred</span></a></a><span> </span><a name="local-6989586621679400026"><a href="#local-6989586621679400026"><span class="hs-identifier">ty1</span></a></a><span>  </span><a name="local-6989586621679400027"><a href="#local-6989586621679400027"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-1677"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a href="TysPrim.html#eqReprPrimTyCon"><span class="hs-identifier hs-var">eqReprPrimTyCon</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679400028"><span class="hs-identifier hs-var">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400029"><span class="hs-identifier hs-var">k2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400026"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400027"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span>
</span><a name="line-1678"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1679"></a><span>    </span><a name="local-6989586621679400028"><a href="#local-6989586621679400028"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400026"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-1680"></a><span>    </span><a name="local-6989586621679400029"><a href="#local-6989586621679400029"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400027"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1681"></a><span>
</span><a name="line-1682"></a><span class="hs-identifier">equalityTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-1683"></a><a name="equalityTyCon"><a href="Type.html#equalityTyCon"><span class="hs-identifier">equalityTyCon</span></a></a><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#eqPrimTyCon"><span class="hs-identifier hs-var">eqPrimTyCon</span></a><span>
</span><a name="line-1684"></a><span class="hs-identifier">equalityTyCon</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#eqReprPrimTyCon"><span class="hs-identifier hs-var">eqReprPrimTyCon</span></a><span>
</span><a name="line-1685"></a><span class="hs-identifier">equalityTyCon</span><span> </span><a href="CoAxiom.html#Phantom"><span class="hs-identifier hs-var">Phantom</span></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="TysPrim.html#eqPhantPrimTyCon"><span class="hs-identifier hs-var">eqPhantPrimTyCon</span></a><span>
</span><a name="line-1686"></a><span>
</span><a name="line-1687"></a><span class="hs-comment">-- --------------------- Dictionary types ---------------------------------</span><span>
</span><a name="line-1688"></a><span>
</span><a name="line-1689"></a><span class="hs-identifier">mkClassPred</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span>
</span><a name="line-1690"></a><a name="mkClassPred"><a href="Type.html#mkClassPred"><span class="hs-identifier">mkClassPred</span></a></a><span> </span><a name="local-6989586621679400030"><a href="#local-6989586621679400030"><span class="hs-identifier">clas</span></a></a><span> </span><a name="local-6989586621679400031"><a href="#local-6989586621679400031"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">classTyCon</span><span> </span><a href="#local-6989586621679400030"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400031"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1691"></a><span>
</span><a name="line-1692"></a><span class="hs-identifier">isDictTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1693"></a><a name="isDictTy"><a href="Type.html#isDictTy"><span class="hs-identifier">isDictTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isClassPred"><span class="hs-identifier hs-var">isClassPred</span></a><span>
</span><a name="line-1694"></a><span>
</span><a name="line-1695"></a><span class="hs-identifier">isDictLikeTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1696"></a><span class="hs-comment">-- Note [Dictionary-like types]</span><span>
</span><a name="line-1697"></a><a name="isDictLikeTy"><a href="Type.html#isDictLikeTy"><span class="hs-identifier">isDictLikeTy</span></a></a><span> </span><a name="local-6989586621679400032"><a href="#local-6989586621679400032"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400033"><a href="#local-6989586621679400033"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679400032"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isDictLikeTy"><span class="hs-identifier hs-var">isDictLikeTy</span></a><span> </span><a href="#local-6989586621679400033"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1698"></a><span class="hs-identifier">isDictLikeTy</span><span> </span><a name="local-6989586621679400034"><a href="#local-6989586621679400034"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400034"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1699"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400035"><a href="#local-6989586621679400035"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400036"><a href="#local-6989586621679400036"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isClassTyCon"><span class="hs-identifier hs-var">isClassTyCon</span></a><span> </span><a href="#local-6989586621679400035"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1700"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><a href="TyCon.html#isTupleTyCon"><span class="hs-identifier hs-var">isTupleTyCon</span></a><span> </span><a href="#local-6989586621679400035"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Type.html#isDictLikeTy"><span class="hs-identifier hs-var">isDictLikeTy</span></a><span> </span><a href="#local-6989586621679400036"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1701"></a><span>        </span><a name="local-6989586621679400037"><a href="#local-6989586621679400037"><span class="hs-identifier">_other</span></a></a><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-1702"></a><span>
</span><a name="line-1703"></a><span class="hs-comment">{-
Note [Dictionary-like types]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Being &quot;dictionary-like&quot; means either a dictionary type or a tuple thereof.
In GHC 6.10 we build implication constraints which construct such tuples,
and if we land up with a binding
    t :: (C [a], Eq [a])
    t = blah
then we want to treat t as cheap under &quot;-fdicts-cheap&quot; for example.
(Implication constraints are normally inlined, but sadly not if the
occurrence is itself inside an INLINE function!  Until we revise the
handling of implication constraints, that is.)  This turned out to
be important in getting good arities in DPH code.  Example:

    class C a
    class D a where { foo :: a -&gt; a }
    instance C a =&gt; D (Maybe a) where { foo x = x }

    bar :: (C a, C b) =&gt; a -&gt; b -&gt; (Maybe a, Maybe b)
    {-# INLINE bar #-}
    bar x y = (foo (Just x), foo (Just y))

Then 'bar' should jolly well have arity 4 (two dicts, two args), but
we ended up with something like
   bar = __inline_me__ (\d1,d2. let t :: (D (Maybe a), D (Maybe b)) = ...
                                in \x,y. &lt;blah&gt;)

This is all a bit ad-hoc; eg it relies on knowing that implication
constraints build tuples.


Decomposing PredType
-}</span><span>
</span><a name="line-1736"></a><span>
</span><a name="line-1737"></a><span class="hs-comment">-- | A choice of equality relation. This is separate from the type 'Role'</span><span>
</span><a name="line-1738"></a><span class="hs-comment">-- because 'Phantom' does not define a (non-trivial) equality relation.</span><span>
</span><a name="line-1739"></a><span class="hs-keyword">data</span><span> </span><a name="EqRel"><a href="Type.html#EqRel"><span class="hs-identifier">EqRel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NomEq"><a href="Type.html#NomEq"><span class="hs-identifier">NomEq</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ReprEq"><a href="Type.html#ReprEq"><span class="hs-identifier">ReprEq</span></a></a><span>
</span><a name="line-1740"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-1741"></a><span>
</span><a name="line-1742"></a><span class="hs-keyword">instance</span><span> </span><a href="Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1743"></a><span>  </span><a name="local-8214565720323905585"><a href="Outputable.html#ppr"><span class="hs-identifier">ppr</span></a></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;nominal equality&quot;</span><span>
</span><a name="line-1744"></a><span>  </span><span class="hs-identifier">ppr</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#text"><span class="hs-identifier hs-var">text</span></a><span> </span><span class="hs-string">&quot;representational equality&quot;</span><span>
</span><a name="line-1745"></a><span>
</span><a name="line-1746"></a><span class="hs-identifier">eqRelRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-1747"></a><a name="eqRelRole"><a href="Type.html#eqRelRole"><span class="hs-identifier">eqRelRole</span></a></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span>
</span><a name="line-1748"></a><span class="hs-identifier">eqRelRole</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span>
</span><a name="line-1749"></a><span>
</span><a name="line-1750"></a><span class="hs-keyword">data</span><span> </span><a name="PredTree"><a href="Type.html#PredTree"><span class="hs-identifier">PredTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ClassPred"><a href="Type.html#ClassPred"><span class="hs-identifier">ClassPred</span></a></a><span> </span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1751"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="EqPred"><a href="Type.html#EqPred"><span class="hs-identifier">EqPred</span></a></a><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1752"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="IrredPred"><a href="Type.html#IrredPred"><span class="hs-identifier">IrredPred</span></a></a><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span>
</span><a name="line-1753"></a><span>  </span><span class="hs-comment">-- NB: There is no TuplePred case</span><span>
</span><a name="line-1754"></a><span>  </span><span class="hs-comment">--     Tuple predicates like (Eq a, Ord b) are just treated</span><span>
</span><a name="line-1755"></a><span>  </span><span class="hs-comment">--     as ClassPred, as if we had a tuple class with two superclasses</span><span>
</span><a name="line-1756"></a><span>  </span><span class="hs-comment">--        class (c1, c2) =&gt; (%,%) c1 c2</span><span>
</span><a name="line-1757"></a><span>
</span><a name="line-1758"></a><span class="hs-identifier">classifyPredType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#PredTree"><span class="hs-identifier hs-type">PredTree</span></a><span>
</span><a name="line-1759"></a><a name="classifyPredType"><a href="Type.html#classifyPredType"><span class="hs-identifier">classifyPredType</span></a></a><span> </span><a name="local-6989586621679400038"><a href="#local-6989586621679400038"><span class="hs-identifier">ev_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400038"><span class="hs-identifier hs-var">ev_ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1760"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400039"><a href="#local-6989586621679400039"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679400040"><a href="#local-6989586621679400040"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400041"><a href="#local-6989586621679400041"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1761"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679400039"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span> </span><a href="#local-6989586621679400040"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679400041"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1762"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679400039"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqPred"><span class="hs-identifier hs-var">EqPred</span></a><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span> </span><a href="#local-6989586621679400040"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679400041"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-1763"></a><span>    </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400042"><a href="#local-6989586621679400042"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400043"><a href="#local-6989586621679400043"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-1764"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400044"><a href="#local-6989586621679400044"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConClass_maybe"><span class="hs-identifier hs-var">tyConClass_maybe</span></a><span> </span><a href="#local-6989586621679400042"><span class="hs-identifier hs-var">tc</span></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#ClassPred"><span class="hs-identifier hs-var">ClassPred</span></a><span> </span><a href="#local-6989586621679400044"><span class="hs-identifier hs-var">clas</span></a><span> </span><a href="#local-6989586621679400043"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1765"></a><span>    </span><span class="hs-identifier">_</span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#IrredPred"><span class="hs-identifier hs-var">IrredPred</span></a><span> </span><a href="#local-6989586621679400038"><span class="hs-identifier hs-var">ev_ty</span></a><span>
</span><a name="line-1766"></a><span>
</span><a name="line-1767"></a><span class="hs-identifier">getClassPredTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1768"></a><a name="getClassPredTys"><a href="Type.html#getClassPredTys"><span class="hs-identifier">getClassPredTys</span></a></a><span> </span><a name="local-6989586621679400045"><a href="#local-6989586621679400045"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier hs-var">getClassPredTys_maybe</span></a><span> </span><a href="#local-6989586621679400045"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1769"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400046"><a href="#local-6989586621679400046"><span class="hs-identifier">clas</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400047"><a href="#local-6989586621679400047"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400046"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400047"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1770"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;getClassPredTys&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400045"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1771"></a><span>
</span><a name="line-1772"></a><span class="hs-identifier">getClassPredTys_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="Class.html#Class"><span class="hs-identifier hs-type">Class</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1773"></a><a name="getClassPredTys_maybe"><a href="Type.html#getClassPredTys_maybe"><span class="hs-identifier">getClassPredTys_maybe</span></a></a><span> </span><a name="local-6989586621679400048"><a href="#local-6989586621679400048"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400048"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1774"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400049"><a href="#local-6989586621679400049"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400050"><a href="#local-6989586621679400050"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400051"><a href="#local-6989586621679400051"><span class="hs-identifier">clas</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConClass_maybe"><span class="hs-identifier hs-var">tyConClass_maybe</span></a><span> </span><a href="#local-6989586621679400049"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400051"><span class="hs-identifier hs-var">clas</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400050"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1775"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1776"></a><span>
</span><a name="line-1777"></a><span class="hs-identifier">getEqPredTys</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1778"></a><a name="getEqPredTys"><a href="Type.html#getEqPredTys"><span class="hs-identifier">getEqPredTys</span></a></a><span> </span><a name="local-6989586621679400052"><a href="#local-6989586621679400052"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1779"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400052"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1780"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400053"><a href="#local-6989586621679400053"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679400054"><a href="#local-6989586621679400054"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400055"><a href="#local-6989586621679400055"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1781"></a><span>        </span><span class="hs-glyph">|</span><span>  </span><a href="#local-6989586621679400053"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>
</span><a name="line-1782"></a><span>        </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679400053"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1783"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400054"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400055"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1784"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;getEqPredTys&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400052"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1785"></a><span>
</span><a name="line-1786"></a><span class="hs-identifier">getEqPredTys_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-1787"></a><a name="getEqPredTys_maybe"><a href="Type.html#getEqPredTys_maybe"><span class="hs-identifier">getEqPredTys_maybe</span></a></a><span> </span><a name="local-6989586621679400056"><a href="#local-6989586621679400056"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1788"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400056"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1789"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400057"><a href="#local-6989586621679400057"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679400058"><a href="#local-6989586621679400058"><span class="hs-identifier">ty1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400059"><a href="#local-6989586621679400059"><span class="hs-identifier">ty2</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1790"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679400057"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqPrimTyConKey"><span class="hs-identifier hs-var">eqPrimTyConKey</span></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400058"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400059"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1791"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679400057"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#Representational"><span class="hs-identifier hs-var">Representational</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400058"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400059"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-1792"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1793"></a><span>
</span><a name="line-1794"></a><span class="hs-identifier">getEqPredRole</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CoAxiom.html#Role"><span class="hs-identifier hs-type">Role</span></a><span>
</span><a name="line-1795"></a><a name="getEqPredRole"><a href="Type.html#getEqPredRole"><span class="hs-identifier">getEqPredRole</span></a></a><span> </span><a name="local-6989586621679400060"><a href="#local-6989586621679400060"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#eqRelRole"><span class="hs-identifier hs-var">eqRelRole</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#predTypeEqRel"><span class="hs-identifier hs-var">predTypeEqRel</span></a><span> </span><a href="#local-6989586621679400060"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1796"></a><span>
</span><a name="line-1797"></a><span class="hs-comment">-- | Get the equality relation relevant for a pred type.</span><span>
</span><a name="line-1798"></a><span class="hs-identifier">predTypeEqRel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#PredType"><span class="hs-identifier hs-type">PredType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#EqRel"><span class="hs-identifier hs-type">EqRel</span></a><span>
</span><a name="line-1799"></a><a name="predTypeEqRel"><a href="Type.html#predTypeEqRel"><span class="hs-identifier">predTypeEqRel</span></a></a><span> </span><a name="local-6989586621679400061"><a href="#local-6989586621679400061"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1800"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400062"><a href="#local-6989586621679400062"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400061"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1801"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400062"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#eqReprPrimTyConKey"><span class="hs-identifier hs-var">eqReprPrimTyConKey</span></a><span>
</span><a name="line-1802"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#ReprEq"><span class="hs-identifier hs-var">ReprEq</span></a><span>
</span><a name="line-1803"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1804"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#NomEq"><span class="hs-identifier hs-var">NomEq</span></a><span>
</span><a name="line-1805"></a><span>
</span><a name="line-1806"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
         Well-scoped tyvars
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1813"></a><span>
</span><a name="line-1814"></a><span class="hs-comment">-- | Do a topological sort on a list of tyvars,</span><span>
</span><a name="line-1815"></a><span class="hs-comment">--   so that binders occur before occurrences</span><span>
</span><a name="line-1816"></a><span class="hs-comment">-- E.g. given  [ a::k, k::*, b::k ]</span><span>
</span><a name="line-1817"></a><span class="hs-comment">-- it'll return a well-scoped list [ k::*, a::k, b::k ]</span><span>
</span><a name="line-1818"></a><span class="hs-comment">--</span><span>
</span><a name="line-1819"></a><span class="hs-comment">-- This is a deterministic sorting operation</span><span>
</span><a name="line-1820"></a><span class="hs-comment">-- (that is, doesn't depend on Uniques).</span><span>
</span><a name="line-1821"></a><span class="hs-identifier">toposortTyVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1822"></a><a name="toposortTyVars"><a href="Type.html#toposortTyVars"><span class="hs-identifier">toposortTyVars</span></a></a><span> </span><a name="local-6989586621679400063"><a href="#local-6989586621679400063"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1823"></a><span>                     </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">node_payload</span><span> </span><a href="#local-6989586621679400067"><span class="hs-identifier hs-var">node</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679400067"><a href="#local-6989586621679400067"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Digraph.html#topologicalSortG"><span class="hs-identifier hs-var">topologicalSortG</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-1824"></a><span>                                          </span><a href="Digraph.html#graphFromEdgedVerticesOrd"><span class="hs-identifier hs-var">graphFromEdgedVerticesOrd</span></a><span> </span><a href="#local-6989586621679400065"><span class="hs-identifier hs-var">nodes</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1825"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1826"></a><span>    </span><span class="hs-identifier">var_ids</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#VarEnv"><span class="hs-identifier hs-type">VarEnv</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-1827"></a><span>    </span><a name="local-6989586621679400064"><a href="#local-6989586621679400064"><span class="hs-identifier">var_ids</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-6989586621679400063"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1828"></a><span>
</span><a name="line-1829"></a><span>    </span><span class="hs-identifier">nodes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><a href="Digraph.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1830"></a><span>    </span><a name="local-6989586621679400065"><a href="#local-6989586621679400065"><span class="hs-identifier">nodes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="Digraph.html#DigraphNode"><span class="hs-identifier hs-var">DigraphNode</span></a><span>
</span><a name="line-1831"></a><span>                </span><a href="#local-6989586621679400066"><span class="hs-identifier hs-var">tv</span></a><span>
</span><a name="line-1832"></a><span>                </span><span class="hs-special">(</span><a href="VarEnv.html#lookupVarEnv_NF"><span class="hs-identifier hs-var">lookupVarEnv_NF</span></a><span> </span><a href="#local-6989586621679400064"><span class="hs-identifier hs-var">var_ids</span></a><span> </span><a href="#local-6989586621679400066"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-1833"></a><span>                </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a><span> </span><a href="#local-6989586621679400064"><span class="hs-identifier hs-var">var_ids</span></a><span class="hs-special">)</span><span>
</span><a name="line-1834"></a><span>                         </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400066"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1835"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679400066"><a href="#local-6989586621679400066"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679400063"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-1836"></a><span>
</span><a name="line-1837"></a><span class="hs-comment">-- | Extract a well-scoped list of variables from a deterministic set of</span><span>
</span><a name="line-1838"></a><span class="hs-comment">-- variables. The result is deterministic.</span><span>
</span><a name="line-1839"></a><span class="hs-comment">-- NB: There used to exist varSetElemsWellScoped :: VarSet -&gt; [Var] which</span><span>
</span><a name="line-1840"></a><span class="hs-comment">-- took a non-deterministic set and produced a non-deterministic</span><span>
</span><a name="line-1841"></a><span class="hs-comment">-- well-scoped list. If you care about the list being well-scoped you also</span><span>
</span><a name="line-1842"></a><span class="hs-comment">-- most likely care about it being in deterministic order.</span><span>
</span><a name="line-1843"></a><span class="hs-identifier">dVarSetElemsWellScoped</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarSet.html#DVarSet"><span class="hs-identifier hs-type">DVarSet</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span>
</span><a name="line-1844"></a><a name="dVarSetElemsWellScoped"><a href="Type.html#dVarSetElemsWellScoped"><span class="hs-identifier">dVarSetElemsWellScoped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="VarSet.html#dVarSetElems"><span class="hs-identifier hs-var">dVarSetElems</span></a><span>
</span><a name="line-1845"></a><span>
</span><a name="line-1846"></a><span class="hs-comment">-- | Get the free vars of a type in scoped order</span><span>
</span><a name="line-1847"></a><span class="hs-identifier">tyCoVarsOfTypeWellScoped</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1848"></a><a name="tyCoVarsOfTypeWellScoped"><a href="Type.html#tyCoVarsOfTypeWellScoped"><span class="hs-identifier">tyCoVarsOfTypeWellScoped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TyCoRep.html#tyCoVarsOfTypeList"><span class="hs-identifier hs-var">tyCoVarsOfTypeList</span></a><span>
</span><a name="line-1849"></a><span>
</span><a name="line-1850"></a><span class="hs-comment">-- | Get the free vars of types in scoped order</span><span>
</span><a name="line-1851"></a><span class="hs-identifier">tyCoVarsOfTypesWellScoped</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a><span class="hs-special">]</span><span>
</span><a name="line-1852"></a><a name="tyCoVarsOfTypesWellScoped"><a href="Type.html#tyCoVarsOfTypesWellScoped"><span class="hs-identifier">tyCoVarsOfTypesWellScoped</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#toposortTyVars"><span class="hs-identifier hs-var">toposortTyVars</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="TyCoRep.html#tyCoVarsOfTypesList"><span class="hs-identifier hs-var">tyCoVarsOfTypesList</span></a><span>
</span><a name="line-1853"></a><span>
</span><a name="line-1854"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Type families}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1861"></a><span>
</span><a name="line-1862"></a><span class="hs-identifier">mkFamilyTyConApp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1863"></a><span class="hs-comment">-- ^ Given a family instance TyCon and its arg types, return the</span><span>
</span><a name="line-1864"></a><span class="hs-comment">-- corresponding family type.  E.g:</span><span>
</span><a name="line-1865"></a><span class="hs-comment">--</span><span>
</span><a name="line-1866"></a><span class="hs-comment">-- &gt; data family T a</span><span>
</span><a name="line-1867"></a><span class="hs-comment">-- &gt; data instance T (Maybe b) = MkT b</span><span>
</span><a name="line-1868"></a><span class="hs-comment">--</span><span>
</span><a name="line-1869"></a><span class="hs-comment">-- Where the instance tycon is :RTL, so:</span><span>
</span><a name="line-1870"></a><span class="hs-comment">--</span><span>
</span><a name="line-1871"></a><span class="hs-comment">-- &gt; mkFamilyTyConApp :RTL Int  =  T (Maybe Int)</span><span>
</span><a name="line-1872"></a><a name="mkFamilyTyConApp"><a href="Type.html#mkFamilyTyConApp"><span class="hs-identifier">mkFamilyTyConApp</span></a></a><span> </span><a name="local-6989586621679400068"><a href="#local-6989586621679400068"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400069"><a href="#local-6989586621679400069"><span class="hs-identifier">tys</span></a></a><span>
</span><a name="line-1873"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400070"><a href="#local-6989586621679400070"><span class="hs-identifier">fam_tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400071"><a href="#local-6989586621679400071"><span class="hs-identifier">fam_tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span> </span><a href="#local-6989586621679400068"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1874"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679400072"><a href="#local-6989586621679400072"><span class="hs-identifier">tvs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConTyVars</span><span> </span><a href="#local-6989586621679400068"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1875"></a><span>        </span><a name="local-6989586621679400073"><a href="#local-6989586621679400073"><span class="hs-identifier">fam_subst</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><a href="Util.html#equalLength"><span class="hs-identifier hs-var">tys</span></a><span class="hs-special">,</span><span> </span><a href="Util.html#equalLength"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="Util.html#equalLength"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1876"></a><span>                    </span><a href="TyCoRep.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a><span> </span><a href="#local-6989586621679400072"><span class="hs-identifier hs-var">tvs</span></a><span> </span><a href="#local-6989586621679400069"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1877"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-6989586621679400070"><span class="hs-identifier hs-var">fam_tc</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#substTys"><span class="hs-identifier hs-var">substTys</span></a><span> </span><a href="#local-6989586621679400073"><span class="hs-identifier hs-var">fam_subst</span></a><span> </span><a href="#local-6989586621679400071"><span class="hs-identifier hs-var">fam_tys</span></a><span class="hs-special">)</span><span>
</span><a name="line-1878"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1879"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><a href="#local-6989586621679400068"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679400069"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-1880"></a><span>
</span><a name="line-1881"></a><span class="hs-comment">-- | Get the type on the LHS of a coercion induced by a type/data</span><span>
</span><a name="line-1882"></a><span class="hs-comment">-- family instance.</span><span>
</span><a name="line-1883"></a><span class="hs-identifier">coAxNthLHS</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoAxiom.html#CoAxiom"><span class="hs-identifier hs-type">CoAxiom</span></a><span> </span><a href="#local-6989586621679399373"><span class="hs-identifier hs-type">br</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1884"></a><a name="coAxNthLHS"><a href="Type.html#coAxNthLHS"><span class="hs-identifier">coAxNthLHS</span></a></a><span> </span><a name="local-6989586621679400074"><a href="#local-6989586621679400074"><span class="hs-identifier">ax</span></a></a><span> </span><a name="local-6989586621679400075"><a href="#local-6989586621679400075"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1885"></a><span>  </span><a href="Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a><span> </span><a href="#local-6989586621679400074"><span class="hs-identifier hs-var">ax</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxBranchLHS"><span class="hs-identifier hs-var">coAxBranchLHS</span></a><span> </span><span class="hs-special">(</span><a href="CoAxiom.html#coAxiomNthBranch"><span class="hs-identifier hs-var">coAxiomNthBranch</span></a><span> </span><a href="#local-6989586621679400074"><span class="hs-identifier hs-var">ax</span></a><span> </span><a href="#local-6989586621679400075"><span class="hs-identifier hs-var">ind</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1886"></a><span>
</span><a name="line-1887"></a><span class="hs-comment">-- | Pretty prints a 'TyCon', using the family instance in case of a</span><span>
</span><a name="line-1888"></a><span class="hs-comment">-- representation tycon.  For example:</span><span>
</span><a name="line-1889"></a><span class="hs-comment">--</span><span>
</span><a name="line-1890"></a><span class="hs-comment">-- &gt; data T [a] = ...</span><span>
</span><a name="line-1891"></a><span class="hs-comment">--</span><span>
</span><a name="line-1892"></a><span class="hs-comment">-- In that case we want to print @T [a]@, where @T@ is the family 'TyCon'</span><span>
</span><a name="line-1893"></a><span class="hs-identifier">pprSourceTyCon</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a><span>
</span><a name="line-1894"></a><a name="pprSourceTyCon"><a href="Type.html#pprSourceTyCon"><span class="hs-identifier">pprSourceTyCon</span></a></a><span> </span><a name="local-6989586621679400076"><a href="#local-6989586621679400076"><span class="hs-identifier">tycon</span></a></a><span>
</span><a name="line-1895"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400077"><a href="#local-6989586621679400077"><span class="hs-identifier">fam_tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400078"><a href="#local-6989586621679400078"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="TyCon.html#tyConFamInst_maybe"><span class="hs-identifier hs-var">tyConFamInst_maybe</span></a><span> </span><a href="#local-6989586621679400076"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1896"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679400077"><span class="hs-identifier hs-var">fam_tc</span></a><span> </span><span class="hs-special">`</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400078"><span class="hs-identifier hs-var">tys</span></a><span>        </span><span class="hs-comment">-- can't be FunTyCon</span><span>
</span><a name="line-1897"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-1898"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400076"><span class="hs-identifier hs-var">tycon</span></a><span>
</span><a name="line-1899"></a><span>
</span><a name="line-1900"></a><span class="hs-comment">-- @isTauTy@ tests if a type has no foralls</span><span>
</span><a name="line-1901"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1902"></a><a name="isFamFreeTy"><a href="Type.html#isFamFreeTy"><span class="hs-identifier">isFamFreeTy</span></a></a><span> </span><a name="local-6989586621679400079"><a href="#local-6989586621679400079"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400080"><a href="#local-6989586621679400080"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679400079"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400080"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-1903"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1904"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1905"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400081"><a href="#local-6989586621679400081"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400082"><a href="#local-6989586621679400082"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400082"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="TyCon.html#isFamFreeTyCon"><span class="hs-identifier hs-var">isFamFreeTyCon</span></a><span> </span><a href="#local-6989586621679400081"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-1906"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679400083"><a href="#local-6989586621679400083"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679400084"><a href="#local-6989586621679400084"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400083"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400084"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1907"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679400085"><a href="#local-6989586621679400085"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679400086"><a href="#local-6989586621679400086"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400085"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400086"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-1908"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400087"><a href="#local-6989586621679400087"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400087"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1909"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679400088"><a href="#local-6989586621679400088"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isFamFreeTy"><span class="hs-identifier hs-var">isFamFreeTy</span></a><span> </span><a href="#local-6989586621679400088"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-1910"></a><span class="hs-identifier">isFamFreeTy</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>  </span><span class="hs-comment">-- Not sure about this</span><span>
</span><a name="line-1911"></a><span>
</span><a name="line-1912"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Liftedness}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-1919"></a><span>
</span><a name="line-1920"></a><span class="hs-comment">-- | Returns Just True if this type is surely lifted, Just False</span><span>
</span><a name="line-1921"></a><span class="hs-comment">-- if it is surely unlifted, Nothing if we can't be sure (i.e., it is</span><span>
</span><a name="line-1922"></a><span class="hs-comment">-- levity polymorphic), and panics if the kind does not have the shape</span><span>
</span><a name="line-1923"></a><span class="hs-comment">-- TYPE r.</span><span>
</span><a name="line-1924"></a><span class="hs-identifier">isLiftedType_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1925"></a><a name="isLiftedType_maybe"><a href="Type.html#isLiftedType_maybe"><span class="hs-identifier">isLiftedType_maybe</span></a></a><span> </span><a name="local-6989586621679400089"><a href="#local-6989586621679400089"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400090"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679400089"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-1926"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1927"></a><span>    </span><a name="local-6989586621679400090"><a href="#local-6989586621679400090"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679400091"><a href="#local-6989586621679400091"><span class="hs-identifier">rr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400092"><a href="#local-6989586621679400092"><span class="hs-identifier">rr'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679400091"><span class="hs-identifier hs-var">rr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400090"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400092"><span class="hs-identifier hs-var">rr'</span></a><span>
</span><a name="line-1928"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400093"><a href="#local-6989586621679400093"><span class="hs-identifier">lifted_rep</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-1929"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679400093"><span class="hs-identifier hs-var">lifted_rep</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#liftedRepDataConKey"><span class="hs-identifier hs-var">liftedRepDataConKey</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-1930"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-comment">-- everything else is unlifted</span><span>
</span><a name="line-1931"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>    </span><span class="hs-comment">-- levity polymorphic</span><span>
</span><a name="line-1932"></a><span>
</span><a name="line-1933"></a><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an unlifted type is.</span><span>
</span><a name="line-1934"></a><span class="hs-comment">-- Panics on levity polymorphic types.</span><span>
</span><a name="line-1935"></a><span class="hs-identifier">isUnliftedType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1936"></a><span>        </span><span class="hs-comment">-- isUnliftedType returns True for forall'd unlifted types:</span><span>
</span><a name="line-1937"></a><span>        </span><span class="hs-comment">--      x :: forall a. Int#</span><span>
</span><a name="line-1938"></a><span>        </span><span class="hs-comment">-- I found bindings like these were getting floated to the top level.</span><span>
</span><a name="line-1939"></a><span>        </span><span class="hs-comment">-- They are pretty bogus types, mind you.  It would be better never to</span><span>
</span><a name="line-1940"></a><span>        </span><span class="hs-comment">-- construct them</span><span>
</span><a name="line-1941"></a><a name="isUnliftedType"><a href="Type.html#isUnliftedType"><span class="hs-identifier">isUnliftedType</span></a></a><span> </span><a name="local-6989586621679400094"><a href="#local-6989586621679400094"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1942"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="Type.html#isLiftedType_maybe"><span class="hs-identifier hs-var">isLiftedType_maybe</span></a><span> </span><a href="#local-6989586621679400094"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="Maybes.html#orElse"><span class="hs-identifier hs-var">orElse</span></a><span class="hs-special">`</span><span>
</span><a name="line-1943"></a><span>         </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;isUnliftedType&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400094"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400094"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1944"></a><span>
</span><a name="line-1945"></a><span class="hs-comment">-- | Is this a type of kind RuntimeRep? (e.g. LiftedRep)</span><span>
</span><a name="line-1946"></a><span class="hs-identifier">isRuntimeRepKindedTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1947"></a><a name="isRuntimeRepKindedTy"><a href="Type.html#isRuntimeRepKindedTy"><span class="hs-identifier">isRuntimeRepKindedTy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#isRuntimeRepTy"><span class="hs-identifier hs-var">isRuntimeRepTy</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span>
</span><a name="line-1948"></a><span>
</span><a name="line-1949"></a><span class="hs-comment">-- | Drops prefix of RuntimeRep constructors in 'TyConApp's. Useful for e.g.</span><span>
</span><a name="line-1950"></a><span class="hs-comment">-- dropping 'LiftedRep arguments of unboxed tuple TyCon applications:</span><span>
</span><a name="line-1951"></a><span class="hs-comment">--</span><span>
</span><a name="line-1952"></a><span class="hs-comment">--   dropRuntimeRepArgs [ 'LiftedRep, 'IntRep</span><span>
</span><a name="line-1953"></a><span class="hs-comment">--                      , String, Int# ] == [String, Int#]</span><span>
</span><a name="line-1954"></a><span class="hs-comment">--</span><span>
</span><a name="line-1955"></a><span class="hs-identifier">dropRuntimeRepArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-1956"></a><a name="dropRuntimeRepArgs"><a href="Type.html#dropRuntimeRepArgs"><span class="hs-identifier">dropRuntimeRepArgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span> </span><a href="Type.html#isRuntimeRepKindedTy"><span class="hs-identifier hs-var">isRuntimeRepKindedTy</span></a><span>
</span><a name="line-1957"></a><span>
</span><a name="line-1958"></a><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type. For instance,</span><span>
</span><a name="line-1959"></a><span class="hs-comment">-- @getRuntimeRep_maybe Int = LiftedRep@. Returns 'Nothing' if this is not</span><span>
</span><a name="line-1960"></a><span class="hs-comment">-- possible.</span><span>
</span><a name="line-1961"></a><span class="hs-identifier">getRuntimeRep_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span>
</span><a name="line-1962"></a><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1963"></a><a name="getRuntimeRep_maybe"><a href="Type.html#getRuntimeRep_maybe"><span class="hs-identifier">getRuntimeRep_maybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#getRuntimeRepFromKind_maybe"><span class="hs-identifier hs-var">getRuntimeRepFromKind_maybe</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span>
</span><a name="line-1964"></a><span>
</span><a name="line-1965"></a><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type. For instance,</span><span>
</span><a name="line-1966"></a><span class="hs-comment">-- @getRuntimeRep_maybe Int = LiftedRep@. Panics if this is not possible.</span><span>
</span><a name="line-1967"></a><span class="hs-identifier">getRuntimeRep</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1968"></a><a name="getRuntimeRep"><a href="Type.html#getRuntimeRep"><span class="hs-identifier">getRuntimeRep</span></a></a><span> </span><a name="local-6989586621679400095"><a href="#local-6989586621679400095"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1969"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getRuntimeRep_maybe"><span class="hs-identifier hs-var">getRuntimeRep_maybe</span></a><span> </span><a href="#local-6989586621679400095"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1970"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400096"><a href="#local-6989586621679400096"><span class="hs-identifier">r</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679400096"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1971"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;getRuntimeRep&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400095"><span class="hs-identifier hs-var">ty</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400095"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1972"></a><span>
</span><a name="line-1973"></a><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type from its kind. For example,</span><span>
</span><a name="line-1974"></a><span class="hs-comment">-- @getRuntimeRepFromKind * = LiftedRep@; Panics if this is not possible.</span><span>
</span><a name="line-1975"></a><span class="hs-identifier">getRuntimeRepFromKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span>
</span><a name="line-1976"></a><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1977"></a><a name="getRuntimeRepFromKind"><a href="Type.html#getRuntimeRepFromKind"><span class="hs-identifier">getRuntimeRepFromKind</span></a></a><span> </span><a name="local-6989586621679400097"><a href="#local-6989586621679400097"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1978"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#getRuntimeRepFromKind_maybe"><span class="hs-identifier hs-var">getRuntimeRepFromKind_maybe</span></a><span> </span><a href="#local-6989586621679400097"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1979"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400098"><a href="#local-6989586621679400098"><span class="hs-identifier">r</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679400098"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1980"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;getRuntimeRepFromKind&quot;</span><span>
</span><a name="line-1981"></a><span>                           </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400097"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400097"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1982"></a><span>
</span><a name="line-1983"></a><span class="hs-comment">-- | Extract the RuntimeRep classifier of a type from its kind. For example,</span><span>
</span><a name="line-1984"></a><span class="hs-comment">-- @getRuntimeRepFromKind * = LiftedRep@; Returns 'Nothing' if this is not</span><span>
</span><a name="line-1985"></a><span class="hs-comment">-- possible.</span><span>
</span><a name="line-1986"></a><span class="hs-identifier">getRuntimeRepFromKind_maybe</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span>
</span><a name="line-1987"></a><span>                            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-1988"></a><a name="getRuntimeRepFromKind_maybe"><a href="Type.html#getRuntimeRepFromKind_maybe"><span class="hs-identifier">getRuntimeRepFromKind_maybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400099"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-1989"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1990"></a><span>    </span><a name="local-6989586621679400099"><a href="#local-6989586621679400099"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679400100"><a href="#local-6989586621679400100"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400101"><a href="#local-6989586621679400101"><span class="hs-identifier">k'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679400100"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400099"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400101"><span class="hs-identifier hs-var">k'</span></a><span>
</span><a name="line-1991"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400102"><a href="#local-6989586621679400102"><span class="hs-identifier">k</span></a></a><span>
</span><a name="line-1992"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400103"><a href="#local-6989586621679400103"><span class="hs-identifier">_tc</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679400104"><a href="#local-6989586621679400104"><span class="hs-identifier">arg</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400102"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-1993"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">_tc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">hasKey</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tYPETyConKey</span><span class="hs-special">,</span><span> </span><a href="PrelNames.html#tYPETyConKey"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="PrelNames.html#tYPETyConKey"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-1994"></a><span>        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679400104"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-1995"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-1996"></a><span>
</span><a name="line-1997"></a><span class="hs-identifier">isUnboxedTupleType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-1998"></a><a name="isUnboxedTupleType"><a href="Type.html#isUnboxedTupleType"><span class="hs-identifier">isUnboxedTupleType</span></a></a><span> </span><a name="local-6989586621679400105"><a href="#local-6989586621679400105"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-1999"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679400105"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#tupleRepDataConKey"><span class="hs-identifier hs-var">tupleRepDataConKey</span></a><span>
</span><a name="line-2000"></a><span>  </span><span class="hs-comment">-- NB: Do not use typePrimRep, as that can't tell the difference between</span><span>
</span><a name="line-2001"></a><span>  </span><span class="hs-comment">-- unboxed tuples and unboxed sums</span><span>
</span><a name="line-2002"></a><span>
</span><a name="line-2003"></a><span>
</span><a name="line-2004"></a><span class="hs-identifier">isUnboxedSumType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2005"></a><a name="isUnboxedSumType"><a href="Type.html#isUnboxedSumType"><span class="hs-identifier">isUnboxedSumType</span></a></a><span> </span><a name="local-6989586621679400106"><a href="#local-6989586621679400106"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2006"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#getRuntimeRep"><span class="hs-identifier hs-var">getRuntimeRep</span></a><span> </span><a href="#local-6989586621679400106"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Unique.html#hasKey"><span class="hs-identifier hs-var">hasKey</span></a><span class="hs-special">`</span><span> </span><a href="PrelNames.html#sumRepDataConKey"><span class="hs-identifier hs-var">sumRepDataConKey</span></a><span>
</span><a name="line-2007"></a><span>
</span><a name="line-2008"></a><span class="hs-comment">-- | See &quot;Type#type_classification&quot; for what an algebraic type is.</span><span>
</span><a name="line-2009"></a><span class="hs-comment">-- Should only be applied to /types/, as opposed to e.g. partially</span><span>
</span><a name="line-2010"></a><span class="hs-comment">-- saturated type constructors</span><span>
</span><a name="line-2011"></a><span class="hs-identifier">isAlgType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2012"></a><a name="isAlgType"><a href="Type.html#isAlgType"><span class="hs-identifier">isAlgType</span></a></a><span> </span><a name="local-6989586621679400107"><a href="#local-6989586621679400107"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2013"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400107"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2014"></a><span>      </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400108"><a href="#local-6989586621679400108"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400109"><a href="#local-6989586621679400109"><span class="hs-identifier">ty_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="Util.html#lengthIs"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2015"></a><span>                            </span><a href="TyCon.html#isAlgTyCon"><span class="hs-identifier hs-var">isAlgTyCon</span></a><span> </span><a href="#local-6989586621679400108"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2016"></a><span>      </span><a name="local-6989586621679400110"><a href="#local-6989586621679400110"><span class="hs-identifier">_other</span></a></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2017"></a><span>
</span><a name="line-2018"></a><span class="hs-comment">-- | Check whether a type is a data family type</span><span>
</span><a name="line-2019"></a><span class="hs-identifier">isDataFamilyAppType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2020"></a><a name="isDataFamilyAppType"><a href="Type.html#isDataFamilyAppType"><span class="hs-identifier">isDataFamilyAppType</span></a></a><span> </span><a name="local-6989586621679400111"><a href="#local-6989586621679400111"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a><span> </span><a href="#local-6989586621679400111"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2021"></a><span>                           </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400112"><a href="#local-6989586621679400112"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#isDataFamilyTyCon"><span class="hs-identifier hs-var">isDataFamilyTyCon</span></a><span> </span><a href="#local-6989586621679400112"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2022"></a><span>                           </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2023"></a><span>
</span><a name="line-2024"></a><span class="hs-comment">-- | Computes whether an argument (or let right hand side) should</span><span>
</span><a name="line-2025"></a><span class="hs-comment">-- be computed strictly or lazily, based only on its type.</span><span>
</span><a name="line-2026"></a><span class="hs-comment">-- Currently, it's just 'isUnliftedType'. Panics on levity-polymorphic types.</span><span>
</span><a name="line-2027"></a><span class="hs-identifier">isStrictType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2028"></a><a name="isStrictType"><a href="Type.html#isStrictType"><span class="hs-identifier">isStrictType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isUnliftedType"><span class="hs-identifier hs-var">isUnliftedType</span></a><span>
</span><a name="line-2029"></a><span>
</span><a name="line-2030"></a><span class="hs-identifier">isPrimitiveType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2031"></a><span class="hs-comment">-- ^ Returns true of types that are opaque to Haskell.</span><span>
</span><a name="line-2032"></a><a name="isPrimitiveType"><a href="Type.html#isPrimitiveType"><span class="hs-identifier">isPrimitiveType</span></a></a><span> </span><a name="local-6989586621679400113"><a href="#local-6989586621679400113"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a><span> </span><a href="#local-6989586621679400113"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2033"></a><span>                        </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400114"><a href="#local-6989586621679400114"><span class="hs-identifier">tc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400115"><a href="#local-6989586621679400115"><span class="hs-identifier">ty_args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">lengthIs</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tyConArity</span><span> </span><a href="Util.html#lengthIs"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2034"></a><span>                                              </span><a href="TyCon.html#isPrimTyCon"><span class="hs-identifier hs-var">isPrimTyCon</span></a><span> </span><a href="#local-6989586621679400114"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2035"></a><span>                        </span><span class="hs-identifier">_</span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2036"></a><span>
</span><a name="line-2037"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Join points}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2044"></a><span>
</span><a name="line-2045"></a><span class="hs-comment">-- | Determine whether a type could be the type of a join point of given total</span><span>
</span><a name="line-2046"></a><span class="hs-comment">-- arity, according to the polymorphism rule. A join point cannot be polymorphic</span><span>
</span><a name="line-2047"></a><span class="hs-comment">-- in its return type, since given</span><span>
</span><a name="line-2048"></a><span class="hs-comment">--   join j @a @b x y z = e1 in e2,</span><span>
</span><a name="line-2049"></a><span class="hs-comment">-- the types of e1 and e2 must be the same, and a and b are not in scope for e2.</span><span>
</span><a name="line-2050"></a><span class="hs-comment">-- (See Note [The polymorphism rule of join points] in CoreSyn.) Returns False</span><span>
</span><a name="line-2051"></a><span class="hs-comment">-- also if the type simply doesn't have enough arguments.</span><span>
</span><a name="line-2052"></a><span class="hs-comment">--</span><span>
</span><a name="line-2053"></a><span class="hs-comment">-- Note that we need to know how many arguments (type *and* value) the putative</span><span>
</span><a name="line-2054"></a><span class="hs-comment">-- join point takes; for instance, if</span><span>
</span><a name="line-2055"></a><span class="hs-comment">--   j :: forall a. a -&gt; Int</span><span>
</span><a name="line-2056"></a><span class="hs-comment">-- then j could be a binary join point returning an Int, but it could *not* be a</span><span>
</span><a name="line-2057"></a><span class="hs-comment">-- unary join point returning a -&gt; Int.</span><span>
</span><a name="line-2058"></a><span class="hs-comment">--</span><span>
</span><a name="line-2059"></a><span class="hs-comment">-- TODO: See Note [Excess polymorphism and join points]</span><span>
</span><a name="line-2060"></a><span class="hs-identifier">isValidJoinPointType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="BasicTypes.html#JoinArity"><span class="hs-identifier hs-type">JoinArity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2061"></a><a name="isValidJoinPointType"><a href="Type.html#isValidJoinPointType"><span class="hs-identifier">isValidJoinPointType</span></a></a><span> </span><a name="local-6989586621679400116"><a href="#local-6989586621679400116"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621679400117"><a href="#local-6989586621679400117"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2062"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400118"><span class="hs-identifier hs-var">valid_under</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span> </span><a href="#local-6989586621679400116"><span class="hs-identifier hs-var">arity</span></a><span> </span><a href="#local-6989586621679400117"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2063"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2064"></a><span>    </span><a name="local-6989586621679400118"><a href="#local-6989586621679400118"><span class="hs-identifier">valid_under</span></a></a><span> </span><a name="local-6989586621679400119"><a href="#local-6989586621679400119"><span class="hs-identifier">tvs</span></a></a><span> </span><a name="local-6989586621679400120"><a href="#local-6989586621679400120"><span class="hs-identifier">arity</span></a></a><span> </span><a name="local-6989586621679400121"><a href="#local-6989586621679400121"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2065"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679400120"><span class="hs-identifier hs-var">arity</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2066"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="VarSet.html#isEmptyVarSet"><span class="hs-identifier hs-var">isEmptyVarSet</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400119"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#intersectVarSet"><span class="hs-identifier hs-var">intersectVarSet</span></a><span class="hs-special">`</span><span> </span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="#local-6989586621679400121"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2067"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400122"><a href="#local-6989586621679400122"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400123"><a href="#local-6989586621679400123"><span class="hs-identifier">ty'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitForAllTy_maybe"><span class="hs-identifier hs-var">splitForAllTy_maybe</span></a><span> </span><a href="#local-6989586621679400121"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2068"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400118"><span class="hs-identifier hs-var">valid_under</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400119"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#extendVarSet"><span class="hs-identifier hs-var">extendVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400122"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400120"><span class="hs-identifier hs-var">arity</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400123"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-2069"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679400124"><a href="#local-6989586621679400124"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a><span> </span><a href="#local-6989586621679400121"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2070"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400118"><span class="hs-identifier hs-var">valid_under</span></a><span> </span><a href="#local-6989586621679400119"><span class="hs-identifier hs-var">tvs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400120"><span class="hs-identifier hs-var">arity</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400124"><span class="hs-identifier hs-var">res_ty</span></a><span>
</span><a name="line-2071"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2072"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2073"></a><span>
</span><a name="line-2074"></a><span class="hs-comment">{- Note [Excess polymorphism and join points]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In principle, if a function would be a join point except that it fails
the polymorphism rule (see Note [The polymorphism rule of join points] in
CoreSyn), it can still be made a join point with some effort. This is because
all tail calls must return the same type (they return to the same context!), and
thus if the return type depends on an argument, that argument must always be the
same.

For instance, consider:

  let f :: forall a. a -&gt; Char -&gt; [a]
      f @a x c = ... f @a y 'a' ...
  in ... f @Int 1 'b' ... f @Int 2 'c' ...

(where the calls are tail calls). `f` fails the polymorphism rule because its
return type is [a], where [a] is bound. But since the type argument is always
'Int', we can rewrite it as:

  let f' :: Int -&gt; Char -&gt; [Int]
      f' x c = ... f' y 'a' ...
  in ... f' 1 'b' ... f 2 'c' ...

and now we can make f' a join point:

  join f' :: Int -&gt; Char -&gt; [Int]
       f' x c = ... jump f' y 'a' ...
  in ... jump f' 1 'b' ... jump f' 2 'c' ...

It's not clear that this comes up often, however. TODO: Measure how often and
add this analysis if necessary.  See Trac #14620.


************************************************************************
*                                                                      *
\subsection{Sequencing on types}
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2113"></a><span>
</span><a name="line-2114"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2115"></a><a name="seqType"><a href="Type.html#seqType"><span class="hs-identifier">seqType</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679400125"><a href="#local-6989586621679400125"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400125"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2116"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679400126"><a href="#local-6989586621679400126"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400126"><span class="hs-identifier hs-var">tv</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2117"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679400127"><a href="#local-6989586621679400127"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400128"><a href="#local-6989586621679400128"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-6989586621679400127"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-6989586621679400128"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2118"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679400129"><a href="#local-6989586621679400129"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400130"><a href="#local-6989586621679400130"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-6989586621679400129"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-6989586621679400130"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2119"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400131"><a href="#local-6989586621679400131"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400132"><a href="#local-6989586621679400132"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400131"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a><span> </span><a href="#local-6989586621679400132"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2120"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679400133"><a href="#local-6989586621679400133"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679400134"><a href="#local-6989586621679400134"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400133"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-6989586621679400134"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2121"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679400135"><a href="#local-6989586621679400135"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679400136"><a href="#local-6989586621679400136"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-6989586621679400135"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a><span> </span><a href="#local-6989586621679400136"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2122"></a><span class="hs-identifier">seqType</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679400137"><a href="#local-6989586621679400137"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#seqCo"><span class="hs-identifier hs-var">seqCo</span></a><span> </span><a href="#local-6989586621679400137"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2123"></a><span>
</span><a name="line-2124"></a><span class="hs-identifier">seqTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2125"></a><a name="seqTypes"><a href="Type.html#seqTypes"><span class="hs-identifier">seqTypes</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-2126"></a><span class="hs-identifier">seqTypes</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679400138"><a href="#local-6989586621679400138"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679400139"><a href="#local-6989586621679400139"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#seqType"><span class="hs-identifier hs-var">seqType</span></a><span> </span><a href="#local-6989586621679400138"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="Type.html#seqTypes"><span class="hs-identifier hs-var">seqTypes</span></a><span> </span><a href="#local-6989586621679400139"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2127"></a><span>
</span><a name="line-2128"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Comparison for types
        (We don't use instances so that we know where it happens)
*                                                                      *
************************************************************************

Note [Equality on AppTys]
~~~~~~~~~~~~~~~~~~~~~~~~~
In our cast-ignoring equality, we want to say that the following two
are equal:

  (Maybe |&gt; co) (Int |&gt; co')   ~?       Maybe Int

But the left is an AppTy while the right is a TyConApp. The solution is
to use repSplitAppTy_maybe to break up the TyConApp into its pieces and
then continue. Easy to do, but also easy to forget to do.

-}</span><span>
</span><a name="line-2148"></a><span>
</span><a name="line-2149"></a><span class="hs-identifier">eqType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2150"></a><span class="hs-comment">-- ^ Type equality on source types. Does not look through @newtypes@ or</span><span>
</span><a name="line-2151"></a><span class="hs-comment">-- 'PredType's, but it does look through type synonyms.</span><span>
</span><a name="line-2152"></a><span class="hs-comment">-- This first checks that the kinds of the types are equal and then</span><span>
</span><a name="line-2153"></a><span class="hs-comment">-- checks whether the types are equal, ignoring casts and coercions.</span><span>
</span><a name="line-2154"></a><span class="hs-comment">-- (The kind check is a recursive call, but since all kinds have type</span><span>
</span><a name="line-2155"></a><span class="hs-comment">-- @Type@, there is no need to check the types of kinds.)</span><span>
</span><a name="line-2156"></a><span class="hs-comment">-- See also Note [Non-trivial definitional equality] in TyCoRep.</span><span>
</span><a name="line-2157"></a><a name="eqType"><a href="Type.html#eqType"><span class="hs-identifier">eqType</span></a></a><span> </span><a name="local-6989586621679400140"><a href="#local-6989586621679400140"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400141"><a href="#local-6989586621679400141"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#nonDetCmpType"><span class="hs-identifier hs-var">nonDetCmpType</span></a><span> </span><a href="#local-6989586621679400140"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400141"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2158"></a><span>  </span><span class="hs-comment">-- It's OK to use nonDetCmpType here and eqType is deterministic,</span><span>
</span><a name="line-2159"></a><span>  </span><span class="hs-comment">-- nonDetCmpType does equality deterministically</span><span>
</span><a name="line-2160"></a><span>
</span><a name="line-2161"></a><span class="hs-comment">-- | Compare types with respect to a (presumably) non-empty 'RnEnv2'.</span><span>
</span><a name="line-2162"></a><span class="hs-identifier">eqTypeX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2163"></a><a name="eqTypeX"><a href="Type.html#eqTypeX"><span class="hs-identifier">eqTypeX</span></a></a><span> </span><a name="local-6989586621679400142"><a href="#local-6989586621679400142"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679400143"><a href="#local-6989586621679400143"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400144"><a href="#local-6989586621679400144"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var">nonDetCmpTypeX</span></a><span> </span><a href="#local-6989586621679400142"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400143"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400144"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2164"></a><span>  </span><span class="hs-comment">-- It's OK to use nonDetCmpType here and eqTypeX is deterministic,</span><span>
</span><a name="line-2165"></a><span>  </span><span class="hs-comment">-- nonDetCmpTypeX does equality deterministically</span><span>
</span><a name="line-2166"></a><span>
</span><a name="line-2167"></a><span class="hs-comment">-- | Type equality on lists of types, looking through type synonyms</span><span>
</span><a name="line-2168"></a><span class="hs-comment">-- but not newtypes.</span><span>
</span><a name="line-2169"></a><span class="hs-identifier">eqTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2170"></a><a name="eqTypes"><a href="Type.html#eqTypes"><span class="hs-identifier">eqTypes</span></a></a><span> </span><a name="local-6989586621679400145"><a href="#local-6989586621679400145"><span class="hs-identifier">tys1</span></a></a><span> </span><a name="local-6989586621679400146"><a href="#local-6989586621679400146"><span class="hs-identifier">tys2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Util.html#isEqual"><span class="hs-identifier hs-var">isEqual</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Type.html#nonDetCmpTypes"><span class="hs-identifier hs-var">nonDetCmpTypes</span></a><span> </span><a href="#local-6989586621679400145"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-6989586621679400146"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2171"></a><span>  </span><span class="hs-comment">-- It's OK to use nonDetCmpType here and eqTypes is deterministic,</span><span>
</span><a name="line-2172"></a><span>  </span><span class="hs-comment">-- nonDetCmpTypes does equality deterministically</span><span>
</span><a name="line-2173"></a><span>
</span><a name="line-2174"></a><span class="hs-identifier">eqVarBndrs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span>
</span><a name="line-2175"></a><span class="hs-comment">-- Check that the var lists are the same length</span><span>
</span><a name="line-2176"></a><span class="hs-comment">-- and have matching kinds; if so, extend the RnEnv2</span><span>
</span><a name="line-2177"></a><span class="hs-comment">-- Returns Nothing if they don't match</span><span>
</span><a name="line-2178"></a><a name="eqVarBndrs"><a href="Type.html#eqVarBndrs"><span class="hs-identifier">eqVarBndrs</span></a></a><span> </span><a name="local-6989586621679400147"><a href="#local-6989586621679400147"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-2179"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679400147"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-2180"></a><span class="hs-identifier">eqVarBndrs</span><span> </span><a name="local-6989586621679400148"><a href="#local-6989586621679400148"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400149"><a href="#local-6989586621679400149"><span class="hs-identifier">tv1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679400150"><a href="#local-6989586621679400150"><span class="hs-identifier">tvs1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679400151"><a href="#local-6989586621679400151"><span class="hs-identifier">tv2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679400152"><a href="#local-6989586621679400152"><span class="hs-identifier">tvs2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2181"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Type.html#eqTypeX"><span class="hs-identifier hs-var">eqTypeX</span></a><span> </span><a href="#local-6989586621679400148"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400149"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400151"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2182"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#eqVarBndrs"><span class="hs-identifier hs-var">eqVarBndrs</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#rnBndr2"><span class="hs-identifier hs-var">rnBndr2</span></a><span> </span><a href="#local-6989586621679400148"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400149"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-6989586621679400151"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400150"><span class="hs-identifier hs-var">tvs1</span></a><span> </span><a href="#local-6989586621679400152"><span class="hs-identifier hs-var">tvs2</span></a><span>
</span><a name="line-2183"></a><span class="hs-identifier">eqVarBndrs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-2184"></a><span>
</span><a name="line-2185"></a><span class="hs-comment">-- Now here comes the real worker</span><span>
</span><a name="line-2186"></a><span>
</span><a name="line-2187"></a><span class="hs-comment">{-
Note [nonDetCmpType nondeterminism]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
nonDetCmpType is implemented in terms of nonDetCmpTypeX. nonDetCmpTypeX
uses nonDetCmpTc which compares TyCons by their Unique value. Using Uniques for
ordering leads to nondeterminism. We hit the same problem in the TyVarTy case,
comparing type variables is nondeterministic, note the call to nonDetCmpVar in
nonDetCmpTypeX.
See Note [Unique Determinism] for more details.
-}</span><span>
</span><a name="line-2197"></a><span>
</span><a name="line-2198"></a><span class="hs-identifier">nonDetCmpType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2199"></a><a name="nonDetCmpType"><a href="Type.html#nonDetCmpType"><span class="hs-identifier">nonDetCmpType</span></a></a><span> </span><a name="local-6989586621679400153"><a href="#local-6989586621679400153"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400154"><a href="#local-6989586621679400154"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-2200"></a><span>  </span><span class="hs-comment">-- we know k1 and k2 have the same kind, because they both have kind *.</span><span>
</span><a name="line-2201"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var">nonDetCmpTypeX</span></a><span> </span><a href="#local-6989586621679400155"><span class="hs-identifier hs-var">rn_env</span></a><span> </span><a href="#local-6989586621679400153"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400154"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2202"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2203"></a><span>    </span><a name="local-6989586621679400155"><a href="#local-6989586621679400155"><span class="hs-identifier">rn_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkRnEnv2"><span class="hs-identifier hs-var">mkRnEnv2</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679400153"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679400154"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2204"></a><span>
</span><a name="line-2205"></a><span class="hs-identifier">nonDetCmpTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2206"></a><a name="nonDetCmpTypes"><a href="Type.html#nonDetCmpTypes"><span class="hs-identifier">nonDetCmpTypes</span></a></a><span> </span><a name="local-6989586621679400156"><a href="#local-6989586621679400156"><span class="hs-identifier">ts1</span></a></a><span> </span><a name="local-6989586621679400157"><a href="#local-6989586621679400157"><span class="hs-identifier">ts2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a><span> </span><a href="#local-6989586621679400158"><span class="hs-identifier hs-var">rn_env</span></a><span> </span><a href="#local-6989586621679400156"><span class="hs-identifier hs-var">ts1</span></a><span> </span><a href="#local-6989586621679400157"><span class="hs-identifier hs-var">ts2</span></a><span>
</span><a name="line-2207"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2208"></a><span>    </span><a name="local-6989586621679400158"><a href="#local-6989586621679400158"><span class="hs-identifier">rn_env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="VarEnv.html#mkRnEnv2"><span class="hs-identifier hs-var">mkRnEnv2</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400156"><span class="hs-identifier hs-var">ts1</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679400157"><span class="hs-identifier hs-var">ts2</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2209"></a><span>
</span><a name="line-2210"></a><span class="hs-comment">-- | An ordering relation between two 'Type's (known below as @t1 :: k1@</span><span>
</span><a name="line-2211"></a><span class="hs-comment">-- and @t2 :: k2@)</span><span>
</span><a name="line-2212"></a><span class="hs-keyword">data</span><span> </span><a name="TypeOrdering"><a href="Type.html#TypeOrdering"><span class="hs-identifier">TypeOrdering</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TLT"><a href="Type.html#TLT"><span class="hs-identifier">TLT</span></a></a><span>  </span><span class="hs-comment">-- ^ @t1 &lt; t2@</span><span>
</span><a name="line-2213"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="TEQ"><a href="Type.html#TEQ"><span class="hs-identifier">TEQ</span></a></a><span>  </span><span class="hs-comment">-- ^ @t1 ~ t2@ and there are no casts in either,</span><span>
</span><a name="line-2214"></a><span>                         </span><span class="hs-comment">-- therefore we can conclude @k1 ~ k2@</span><span>
</span><a name="line-2215"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="TEQX"><a href="Type.html#TEQX"><span class="hs-identifier">TEQX</span></a></a><span> </span><span class="hs-comment">-- ^ @t1 ~ t2@ yet one of the types contains a cast so</span><span>
</span><a name="line-2216"></a><span>                         </span><span class="hs-comment">-- they may differ in kind.</span><span>
</span><a name="line-2217"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><a name="TGT"><a href="Type.html#TGT"><span class="hs-identifier">TGT</span></a></a><span>  </span><span class="hs-comment">-- ^ @t1 &gt; t2@</span><span>
</span><a name="line-2218"></a><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Enum.html#Enum"><span class="hs-identifier hs-type">Enum</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Enum.html#Bounded"><span class="hs-identifier hs-type">Bounded</span></a><span class="hs-special">)</span><span>
</span><a name="line-2219"></a><span>
</span><a name="line-2220"></a><span class="hs-identifier">nonDetCmpTypeX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>  </span><span class="hs-comment">-- Main workhorse</span><span>
</span><a name="line-2221"></a><span>    </span><span class="hs-comment">-- See Note [Non-trivial definitional equality] in TyCoRep</span><span>
</span><a name="line-2222"></a><a name="nonDetCmpTypeX"><a href="Type.html#nonDetCmpTypeX"><span class="hs-identifier">nonDetCmpTypeX</span></a></a><span> </span><a name="local-6989586621679400159"><a href="#local-6989586621679400159"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679400160"><a href="#local-6989586621679400160"><span class="hs-identifier">orig_t1</span></a></a><span> </span><a name="local-6989586621679400161"><a href="#local-6989586621679400161"><span class="hs-identifier">orig_t2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2223"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400159"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400160"><span class="hs-identifier hs-var">orig_t1</span></a><span> </span><a href="#local-6989586621679400161"><span class="hs-identifier hs-var">orig_t2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2224"></a><span>      </span><span class="hs-comment">-- If there are casts then we also need to do a comparison of the kinds of</span><span>
</span><a name="line-2225"></a><span>      </span><span class="hs-comment">-- the types being compared</span><span>
</span><a name="line-2226"></a><span>      </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679400164"><span class="hs-identifier hs-var">toOrdering</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400159"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400162"><span class="hs-identifier hs-var">k1</span></a><span> </span><a href="#local-6989586621679400163"><span class="hs-identifier hs-var">k2</span></a><span>
</span><a name="line-2227"></a><span>      </span><a name="local-6989586621679400225"><a href="#local-6989586621679400225"><span class="hs-identifier">ty_ordering</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679400164"><span class="hs-identifier hs-var">toOrdering</span></a><span> </span><a href="#local-6989586621679400225"><span class="hs-identifier hs-var">ty_ordering</span></a><span>
</span><a name="line-2228"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2229"></a><span>    </span><a name="local-6989586621679400162"><a href="#local-6989586621679400162"><span class="hs-identifier">k1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400160"><span class="hs-identifier hs-var">orig_t1</span></a><span>
</span><a name="line-2230"></a><span>    </span><a name="local-6989586621679400163"><a href="#local-6989586621679400163"><span class="hs-identifier">k2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400161"><span class="hs-identifier hs-var">orig_t2</span></a><span>
</span><a name="line-2231"></a><span>
</span><a name="line-2232"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2233"></a><span>    </span><a name="local-6989586621679400164"><a href="#local-6989586621679400164"><span class="hs-identifier">toOrdering</span></a></a><span> </span><a href="Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-2234"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-2235"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-2236"></a><span>    </span><span class="hs-identifier">toOrdering</span><span> </span><a href="Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-2237"></a><span>
</span><a name="line-2238"></a><span>    </span><span class="hs-identifier">liftOrdering</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2239"></a><span>    </span><a name="local-6989586621679400165"><a href="#local-6989586621679400165"><span class="hs-identifier">liftOrdering</span></a></a><span> </span><span class="hs-identifier hs-var">LT</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a><span>
</span><a name="line-2240"></a><span>    </span><span class="hs-identifier">liftOrdering</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>
</span><a name="line-2241"></a><span>    </span><span class="hs-identifier">liftOrdering</span><span> </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a><span>
</span><a name="line-2242"></a><span>
</span><a name="line-2243"></a><span>    </span><span class="hs-identifier">thenCmpTy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2244"></a><span>    </span><a name="local-6989586621679400166"><a href="#local-6989586621679400166"><span class="hs-identifier">thenCmpTy</span></a></a><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>  </span><a name="local-6989586621679400170"><a href="#local-6989586621679400170"><span class="hs-identifier">rel</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400170"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2245"></a><span>    </span><span class="hs-identifier">thenCmpTy</span><span> </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span> </span><a name="local-6989586621679400171"><a href="#local-6989586621679400171"><span class="hs-identifier">rel</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400167"><span class="hs-identifier hs-var">hasCast</span></a><span> </span><a href="#local-6989586621679400171"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2246"></a><span>    </span><span class="hs-identifier">thenCmpTy</span><span> </span><a name="local-6989586621679400172"><a href="#local-6989586621679400172"><span class="hs-identifier">rel</span></a></a><span>  </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400172"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2247"></a><span>
</span><a name="line-2248"></a><span>    </span><span class="hs-identifier">hasCast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2249"></a><span>    </span><a name="local-6989586621679400167"><a href="#local-6989586621679400167"><span class="hs-identifier">hasCast</span></a></a><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQX"><span class="hs-identifier hs-var">TEQX</span></a><span>
</span><a name="line-2250"></a><span>    </span><span class="hs-identifier">hasCast</span><span> </span><a name="local-6989586621679400173"><a href="#local-6989586621679400173"><span class="hs-identifier">rel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400173"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-2251"></a><span>
</span><a name="line-2252"></a><span>    </span><span class="hs-comment">-- Returns both the resulting ordering relation between the two types</span><span>
</span><a name="line-2253"></a><span>    </span><span class="hs-comment">-- and whether either contains a cast.</span><span>
</span><a name="line-2254"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2255"></a><span>    </span><a name="local-6989586621679400168"><a href="#local-6989586621679400168"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679400174"><a href="#local-6989586621679400174"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679400175"><a href="#local-6989586621679400175"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400176"><a href="#local-6989586621679400176"><span class="hs-identifier">t2</span></a></a><span>
</span><a name="line-2256"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400177"><a href="#local-6989586621679400177"><span class="hs-identifier">t1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679400175"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400174"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400177"><span class="hs-identifier hs-var">t1'</span></a><span> </span><a href="#local-6989586621679400176"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2257"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400178"><a href="#local-6989586621679400178"><span class="hs-identifier">t2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679400176"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400174"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400175"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400178"><span class="hs-identifier hs-var">t2'</span></a><span>
</span><a name="line-2258"></a><span>
</span><a name="line-2259"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400179"><a href="#local-6989586621679400179"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679400180"><a href="#local-6989586621679400180"><span class="hs-identifier">tv1</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679400181"><a href="#local-6989586621679400181"><span class="hs-identifier">tv2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2260"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400165"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="VarEnv.html#rnOccL"><span class="hs-identifier hs-var">rnOccL</span></a><span> </span><a href="#local-6989586621679400179"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400180"><span class="hs-identifier hs-var">tv1</span></a><span> </span><span class="hs-special">`</span><a href="Var.html#nonDetCmpVar"><span class="hs-identifier hs-var">nonDetCmpVar</span></a><span class="hs-special">`</span><span> </span><a href="VarEnv.html#rnOccR"><span class="hs-identifier hs-var">rnOccR</span></a><span> </span><a href="#local-6989586621679400179"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400181"><span class="hs-identifier hs-var">tv2</span></a><span>
</span><a name="line-2261"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400182"><a href="#local-6989586621679400182"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679400183"><a href="#local-6989586621679400183"><span class="hs-identifier">tv1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679400184"><a href="#local-6989586621679400184"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679400185"><a href="#local-6989586621679400185"><span class="hs-identifier">tv2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679400186"><a href="#local-6989586621679400186"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2262"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400182"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400183"><span class="hs-identifier hs-var">tv1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400185"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2263"></a><span>        </span><span class="hs-special">`</span><a href="#local-6989586621679400166"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="VarEnv.html#rnBndr2"><span class="hs-identifier hs-var">rnBndr2</span></a><span> </span><a href="#local-6989586621679400182"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400183"><span class="hs-identifier hs-var">tv1</span></a><span> </span><a href="#local-6989586621679400185"><span class="hs-identifier hs-var">tv2</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400184"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400186"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2264"></a><span>        </span><span class="hs-comment">-- See Note [Equality on AppTys]</span><span>
</span><a name="line-2265"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400187"><a href="#local-6989586621679400187"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679400188"><a href="#local-6989586621679400188"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679400189"><a href="#local-6989586621679400189"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679400190"><a href="#local-6989586621679400190"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-2266"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400191"><a href="#local-6989586621679400191"><span class="hs-identifier">s2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400192"><a href="#local-6989586621679400192"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-6989586621679400190"><span class="hs-identifier hs-var">ty2</span></a><span>
</span><a name="line-2267"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400187"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400188"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621679400191"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679400166"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400187"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400189"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400192"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2268"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400193"><a href="#local-6989586621679400193"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679400194"><a href="#local-6989586621679400194"><span class="hs-identifier">ty1</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679400195"><a href="#local-6989586621679400195"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621679400196"><a href="#local-6989586621679400196"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2269"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400197"><a href="#local-6989586621679400197"><span class="hs-identifier">s1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400198"><a href="#local-6989586621679400198"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#repSplitAppTy_maybe"><span class="hs-identifier hs-var">repSplitAppTy_maybe</span></a><span> </span><a href="#local-6989586621679400194"><span class="hs-identifier hs-var">ty1</span></a><span>
</span><a name="line-2270"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400193"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400197"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621679400195"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679400166"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400193"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400198"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400196"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2271"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400199"><a href="#local-6989586621679400199"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679400200"><a href="#local-6989586621679400200"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679400201"><a href="#local-6989586621679400201"><span class="hs-identifier">t1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679400202"><a href="#local-6989586621679400202"><span class="hs-identifier">s2</span></a></a><span> </span><a name="local-6989586621679400203"><a href="#local-6989586621679400203"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2272"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400199"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400200"><span class="hs-identifier hs-var">s1</span></a><span> </span><a href="#local-6989586621679400202"><span class="hs-identifier hs-var">s2</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679400166"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400199"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400201"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400203"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2273"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400204"><a href="#local-6989586621679400204"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400205"><a href="#local-6989586621679400205"><span class="hs-identifier">tc1</span></a></a><span> </span><a name="local-6989586621679400206"><a href="#local-6989586621679400206"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400207"><a href="#local-6989586621679400207"><span class="hs-identifier">tc2</span></a></a><span> </span><a name="local-6989586621679400208"><a href="#local-6989586621679400208"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2274"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400165"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400205"><span class="hs-identifier hs-var">tc1</span></a><span> </span><span class="hs-special">`</span><a href="Type.html#nonDetCmpTc"><span class="hs-identifier hs-var">nonDetCmpTc</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400207"><span class="hs-identifier hs-var">tc2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679400166"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400169"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621679400204"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400206"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-6989586621679400208"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2275"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679400209"><a href="#local-6989586621679400209"><span class="hs-identifier">l1</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679400210"><a href="#local-6989586621679400210"><span class="hs-identifier">l2</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400165"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679400209"><span class="hs-identifier hs-var">l1</span></a><span> </span><a href="#local-6989586621679400210"><span class="hs-identifier hs-var">l2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2276"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400211"><a href="#local-6989586621679400211"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679400212"><a href="#local-6989586621679400212"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><a name="local-6989586621679400213"><a href="#local-6989586621679400213"><span class="hs-identifier">t2</span></a></a><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400167"><span class="hs-identifier hs-var">hasCast</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400211"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400212"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400213"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2277"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400214"><a href="#local-6989586621679400214"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679400215"><a href="#local-6989586621679400215"><span class="hs-identifier">t1</span></a></a><span>                  </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679400216"><a href="#local-6989586621679400216"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400167"><span class="hs-identifier hs-var">hasCast</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400214"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400215"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400216"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2278"></a><span>
</span><a name="line-2279"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>
</span><a name="line-2280"></a><span>
</span><a name="line-2281"></a><span>        </span><span class="hs-comment">-- Deal with the rest: TyVarTy &lt; CoercionTy &lt; AppTy &lt; LitTy &lt; TyConApp &lt; ForAllTy</span><span>
</span><a name="line-2282"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400217"><a href="#local-6989586621679400217"><span class="hs-identifier">ty1</span></a></a><span> </span><a name="local-6989586621679400218"><a href="#local-6989586621679400218"><span class="hs-identifier">ty2</span></a></a><span>
</span><a name="line-2283"></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400165"><span class="hs-identifier hs-var">liftOrdering</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400219"><span class="hs-identifier hs-var">get_rank</span></a><span> </span><a href="#local-6989586621679400217"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400219"><span class="hs-identifier hs-var">get_rank</span></a><span> </span><a href="#local-6989586621679400218"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">)</span><span>
</span><a name="line-2284"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-2285"></a><span>            </span><a name="local-6989586621679400219"><a href="#local-6989586621679400219"><span class="hs-identifier">get_rank</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-2286"></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;nonDetCmpTypeX.get_rank&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679400217"><span class="hs-identifier hs-var">ty1</span></a><span class="hs-special">,</span><a href="#local-6989586621679400218"><span class="hs-identifier hs-var">ty2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-2287"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-2288"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-2289"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span>
</span><a name="line-2290"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">4</span><span>
</span><a name="line-2291"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">5</span><span>
</span><a name="line-2292"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">6</span><span>
</span><a name="line-2293"></a><span>            </span><span class="hs-identifier">get_rank</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">7</span><span>
</span><a name="line-2294"></a><span>
</span><a name="line-2295"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Type.html#TypeOrdering"><span class="hs-identifier hs-type">TypeOrdering</span></a><span>
</span><a name="line-2296"></a><span>    </span><a name="local-6989586621679400169"><a href="#local-6989586621679400169"><span class="hs-identifier">gos</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TEQ"><span class="hs-identifier hs-var">TEQ</span></a><span>
</span><a name="line-2297"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TLT"><span class="hs-identifier hs-var">TLT</span></a><span>
</span><a name="line-2298"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#TGT"><span class="hs-identifier hs-var">TGT</span></a><span>
</span><a name="line-2299"></a><span>    </span><span class="hs-identifier">gos</span><span> </span><a name="local-6989586621679400220"><a href="#local-6989586621679400220"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400221"><a href="#local-6989586621679400221"><span class="hs-identifier">ty1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679400222"><a href="#local-6989586621679400222"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679400223"><a href="#local-6989586621679400223"><span class="hs-identifier">ty2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679400224"><a href="#local-6989586621679400224"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400168"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400220"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400221"><span class="hs-identifier hs-var">ty1</span></a><span> </span><a href="#local-6989586621679400223"><span class="hs-identifier hs-var">ty2</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679400166"><span class="hs-identifier hs-var">thenCmpTy</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400169"><span class="hs-identifier hs-var">gos</span></a><span> </span><a href="#local-6989586621679400220"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400222"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-6989586621679400224"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2300"></a><span>
</span><a name="line-2301"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-2302"></a><span class="hs-identifier">nonDetCmpTypesX</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="VarEnv.html#RnEnv2"><span class="hs-identifier hs-type">RnEnv2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2303"></a><a name="nonDetCmpTypesX"><a href="Type.html#nonDetCmpTypesX"><span class="hs-identifier">nonDetCmpTypesX</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-2304"></a><span class="hs-identifier">nonDetCmpTypesX</span><span> </span><a name="local-6989586621679400226"><a href="#local-6989586621679400226"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400227"><a href="#local-6989586621679400227"><span class="hs-identifier">t1</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679400228"><a href="#local-6989586621679400228"><span class="hs-identifier">tys1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679400229"><a href="#local-6989586621679400229"><span class="hs-identifier">t2</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679400230"><a href="#local-6989586621679400230"><span class="hs-identifier">tys2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#nonDetCmpTypeX"><span class="hs-identifier hs-var">nonDetCmpTypeX</span></a><span> </span><a href="#local-6989586621679400226"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400227"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679400229"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2305"></a><span>                                      </span><span class="hs-special">`</span><a href="Util.html#thenCmp"><span class="hs-identifier hs-var">thenCmp</span></a><span class="hs-special">`</span><span> </span><a href="Type.html#nonDetCmpTypesX"><span class="hs-identifier hs-var">nonDetCmpTypesX</span></a><span> </span><a href="#local-6989586621679400226"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679400228"><span class="hs-identifier hs-var">tys1</span></a><span> </span><a href="#local-6989586621679400230"><span class="hs-identifier hs-var">tys2</span></a><span>
</span><a name="line-2306"></a><span class="hs-identifier">nonDetCmpTypesX</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-2307"></a><span class="hs-identifier">nonDetCmpTypesX</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-identifier">_</span><span>         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-2308"></a><span>
</span><a name="line-2309"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-2310"></a><span class="hs-comment">-- | Compare two 'TyCon's. NB: This should /never/ see the &quot;star synonyms&quot;,</span><span>
</span><a name="line-2311"></a><span class="hs-comment">-- as recognized by Kind.isStarKindSynonymTyCon. See Note</span><span>
</span><a name="line-2312"></a><span class="hs-comment">-- [Kind Constraint and kind *] in Kind.</span><span>
</span><a name="line-2313"></a><span class="hs-comment">-- See Note [nonDetCmpType nondeterminism]</span><span>
</span><a name="line-2314"></a><span class="hs-identifier">nonDetCmpTc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span>
</span><a name="line-2315"></a><a name="nonDetCmpTc"><a href="Type.html#nonDetCmpTc"><span class="hs-identifier">nonDetCmpTc</span></a></a><span> </span><a name="local-6989586621679400231"><a href="#local-6989586621679400231"><span class="hs-identifier">tc1</span></a></a><span> </span><a name="local-6989586621679400232"><a href="#local-6989586621679400232"><span class="hs-identifier">tc2</span></a></a><span>
</span><a name="line-2316"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><a href="Util.html#debugIsOn"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">isStarKindSynonymTyCon</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">tc1</span></a><span class="hs-special">)</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">not</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">isStarKindSynonymTyCon</span><span> </span><a href="Kind.html#isStarKindSynonymTyCon"><span class="hs-identifier hs-var">tc2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-2317"></a><span>    </span><a href="#local-6989586621679400233"><span class="hs-identifier hs-var">u1</span></a><span> </span><span class="hs-special">`</span><a href="Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var">nonDetCmpUnique</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400234"><span class="hs-identifier hs-var">u2</span></a><span>
</span><a name="line-2318"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2319"></a><span>    </span><a name="local-6989586621679400233"><a href="#local-6989586621679400233"><span class="hs-identifier">u1</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConUnique</span><span> </span><a href="#local-6989586621679400231"><span class="hs-identifier hs-var">tc1</span></a><span>
</span><a name="line-2320"></a><span>    </span><a name="local-6989586621679400234"><a href="#local-6989586621679400234"><span class="hs-identifier">u2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tyConUnique</span><span> </span><a href="#local-6989586621679400232"><span class="hs-identifier hs-var">tc2</span></a><span>
</span><a name="line-2321"></a><span>
</span><a name="line-2322"></a><span class="hs-comment">{-
************************************************************************
*                                                                      *
        The kind of a type
*                                                                      *
************************************************************************
-}</span><span>
</span><a name="line-2329"></a><span>
</span><a name="line-2330"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Util.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-2331"></a><a name="typeKind"><a href="Type.html#typeKind"><span class="hs-identifier">typeKind</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400235"><a href="#local-6989586621679400235"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400236"><a href="#local-6989586621679400236"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-6989586621679400235"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400236"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2332"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679400237"><a href="#local-6989586621679400237"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679400238"><a href="#local-6989586621679400238"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTy"><span class="hs-identifier hs-var">piResultTy</span></a><span> </span><span class="hs-special">(</span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400237"><span class="hs-identifier hs-var">fun</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400238"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-2333"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><a name="local-6989586621679400239"><a href="#local-6989586621679400239"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeLiteralKind"><span class="hs-identifier hs-var">typeLiteralKind</span></a><span> </span><a href="#local-6989586621679400239"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-2334"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="TysWiredIn.html#liftedTypeKind"><span class="hs-identifier hs-var">liftedTypeKind</span></a><span>
</span><a name="line-2335"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400240"><a href="#local-6989586621679400240"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span> </span><a href="#local-6989586621679400240"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2336"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679400241"><a href="#local-6989586621679400241"><span class="hs-identifier">tyvar</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400241"><span class="hs-identifier hs-var">tyvar</span></a><span>
</span><a name="line-2337"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679400242"><a href="#local-6989586621679400242"><span class="hs-identifier">_ty</span></a></a><span> </span><a name="local-6989586621679400243"><a href="#local-6989586621679400243"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pSnd</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a><span> </span><a href="#local-6989586621679400243"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2338"></a><span class="hs-identifier">typeKind</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679400244"><a href="#local-6989586621679400244"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Coercion.html#coercionType"><span class="hs-identifier hs-var">coercionType</span></a><span> </span><a href="#local-6989586621679400244"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2339"></a><span>
</span><a name="line-2340"></a><span class="hs-identifier">typeLiteralKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#TyLit"><span class="hs-identifier hs-type">TyLit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-2341"></a><a name="typeLiteralKind"><a href="Type.html#typeLiteralKind"><span class="hs-identifier">typeLiteralKind</span></a></a><span> </span><a name="local-6989586621679400245"><a href="#local-6989586621679400245"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-2342"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679400245"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-2343"></a><span>    </span><a href="TyCoRep.html#NumTyLit"><span class="hs-identifier hs-var">NumTyLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysWiredIn.html#typeNatKind"><span class="hs-identifier hs-var">typeNatKind</span></a><span>
</span><a name="line-2344"></a><span>    </span><a href="TyCoRep.html#StrTyLit"><span class="hs-identifier hs-var">StrTyLit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TysWiredIn.html#typeSymbolKind"><span class="hs-identifier hs-var">typeSymbolKind</span></a><span>
</span><a name="line-2345"></a><span>
</span><a name="line-2346"></a><span class="hs-comment">-- | Returns True if a type is levity polymorphic. Should be the same</span><span>
</span><a name="line-2347"></a><span class="hs-comment">-- as (isKindLevPoly . typeKind) but much faster.</span><span>
</span><a name="line-2348"></a><span class="hs-comment">-- Precondition: The type has kind (TYPE blah)</span><span>
</span><a name="line-2349"></a><span class="hs-identifier">isTypeLevPoly</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2350"></a><a name="isTypeLevPoly"><a href="Type.html#isTypeLevPoly"><span class="hs-identifier">isTypeLevPoly</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400246"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-2351"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2352"></a><span>    </span><a name="local-6989586621679400246"><a href="#local-6989586621679400246"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679400248"><a href="#local-6989586621679400248"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400247"><span class="hs-identifier hs-var">check_kind</span></a><span> </span><a href="#local-6989586621679400248"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2353"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400249"><a href="#local-6989586621679400249"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400247"><span class="hs-identifier hs-var">check_kind</span></a><span> </span><a href="#local-6989586621679400249"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2354"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400250"><a href="#local-6989586621679400250"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400251"><a href="#local-6989586621679400251"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="TyCon.html#isTcLevPoly"><span class="hs-identifier hs-var">isTcLevPoly</span></a><span> </span><a href="#local-6989586621679400251"><span class="hs-identifier hs-var">tc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2355"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400247"><span class="hs-identifier hs-var">check_kind</span></a><span> </span><a href="#local-6989586621679400250"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2356"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400252"><a href="#local-6989586621679400252"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400246"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400252"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2357"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2358"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-2359"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400253"><a href="#local-6989586621679400253"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400247"><span class="hs-identifier hs-var">check_kind</span></a><span> </span><a href="#local-6989586621679400253"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2360"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400254"><a href="#local-6989586621679400254"><span class="hs-identifier">ty</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                        </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;isTypeLevPoly co&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400254"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2361"></a><span>
</span><a name="line-2362"></a><span>    </span><a name="local-6989586621679400247"><a href="#local-6989586621679400247"><span class="hs-identifier">check_kind</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Kind.html#isKindLevPoly"><span class="hs-identifier hs-var">isKindLevPoly</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Type.html#typeKind"><span class="hs-identifier hs-var">typeKind</span></a><span>
</span><a name="line-2363"></a><span>
</span><a name="line-2364"></a><span class="hs-comment">-- | Looking past all pi-types, is the end result potentially levity polymorphic?</span><span>
</span><a name="line-2365"></a><span class="hs-comment">-- Example: True for (forall r (a :: TYPE r). String -&gt; a)</span><span>
</span><a name="line-2366"></a><span class="hs-comment">-- Example: False for (forall r1 r2 (a :: TYPE r1) (b :: TYPE r2). a -&gt; b -&gt; Type)</span><span>
</span><a name="line-2367"></a><span class="hs-identifier">resultIsLevPoly</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-2368"></a><a name="resultIsLevPoly"><a href="Type.html#resultIsLevPoly"><span class="hs-identifier">resultIsLevPoly</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#isTypeLevPoly"><span class="hs-identifier hs-var">isTypeLevPoly</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Type.html#splitPiTys"><span class="hs-identifier hs-var">splitPiTys</span></a><span>
</span><a name="line-2369"></a><span>
</span><a name="line-2370"></a><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
        Miscellaneous functions
%*                                                                      *
%************************************************************************

-}</span><span>
</span><a name="line-2378"></a><span class="hs-comment">-- | All type constructors occurring in the type; looking through type</span><span>
</span><a name="line-2379"></a><span class="hs-comment">--   synonyms, but not newtypes.</span><span>
</span><a name="line-2380"></a><span class="hs-comment">--  When it finds a Class, it returns the class TyCon.</span><span>
</span><a name="line-2381"></a><span class="hs-identifier">tyConsOfType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSet.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>
</span><a name="line-2382"></a><a name="tyConsOfType"><a href="Type.html#tyConsOfType"><span class="hs-identifier">tyConsOfType</span></a></a><span> </span><a name="local-6989586621679400255"><a href="#local-6989586621679400255"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2383"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400255"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2384"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2385"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="UniqSet.html#UniqSet"><span class="hs-identifier hs-type">UniqSet</span></a><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span>  </span><span class="hs-comment">-- The UniqSet does duplicate elim</span><span>
</span><a name="line-2386"></a><span>     </span><a name="local-6989586621679400256"><a href="#local-6989586621679400256"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679400263"><a href="#local-6989586621679400263"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679400264"><a href="#local-6989586621679400264"><span class="hs-identifier">ty'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#coreView"><span class="hs-identifier hs-var">coreView</span></a><span> </span><a href="#local-6989586621679400263"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400264"><span class="hs-identifier hs-var">ty'</span></a><span>
</span><a name="line-2387"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span>
</span><a name="line-2388"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span>
</span><a name="line-2389"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400265"><a href="#local-6989586621679400265"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400266"><a href="#local-6989586621679400266"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400261"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-6989586621679400265"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400259"><span class="hs-identifier hs-var">go_s</span></a><span> </span><a href="#local-6989586621679400266"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2390"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679400267"><a href="#local-6989586621679400267"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679400268"><a href="#local-6989586621679400268"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400267"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400268"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-2391"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679400269"><a href="#local-6989586621679400269"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679400270"><a href="#local-6989586621679400270"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400269"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400270"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400261"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="TysPrim.html#funTyCon"><span class="hs-identifier hs-var">funTyCon</span></a><span>
</span><a name="line-2392"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679400271"><a href="#local-6989586621679400271"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679400272"><a href="#local-6989586621679400272"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400272"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400271"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2393"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679400273"><a href="#local-6989586621679400273"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679400274"><a href="#local-6989586621679400274"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400273"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400274"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2394"></a><span>     </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679400275"><a href="#local-6989586621679400275"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400275"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2395"></a><span>
</span><a name="line-2396"></a><span>     </span><a name="local-6989586621679400257"><a href="#local-6989586621679400257"><span class="hs-identifier">go_co</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Refl"><span class="hs-identifier hs-var">Refl</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400276"><a href="#local-6989586621679400276"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400276"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2397"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConAppCo"><span class="hs-identifier hs-var">TyConAppCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400277"><a href="#local-6989586621679400277"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400278"><a href="#local-6989586621679400278"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400261"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-6989586621679400277"><span class="hs-identifier hs-var">tc</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400260"><span class="hs-identifier hs-var">go_cos</span></a><span> </span><a href="#local-6989586621679400278"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2398"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppCo"><span class="hs-identifier hs-var">AppCo</span></a><span> </span><a name="local-6989586621679400279"><a href="#local-6989586621679400279"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679400280"><a href="#local-6989586621679400280"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400279"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400280"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-2399"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllCo"><span class="hs-identifier hs-var">ForAllCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400281"><a href="#local-6989586621679400281"><span class="hs-identifier">kind_co</span></a></a><span> </span><a name="local-6989586621679400282"><a href="#local-6989586621679400282"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400281"><span class="hs-identifier hs-var">kind_co</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400282"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2400"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunCo"><span class="hs-identifier hs-var">FunCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400283"><a href="#local-6989586621679400283"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-6989586621679400284"><a href="#local-6989586621679400284"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400283"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400284"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-2401"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomInstCo"><span class="hs-identifier hs-var">AxiomInstCo</span></a><span> </span><a name="local-6989586621679400285"><a href="#local-6989586621679400285"><span class="hs-identifier">ax</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400286"><a href="#local-6989586621679400286"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400262"><span class="hs-identifier hs-var">go_ax</span></a><span> </span><a href="#local-6989586621679400285"><span class="hs-identifier hs-var">ax</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400260"><span class="hs-identifier hs-var">go_cos</span></a><span> </span><a href="#local-6989586621679400286"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-2402"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#UnivCo"><span class="hs-identifier hs-var">UnivCo</span></a><span> </span><a name="local-6989586621679400287"><a href="#local-6989586621679400287"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400288"><a href="#local-6989586621679400288"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400289"><a href="#local-6989586621679400289"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400258"><span class="hs-identifier hs-var">go_prov</span></a><span> </span><a href="#local-6989586621679400287"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400288"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400289"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2403"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span>
</span><a name="line-2404"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#HoleCo"><span class="hs-identifier hs-var">HoleCo</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span>
</span><a name="line-2405"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SymCo"><span class="hs-identifier hs-var">SymCo</span></a><span> </span><a name="local-6989586621679400290"><a href="#local-6989586621679400290"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400290"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2406"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TransCo"><span class="hs-identifier hs-var">TransCo</span></a><span> </span><a name="local-6989586621679400291"><a href="#local-6989586621679400291"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-6989586621679400292"><a href="#local-6989586621679400292"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400291"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400292"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-2407"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#NthCo"><span class="hs-identifier hs-var">NthCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400293"><a href="#local-6989586621679400293"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400293"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2408"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LRCo"><span class="hs-identifier hs-var">LRCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400294"><a href="#local-6989586621679400294"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400294"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2409"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#InstCo"><span class="hs-identifier hs-var">InstCo</span></a><span> </span><a name="local-6989586621679400295"><a href="#local-6989586621679400295"><span class="hs-identifier">co</span></a></a><span> </span><a name="local-6989586621679400296"><a href="#local-6989586621679400296"><span class="hs-identifier">arg</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400295"><span class="hs-identifier hs-var">co</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400296"><span class="hs-identifier hs-var">arg</span></a><span>
</span><a name="line-2410"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoherenceCo"><span class="hs-identifier hs-var">CoherenceCo</span></a><span> </span><a name="local-6989586621679400297"><a href="#local-6989586621679400297"><span class="hs-identifier">co1</span></a></a><span> </span><a name="local-6989586621679400298"><a href="#local-6989586621679400298"><span class="hs-identifier">co2</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400297"><span class="hs-identifier hs-var">co1</span></a><span> </span><span class="hs-special">`</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400298"><span class="hs-identifier hs-var">co2</span></a><span>
</span><a name="line-2411"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#KindCo"><span class="hs-identifier hs-var">KindCo</span></a><span> </span><a name="local-6989586621679400299"><a href="#local-6989586621679400299"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400299"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2412"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#SubCo"><span class="hs-identifier hs-var">SubCo</span></a><span> </span><a name="local-6989586621679400300"><a href="#local-6989586621679400300"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400300"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2413"></a><span>     </span><span class="hs-identifier">go_co</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679400301"><a href="#local-6989586621679400301"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400260"><span class="hs-identifier hs-var">go_cos</span></a><span> </span><a href="#local-6989586621679400301"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-2414"></a><span>
</span><a name="line-2415"></a><span>     </span><a name="local-6989586621679400258"><a href="#local-6989586621679400258"><span class="hs-identifier">go_prov</span></a></a><span> </span><a href="TyCoRep.html#UnsafeCoerceProv"><span class="hs-identifier hs-var">UnsafeCoerceProv</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span>
</span><a name="line-2416"></a><span>     </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a><span> </span><a name="local-6989586621679400302"><a href="#local-6989586621679400302"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400302"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2417"></a><span>     </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a><span> </span><a name="local-6989586621679400303"><a href="#local-6989586621679400303"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span> </span><a href="#local-6989586621679400303"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2418"></a><span>     </span><span class="hs-identifier">go_prov</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#PluginProv"><span class="hs-identifier hs-var">PluginProv</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span>
</span><a name="line-2419"></a><span>        </span><span class="hs-comment">-- this last case can happen from the tyConsOfType used from</span><span>
</span><a name="line-2420"></a><span>        </span><span class="hs-comment">-- checkTauTvUpdate</span><span>
</span><a name="line-2421"></a><span>
</span><a name="line-2422"></a><span>     </span><a name="local-6989586621679400259"><a href="#local-6989586621679400259"><span class="hs-identifier">go_s</span></a></a><span> </span><a name="local-6989586621679400304"><a href="#local-6989586621679400304"><span class="hs-identifier">tys</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679400256"><span class="hs-identifier hs-var">go</span></a><span class="hs-special">)</span><span>     </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span> </span><a href="#local-6989586621679400304"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2423"></a><span>     </span><a name="local-6989586621679400260"><a href="#local-6989586621679400260"><span class="hs-identifier">go_cos</span></a></a><span> </span><a name="local-6989586621679400305"><a href="#local-6989586621679400305"><span class="hs-identifier">cos</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="UniqSet.html#unionUniqSets"><span class="hs-identifier hs-var">unionUniqSets</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679400257"><span class="hs-identifier hs-var">go_co</span></a><span class="hs-special">)</span><span>  </span><a href="UniqSet.html#emptyUniqSet"><span class="hs-identifier hs-var">emptyUniqSet</span></a><span> </span><a href="#local-6989586621679400305"><span class="hs-identifier hs-var">cos</span></a><span>
</span><a name="line-2424"></a><span>
</span><a name="line-2425"></a><span>     </span><a name="local-6989586621679400261"><a href="#local-6989586621679400261"><span class="hs-identifier">go_tc</span></a></a><span> </span><a name="local-6989586621679400306"><a href="#local-6989586621679400306"><span class="hs-identifier">tc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="UniqSet.html#unitUniqSet"><span class="hs-identifier hs-var">unitUniqSet</span></a><span> </span><a href="#local-6989586621679400306"><span class="hs-identifier hs-var">tc</span></a><span>
</span><a name="line-2426"></a><span>     </span><a name="local-6989586621679400262"><a href="#local-6989586621679400262"><span class="hs-identifier">go_ax</span></a></a><span> </span><a name="local-6989586621679400307"><a href="#local-6989586621679400307"><span class="hs-identifier">ax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400261"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="CoAxiom.html#coAxiomTyCon"><span class="hs-identifier hs-var">coAxiomTyCon</span></a><span> </span><a href="#local-6989586621679400307"><span class="hs-identifier hs-var">ax</span></a><span>
</span><a name="line-2427"></a><span>
</span><a name="line-2428"></a><span class="hs-comment">-- | Find the result 'Kind' of a type synonym,</span><span>
</span><a name="line-2429"></a><span class="hs-comment">-- after applying it to its 'arity' number of type variables</span><span>
</span><a name="line-2430"></a><span class="hs-comment">-- Actually this function works fine on data types too,</span><span>
</span><a name="line-2431"></a><span class="hs-comment">-- but they'd always return '*', so we never need to ask</span><span>
</span><a name="line-2432"></a><span class="hs-identifier">synTyConResKind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Kind"><span class="hs-identifier hs-type">Kind</span></a><span>
</span><a name="line-2433"></a><a name="synTyConResKind"><a href="Type.html#synTyConResKind"><span class="hs-identifier">synTyConResKind</span></a></a><span> </span><a name="local-6989586621679400308"><a href="#local-6989586621679400308"><span class="hs-identifier">tycon</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#piResultTys"><span class="hs-identifier hs-var">piResultTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConKind</span><span> </span><a href="#local-6989586621679400308"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#mkTyVarTys"><span class="hs-identifier hs-var">mkTyVarTys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tyConTyVars</span><span> </span><a href="#local-6989586621679400308"><span class="hs-identifier hs-var">tycon</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2434"></a><span>
</span><a name="line-2435"></a><span class="hs-comment">-- | Retrieve the free variables in this type, splitting them based</span><span>
</span><a name="line-2436"></a><span class="hs-comment">-- on whether they are used visibly or invisibly. Invisible ones come</span><span>
</span><a name="line-2437"></a><span class="hs-comment">-- first.</span><span>
</span><a name="line-2438"></a><span class="hs-identifier">splitVisVarsOfType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-2439"></a><a name="splitVisVarsOfType"><a href="Type.html#splitVisVarsOfType"><span class="hs-identifier">splitVisVarsOfType</span></a></a><span> </span><a name="local-6989586621679400309"><a href="#local-6989586621679400309"><span class="hs-identifier">orig_ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679400312"><span class="hs-identifier hs-var">invis_vars</span></a><span> </span><a href="#local-6989586621679400311"><span class="hs-identifier hs-var">vis_vars</span></a><span>
</span><a name="line-2440"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2441"></a><span>    </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679400310"><a href="#local-6989586621679400310"><span class="hs-identifier">invis_vars1</span></a></a><span> </span><a name="local-6989586621679400311"><a href="#local-6989586621679400311"><span class="hs-identifier">vis_vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400309"><span class="hs-identifier hs-var">orig_ty</span></a><span>
</span><a name="line-2442"></a><span>    </span><a name="local-6989586621679400312"><a href="#local-6989586621679400312"><span class="hs-identifier">invis_vars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400310"><span class="hs-identifier hs-var">invis_vars1</span></a><span> </span><span class="hs-special">`</span><a href="VarSet.html#minusVarSet"><span class="hs-identifier hs-var">minusVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400311"><span class="hs-identifier hs-var">vis_vars</span></a><span>
</span><a name="line-2443"></a><span>
</span><a name="line-2444"></a><span>    </span><a name="local-6989586621679400313"><a href="#local-6989586621679400313"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a><span> </span><a name="local-6989586621679400316"><a href="#local-6989586621679400316"><span class="hs-identifier">tv</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400316"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="VarSet.html#unitVarSet"><span class="hs-identifier hs-var">unitVarSet</span></a><span> </span><a href="#local-6989586621679400316"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span>
</span><a name="line-2445"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#AppTy"><span class="hs-identifier hs-var">AppTy</span></a><span> </span><a name="local-6989586621679400317"><a href="#local-6989586621679400317"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400318"><a href="#local-6989586621679400318"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400317"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400318"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2446"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#TyConApp"><span class="hs-identifier hs-var">TyConApp</span></a><span> </span><a name="local-6989586621679400319"><a href="#local-6989586621679400319"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400320"><a href="#local-6989586621679400320"><span class="hs-identifier">tys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400315"><span class="hs-identifier hs-var">go_tc</span></a><span> </span><a href="#local-6989586621679400319"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="#local-6989586621679400320"><span class="hs-identifier hs-var">tys</span></a><span>
</span><a name="line-2447"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#FunTy"><span class="hs-identifier hs-var">FunTy</span></a><span> </span><a name="local-6989586621679400321"><a href="#local-6989586621679400321"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679400322"><a href="#local-6989586621679400322"><span class="hs-identifier">t2</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400321"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400322"><span class="hs-identifier hs-var">t2</span></a><span>
</span><a name="line-2448"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a><span> </span><span class="hs-special">(</span><a href="Var.html#TvBndr"><span class="hs-identifier hs-var">TvBndr</span></a><span> </span><a name="local-6989586621679400323"><a href="#local-6989586621679400323"><span class="hs-identifier">tv</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679400324"><a href="#local-6989586621679400324"><span class="hs-identifier">ty</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-2449"></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">`</span><a href="VarSet.html#delVarSet"><span class="hs-identifier hs-var">delVarSet</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400323"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400324"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span>
</span><a name="line-2450"></a><span>        </span><span class="hs-special">(</span><a href="#local-6989586621679400314"><span class="hs-identifier hs-var">invisible</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a><span> </span><a href="#local-6989586621679400323"><span class="hs-identifier hs-var">tv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-2451"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a><span>
</span><a name="line-2452"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CastTy"><span class="hs-identifier hs-var">CastTy</span></a><span> </span><a name="local-6989586621679400325"><a href="#local-6989586621679400325"><span class="hs-identifier">ty</span></a></a><span> </span><a name="local-6989586621679400326"><a href="#local-6989586621679400326"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400325"><span class="hs-identifier hs-var">ty</span></a><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679400314"><span class="hs-identifier hs-var">invisible</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a><span> </span><a href="#local-6989586621679400326"><span class="hs-identifier hs-var">co</span></a><span class="hs-special">)</span><span>
</span><a name="line-2453"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a><span> </span><a name="local-6989586621679400327"><a href="#local-6989586621679400327"><span class="hs-identifier">co</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400314"><span class="hs-identifier hs-var">invisible</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="TyCoRep.html#tyCoVarsOfCo"><span class="hs-identifier hs-var">tyCoVarsOfCo</span></a><span> </span><a href="#local-6989586621679400327"><span class="hs-identifier hs-var">co</span></a><span>
</span><a name="line-2454"></a><span>
</span><a name="line-2455"></a><span>    </span><a name="local-6989586621679400314"><a href="#local-6989586621679400314"><span class="hs-identifier">invisible</span></a></a><span> </span><a name="local-6989586621679400328"><a href="#local-6989586621679400328"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679400328"><span class="hs-identifier hs-var">vs</span></a><span> </span><a href="VarSet.html#emptyVarSet"><span class="hs-identifier hs-var">emptyVarSet</span></a><span>
</span><a name="line-2456"></a><span>
</span><a name="line-2457"></a><span>    </span><a name="local-6989586621679400315"><a href="#local-6989586621679400315"><span class="hs-identifier">go_tc</span></a></a><span> </span><a name="local-6989586621679400329"><a href="#local-6989586621679400329"><span class="hs-identifier">tc</span></a></a><span> </span><a name="local-6989586621679400330"><a href="#local-6989586621679400330"><span class="hs-identifier">tys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679400331"><a href="#local-6989586621679400331"><span class="hs-identifier">invis</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400332"><a href="#local-6989586621679400332"><span class="hs-identifier">vis</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#partitionInvisibles"><span class="hs-identifier hs-var">partitionInvisibles</span></a><span> </span><a href="#local-6989586621679400329"><span class="hs-identifier hs-var">tc</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679400330"><span class="hs-identifier hs-var">tys</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-2458"></a><span>                   </span><a href="#local-6989586621679400314"><span class="hs-identifier hs-var">invisible</span></a><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#tyCoVarsOfTypes"><span class="hs-identifier hs-var">tyCoVarsOfTypes</span></a><span> </span><a href="#local-6989586621679400331"><span class="hs-identifier hs-var">invis</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a><span class="hs-special">`</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="#local-6989586621679400313"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400332"><span class="hs-identifier hs-var">vis</span></a><span>
</span><a name="line-2459"></a><span>
</span><a name="line-2460"></a><span class="hs-identifier">splitVisVarsOfTypes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a><span> </span><a href="VarSet.html#TyCoVarSet"><span class="hs-identifier hs-type">TyCoVarSet</span></a><span>
</span><a name="line-2461"></a><a name="splitVisVarsOfTypes"><a href="Type.html#splitVisVarsOfTypes"><span class="hs-identifier">splitVisVarsOfTypes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a><span> </span><a href="Type.html#splitVisVarsOfType"><span class="hs-identifier hs-var">splitVisVarsOfType</span></a><span>
</span><a name="line-2462"></a><span>
</span><a name="line-2463"></a><span class="hs-identifier">modifyJoinResTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>            </span><span class="hs-comment">-- Number of binders to skip</span><span>
</span><a name="line-2464"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Function to apply to result type</span><span>
</span><a name="line-2465"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>           </span><span class="hs-comment">-- Type of join point</span><span>
</span><a name="line-2466"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>           </span><span class="hs-comment">-- New type</span><span>
</span><a name="line-2467"></a><span class="hs-comment">-- INVARIANT: If any of the first n binders are foralls, those tyvars cannot</span><span>
</span><a name="line-2468"></a><span class="hs-comment">-- appear in the original result type. See isValidJoinPointType.</span><span>
</span><a name="line-2469"></a><a name="modifyJoinResTy"><a href="Type.html#modifyJoinResTy"><span class="hs-identifier">modifyJoinResTy</span></a></a><span> </span><a name="local-6989586621679400333"><a href="#local-6989586621679400333"><span class="hs-identifier">orig_ar</span></a></a><span> </span><a name="local-6989586621679400334"><a href="#local-6989586621679400334"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679400335"><a href="#local-6989586621679400335"><span class="hs-identifier">orig_ty</span></a></a><span>
</span><a name="line-2470"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400336"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679400333"><span class="hs-identifier hs-var">orig_ar</span></a><span> </span><a href="#local-6989586621679400335"><span class="hs-identifier hs-var">orig_ty</span></a><span>
</span><a name="line-2471"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-2472"></a><span>    </span><a name="local-6989586621679400336"><a href="#local-6989586621679400336"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679400337"><a href="#local-6989586621679400337"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679400334"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679400337"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2473"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679400338"><a href="#local-6989586621679400338"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679400339"><a href="#local-6989586621679400339"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679400340"><a href="#local-6989586621679400340"><span class="hs-identifier">arg_bndr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679400341"><a href="#local-6989586621679400341"><span class="hs-identifier">res_ty</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Type.html#splitPiTy_maybe"><span class="hs-identifier hs-var">splitPiTy_maybe</span></a><span> </span><a href="#local-6989586621679400339"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2474"></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="TyCoRep.html#mkPiTy"><span class="hs-identifier hs-var">mkPiTy</span></a><span> </span><a href="#local-6989586621679400340"><span class="hs-identifier hs-var">arg_bndr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400336"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679400338"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400341"><span class="hs-identifier hs-var">res_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2475"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>
</span><a name="line-2476"></a><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Outputable.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a><span> </span><span class="hs-string">&quot;modifyJoinResTy&quot;</span><span> </span><span class="hs-special">(</span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400333"><span class="hs-identifier hs-var">orig_ar</span></a><span> </span><a href="Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a><span> </span><a href="Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a><span> </span><a href="#local-6989586621679400335"><span class="hs-identifier hs-var">orig_ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-2477"></a><span>
</span><a name="line-2478"></a><span class="hs-identifier">setJoinResTy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>  </span><span class="hs-comment">-- Number of binders to skip</span><span>
</span><a name="line-2479"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-comment">-- New result type</span><span>
</span><a name="line-2480"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-comment">-- Type of join point</span><span>
</span><a name="line-2481"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-comment">-- New type</span><span>
</span><a name="line-2482"></a><span class="hs-comment">-- INVARIANT: Same as for modifyJoinResTy</span><span>
</span><a name="line-2483"></a><a name="setJoinResTy"><a href="Type.html#setJoinResTy"><span class="hs-identifier">setJoinResTy</span></a></a><span> </span><a name="local-6989586621679400342"><a href="#local-6989586621679400342"><span class="hs-identifier">ar</span></a></a><span> </span><a name="local-6989586621679400343"><a href="#local-6989586621679400343"><span class="hs-identifier">new_res_ty</span></a></a><span> </span><a name="local-6989586621679400344"><a href="#local-6989586621679400344"><span class="hs-identifier">ty</span></a></a><span>
</span><a name="line-2484"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Type.html#modifyJoinResTy"><span class="hs-identifier hs-var">modifyJoinResTy</span></a><span> </span><a href="#local-6989586621679400342"><span class="hs-identifier hs-var">ar</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a><span> </span><a href="#local-6989586621679400343"><span class="hs-identifier hs-var">new_res_ty</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679400344"><span class="hs-identifier hs-var">ty</span></a><span>
</span><a name="line-2485"></a></pre></body></html>